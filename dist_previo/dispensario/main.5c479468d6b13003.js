(self.webpackChunkdispensario=self.webpackChunkdispensario||[]).push([[179],{3901:(Md,Ys,qi)=>{"use strict";function zn(t){return"function"==typeof t}function pl(t){const e=t(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const ga=pl(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Ur(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class br{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(zn(r))try{r()}catch(o){n=o instanceof ga?o.errors:[o]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const o of i)try{Tn(o)}catch(a){n=n??[],a instanceof ga?n=[...n,...a.errors]:n.push(a)}}if(n)throw new ga(n)}}add(n){var e;if(n&&n!==this)if(this.closed)Tn(n);else{if(n instanceof br){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&Ur(e,n)}remove(n){const{_finalizers:e}=this;e&&Ur(e,n),n instanceof br&&n._removeParent(this)}}br.EMPTY=(()=>{const t=new br;return t.closed=!0,t})();const yr=br.EMPTY;function pn(t){return t instanceof br||t&&"closed"in t&&zn(t.remove)&&zn(t.add)&&zn(t.unsubscribe)}function Tn(t){zn(t)?t():t.unsubscribe()}const ir={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},yn={setTimeout(t,n,...e){const{delegate:r}=yn;return r?.setTimeout?r.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=yn;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function on(t){yn.setTimeout(()=>{const{onUnhandledError:n}=ir;if(!n)throw t;n(t)})}function Dn(){}const ut=Ot("C",void 0,void 0);function Ot(t,n,e){return{kind:t,value:n,error:e}}let lt=null;function Ie(t){if(ir.useDeprecatedSynchronousErrorHandling){const n=!lt;if(n&&(lt={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:r}=lt;if(lt=null,e)throw r}}else t()}class _t extends br{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,pn(n)&&n.add(this)):this.destination=kn}static create(n,e,r){return new Jt(n,e,r)}next(n){this.isStopped?vt(function hn(t){return Ot("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?vt(function Cn(t){return Ot("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?vt(ut,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Et=Function.prototype.bind;function Je(t,n){return Et.call(t,n)}class Ft{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(r){tn(r)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(r){tn(r)}else tn(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){tn(e)}}}class Jt extends _t{constructor(n,e,r){let i;if(super(),zn(n)||!n)i={next:n??void 0,error:e??void 0,complete:r??void 0};else{let o;this&&ir.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),i={next:n.next&&Je(n.next,o),error:n.error&&Je(n.error,o),complete:n.complete&&Je(n.complete,o)}):i=n}this.destination=new Ft(i)}}function tn(t){ir.useDeprecatedSynchronousErrorHandling?function Ze(t){ir.useDeprecatedSynchronousErrorHandling&&lt&&(lt.errorThrown=!0,lt.error=t)}(t):on(t)}function vt(t,n){const{onStoppedNotification:e}=ir;e&&yn.setTimeout(()=>e(t,n))}const kn={closed:!0,next:Dn,error:function nn(t){throw t},complete:Dn},ur="function"==typeof Symbol&&Symbol.observable||"@@observable";function xr(t){return t}function mt(t){return 0===t.length?xr:1===t.length?t[0]:function(e){return t.reduce((r,i)=>i(r),e)}}let Ht=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new t;return r.source=this,r.operator=e,r}subscribe(e,r,i){const o=function Ve(t){return t&&t instanceof _t||function Qn(t){return t&&zn(t.next)&&zn(t.error)&&zn(t.complete)}(t)&&pn(t)}(e)?e:new Jt(e,r,i);return Ie(()=>{const{operator:a,source:s}=this;o.add(a?a.call(o,s):s?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=Rt(r))((i,o)=>{const a=new Jt({next:s=>{try{e(s)}catch(l){o(l),a.unsubscribe()}},error:o,complete:i});this.subscribe(a)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[ur](){return this}pipe(...e){return mt(e)(this)}toPromise(e){return new(e=Rt(e))((r,i)=>{let o;this.subscribe(a=>o=a,a=>i(a),()=>r(o))})}}return t.create=n=>new t(n),t})();function Rt(t){var n;return null!==(n=t??ir.Promise)&&void 0!==n?n:Promise}const dr=pl(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Bt=(()=>{class t extends Ht{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new Ar(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new dr}next(e){Ie(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){Ie(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){Ie(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:i,observers:o}=this;return r||i?yr:(this.currentObservers=null,o.push(e),new br(()=>{this.currentObservers=null,Ur(o,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:i,isStopped:o}=this;r?e.error(i):o&&e.complete()}asObservable(){const e=new Ht;return e.source=this,e}}return t.create=(n,e)=>new Ar(n,e),t})();class Ar extends Bt{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,n)}error(n){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==r?r:yr}}function Dr(t){return zn(t?.lift)}function wn(t){return n=>{if(Dr(n))return n.lift(function(e){try{return t(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Rr(t,n,e,r,i){return new la(t,n,e,r,i)}class la extends _t{constructor(n,e,r,i,o,a){super(n),this.onFinalize=o,this.shouldUnsubscribe=a,this._next=e?function(s){try{e(s)}catch(l){n.error(l)}}:super._next,this._error=i?function(s){try{i(s)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(s){n.error(s)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function gr(t,n){return wn((e,r)=>{let i=0;e.subscribe(Rr(r,o=>{r.next(t.call(n,o,i++))}))})}function xa(t,n){return function(e,r){n(e,r,t)}}function g0(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)}function Yi(t){return this instanceof Yi?(this.v=t,this):new Yi(t)}function Pd(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function hu(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(o){e[o]=t[o]&&function(a){return new Promise(function(s,l){!function i(o,a,s,l){Promise.resolve(l).then(function(c){o({value:c,done:s})},a)}(s,l,(a=t[o](a)).done,a.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const Vf=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Qu(t){return zn(t?.then)}function Pi(t){return zn(t[ur])}function sc(t){return Symbol.asyncIterator&&zn(t?.[Symbol.asyncIterator])}function pu(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Ca=function mu(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function es(t){return zn(t?.[Ca])}function Gh(t){return function jo(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=e.apply(t,n||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(E){r[E]&&(i[E]=function(D){return new Promise(function(k,T){o.push([E,D,k,T])>1||s(E,D)})})}function s(E,D){try{!function l(E){E.value instanceof Yi?Promise.resolve(E.value.v).then(c,f):v(o[0][2],E)}(r[E](D))}catch(k){v(o[0][3],k)}}function c(E){s("next",E)}function f(E){s("throw",E)}function v(E,D){E(D),o.shift(),o.length&&s(o[0][0],o[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:r,done:i}=yield Yi(e.read());if(i)return yield Yi(void 0);yield yield Yi(r)}}finally{e.releaseLock()}})}function Uf(t){return zn(t?.getReader)}function ja(t){if(t instanceof Ht)return t;if(null!=t){if(Pi(t))return function gl(t){return new Ht(n=>{const e=t[ur]();if(zn(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Vf(t))return function d2(t){return new Ht(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(Qu(t))return function Od(t){return new Ht(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,on)})}(t);if(sc(t))return Dm(t);if(es(t))return function x_(t){return new Ht(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Uf(t))return function C_(t){return Dm(Gh(t))}(t)}throw pu(t)}function Dm(t){return new Ht(n=>{(function Hf(t,n){var e,r,i,o;return function xm(t,n,e,r){return new(e||(e=Promise))(function(o,a){function s(f){try{c(r.next(f))}catch(v){a(v)}}function l(f){try{c(r.throw(f))}catch(v){a(v)}}function c(f){f.done?o(f.value):function i(o){return o instanceof e?o:new e(function(a){a(o)})}(f.value).then(s,l)}c((r=r.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Pd(t);!(r=yield e.next()).done;)if(n.next(r.value),n.closed)return}catch(a){i={error:a}}finally{try{r&&!r.done&&(o=e.return)&&(yield o.call(e))}finally{if(i)throw i.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function gu(t,n,e,r=0,i=!1){const o=n.schedule(function(){e(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function ko(t,n,e=1/0){return zn(n)?ko((r,i)=>gr((o,a)=>n(r,o,i,a))(ja(t(r,i))),e):("number"==typeof n&&(e=n),wn((r,i)=>function f2(t,n,e,r,i,o,a,s){const l=[];let c=0,f=0,v=!1;const E=()=>{v&&!l.length&&!c&&n.complete()},D=T=>c<r?k(T):l.push(T),k=T=>{o&&n.next(T),c++;let R=!1;ja(e(T,f++)).subscribe(Rr(n,q=>{i?.(q),o?D(q):n.next(q)},()=>{R=!0},void 0,()=>{if(R)try{for(c--;l.length&&c<r;){const q=l.shift();a?gu(n,a,()=>k(q)):k(q)}E()}catch(q){n.error(q)}}))};return t.subscribe(Rr(n,D,()=>{v=!0,E()})),()=>{s?.()}}(r,i,t,e)))}function zf(t=1/0){return ko(xr,t)}const Zs=new Ht(t=>t.complete());function Am(t){return t&&zn(t.schedule)}function Nd(t){return t[t.length-1]}function b0(t){return zn(Nd(t))?t.pop():void 0}function _u(t){return Am(Nd(t))?t.pop():void 0}function D_(t,n=0){return wn((e,r)=>{e.subscribe(Rr(r,i=>gu(r,t,()=>r.next(i),n),()=>gu(r,t,()=>r.complete(),n),i=>gu(r,t,()=>r.error(i),n)))})}function A_(t,n=0){return wn((e,r)=>{r.add(t.schedule(()=>e.subscribe(r),n))})}function io(t,n){if(!t)throw new Error("Iterable cannot be null");return new Ht(e=>{gu(e,n,()=>{const r=t[Symbol.asyncIterator]();gu(e,n,()=>{r.next().then(i=>{i.done?e.complete():e.next(i.value)})},0,!0)})})}function Br(t,n){return n?function w0(t,n){if(null!=t){if(Pi(t))return function h2(t,n){return ja(t).pipe(A_(n),D_(n))}(t,n);if(Vf(t))return function Lr(t,n){return new Ht(e=>{let r=0;return n.schedule(function(){r===t.length?e.complete():(e.next(t[r++]),e.closed||this.schedule())})})}(t,n);if(Qu(t))return function y0(t,n){return ja(t).pipe(A_(n),D_(n))}(t,n);if(sc(t))return io(t,n);if(es(t))return function Tm(t,n){return new Ht(e=>{let r;return gu(e,n,()=>{r=t[Ca](),gu(e,n,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(a){return void e.error(a)}o?e.complete():e.next(i)},0,!0)}),()=>zn(r?.return)&&r.return()})}(t,n);if(Uf(t))return function Mm(t,n){return io(Gh(t),n)}(t,n)}throw pu(t)}(t,n):ja(t)}function Ea(...t){const n=_u(t),e=function vu(t,n){return"number"==typeof Nd(t)?t.pop():n}(t,1/0),r=t;return r.length?1===r.length?ja(r[0]):zf(e)(Br(r,n)):Zs}function Yh(t={}){const{connector:n=(()=>new Bt),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return o=>{let a,s,l,c=0,f=!1,v=!1;const E=()=>{s?.unsubscribe(),s=void 0},D=()=>{E(),a=l=void 0,f=v=!1},k=()=>{const T=a;D(),T?.unsubscribe()};return wn((T,R)=>{c++,!v&&!f&&E();const q=l=l??n();R.add(()=>{c--,0===c&&!v&&!f&&(s=Fc(k,i))}),q.subscribe(R),!a&&c>0&&(a=new Jt({next:Z=>q.next(Z),error:Z=>{v=!0,E(),s=Fc(D,e,Z),q.error(Z)},complete:()=>{f=!0,E(),s=Fc(D,r),q.complete()}}),ja(T).subscribe(a))})(o)}}function Fc(t,n,...e){if(!0===n)return void t();if(!1===n)return;const r=new Jt({next:()=>{r.unsubscribe(),t()}});return n(...e).subscribe(r)}function oo(t){for(let n in t)if(t[n]===oo)return n;throw Error("Could not find renamed property on target object.")}function $f(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function to(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(to).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function ca(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const ua=oo({__forward_ref__:oo});function Ir(t){return t.__forward_ref__=Ir,t.toString=function(){return to(this())},t}function or(t){return Fo(t)?t():t}function Fo(t){return"function"==typeof t&&t.hasOwnProperty(ua)&&t.__forward_ref__===Ir}function km(t){return t&&!!t.\u0275providers}const Xh="https://g.co/ng/security#xss";class Vt extends Error{constructor(n,e){super(Rd(n,e)),this.code=n}}function Rd(t,n){return`NG0${Math.abs(t)}${n?": "+n.trim():""}`}function ei(t){return"string"==typeof t?t:null==t?"":String(t)}function Ic(t,n){throw new Vt(-201,!1)}function Js(t,n){null==t&&function ci(t,n,e,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${e} ${r} ${n} <=Actual]`))}(n,t,null,"!=")}function Gt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function hr(t){return{providers:t.providers||[],imports:t.imports||[]}}function Qh(t){return Jh(t,ep)||Jh(t,E0)}function Jh(t,n){return t.hasOwnProperty(n)?t[n]:null}function Fm(t){return t&&(t.hasOwnProperty(Im)||t.hasOwnProperty(S0))?t[Im]:null}const ep=oo({\u0275prov:oo}),Im=oo({\u0275inj:oo}),E0=oo({ngInjectableDef:oo}),S0=oo({ngInjectorDef:oo});var Cr=(()=>((Cr=Cr||{})[Cr.Default=0]="Default",Cr[Cr.Host=1]="Host",Cr[Cr.Self=2]="Self",Cr[Cr.SkipSelf=4]="SkipSelf",Cr[Cr.Optional=8]="Optional",Cr))();let _l;function Sa(t){const n=_l;return _l=t,n}function vl(t,n,e){const r=Qh(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Cr.Optional?null:void 0!==n?n:void Ic(to(t))}const Vi=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),lc={},el="__NG_DI_FLAG__",nd="ngTempTokenPath",qf="ngTokenPath",bu=/\n/gm,Ud="\u0275",Kn="__source";let Gf;function Hd(t){const n=Gf;return Gf=t,n}function A0(t,n=Cr.Default){if(void 0===Gf)throw new Vt(-203,!1);return null===Gf?vl(t,void 0,n):Gf.get(t,n&Cr.Optional?null:void 0,n)}function it(t,n=Cr.Default){return(function D0(){return _l}()||A0)(or(t),n)}function Xr(t,n=Cr.Default){return it(t,Yf(n))}function Yf(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Om(t){const n=[];for(let e=0;e<t.length;e++){const r=or(t[e]);if(Array.isArray(r)){if(0===r.length)throw new Vt(900,!1);let i,o=Cr.Default;for(let a=0;a<r.length;a++){const s=r[a],l=T0(s);"number"==typeof l?-1===l?i=s.token:o|=l:i=s}n.push(it(i,o))}else n.push(it(r))}return n}function rd(t,n){return t[el]=n,t.prototype[el]=n,t}function T0(t){return t[el]}function tl(t){return{toString:t}.toString()}var cc=(()=>((cc=cc||{})[cc.OnPush=0]="OnPush",cc[cc.Default=1]="Default",cc))(),bl=(()=>{return(t=bl||(bl={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",bl;var t})();const Pc={},Ui=[],id=oo({\u0275cmp:oo}),zd=oo({\u0275dir:oo}),Xf=oo({\u0275pipe:oo}),Kf=oo({\u0275mod:oo}),ts=oo({\u0275fac:oo}),Wl=oo({__NG_ELEMENT_ID__:oo});let k0=0;function pr(t){return tl(()=>{const n=np(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===cc.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,data:t.data||{},encapsulation:t.encapsulation||bl.Emulated,id:"c"+k0++,styles:t.styles||Ui,_:null,schemas:t.schemas||null,tView:null};rp(e);const r=t.dependencies;return e.directiveDefs=ip(r,!1),e.pipeDefs=ip(r,!0),e})}function F0(t){return oi(t)||ns(t)}function I0(t){return null!==t}function Kr(t){return tl(()=>({type:t.type,bootstrap:t.bootstrap||Ui,declarations:t.declarations||Ui,imports:t.imports||Ui,exports:t.exports||Ui,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function nl(t,n){if(null==t)return Pc;const e={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),e[i]=r,n&&(n[i]=o)}return e}function jn(t){return tl(()=>{const n=np(t);return rp(n),n})}function Eo(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function oi(t){return t[id]||null}function ns(t){return t[zd]||null}function Ps(t){return t[Xf]||null}function Os(t,n){const e=t[Kf]||null;if(!e&&!0===n)throw new Error(`Type ${to(t)} does not have '\u0275mod' property.`);return e}function np(t){const n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,exportAs:t.exportAs||null,standalone:!0===t.standalone,selectors:t.selectors||Ui,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:nl(t.inputs,n),outputs:nl(t.outputs)}}function rp(t){t.features?.forEach(n=>n(t))}function ip(t,n){if(!t)return null;const e=n?Ps:F0;return()=>("function"==typeof t?t():t).map(r=>e(r)).filter(I0)}const Oc=0,ar=1,ui=2,Vo=3,ql=4,yu=5,Va=6,od=7,Uo=8,op=9,ap=10,di=11,Lm=12,_=13,p=14,g=15,b=16,S=17,x=18,M=19,P=20,O=21,H=22,Q=1,re=2,V=7,ve=8,ce=9,be=10;function me(t){return Array.isArray(t)&&"object"==typeof t[Q]}function Be(t){return Array.isArray(t)&&!0===t[Q]}function st(t){return 0!=(4&t.flags)}function At(t){return t.componentOffset>-1}function ln(t){return 1==(1&t.flags)}function nt(t){return!!t.template}function Oe(t){return 0!=(256&t[ui])}function bt(t,n){return t.hasOwnProperty(ts)?t[ts]:null}class Rn{constructor(n,e,r){this.previousValue=n,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function gn(){return Xn}function Xn(t){return t.type.prototype.ngOnChanges&&(t.setInput=jr),tr}function tr(){const t=Me(this),n=t?.current;if(n){const e=t.previous;if(e===Pc)t.previous=n;else for(let r in n)e[r]=n[r];t.current=null,this.ngOnChanges(n)}}function jr(t,n,e,r){const i=this.declaredInputs[e],o=Me(t)||function ti(t,n){return t[Lt]=n}(t,{previous:Pc,current:null}),a=o.current||(o.current={}),s=o.previous,l=s[i];a[i]=new Rn(l&&l.currentValue,n,s===Pc),t[r]=n}gn.ngInherit=!0;const Lt="__ngSimpleChanges__";function Me(t){return t[Lt]||null}const C=function(t,n,e){},F="svg";function le(t){for(;Array.isArray(t);)t=t[Oc];return t}function cn(t,n){return le(n[t])}function In(t,n){return le(n[t.index])}function Or(t,n){return t.data[n]}function wr(t,n){return t[n]}function Hr(t,n){const e=n[t];return me(e)?e:e[Oc]}function Ua(t){return 64==(64&t[ui])}function rs(t,n){return null==n?null:t[n]}function po(t){t[x]=0}function Io(t,n){t[yu]+=n;let e=t,r=t[Vo];for(;null!==r&&(1===n&&1===e[yu]||-1===n&&0===e[yu]);)r[yu]+=n,e=r,r=r[Vo]}const Tr={lFrame:dp(null),bindingsEnabled:!0};function ta(){return Tr.bindingsEnabled}function fn(){return Tr.lFrame.lView}function zr(){return Tr.lFrame.tView}function ht(t){return Tr.lFrame.contextLView=t,t[Uo]}function pt(t){return Tr.lFrame.contextLView=null,t}function mr(){let t=uc();for(;null!==t&&64===t.type;)t=t.parent;return t}function uc(){return Tr.lFrame.currentTNode}function na(t,n){const e=Tr.lFrame;e.currentTNode=t,e.isParent=n}function _a(){return Tr.lFrame.isParent}function ha(){Tr.lFrame.isParent=!1}function Ho(){const t=Tr.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Ha(){return Tr.lFrame.bindingIndex}function rl(){return Tr.lFrame.bindingIndex++}function Aa(t){const n=Tr.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function lp(t,n){const e=Tr.lFrame;e.bindingIndex=e.bindingRootIndex=t,Wd(n)}function Wd(t){Tr.lFrame.currentDirectiveIndex=t}function qd(t){const n=Tr.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}function jm(){return Tr.lFrame.currentQueryIndex}function Vm(t){Tr.lFrame.currentQueryIndex=t}function F_(t){const n=t[ar];return 2===n.type?n.declTNode:1===n.type?t[Va]:null}function Zf(t,n,e){if(e&Cr.SkipSelf){let i=n,o=t;for(;!(i=i.parent,null!==i||e&Cr.Host||(i=F_(o),null===i||(o=o[g],10&i.type))););if(null===i)return!1;n=i,t=o}const r=Tr.lFrame=P0();return r.currentTNode=n,r.lView=t,!0}function up(t){const n=P0(),e=t[ar];Tr.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function P0(){const t=Tr.lFrame,n=null===t?null:t.child;return null===n?dp(t):n}function dp(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function O0(){const t=Tr.lFrame;return Tr.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Um=O0;function Hm(){const t=O0();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Oi(){return Tr.lFrame.selectedIndex}function Cu(t){Tr.lFrame.selectedIndex=t}function Po(){const t=Tr.lFrame;return Or(t.tView,t.selectedIndex)}function Ns(){Tr.lFrame.currentNamespace=F}function Eu(){!function Rc(){Tr.lFrame.currentNamespace=null}()}function Gd(t,n){for(let e=n.directiveStart,r=n.directiveEnd;e<r;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:s,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:f}=o;a&&(t.contentHooks??(t.contentHooks=[])).push(-e,a),s&&((t.contentHooks??(t.contentHooks=[])).push(e,s),(t.contentCheckHooks??(t.contentCheckHooks=[])).push(e,s)),l&&(t.viewHooks??(t.viewHooks=[])).push(-e,l),c&&((t.viewHooks??(t.viewHooks=[])).push(e,c),(t.viewCheckHooks??(t.viewCheckHooks=[])).push(e,c)),null!=f&&(t.destroyHooks??(t.destroyHooks=[])).push(e,f)}}function Qf(t,n,e){N0(t,n,3,e)}function pp(t,n,e,r){(3&t[ui])===e&&N0(t,n,e,r)}function mp(t,n){let e=t[ui];(3&e)===n&&(e&=2047,e+=1,t[ui]=e)}function N0(t,n,e,r){const o=r??-1,a=n.length-1;let s=0;for(let l=void 0!==r?65535&t[x]:0;l<a;l++)if("number"==typeof n[l+1]){if(s=n[l],null!=r&&s>=r)break}else n[l]<0&&(t[x]+=65536),(s<o||-1==o)&&(R0(t,e,n,l),t[x]=(4294901760&t[x])+l+2),l++}function R0(t,n,e,r){const i=e[r]<0,o=e[r+1],s=t[i?-e[r]:e[r]];if(i){if(t[ui]>>11<t[x]>>16&&(3&t[ui])===n){t[ui]+=2048,C(4,s,o);try{o.call(s)}finally{C(5,s,o)}}}else{C(4,s,o);try{o.call(s)}finally{C(5,s,o)}}}const Yd=-1;class sd{constructor(n,e,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function Wm(t,n,e){let r=0;for(;r<e.length;){const i=e[r];if("number"==typeof i){if(0!==i)break;r++;const o=e[r++],a=e[r++],s=e[r++];t.setAttribute(n,a,s,o)}else{const o=i,a=e[++r];ni(o)?t.setProperty(n,o,a):t.setAttribute(n,o,a),r++}}return r}function qm(t){return 3===t||4===t||6===t}function ni(t){return 64===t.charCodeAt(0)}function Jf(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let r=0;r<n.length;r++){const i=n[r];"number"==typeof i?e=i:0===e||L0(t,e,i,null,-1===e||2===e?n[++r]:null)}}return t}function L0(t,n,e,r,i){let o=0,a=t.length;if(-1===n)a=-1;else for(;o<t.length;){const s=t[o++];if("number"==typeof s){if(s===n){a=-1;break}if(s>n){a=o-1;break}}}for(;o<t.length;){const s=t[o];if("number"==typeof s)break;if(s===e){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==a&&(t.splice(a,0,n),o=a+1),t.splice(o++,0,e),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function Lc(t){return t!==Yd}function eh(t){return 32767&t}function ld(t,n){let e=function B0(t){return t>>16}(t),r=n;for(;e>0;)r=r[g],e--;return r}let th=!0;function vp(t){const n=th;return th=t,n}const j0=255,bp=5;let nh=0;const vs={};function Su(t,n){const e=ih(t,n);if(-1!==e)return e;const r=n[ar];r.firstCreatePass&&(t.injectorIndex=n.length,rh(r.data,t),rh(n,null),rh(r.blueprint,null));const i=yp(t,n),o=t.injectorIndex;if(Lc(i)){const a=eh(i),s=ld(i,n),l=s[ar].data;for(let c=0;c<8;c++)n[o+c]=s[a+c]|l[a+c]}return n[o+8]=i,o}function rh(t,n){t.push(0,0,0,0,0,0,0,0,n)}function ih(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function yp(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,r=null,i=n;for(;null!==i;){if(r=Ep(i),null===r)return Yd;if(e++,i=i[g],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return Yd}function wp(t,n,e){!function N_(t,n,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(Wl)&&(r=e[Wl]),null==r&&(r=e[Wl]=nh++);const i=r&j0;n.data[t+(i>>bp)]|=1<<i}(t,n,e)}function Gm(t,n,e){if(e&Cr.Optional||void 0!==t)return t;Ic()}function Du(t,n,e,r){if(e&Cr.Optional&&void 0===r&&(r=null),!(e&(Cr.Self|Cr.Host))){const i=t[op],o=Sa(void 0);try{return i?i.get(n,r,e&Cr.Optional):vl(n,r,e&Cr.Optional)}finally{Sa(o)}}return Gm(r,0,e)}function cd(t,n,e,r=Cr.Default,i){if(null!==t){if(1024&n[ui]){const a=function Cp(t,n,e,r,i){let o=t,a=n;for(;null!==o&&null!==a&&1024&a[ui]&&!(256&a[ui]);){const s=U0(o,a,e,r|Cr.Self,vs);if(s!==vs)return s;let l=o.parent;if(!l){const c=a[O];if(c){const f=c.get(e,vs,r);if(f!==vs)return f}l=Ep(a),a=a[g]}o=l}return i}(t,n,e,r,vs);if(a!==vs)return a}const o=U0(t,n,e,r,vs);if(o!==vs)return o}return Du(n,e,r,i)}function U0(t,n,e,r,i){const o=function oh(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Wl)?t[Wl]:void 0;return"number"==typeof n?n>=0?n&j0:Ym:n}(e);if("function"==typeof o){if(!Zf(n,t,r))return r&Cr.Host?Gm(i,0,r):Du(n,e,r,i);try{const a=o(r);if(null!=a||r&Cr.Optional)return a;Ic()}finally{Um()}}else if("number"==typeof o){let a=null,s=ih(t,n),l=Yd,c=r&Cr.Host?n[b][Va]:null;for((-1===s||r&Cr.SkipSelf)&&(l=-1===s?yp(t,n):n[s+8],l!==Yd&&ah(r,!1)?(a=n[ar],s=eh(l),n=ld(l,n)):s=-1);-1!==s;){const f=n[ar];if(H0(o,s,f.data)){const v=Kd(s,n,e,a,r,c);if(v!==vs)return v}l=n[s+8],l!==Yd&&ah(r,n[ar].data[s+8]===c)&&H0(o,s,n)?(a=f,s=eh(l),n=ld(l,n)):s=-1}}return i}function Kd(t,n,e,r,i,o){const a=n[ar],s=a.data[t+8],f=xl(s,a,e,null==r?At(s)&&th:r!=a&&0!=(3&s.type),i&Cr.Host&&o===s);return null!==f?Bc(n,a,f,s):vs}function xl(t,n,e,r,i){const o=t.providerIndexes,a=n.data,s=1048575&o,l=t.directiveStart,f=o>>20,E=i?s+f:t.directiveEnd;for(let D=r?s:s+f;D<E;D++){const k=a[D];if(D<l&&e===k||D>=l&&k.type===e)return D}if(i){const D=a[l];if(D&&nt(D)&&D.type===e)return l}return null}function Bc(t,n,e,r){let i=t[e];const o=n.data;if(function P_(t){return t instanceof sd}(i)){const a=i;a.resolving&&function Kh(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new Vt(-200,`Circular dependency in DI detected for ${t}${e}`)}(function wi(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():ei(t)}(o[e]));const s=vp(a.canSeeViewProviders);a.resolving=!0;const l=a.injectImpl?Sa(a.injectImpl):null;Zf(t,r,Cr.Default);try{i=t[e]=a.factory(void 0,o,t,r),n.firstCreatePass&&e>=r.directiveStart&&function wl(t,n,e){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=n.type.prototype;if(r){const a=Xn(n);(e.preOrderHooks??(e.preOrderHooks=[])).push(t,a),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(t,a)}i&&(e.preOrderHooks??(e.preOrderHooks=[])).push(0-t,i),o&&((e.preOrderHooks??(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(t,o))}(e,o[e],n)}finally{null!==l&&Sa(l),vp(s),a.resolving=!1,Um()}}return i}function H0(t,n,e){return!!(e[n+(t>>bp)]&1<<t)}function ah(t,n){return!(t&Cr.Self||t&Cr.Host&&n)}class Zd{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,r){return cd(this._tNode,this._lView,n,Yf(r),e)}}function Ym(){return new Zd(mr(),fn())}function co(t){return tl(()=>{const n=t.prototype.constructor,e=n[ts]||xp(n),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const o=i[ts]||xp(i);if(o&&o!==e)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function xp(t){return Fo(t)?()=>{const n=xp(or(t));return n&&n()}:bt(t)}function Ep(t){const n=t[ar],e=n.type;return 2===e?n.declTNode:1===e?t[Va]:null}function jc(t){return function V0(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const e=t.attrs;if(e){const r=e.length;let i=0;for(;i<r;){const o=e[i];if(qm(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof e[i];)i++;else{if(o===n)return e[i+1];i+=2}}}return null}(mr(),t)}const Qd="__parameters__";function Yl(t,n,e){return tl(()=>{const r=function sh(t){return function(...e){if(t){const r=t(...e);for(const i in r)this[i]=r[i]}}}(n);function i(...o){if(this instanceof i)return r.apply(this,o),this;const a=new i(...o);return s.annotation=a,s;function s(l,c,f){const v=l.hasOwnProperty(Qd)?l[Qd]:Object.defineProperty(l,Qd,{value:[]})[Qd];for(;v.length<=f;)v.push(null);return(v[f]=v[f]||[]).push(a),l}}return e&&(i.prototype=Object.create(e.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class U{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Gt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function bs(t,n){t.forEach(e=>Array.isArray(e)?bs(e,n):n(e))}function Cl(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function fc(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function ef(t,n){const e=[];for(let r=0;r<t;r++)e.push(n);return e}function ys(t,n,e){let r=za(t,n);return r>=0?t[1|r]=e:(r=~r,function Sp(t,n,e,r){let i=t.length;if(i==n)t.push(e,r);else if(1===i)t.push(r,t[0]),t[0]=e;else{for(i--,t.push(t[i-1],t[i]);i>n;)t[i]=t[i-2],i--;t[n]=e,t[n+1]=r}}(t,r,n,e)),r}function tf(t,n){const e=za(t,n);if(e>=0)return t[1|e]}function za(t,n){return function lh(t,n,e){let r=0,i=t.length>>e;for(;i!==r;){const o=r+(i-r>>1),a=t[o<<e];if(n===a)return o<<e;a>n?i=o:r=o+1}return~(i<<e)}(t,n,1)}const Uc=rd(Yl("Optional"),8),ws=rd(Yl("SkipSelf"),4);var Ls=(()=>((Ls=Ls||{})[Ls.Important=1]="Important",Ls[Ls.DashCase=2]="DashCase",Ls))();const og=new Map;let Yx=0;const ag="__ngContext__";function Ta(t,n){me(n)?(t[ag]=n[P],function y2(t){og.set(t[P],t)}(n)):t[ag]=n}let Z0;function Mu(t,n){return Z0(t,n)}function lg(t){const n=t[Vo];return Be(n)?n[Vo]:n}function Q0(t){return z_(t[_])}function J0(t){return z_(t[ql])}function z_(t){for(;null!==t&&!Be(t);)t=t[ql];return t}function Ip(t,n,e,r,i){if(null!=r){let o,a=!1;Be(r)?o=r:me(r)&&(a=!0,r=r[Oc]);const s=le(r);0===t&&null!==e?null==i?y(n,e,s):m(n,e,s,i||null,!0):1===t&&null!==e?m(n,e,s,i||null,!0):2===t?function ze(t,n,e){const r=K(t,n);r&&function L(t,n,e,r){t.removeChild(n,e,r)}(t,r,n,e)}(n,s,a):3===t&&n.destroyNode(s),null!=o&&function lr(t,n,e,r,i){const o=e[V];o!==le(e)&&Ip(n,t,r,o,i);for(let s=be;s<e.length;s++){const l=e[s];en(l[ar],l,t,n,r,o)}}(n,t,o,e,i)}}function dg(t,n,e){return t.createElement(n,e)}function T2(t,n){const e=t[ce],r=e.indexOf(n),i=n[Vo];512&n[ui]&&(n[ui]&=-513,Io(i,-1)),e.splice(r,1)}function $_(t,n){if(t.length<=be)return;const e=be+n,r=t[e];if(r){const i=r[S];null!==i&&i!==t&&T2(i,r),n>0&&(t[e-1][ql]=r[ql]);const o=fc(t,be+n);!function D2(t,n){en(t,n,n[di],2,null,null),n[Oc]=null,n[Va]=null}(r[ar],r);const a=o[M];null!==a&&a.detachView(o[ar]),r[Vo]=null,r[ql]=null,r[ui]&=-65}return r}function M2(t,n){if(!(128&n[ui])){const e=n[di];e.destroyNode&&en(t,n,e,3,null,null),function rC(t){let n=t[_];if(!n)return e1(t[ar],t);for(;n;){let e=null;if(me(n))e=n[_];else{const r=n[be];r&&(e=r)}if(!e){for(;n&&!n[ql]&&n!==t;)me(n)&&e1(n[ar],n),n=n[Vo];null===n&&(n=t),me(n)&&e1(n[ar],n),e=n&&n[ql]}n=e}}(n)}}function e1(t,n){if(!(128&n[ui])){n[ui]&=-65,n[ui]|=128,function aC(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let r=0;r<e.length;r+=2){const i=n[e[r]];if(!(i instanceof sd)){const o=e[r+1];if(Array.isArray(o))for(let a=0;a<o.length;a+=2){const s=i[o[a]],l=o[a+1];C(4,s,l);try{l.call(s)}finally{C(5,s,l)}}else{C(4,i,o);try{o.call(i)}finally{C(5,i,o)}}}}}(t,n),function t1(t,n){const e=t.cleanup,r=n[od];let i=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const a=e[o+3];a>=0?r[i=a]():r[i=-a].unsubscribe(),o+=2}else{const a=r[i=e[o+1]];e[o].call(a)}if(null!==r){for(let o=i+1;o<r.length;o++)(0,r[o])();n[od]=null}}(t,n),1===n[ar].type&&n[di].destroy();const e=n[S];if(null!==e&&Be(n[Vo])){e!==n[Vo]&&T2(e,n);const r=n[M];null!==r&&r.detachView(t)}!function Kx(t){og.delete(t[P])}(n)}}function k2(t,n,e){return function W_(t,n,e){let r=n;for(;null!==r&&40&r.type;)r=(n=r).parent;if(null===r)return e[Oc];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:o}=t.data[r.directiveStart+i];if(o===bl.None||o===bl.Emulated)return null}return In(r,e)}}(t,n.parent,e)}function m(t,n,e,r,i){t.insertBefore(n,e,r,i)}function y(t,n,e){t.appendChild(n,e)}function I(t,n,e,r,i){null!==r?m(t,n,e,r,i):y(t,n,e)}function K(t,n){return t.parentNode(n)}function ne(t,n,e){return he(t,n,e)}let Ue,Zi,Bs,Qi,he=function ie(t,n,e){return 40&t.type?In(t,e):null};function at(t,n,e,r){const i=k2(t,r,n),o=n[di],s=ne(r.parent||n[Va],r,n);if(null!=i)if(Array.isArray(e))for(let l=0;l<e.length;l++)I(o,i,e[l],s,!1);else I(o,i,e,s,!1);void 0!==Ue&&Ue(o,r,n,e,i)}function Ke(t,n){if(null!==n){const e=n.type;if(3&e)return In(n,t);if(4&e)return kt(-1,t[n.index]);if(8&e){const r=n.child;if(null!==r)return Ke(t,r);{const i=t[n.index];return Be(i)?kt(-1,i):le(i)}}if(32&e)return Mu(n,t)()||le(t[n.index]);{const r=un(t,n);return null!==r?Array.isArray(r)?r[0]:Ke(lg(t[b]),r):Ke(t,n.next)}}return null}function un(t,n){return null!==n?t[b][Va].projection[n.projection]:null}function kt(t,n){const e=be+t+1;if(e<n.length){const r=n[e],i=r[ar].firstChild;if(null!==i)return Ke(r,i)}return n[V]}function We(t,n,e,r,i,o,a){for(;null!=e;){const s=r[e.index],l=e.type;if(a&&0===n&&(s&&Ta(le(s),r),e.flags|=2),32!=(32&e.flags))if(8&l)We(t,n,e.child,r,i,o,!1),Ip(n,t,i,s,o);else if(32&l){const c=Mu(e,r);let f;for(;f=c();)Ip(n,t,i,f,o);Ip(n,t,i,s,o)}else 16&l?sn(t,n,r,e,i,o):Ip(n,t,i,s,o);e=a?e.projectionNext:e.next}}function en(t,n,e,r,i,o){We(e,r,t.firstChild,n,i,o,!1)}function sn(t,n,e,r,i,o){const a=e[b],l=a[Va].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Ip(n,t,i,l[c],o);else We(t,n,l,a[Vo],i,o,!0)}function qn(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Ki(t,n,e){const{mergedAttrs:r,classes:i,styles:o}=e;null!==r&&Wm(t,n,r),null!==i&&qn(t,n,i),null!==o&&function Nr(t,n,e){t.setAttribute(n,"style",e)}(t,n,o)}function gi(t){return function Ni(){if(void 0===Zi&&(Zi=null,Vi.trustedTypes))try{Zi=Vi.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Zi}()?.createHTML(t)||t}function os(t){return function al(){if(void 0===Qi&&(Qi=null,Vi.trustedTypes))try{Qi=Vi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Qi}()?.createScriptURL(t)||t}class va{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Xh})`}}class wc extends va{getTypeName(){return"HTML"}}class ku extends va{getTypeName(){return"Style"}}class as extends va{getTypeName(){return"Script"}}class pd extends va{getTypeName(){return"URL"}}class dh extends va{getTypeName(){return"ResourceURL"}}function ss(t){return t instanceof va?t.changingThisBreaksApplicationSecurity:t}function xs(t,n){const e=function ma(t){return t instanceof va&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${Xh})`)}return e===n}class Wc{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(gi(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class Op{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=gi(n),e}}const P2=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function fh(t){return(t=String(t)).match(P2)?t:"unsafe:"+t}function Fu(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function cf(...t){const n={};for(const e of t)for(const r in e)e.hasOwnProperty(r)&&(n[r]=!0);return n}const r1=Fu("area,br,col,hr,img,wbr"),pg=Fu("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Rp=Fu("rp,rt"),Iu=cf(r1,cf(pg,Fu("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),cf(Rp,Fu("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),cf(Rp,pg)),G_=Fu("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Y_=cf(G_,Fu("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Fu("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),o1=Fu("script,style,template");class N2{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let i=this.checkClobberedElement(e,e.nextSibling);if(i){e=i;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!Iu.hasOwnProperty(e))return this.sanitizedSomething=!0,!o1.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=n.attributes;for(let i=0;i<r.length;i++){const o=r.item(i),a=o.name,s=a.toLowerCase();if(!Y_.hasOwnProperty(s)){this.sanitizedSomething=!0;continue}let l=o.value;G_[s]&&(l=fh(l)),this.buf.push(" ",a,'="',s1(l),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();Iu.hasOwnProperty(e)&&!r1.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(s1(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const R2=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,a1=/([^\#-~ |!])/g;function s1(t){return t.replace(/&/g,"&amp;").replace(R2,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(a1,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let uf;function X_(t,n){let e=null;try{uf=uf||function hg(t){const n=new Op(t);return function Np(){try{return!!(new window.DOMParser).parseFromString(gi(""),"text/html")}catch{return!1}}()?new Wc(n):n}(t);let r=n?String(n):"";e=uf.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=e.innerHTML,e=uf.getInertBodyElement(r)}while(r!==o);return gi((new N2).sanitizeChildren(K_(e)||e))}finally{if(e){const r=K_(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function K_(t){return"content"in t&&function l1(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Ji=(()=>((Ji=Ji||{})[Ji.NONE=0]="NONE",Ji[Ji.HTML=1]="HTML",Ji[Ji.STYLE=2]="STYLE",Ji[Ji.SCRIPT=3]="SCRIPT",Ji[Ji.URL=4]="URL",Ji[Ji.RESOURCE_URL=5]="RESOURCE_URL",Ji))();function Q_(t){const n=mg();return n?n.sanitize(Ji.URL,t)||"":xs(t,"URL")?ss(t):fh(ei(t))}function J_(t){const n=mg();if(n)return os(n.sanitize(Ji.RESOURCE_URL,t)||"");if(xs(t,"ResourceURL"))return os(ss(t));throw new Vt(904,!1)}function mg(){const t=fn();return t&&t[Lm]}const ff=new U("ENVIRONMENT_INITIALIZER"),c1=new U("INJECTOR",-1),gg=new U("INJECTOR_DEF_TYPES");class Pu{get(n,e=lc){if(e===lc){const r=new Error(`NullInjectorError: No provider for ${to(n)}!`);throw r.name="NullInjectorError",r}return e}}function pf(...t){return{\u0275providers:_g(0,t),\u0275fromNgModule:!0}}function _g(t,...n){const e=[],r=new Set;let i;return bs(n,o=>{const a=o;d1(a,e,[],r)&&(i||(i=[]),i.push(a))}),void 0!==i&&u1(i,e),e}function u1(t,n){for(let e=0;e<t.length;e++){const{providers:i}=t[e];vg(i,o=>{n.push(o)})}}function d1(t,n,e,r){if(!(t=or(t)))return!1;let i=null,o=Fm(t);const a=!o&&oi(t);if(o||a){if(a&&!a.standalone)return!1;i=t}else{const l=t.ngModule;if(o=Fm(l),!o)return!1;i=l}const s=r.has(i);if(a){if(s)return!1;if(r.add(i),a.dependencies){const l="function"==typeof a.dependencies?a.dependencies():a.dependencies;for(const c of l)d1(c,n,e,r)}}else{if(!o)return!1;{if(null!=o.imports&&!s){let c;r.add(i);try{bs(o.imports,f=>{d1(f,n,e,r)&&(c||(c=[]),c.push(f))})}finally{}void 0!==c&&u1(c,n)}if(!s){const c=bt(i)||(()=>new i);n.push({provide:i,useFactory:c,deps:Ui},{provide:gg,useValue:i,multi:!0},{provide:ff,useValue:()=>it(i),multi:!0})}const l=o.providers;null==l||s||vg(l,f=>{n.push(f)})}}return i!==t&&void 0!==t.providers}function vg(t,n){for(let e of t)km(e)&&(e=e.\u0275providers),Array.isArray(e)?vg(e,n):n(e)}const tv=oo({provide:String,useValue:oo});function uC(t){return null!==t&&"object"==typeof t&&tv in t}function bg(t){return"function"==typeof t}const dC=new U("Set Injector scope."),B2={},CL={};let fC;function j2(){return void 0===fC&&(fC=new Pu),fC}class mf{}class GA extends mf{get destroyed(){return this._destroyed}constructor(n,e,r,i){super(),this.parent=e,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,pC(n,a=>this.processProvider(a)),this.records.set(c1,f1(void 0,this)),i.has("environment")&&this.records.set(mf,f1(void 0,this));const o=this.records.get(dC);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(gg.multi,Ui,Cr.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const e=Hd(this),r=Sa(void 0);try{return n()}finally{Hd(e),Sa(r)}}get(n,e=lc,r=Cr.Default){this.assertNotDestroyed(),r=Yf(r);const i=Hd(this),o=Sa(void 0);try{if(!(r&Cr.SkipSelf)){let s=this.records.get(n);if(void 0===s){const l=function TL(t){return"function"==typeof t||"object"==typeof t&&t instanceof U}(n)&&Qh(n);s=l&&this.injectableDefInScope(l)?f1(hC(n),B2):null,this.records.set(n,s)}if(null!=s)return this.hydrate(n,s)}return(r&Cr.Self?j2():this.parent).get(n,e=r&Cr.Optional&&e===lc?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[nd]=a[nd]||[]).unshift(to(n)),i)throw a;return function M0(t,n,e,r){const i=t[nd];throw n[Kn]&&i.unshift(n[Kn]),t.message=function Nm(t,n,e,r=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==Ud?t.slice(2):t;let i=to(n);if(Array.isArray(n))i=n.map(to).join(" -> ");else if("object"==typeof n){let o=[];for(let a in n)if(n.hasOwnProperty(a)){let s=n[a];o.push(a+":"+("string"==typeof s?JSON.stringify(s):to(s)))}i=`{${o.join(", ")}}`}return`${e}${r?"("+r+")":""}[${i}]: ${t.replace(bu,"\n  ")}`}("\n"+t.message,i,e,r),t[qf]=i,t[nd]=null,t}(a,n,"R3InjectorError",this.source)}throw a}finally{Sa(o),Hd(i)}}resolveInjectorInitializers(){const n=Hd(this),e=Sa(void 0);try{const r=this.get(ff.multi,Ui,Cr.Self);for(const i of r)i()}finally{Hd(n),Sa(e)}}toString(){const n=[],e=this.records;for(const r of e.keys())n.push(to(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Vt(205,!1)}processProvider(n){let e=bg(n=or(n))?n:or(n&&n.provide);const r=function SL(t){return uC(t)?f1(void 0,t.useValue):f1(YA(t),B2)}(n);if(bg(n)||!0!==n.multi)this.records.get(e);else{let i=this.records.get(e);i||(i=f1(void 0,B2,!0),i.factory=()=>Om(i.multi),this.records.set(e,i)),e=n,i.multi.push(n)}this.records.set(e,r)}hydrate(n,e){return e.value===B2&&(e.value=CL,e.value=e.factory()),"object"==typeof e.value&&e.value&&function AL(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=or(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function hC(t){const n=Qh(t),e=null!==n?n.factory:bt(t);if(null!==e)return e;if(t instanceof U)throw new Vt(204,!1);if(t instanceof Function)return function EL(t){const n=t.length;if(n>0)throw ef(n,"?"),new Vt(204,!1);const e=function Wf(t){return t&&(t[ep]||t[E0])||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new Vt(204,!1)}function YA(t,n,e){let r;if(bg(t)){const i=or(t);return bt(i)||hC(i)}if(uC(t))r=()=>or(t.useValue);else if(function qA(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Om(t.deps||[]));else if(function WA(t){return!(!t||!t.useExisting)}(t))r=()=>it(or(t.useExisting));else{const i=or(t&&(t.useClass||t.provide));if(!function DL(t){return!!t.deps}(t))return bt(i)||hC(i);r=()=>new i(...Om(t.deps))}return r}function f1(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function pC(t,n){for(const e of t)Array.isArray(e)?pC(e,n):e&&km(e)?pC(e.\u0275providers,n):n(e)}class ML{}class XA{}class FL{resolveComponentFactory(n){throw function kL(t){const n=Error(`No component factory found for ${to(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let Bp=(()=>{class t{}return t.NULL=new FL,t})();function IL(){return h1(mr(),fn())}function h1(t,n){return new $r(In(t,n))}let $r=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=IL,t})();function PL(t){return t instanceof $r?t.nativeElement:t}class nv{}let hh=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function OL(){const t=fn(),e=Hr(mr().index,t);return(me(e)?e:t)[di]}(),t})(),NL=(()=>{class t{}return t.\u0275prov=Gt({token:t,providedIn:"root",factory:()=>null}),t})();class jp{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const RL=new jp("15.2.10"),mC={},gC="ngOriginalError";function _C(t){return t[gC]}class ph{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&_C(n);for(;e&&_C(e);)e=_C(e);return e||null}}function mh(t){return t instanceof Function?t():t}function QA(t,n,e){let r=t.length;for(;;){const i=t.indexOf(n,e);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const o=n.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}e=i+1}}const JA="ng-template";function GL(t,n,e){let r=0,i=!0;for(;r<t.length;){let o=t[r++];if("string"==typeof o&&i){const a=t[r++];if(e&&"class"===o&&-1!==QA(a.toLowerCase(),n,0))return!0}else{if(1===o){for(;r<t.length&&"string"==typeof(o=t[r++]);)if(o.toLowerCase()===n)return!0;return!1}"number"==typeof o&&(i=!1)}}return!1}function e3(t){return 4===t.type&&t.value!==JA}function YL(t,n,e){return n===(4!==t.type||e?t.value:JA)}function XL(t,n,e){let r=4;const i=t.attrs||[],o=function QL(t){for(let n=0;n<t.length;n++)if(qm(t[n]))return n;return t.length}(i);let a=!1;for(let s=0;s<n.length;s++){const l=n[s];if("number"!=typeof l){if(!a)if(4&r){if(r=2|1&r,""!==l&&!YL(t,l,e)||""===l&&1===n.length){if(md(r))return!1;a=!0}}else{const c=8&r?l:n[++s];if(8&r&&null!==t.attrs){if(!GL(t.attrs,c,e)){if(md(r))return!1;a=!0}continue}const v=KL(8&r?"class":l,i,e3(t),e);if(-1===v){if(md(r))return!1;a=!0;continue}if(""!==c){let E;E=v>o?"":i[v+1].toLowerCase();const D=8&r?E:null;if(D&&-1!==QA(D,c,0)||2&r&&c!==E){if(md(r))return!1;a=!0}}}}else{if(!a&&!md(r)&&!md(l))return!1;if(a&&md(l))continue;a=!1,r=l|1&r}}return md(r)||a}function md(t){return 0==(1&t)}function KL(t,n,e,r){if(null===n)return-1;let i=0;if(r||!e){let o=!1;for(;i<n.length;){const a=n[i];if(a===t)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){let s=n[++i];for(;"string"==typeof s;)s=n[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function JL(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const r=t[e];if("number"==typeof r)return-1;if(r===n)return e;e++}return-1}(n,t)}function t3(t,n,e=!1){for(let r=0;r<n.length;r++)if(XL(t,n[r],e))return!0;return!1}function e7(t,n){e:for(let e=0;e<n.length;e++){const r=n[e];if(t.length===r.length){for(let i=0;i<t.length;i++)if(t[i]!==r[i])continue e;return!0}}return!1}function n3(t,n){return t?":not("+n.trim()+")":n}function t7(t){let n=t[0],e=1,r=2,i="",o=!1;for(;e<t.length;){let a=t[e];if("string"==typeof a)if(2&r){const s=t[++e];i+="["+a+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""!==i&&!md(a)&&(n+=n3(o,i),i=""),r=a,o=o||!md(r);e++}return""!==i&&(n+=n3(o,i)),n}const fi={};function w(t){r3(zr(),fn(),Oi()+t,!1)}function r3(t,n,e,r){if(!r)if(3==(3&n[ui])){const o=t.preOrderCheckHooks;null!==o&&Qf(n,o,e)}else{const o=t.preOrderHooks;null!==o&&pp(n,o,0,e)}Cu(e)}function l3(t,n=null,e=null,r){const i=c3(t,n,e,r);return i.resolveInjectorInitializers(),i}function c3(t,n=null,e=null,r,i=new Set){const o=[e||Ui,pf(t)];return r=r||("object"==typeof t?void 0:to(t)),new GA(o,n||j2(),r||null,i)}let js=(()=>{class t{static create(e,r){if(Array.isArray(e))return l3({name:""},r,e,"");{const i=e.name??"";return l3({name:i},e.parent,e.providers,i)}}}return t.THROW_IF_NOT_FOUND=lc,t.NULL=new Pu,t.\u0275prov=Gt({token:t,providedIn:"any",factory:()=>it(c1)}),t.__NG_ELEMENT_ID__=-1,t})();function X(t,n=Cr.Default){const e=fn();return null===e?it(t,n):cd(mr(),e,or(t),n)}function U2(){throw new Error("invalid")}function g3(t,n){const e=t.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const o=e[r+1];if(-1!==o){const a=t.data[o];Vm(e[r]),a.contentQueries(2,n[o],o)}}}function H2(t,n,e,r,i,o,a,s,l,c,f){const v=n.blueprint.slice();return v[Oc]=i,v[ui]=76|r,(null!==f||t&&1024&t[ui])&&(v[ui]|=1024),po(v),v[Vo]=v[g]=t,v[Uo]=e,v[ap]=a||t&&t[ap],v[di]=s||t&&t[di],v[Lm]=l||t&&t[Lm]||null,v[op]=c||t&&t[op]||null,v[Va]=o,v[P]=function Xx(){return Yx++}(),v[O]=f,v[b]=2==n.type?t[b]:v,v}function g1(t,n,e,r,i){let o=t.data[n];if(null===o)o=function xC(t,n,e,r,i){const o=uc(),a=_a(),l=t.data[n]=function T7(t,n,e,r,i,o){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?o:o&&o.parent,e,n,r,i);return null===t.firstChild&&(t.firstChild=l),null!==o&&(a?null==o.child&&null!==l.parent&&(o.child=l):null===o.next&&(o.next=l,l.prev=o)),l}(t,n,e,r,i),function xu(){return Tr.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=r,o.attrs=i;const a=function yl(){const t=Tr.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===a?-1:a.injectorIndex}return na(o,!0),o}function rv(t,n,e,r){if(0===e)return-1;const i=n.length;for(let o=0;o<e;o++)n.push(r),t.blueprint.push(r),t.data.push(null);return i}function CC(t,n,e){up(n);try{const r=t.viewQuery;null!==r&&IC(1,r,e);const i=t.template;null!==i&&_3(t,n,i,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&g3(t,n),t.staticViewQueries&&IC(2,t.viewQuery,e);const o=t.components;null!==o&&function S7(t,n){for(let e=0;e<n.length;e++)Y7(t,n[e])}(n,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{n[ui]&=-5,Hm()}}function z2(t,n,e,r){const i=n[ui];if(128!=(128&i)){up(n);try{po(n),function dc(t){return Tr.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&_3(t,n,e,2,r);const a=3==(3&i);if(a){const c=t.preOrderCheckHooks;null!==c&&Qf(n,c,null)}else{const c=t.preOrderHooks;null!==c&&pp(n,c,0,null),mp(n,0)}if(function q7(t){for(let n=Q0(t);null!==n;n=J0(n)){if(!n[re])continue;const e=n[ce];for(let r=0;r<e.length;r++){const i=e[r];512&i[ui]||Io(i[Vo],1),i[ui]|=512}}}(n),function W7(t){for(let n=Q0(t);null!==n;n=J0(n))for(let e=be;e<n.length;e++){const r=n[e],i=r[ar];Ua(r)&&z2(i,r,i.template,r[Uo])}}(n),null!==t.contentQueries&&g3(t,n),a){const c=t.contentCheckHooks;null!==c&&Qf(n,c)}else{const c=t.contentHooks;null!==c&&pp(n,c,1),mp(n,1)}!function C7(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const i=e[r];if(i<0)Cu(~i);else{const o=i,a=e[++r],s=e[++r];lp(a,o),s(2,n[o])}}}finally{Cu(-1)}}(t,n);const s=t.components;null!==s&&function E7(t,n){for(let e=0;e<n.length;e++)G7(t,n[e])}(n,s);const l=t.viewQuery;if(null!==l&&IC(2,l,r),a){const c=t.viewCheckHooks;null!==c&&Qf(n,c)}else{const c=t.viewHooks;null!==c&&pp(n,c,2),mp(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[ui]&=-41,512&n[ui]&&(n[ui]&=-513,Io(n[Vo],-1))}finally{Hm()}}}function _3(t,n,e,r,i){const o=Oi(),a=2&r;try{Cu(-1),a&&n.length>H&&r3(t,n,H,!1),C(a?2:0,i),e(r,i)}finally{Cu(o),C(a?3:1,i)}}function EC(t,n,e){if(st(n)){const i=n.directiveEnd;for(let o=n.directiveStart;o<i;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,e[o],o)}}}function SC(t,n,e){ta()&&(function N7(t,n,e,r){const i=e.directiveStart,o=e.directiveEnd;At(e)&&function H7(t,n,e){const r=In(n,t),i=v3(e),o=t[ap],a=$2(t,H2(t,i,null,e.onPush?32:16,r,n,o,o.createRenderer(r,e),null,null,null));t[n.index]=a}(n,e,t.data[i+e.componentOffset]),t.firstCreatePass||Su(e,n),Ta(r,n);const a=e.initialInputs;for(let s=i;s<o;s++){const l=t.data[s],c=Bc(n,t,s,e);Ta(c,n),null!==a&&z7(0,s-i,c,l,0,a),nt(l)&&(Hr(e.index,n)[Uo]=Bc(n,t,s,e))}}(t,n,e,In(e,n)),64==(64&e.flags)&&C3(t,n,e))}function DC(t,n,e=In){const r=n.localNames;if(null!==r){let i=n.index+1;for(let o=0;o<r.length;o+=2){const a=r[o+1],s=-1===a?e(n,t):t[a];t[i++]=s}}}function v3(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=AC(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function AC(t,n,e,r,i,o,a,s,l,c){const f=H+r,v=f+i,E=function D7(t,n){const e=[];for(let r=0;r<n;r++)e.push(r<t?null:fi);return e}(f,v),D="function"==typeof c?c():c;return E[ar]={type:t,blueprint:E,template:e,queries:null,viewQuery:s,declTNode:n,data:E.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:v,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:l,consts:D,incompleteFirstPass:!1}}function b3(t,n,e,r){const i=S3(n);null===e?i.push(r):(i.push(e),t.firstCreatePass&&D3(t).push(r,i.length-1))}function y3(t,n,e,r){for(let i in t)if(t.hasOwnProperty(i)){e=null===e?{}:e;const o=t[i];null===r?w3(e,n,i,o):r.hasOwnProperty(i)&&w3(e,n,r[i],o)}return e}function w3(t,n,e,r){t.hasOwnProperty(e)?t[e].push(n,r):t[e]=[n,r]}function qc(t,n,e,r,i,o,a,s){const l=In(n,e);let f,c=n.inputs;!s&&null!=c&&(f=c[r])?(PC(t,e,f,r,i),At(n)&&function F7(t,n){const e=Hr(n,t);16&e[ui]||(e[ui]|=32)}(e,n.index)):3&n.type&&(r=function k7(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=a?a(i,n.value||"",r):i,o.setProperty(l,r,i))}function TC(t,n,e,r){if(ta()){const i=null===r?null:{"":-1},o=function L7(t,n){const e=t.directiveRegistry;let r=null,i=null;if(e)for(let o=0;o<e.length;o++){const a=e[o];if(t3(n,a.selectors,!1))if(r||(r=[]),nt(a))if(null!==a.findHostDirectiveDefs){const s=[];i=i||new Map,a.findHostDirectiveDefs(a,s,i),r.unshift(...s,a),MC(t,n,s.length)}else r.unshift(a),MC(t,n,0);else i=i||new Map,a.findHostDirectiveDefs?.(a,r,i),r.push(a)}return null===r?null:[r,i]}(t,e);let a,s;null===o?a=s=null:[a,s]=o,null!==a&&x3(t,n,e,a,i,s),i&&function B7(t,n,e){if(n){const r=t.localNames=[];for(let i=0;i<n.length;i+=2){const o=e[n[i+1]];if(null==o)throw new Vt(-301,!1);r.push(n[i],o)}}}(e,r,i)}e.mergedAttrs=Jf(e.mergedAttrs,e.attrs)}function x3(t,n,e,r,i,o){for(let c=0;c<r.length;c++)wp(Su(e,n),t,r[c].type);!function V7(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,r.length);for(let c=0;c<r.length;c++){const f=r[c];f.providersResolver&&f.providersResolver(f)}let a=!1,s=!1,l=rv(t,n,r.length,null);for(let c=0;c<r.length;c++){const f=r[c];e.mergedAttrs=Jf(e.mergedAttrs,f.hostAttrs),U7(t,e,n,l,f),j7(l,f,i),null!==f.contentQueries&&(e.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(e.flags|=64);const v=f.type.prototype;!a&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((t.preOrderHooks??(t.preOrderHooks=[])).push(e.index),a=!0),!s&&(v.ngOnChanges||v.ngDoCheck)&&((t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(e.index),s=!0),l++}!function M7(t,n,e){const i=n.directiveEnd,o=t.data,a=n.attrs,s=[];let l=null,c=null;for(let f=n.directiveStart;f<i;f++){const v=o[f],E=e?e.get(v):null,k=E?E.outputs:null;l=y3(v.inputs,f,l,E?E.inputs:null),c=y3(v.outputs,f,c,k);const T=null===l||null===a||e3(n)?null:$7(l,f,a);s.push(T)}null!==l&&(l.hasOwnProperty("class")&&(n.flags|=8),l.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=s,n.inputs=l,n.outputs=c}(t,e,o)}function C3(t,n,e){const r=e.directiveStart,i=e.directiveEnd,o=e.index,a=function cp(){return Tr.lFrame.currentDirectiveIndex}();try{Cu(o);for(let s=r;s<i;s++){const l=t.data[s],c=n[s];Wd(s),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&R7(l,c)}}finally{Cu(-1),Wd(a)}}function R7(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function MC(t,n,e){n.componentOffset=e,(t.components??(t.components=[])).push(n.index)}function j7(t,n,e){if(e){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)e[n.exportAs[r]]=t;nt(n)&&(e[""]=t)}}function U7(t,n,e,r,i){t.data[r]=i;const o=i.factory||(i.factory=bt(i.type)),a=new sd(o,nt(i),X);t.blueprint[r]=a,e[r]=a,function P7(t,n,e,r,i){const o=i.hostBindings;if(o){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const s=~n.index;(function O7(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(a)!=s&&a.push(s),a.push(e,r,o)}}(t,n,r,rv(t,e,i.hostVars,fi),i)}function gf(t,n,e,r,i,o){const a=In(t,n);!function kC(t,n,e,r,i,o,a){if(null==o)t.removeAttribute(n,i,e);else{const s=null==a?ei(o):a(o,r||"",i);t.setAttribute(n,i,s,e)}}(n[di],a,o,t.value,e,r,i)}function z7(t,n,e,r,i,o){const a=o[n];if(null!==a){const s=r.setInput;for(let l=0;l<a.length;){const c=a[l++],f=a[l++],v=a[l++];null!==s?r.setInput(e,v,c,f):e[f]=v}}}function $7(t,n,e){let r=null,i=0;for(;i<e.length;){const o=e[i];if(0!==o)if(5!==o){if("number"==typeof o)break;if(t.hasOwnProperty(o)){null===r&&(r=[]);const a=t[o];for(let s=0;s<a.length;s+=2)if(a[s]===n){r.push(o,a[s+1],e[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function E3(t,n,e,r){return[t,!0,!1,n,null,0,r,e,null,null]}function G7(t,n){const e=Hr(n,t);if(Ua(e)){const r=e[ar];48&e[ui]?z2(r,e,r.template,e[Uo]):e[yu]>0&&FC(e)}}function FC(t){for(let r=Q0(t);null!==r;r=J0(r))for(let i=be;i<r.length;i++){const o=r[i];if(Ua(o))if(512&o[ui]){const a=o[ar];z2(a,o,a.template,o[Uo])}else o[yu]>0&&FC(o)}const e=t[ar].components;if(null!==e)for(let r=0;r<e.length;r++){const i=Hr(e[r],t);Ua(i)&&i[yu]>0&&FC(i)}}function Y7(t,n){const e=Hr(n,t),r=e[ar];(function X7(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(r,e),CC(r,e,e[Uo])}function $2(t,n){return t[_]?t[p][ql]=n:t[_]=n,t[p]=n,n}function W2(t){for(;t;){t[ui]|=32;const n=lg(t);if(Oe(t)&&!n)return t;t=n}return null}function q2(t,n,e,r=!0){const i=n[ap];i.begin&&i.begin();try{z2(t,n,t.template,e)}catch(a){throw r&&T3(n,a),a}finally{i.end&&i.end()}}function IC(t,n,e){Vm(0),n(t,e)}function S3(t){return t[od]||(t[od]=[])}function D3(t){return t.cleanup||(t.cleanup=[])}function A3(t,n,e){return(null===t||nt(t))&&(e=function et(t){for(;Array.isArray(t);){if("object"==typeof t[Q])return t;t=t[Oc]}return null}(e[n.index])),e[di]}function T3(t,n){const e=t[op],r=e?e.get(ph,null):null;r&&r.handleError(n)}function PC(t,n,e,r,i){for(let o=0;o<e.length;){const a=e[o++],s=e[o++],l=n[a],c=t.data[a];null!==c.setInput?c.setInput(l,i,r,s):l[s]=i}}function gh(t,n,e){const r=cn(n,t);!function cg(t,n,e){t.setValue(n,e)}(t[di],r,e)}function G2(t,n,e){let r=e?t.styles:null,i=e?t.classes:null,o=0;if(null!==n)for(let a=0;a<n.length;a++){const s=n[a];"number"==typeof s?o=s:1==o?i=ca(i,s):2==o&&(r=ca(r,s+": "+n[++a]+";"))}e?t.styles=r:t.stylesWithoutHost=r,e?t.classes=i:t.classesWithoutHost=i}function Y2(t,n,e,r,i=!1){for(;null!==e;){const o=n[e.index];if(null!==o&&r.push(le(o)),Be(o))for(let s=be;s<o.length;s++){const l=o[s],c=l[ar].firstChild;null!==c&&Y2(l[ar],l,c,r)}const a=e.type;if(8&a)Y2(t,n,e.child,r);else if(32&a){const s=Mu(e,n);let l;for(;l=s();)r.push(l)}else if(16&a){const s=un(n,e);if(Array.isArray(s))r.push(...s);else{const l=lg(n[b]);Y2(l[ar],l,s,r,!0)}}e=i?e.projectionNext:e.next}return r}class iv{get rootNodes(){const n=this._lView,e=n[ar];return Y2(e,n,e.firstChild,[])}constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Uo]}set context(n){this._lView[Uo]=n}get destroyed(){return 128==(128&this._lView[ui])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Vo];if(Be(n)){const e=n[ve],r=e?e.indexOf(this):-1;r>-1&&($_(n,r),fc(e,r))}this._attachedToViewContainer=!1}M2(this._lView[ar],this._lView)}onDestroy(n){b3(this._lView[ar],this._lView,null,n)}markForCheck(){W2(this._cdRefInjectingView||this._lView)}detach(){this._lView[ui]&=-65}reattach(){this._lView[ui]|=64}detectChanges(){q2(this._lView[ar],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Vt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function A2(t,n){en(t,n,n[di],2,null,null)}(this._lView[ar],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Vt(902,!1);this._appRef=n}}class K7 extends iv{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;q2(n[ar],n,n[Uo],!1)}checkNoChanges(){}get context(){return null}}class M3 extends Bp{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=oi(n);return new ov(e,this.ngModule)}}function k3(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class Q7{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,r){r=Yf(r);const i=this.injector.get(n,mC,r);return i!==mC||e===mC?i:this.parentInjector.get(n,e,r)}}class ov extends XA{get inputs(){return k3(this.componentDef.inputs)}get outputs(){return k3(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function n7(t){return t.map(t7).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,r,i){let o=(i=i||this.ngModule)instanceof mf?i:i?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const a=o?new Q7(n,o):n,s=a.get(nv,null);if(null===s)throw new Vt(407,!1);const l=a.get(NL,null),c=s.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",v=r?function A7(t,n,e){return t.selectRootElement(n,e===bl.ShadowDom)}(c,r,this.componentDef.encapsulation):dg(c,f,function Z7(t){const n=t.toLowerCase();return"svg"===n?F:"math"===n?"math":null}(f)),E=this.componentDef.onPush?288:272,D=AC(0,null,null,1,0,null,null,null,null,null),k=H2(null,D,null,E,null,null,s,c,l,a,null);let T,R;up(k);try{const q=this.componentDef;let Z,W=null;q.findHostDirectiveDefs?(Z=[],W=new Map,q.findHostDirectiveDefs(q,Z,W),Z.push(q)):Z=[q];const Ee=function eB(t,n){const e=t[ar],r=H;return t[r]=n,g1(e,r,2,"#host",null)}(k,v),Le=function tB(t,n,e,r,i,o,a,s){const l=i[ar];!function nB(t,n,e,r){for(const i of t)n.mergedAttrs=Jf(n.mergedAttrs,i.hostAttrs);null!==n.mergedAttrs&&(G2(n,n.mergedAttrs,!0),null!==e&&Ki(r,e,n))}(r,t,n,a);const c=o.createRenderer(n,e),f=H2(i,v3(e),null,e.onPush?32:16,i[t.index],t,o,c,s||null,null,null);return l.firstCreatePass&&MC(l,t,r.length-1),$2(i,f),i[t.index]=f}(Ee,v,q,Z,k,s,c);R=Or(D,H),v&&function iB(t,n,e,r){if(r)Wm(t,e,["ng-version",RL.full]);else{const{attrs:i,classes:o}=function r7(t){const n=[],e=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&n.push(o,t[++r]):8===i&&e.push(o);else{if(!md(i))break;i=o}r++}return{attrs:n,classes:e}}(n.selectors[0]);i&&Wm(t,e,i),o&&o.length>0&&qn(t,e,o.join(" "))}}(c,q,v,r),void 0!==e&&function oB(t,n,e){const r=t.projection=[];for(let i=0;i<n.length;i++){const o=e[i];r.push(null!=o?Array.from(o):null)}}(R,this.ngContentSelectors,e),T=function rB(t,n,e,r,i,o){const a=mr(),s=i[ar],l=In(a,i);x3(s,i,a,e,null,r);for(let f=0;f<e.length;f++)Ta(Bc(i,s,a.directiveStart+f,a),i);C3(s,i,a),l&&Ta(l,i);const c=Bc(i,s,a.directiveStart+a.componentOffset,a);if(t[Uo]=i[Uo]=c,null!==o)for(const f of o)f(c,n);return EC(s,a,t),c}(Le,q,Z,W,k,[aB]),CC(D,k,null)}finally{Hm()}return new J7(this.componentType,T,h1(R,k),k,R)}}class J7 extends ML{constructor(n,e,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new K7(i),this.componentType=n}setInput(n,e){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[n])){const o=this._rootLView;PC(o[ar],o,i,n,e),W2(Hr(this._tNode.index,o))}}get injector(){return new Zd(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function aB(){const t=mr();Gd(fn()[ar],t)}function _r(t){let n=function F3(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const r=[t];for(;n;){let i;if(nt(t))i=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Vt(903,!1);i=n.\u0275dir}if(i){if(e){r.push(i);const a=t;a.inputs=OC(t.inputs),a.declaredInputs=OC(t.declaredInputs),a.outputs=OC(t.outputs);const s=i.hostBindings;s&&uB(t,s);const l=i.viewQuery,c=i.contentQueries;if(l&&lB(t,l),c&&cB(t,c),$f(t.inputs,i.inputs),$f(t.declaredInputs,i.declaredInputs),$f(t.outputs,i.outputs),nt(i)&&i.data.animation){const f=t.data;f.animation=(f.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let a=0;a<o.length;a++){const s=o[a];s&&s.ngInherit&&s(t),s===_r&&(e=!1)}}n=Object.getPrototypeOf(n)}!function sB(t){let n=0,e=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=n+=i.hostVars,i.hostAttrs=Jf(i.hostAttrs,e=Jf(e,i.hostAttrs))}}(r)}function OC(t){return t===Pc?{}:t===Ui?[]:t}function lB(t,n){const e=t.viewQuery;t.viewQuery=e?(r,i)=>{n(r,i),e(r,i)}:n}function cB(t,n){const e=t.contentQueries;t.contentQueries=e?(r,i,o)=>{n(r,i,o),e(r,i,o)}:n}function uB(t,n){const e=t.hostBindings;t.hostBindings=e?(r,i)=>{n(r,i),e(r,i)}:n}function X2(t){return!!NC(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function NC(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function _f(t,n,e){return t[n]=e}function Tl(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function yg(t,n,e,r){const i=Tl(t,n,e);return Tl(t,n+1,r)||i}function Ou(t,n,e,r,i,o){const a=yg(t,n,e,r);return yg(t,n+2,i,o)||a}function kr(t,n,e,r){const i=fn();return Tl(i,rl(),n)&&(zr(),gf(Po(),i,t,n,e,r)),kr}function y1(t,n,e,r,i,o,a,s){const c=function K2(t,n,e,r,i){const o=yg(t,n,e,r);return Tl(t,n+2,i)||o}(t,Ha(),e,i,a);return Aa(3),c?n+ei(e)+r+ei(i)+o+ei(a)+s:fi}function oe(t,n,e,r,i,o,a,s){const l=fn(),c=zr(),f=t+H,v=c.firstCreatePass?function yB(t,n,e,r,i,o,a,s,l){const c=n.consts,f=g1(n,t,4,a||null,rs(c,s));TC(n,e,f,rs(c,l)),Gd(n,f);const v=f.tView=AC(2,f,r,i,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,c);return null!==n.queries&&(n.queries.template(n,f),v.queries=n.queries.embeddedTView(f)),f}(f,c,l,n,e,r,i,o,a):c.data[f];na(v,!1);const E=l[di].createComment("");at(c,l,E,v),Ta(E,l),$2(l,l[f]=E3(E,l,E,v)),ln(v)&&SC(c,l,v),null!=a&&DC(l,v,s)}function go(t){return wr(function Gl(){return Tr.lFrame.contextLView}(),H+t)}function N(t,n,e){const r=fn();return Tl(r,rl(),n)&&qc(zr(),Po(),r,t,n,r[di],e,!1),N}function RC(t,n,e,r,i){const a=i?"class":"style";PC(t,e,n.inputs[a],a,r)}function d(t,n,e,r){const i=fn(),o=zr(),a=H+t,s=i[di],l=o.firstCreatePass?function xB(t,n,e,r,i,o){const a=n.consts,l=g1(n,t,2,r,rs(a,i));return TC(n,e,l,rs(a,o)),null!==l.attrs&&G2(l,l.attrs,!1),null!==l.mergedAttrs&&G2(l,l.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,l),l}(a,o,i,n,e,r):o.data[a],c=i[a]=dg(s,n,function hp(){return Tr.lFrame.currentNamespace}()),f=ln(l);return na(l,!0),Ki(s,c,l),32!=(32&l.flags)&&at(o,i,c,l),0===function fa(){return Tr.lFrame.elementDepthCount}()&&Ta(c,i),function Nc(){Tr.lFrame.elementDepthCount++}(),f&&(SC(o,i,l),EC(o,l,i)),null!==r&&DC(i,l),d}function u(){let t=mr();_a()?ha():(t=t.parent,na(t,!1));const n=t;!function ad(){Tr.lFrame.elementDepthCount--}();const e=zr();return e.firstCreatePass&&(Gd(e,t),st(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function gp(t){return 0!=(8&t.flags)}(n)&&RC(e,n,fn(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function _p(t){return 0!=(16&t.flags)}(n)&&RC(e,n,fn(),n.stylesWithoutHost,!1),u}function qe(t,n,e,r){return d(t,n,e,r),u(),qe}function xc(t,n,e){const r=fn(),i=zr(),o=t+H,a=i.firstCreatePass?function CB(t,n,e,r,i){const o=n.consts,a=rs(o,r),s=g1(n,t,8,"ng-container",a);return null!==a&&G2(s,a,!0),TC(n,e,s,rs(o,i)),null!==n.queries&&n.queries.elementStart(n,s),s}(o,i,r,n,e):i.data[o];na(a,!0);const s=r[o]=r[di].createComment("");return at(i,r,s,a),Ta(s,r),ln(a)&&(SC(i,r,a),EC(i,a,r)),null!=e&&DC(r,a),xc}function Cc(){let t=mr();const n=zr();return _a()?ha():(t=t.parent,na(t,!1)),n.firstCreatePass&&(Gd(n,t),st(t)&&n.queries.elementEnd(t)),Cc}function Fn(){return fn()}function sv(t){return!!t&&"function"==typeof t.then}const LC=function W3(t){return!!t&&"function"==typeof t.subscribe};function De(t,n,e,r){const i=fn(),o=zr(),a=mr();return q3(o,i,i[di],a,t,n,r),De}function lv(t,n){const e=mr(),r=fn(),i=zr();return q3(i,r,A3(qd(i.data),e,r),e,t,n),lv}function q3(t,n,e,r,i,o,a){const s=ln(r),c=t.firstCreatePass&&D3(t),f=n[Uo],v=S3(n);let E=!0;if(3&r.type||a){const T=In(r,n),R=a?a(T):T,q=v.length,Z=a?Ee=>a(le(Ee[r.index])):r.index;let W=null;if(!a&&s&&(W=function EB(t,n,e,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const a=i[o];if(a===e&&i[o+1]===r){const s=n[od],l=i[o+2];return s.length>l?s[l]:null}"string"==typeof a&&(o+=2)}return null}(t,n,i,r.index)),null!==W)(W.__ngLastListenerFn__||W).__ngNextListenerFn__=o,W.__ngLastListenerFn__=o,E=!1;else{o=Y3(r,n,f,o,!1);const Ee=e.listen(R,i,o);v.push(o,Ee),c&&c.push(i,Z,q,q+1)}}else o=Y3(r,n,f,o,!1);const D=r.outputs;let k;if(E&&null!==D&&(k=D[i])){const T=k.length;if(T)for(let R=0;R<T;R+=2){const Le=n[k[R]][k[R+1]].subscribe(o),Pe=v.length;v.push(o,Le),c&&c.push(i,r.index,Pe,-(Pe+1))}}}function G3(t,n,e,r){try{return C(6,n,e),!1!==e(r)}catch(i){return T3(t,i),!1}finally{C(7,n,e)}}function Y3(t,n,e,r,i){return function o(a){if(a===Function)return r;W2(t.componentOffset>-1?Hr(t.index,n):n);let l=G3(n,e,r,a),c=o.__ngNextListenerFn__;for(;c;)l=G3(n,e,c,a)&&l,c=c.__ngNextListenerFn__;return i&&!1===l&&(a.preventDefault(),a.returnValue=!1),l}}function ae(t=1){return function fp(t){return(Tr.lFrame.contextLView=function I_(t,n){for(;t>0;)n=n[g],t--;return n}(t,Tr.lFrame.contextLView))[Uo]}(t)}function SB(t,n){let e=null;const r=function ZL(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let i=0;i<n.length;i++){const o=n[i];if("*"!==o){if(null===r?t3(t,o,!0):e7(r,o))return i}else e=i}return e}function Fa(t){const n=fn()[b][Va];if(!n.projection){const r=n.projection=ef(t?t.length:1,null),i=r.slice();let o=n.child;for(;null!==o;){const a=t?SB(o,t):0;null!==a&&(i[a]?i[a].projectionNext=o:r[a]=o,i[a]=o),o=o.next}}}function Ri(t,n=0,e){const r=fn(),i=zr(),o=g1(i,H+t,16,null,e||null);null===o.projection&&(o.projection=n),ha(),32!=(32&o.flags)&&function vn(t,n,e){sn(n[di],0,n,e,k2(t,e,n),ne(e.parent||n[Va],e,n))}(i,r,o)}function Z2(t,n){return t<<17|n<<2}function Vp(t){return t>>17&32767}function jC(t){return 2|t}function wg(t){return(131068&t)>>2}function VC(t,n){return-131069&t|n<<2}function UC(t){return 1|t}function iT(t,n,e,r,i){const o=t[e+1],a=null===n;let s=r?Vp(o):wg(o),l=!1;for(;0!==s&&(!1===l||a);){const f=t[s+1];FB(t[s],n)&&(l=!0,t[s+1]=r?UC(f):jC(f)),s=r?Vp(f):wg(f)}l&&(t[e+1]=r?jC(o):UC(o))}function FB(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&za(t,n)>=0}function A1(t,n,e){return gd(t,n,e,!1),A1}function Ai(t,n){return gd(t,n,null,!0),Ai}function gd(t,n,e,r){const i=fn(),o=zr(),a=Aa(2);o.firstUpdatePass&&function fT(t,n,e,r){const i=t.data;if(null===i[e+1]){const o=i[Oi()],a=function dT(t,n){return n>=t.expandoStartIndex}(t,e);(function gT(t,n){return 0!=(t.flags&(n?8:16))})(o,r)&&null===n&&!a&&(n=!1),n=function VB(t,n,e,r){const i=qd(t);let o=r?n.residualClasses:n.residualStyles;if(null===i)0===(r?n.classBindings:n.styleBindings)&&(e=cv(e=HC(null,t,n,e,r),n.attrs,r),o=null);else{const a=n.directiveStylingLast;if(-1===a||t[a]!==i)if(e=HC(i,t,n,e,r),null===o){let l=function UB(t,n,e){const r=e?n.classBindings:n.styleBindings;if(0!==wg(r))return t[Vp(r)]}(t,n,r);void 0!==l&&Array.isArray(l)&&(l=HC(null,t,n,l[1],r),l=cv(l,n.attrs,r),function HB(t,n,e,r){t[Vp(e?n.classBindings:n.styleBindings)]=r}(t,n,r,l))}else o=function zB(t,n,e){let r;const i=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<i;o++)r=cv(r,t[o].hostAttrs,e);return cv(r,n.attrs,e)}(t,n,r)}return void 0!==o&&(r?n.residualClasses=o:n.residualStyles=o),e}(i,o,n,r),function MB(t,n,e,r,i,o){let a=o?n.classBindings:n.styleBindings,s=Vp(a),l=wg(a);t[r]=e;let f,c=!1;if(Array.isArray(e)?(f=e[1],(null===f||za(e,f)>0)&&(c=!0)):f=e,i)if(0!==l){const E=Vp(t[s+1]);t[r+1]=Z2(E,s),0!==E&&(t[E+1]=VC(t[E+1],r)),t[s+1]=function AB(t,n){return 131071&t|n<<17}(t[s+1],r)}else t[r+1]=Z2(s,0),0!==s&&(t[s+1]=VC(t[s+1],r)),s=r;else t[r+1]=Z2(l,0),0===s?s=r:t[l+1]=VC(t[l+1],r),l=r;c&&(t[r+1]=jC(t[r+1])),iT(t,f,r,!0),iT(t,f,r,!1),function kB(t,n,e,r,i){const o=i?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&za(o,n)>=0&&(e[r+1]=UC(e[r+1]))}(n,f,t,r,o),a=Z2(s,l),o?n.classBindings=a:n.styleBindings=a}(i,o,n,e,a,r)}}(o,t,a,r),n!==fi&&Tl(i,a,n)&&function pT(t,n,e,r,i,o,a,s){if(!(3&n.type))return;const l=t.data,c=l[s+1],f=function TB(t){return 1==(1&t)}(c)?mT(l,n,e,i,wg(c),a):void 0;Q2(f)||(Q2(o)||function DB(t){return 2==(2&t)}(c)&&(o=mT(l,null,e,i,s,a)),function $n(t,n,e,r,i){if(n)i?t.addClass(e,r):t.removeClass(e,r);else{let o=-1===r.indexOf("-")?void 0:Ls.DashCase;null==i?t.removeStyle(e,r,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Ls.Important),t.setStyle(e,r,i,o))}}(r,a,cn(Oi(),e),i,o))}(o,o.data[Oi()],i,i[di],t,i[a+1]=function GB(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=to(ss(t)))),t}(n,e),r,a)}function HC(t,n,e,r,i){let o=null;const a=e.directiveEnd;let s=e.directiveStylingLast;for(-1===s?s=e.directiveStart:s++;s<a&&(o=n[s],r=cv(r,o.hostAttrs,i),o!==t);)s++;return null!==t&&(e.directiveStylingLast=s),r}function cv(t,n,e){const r=e?1:2;let i=-1;if(null!==n)for(let o=0;o<n.length;o++){const a=n[o];"number"==typeof a?i=a:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),ys(t,a,!!e||n[++o]))}return void 0===t?null:t}function mT(t,n,e,r,i,o){const a=null===n;let s;for(;i>0;){const l=t[i],c=Array.isArray(l),f=c?l[1]:l,v=null===f;let E=e[i+1];E===fi&&(E=v?Ui:void 0);let D=v?tf(E,r):f===r?E:void 0;if(c&&!Q2(D)&&(D=tf(l,r)),Q2(D)&&(s=D,a))return s;const k=t[i+1];i=a?Vp(k):wg(k)}if(null!==n){let l=o?n.residualClasses:n.residualStyles;null!=l&&(s=tf(l,r))}return s}function Q2(t){return void 0!==t}function h(t,n=""){const e=fn(),r=zr(),i=t+H,o=r.firstCreatePass?g1(r,i,1,n,null):r.data[i],a=e[i]=function Pp(t,n){return t.createText(n)}(e[di],n);at(r,e,a,o),na(o,!1)}function _e(t){return Qt("",t,""),_e}function Qt(t,n,e){const r=fn(),i=function v1(t,n,e,r){return Tl(t,rl(),e)?n+ei(e)+r:fi}(r,t,n,e);return i!==fi&&gh(r,Oi(),i),Qt}function fo(t,n,e,r,i){const o=fn(),a=function b1(t,n,e,r,i,o){const s=yg(t,Ha(),e,i);return Aa(2),s?n+ei(e)+r+ei(i)+o:fi}(o,t,n,e,r,i);return a!==fi&&gh(o,Oi(),a),fo}function zC(t,n,e,r,i,o,a){const s=fn(),l=y1(s,t,n,e,r,i,o,a);return l!==fi&&gh(s,Oi(),l),zC}function Up(t,n,e,r,i,o,a,s,l){const c=fn(),f=function w1(t,n,e,r,i,o,a,s,l,c){const v=Ou(t,Ha(),e,i,a,l);return Aa(4),v?n+ei(e)+r+ei(i)+o+ei(a)+s+ei(l)+c:fi}(c,t,n,e,r,i,o,a,s,l);return f!==fi&&gh(c,Oi(),f),Up}function T1(t,n,e){const r=fn();return Tl(r,rl(),n)&&qc(zr(),Po(),r,t,n,r[di],e,!0),T1}function uv(t,n,e){const r=fn();if(Tl(r,rl(),n)){const o=zr(),a=Po();qc(o,a,r,t,n,A3(qd(o.data),a,r),e,!0)}return uv}const xg=void 0;var h9=["en",[["a","p"],["AM","PM"],xg],[["AM","PM"],xg,xg],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],xg,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],xg,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",xg,"{1} 'at' {0}",xg],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function f9(t){const e=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let M1={};function Kl(t){const n=function p9(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=IT(n);if(e)return e;const r=n.split("-")[0];if(e=IT(r),e)return e;if("en"===r)return h9;throw new Vt(701,!1)}function IT(t){return t in M1||(M1[t]=Vi.ng&&Vi.ng.common&&Vi.ng.common.locales&&Vi.ng.common.locales[t]),M1[t]}var cr=(()=>((cr=cr||{})[cr.LocaleId=0]="LocaleId",cr[cr.DayPeriodsFormat=1]="DayPeriodsFormat",cr[cr.DayPeriodsStandalone=2]="DayPeriodsStandalone",cr[cr.DaysFormat=3]="DaysFormat",cr[cr.DaysStandalone=4]="DaysStandalone",cr[cr.MonthsFormat=5]="MonthsFormat",cr[cr.MonthsStandalone=6]="MonthsStandalone",cr[cr.Eras=7]="Eras",cr[cr.FirstDayOfWeek=8]="FirstDayOfWeek",cr[cr.WeekendRange=9]="WeekendRange",cr[cr.DateFormat=10]="DateFormat",cr[cr.TimeFormat=11]="TimeFormat",cr[cr.DateTimeFormat=12]="DateTimeFormat",cr[cr.NumberSymbols=13]="NumberSymbols",cr[cr.NumberFormats=14]="NumberFormats",cr[cr.CurrencyCode=15]="CurrencyCode",cr[cr.CurrencySymbol=16]="CurrencySymbol",cr[cr.CurrencyName=17]="CurrencyName",cr[cr.Currencies=18]="Currencies",cr[cr.Directionality=19]="Directionality",cr[cr.PluralCase=20]="PluralCase",cr[cr.ExtraData=21]="ExtraData",cr))();const k1="en-US";let PT=k1;function qC(t,n,e,r,i){if(t=or(t),Array.isArray(t))for(let o=0;o<t.length;o++)qC(t[o],n,e,r,i);else{const o=zr(),a=fn();let s=bg(t)?t:or(t.provide),l=YA(t);const c=mr(),f=1048575&c.providerIndexes,v=c.directiveStart,E=c.providerIndexes>>20;if(bg(t)||!t.multi){const D=new sd(l,i,X),k=YC(s,n,i?f:f+E,v);-1===k?(wp(Su(c,a),o,s),GC(o,t,n.length),n.push(s),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),e.push(D),a.push(D)):(e[k]=D,a[k]=D)}else{const D=YC(s,n,f+E,v),k=YC(s,n,f,f+E),R=k>=0&&e[k];if(i&&!R||!i&&!(D>=0&&e[D])){wp(Su(c,a),o,s);const q=function dj(t,n,e,r,i){const o=new sd(t,e,X);return o.multi=[],o.index=n,o.componentProviders=0,iM(o,i,r&&!e),o}(i?uj:cj,e.length,i,r,l);!i&&R&&(e[k].providerFactory=q),GC(o,t,n.length,0),n.push(s),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),e.push(q),a.push(q)}else GC(o,t,D>-1?D:k,iM(e[i?k:D],l,!i&&r));!i&&r&&R&&e[k].componentProviders++}}}function GC(t,n,e,r){const i=bg(n),o=function xL(t){return!!t.useClass}(n);if(i||o){const l=(o?or(n.useClass):n).prototype.ngOnDestroy;if(l){const c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&n.multi){const f=c.indexOf(e);-1===f?c.push(e,[r,l]):c[f+1].push(r,l)}else c.push(e,l)}}}function iM(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function YC(t,n,e,r){for(let i=e;i<r;i++)if(n[i]===t)return i;return-1}function cj(t,n,e,r){return XC(this.multi,[])}function uj(t,n,e,r){const i=this.multi;let o;if(this.providerFactory){const a=this.providerFactory.componentProviders,s=Bc(e,e[ar],this.providerFactory.index,r);o=s.slice(0,a),XC(i,o);for(let l=a;l<s.length;l++)o.push(s[l])}else o=[],XC(i,o);return o}function XC(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function ki(t,n=[]){return e=>{e.providersResolver=(r,i)=>function lj(t,n,e){const r=zr();if(r.firstCreatePass){const i=nt(t);qC(e,r.data,r.blueprint,i,!0),qC(n,r.data,r.blueprint,i,!1)}}(r,i?i(t):t,n)}}class F1{}class oM{}class aM extends F1{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new M3(this);const r=Os(n);this._bootstrapComponents=mh(r.bootstrap),this._r3Injector=c3(n,e,[{provide:F1,useValue:this},{provide:Bp,useValue:this.componentFactoryResolver}],to(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class KC extends oM{constructor(n){super(),this.moduleType=n}create(n){return new aM(this.moduleType,n)}}class hj extends F1{constructor(n,e,r){super(),this.componentFactoryResolver=new M3(this),this.instance=null;const i=new GA([...n,{provide:F1,useValue:this},{provide:Bp,useValue:this.componentFactoryResolver}],e||j2(),r,new Set(["environment"]));this.injector=i,i.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function ry(t,n,e=null){return new hj(t,n,e).injector}let pj=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=_g(0,e.type),i=r.length>0?ry([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,i)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return t.\u0275prov=Gt({token:t,providedIn:"environment",factory:()=>new t(it(mf))}),t})();function sM(t){t.getStandaloneInjector=n=>n.get(pj).getOrCreateStandaloneInjector(t)}function Nt(t,n,e){const r=Ho()+t,i=fn();return i[r]===fi?_f(i,r,e?n.call(e):n()):function av(t,n){return t[n]}(i,r)}function Si(t,n,e,r){return mM(fn(),Ho(),t,n,e,r)}function I1(t,n,e,r,i){return gM(fn(),Ho(),t,n,e,r,i)}function gv(t,n){const e=t[n];return e===fi?void 0:e}function mM(t,n,e,r,i,o){const a=n+e;return Tl(t,a,i)?_f(t,a+1,o?r.call(o,i):r(i)):gv(t,a+1)}function gM(t,n,e,r,i,o,a){const s=n+e;return yg(t,s,i,o)?_f(t,s+2,a?r.call(a,i,o):r(i,o)):gv(t,s+2)}function vM(t,n,e,r,i,o,a,s,l){const c=n+e;return Ou(t,c,i,o,a,s)?_f(t,c+4,l?r.call(l,i,o,a,s):r(i,o,a,s)):gv(t,c+4)}function Hi(t,n){const e=zr();let r;const i=t+H;e.firstCreatePass?(r=function Mj(t,n){if(n)for(let e=n.length-1;e>=0;e--){const r=n[e];if(t===r.name)return r}}(n,e.pipeRegistry),e.data[i]=r,r.onDestroy&&(e.destroyHooks??(e.destroyHooks=[])).push(i,r.onDestroy)):r=e.data[i];const o=r.factory||(r.factory=bt(r.type)),a=Sa(X);try{const s=vp(!1),l=o();return vp(s),function wB(t,n,e,r){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=r}(e,fn(),i,l),l}finally{Sa(a)}}function _h(t,n,e){const r=t+H,i=fn(),o=wr(i,r);return _v(i,r)?mM(i,Ho(),n,o.transform,e,o):o.transform(e)}function Xo(t,n,e,r){const i=t+H,o=fn(),a=wr(o,i);return _v(o,i)?gM(o,Ho(),n,a.transform,e,r,a):a.transform(e,r)}function QC(t,n,e,r,i,o){const a=t+H,s=fn(),l=wr(s,a);return _v(s,a)?vM(s,Ho(),n,l.transform,e,r,i,o,l):l.transform(e,r,i,o)}function _v(t,n){return t[ar].data[n].pure}function JC(t){return n=>{setTimeout(t,void 0,n)}}const Vr=class Ij extends Bt{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,r){let i=n,o=e||(()=>null),a=r;if(n&&"object"==typeof n){const l=n;i=l.next?.bind(l),o=l.error?.bind(l),a=l.complete?.bind(l)}this.__isAsync&&(o=JC(o),i&&(i=JC(i)),a&&(a=JC(a)));const s=super.subscribe({next:i,error:o,complete:a});return n instanceof br&&n.add(s),s}};function Pj(){return this._results[Symbol.iterator]()}class Hp{get changes(){return this._changes||(this._changes=new Vr)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Hp.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=Pj)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const r=this;r.dirty=!1;const i=function uo(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function Rs(t,n,e){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],o=n[r];if(e&&(i=e(i),o=e(o)),o!==i)return!1}return!0}(r._results,i,e))&&(r._results=i,r.length=i.length,r.last=i[this.length-1],r.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Zl=(()=>{class t{}return t.__NG_ELEMENT_ID__=Rj,t})();const Oj=Zl,Nj=class extends Oj{constructor(n,e,r){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(n,e){const r=this._declarationTContainer.tView,i=H2(this._declarationLView,r,n,16,null,r.declTNode,null,null,null,null,e||null);i[S]=this._declarationLView[this._declarationTContainer.index];const a=this._declarationLView[M];return null!==a&&(i[M]=a.createEmbeddedView(r)),CC(r,i,n),new iv(i)}};function Rj(){return iy(mr(),fn())}function iy(t,n){return 4&t.type?new Nj(n,t,h1(t,n)):null}let Ml=(()=>{class t{}return t.__NG_ELEMENT_ID__=Lj,t})();function Lj(){return xM(mr(),fn())}const Bj=Ml,yM=class extends Bj{constructor(n,e,r){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=r}get element(){return h1(this._hostTNode,this._hostLView)}get injector(){return new Zd(this._hostTNode,this._hostLView)}get parentInjector(){const n=yp(this._hostTNode,this._hostLView);if(Lc(n)){const e=ld(n,this._hostLView),r=eh(n);return new Zd(e[ar].data[r+8],e)}return new Zd(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=wM(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-be}createEmbeddedView(n,e,r){let i,o;"number"==typeof r?i=r:null!=r&&(i=r.index,o=r.injector);const a=n.createEmbeddedView(e||{},o);return this.insert(a,i),a}createComponent(n,e,r,i,o){const a=n&&!function Yo(t){return"function"==typeof t}(n);let s;if(a)s=e;else{const v=e||{};s=v.index,r=v.injector,i=v.projectableNodes,o=v.environmentInjector||v.ngModuleRef}const l=a?n:new ov(oi(n)),c=r||this.parentInjector;if(!o&&null==l.ngModule){const E=(a?c:this.parentInjector).get(mf,null);E&&(o=E)}const f=l.create(c,i,void 0,o);return this.insert(f.hostView,s),f}insert(n,e){const r=n._lView,i=r[ar];if(function Xi(t){return Be(t[Vo])}(r)){const f=this.indexOf(n);if(-1!==f)this.detach(f);else{const v=r[Vo],E=new yM(v,v[Va],v[Vo]);E.detach(E.indexOf(n))}}const o=this._adjustIndex(e),a=this._lContainer;!function iC(t,n,e,r){const i=be+r,o=e.length;r>0&&(e[i-1][ql]=n),r<o-be?(n[ql]=e[i],Cl(e,be+r,n)):(e.push(n),n[ql]=null),n[Vo]=e;const a=n[S];null!==a&&e!==a&&function oC(t,n){const e=t[ce];n[b]!==n[Vo][Vo][b]&&(t[re]=!0),null===e?t[ce]=[n]:e.push(n)}(a,n);const s=n[M];null!==s&&s.insertView(t),n[ui]|=64}(i,r,a,o);const s=kt(o,a),l=r[di],c=K(l,a[V]);return null!==c&&function nC(t,n,e,r,i,o){r[Oc]=i,r[Va]=n,en(t,r,e,1,i,o)}(i,a[Va],l,r,c,s),n.attachToViewContainerRef(),Cl(eE(a),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=wM(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),r=$_(this._lContainer,e);r&&(fc(eE(this._lContainer),e),M2(r[ar],r))}detach(n){const e=this._adjustIndex(n,-1),r=$_(this._lContainer,e);return r&&null!=fc(eE(this._lContainer),e)?new iv(r):null}_adjustIndex(n,e=0){return n??this.length+e}};function wM(t){return t[ve]}function eE(t){return t[ve]||(t[ve]=[])}function xM(t,n){let e;const r=n[t.index];if(Be(r))e=r;else{let i;if(8&t.type)i=le(r);else{const o=n[di];i=o.createComment("");const a=In(t,n);m(o,K(o,a),i,function ee(t,n){return t.nextSibling(n)}(o,a),!1)}n[t.index]=e=E3(r,n,i,t),$2(n,e)}return new yM(e,t,n)}class tE{constructor(n){this.queryList=n,this.matches=null}clone(){return new tE(this.queryList)}setDirty(){this.queryList.setDirty()}}class nE{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const r=null!==n.contentQueries?n.contentQueries[0]:e.length,i=[];for(let o=0;o<r;o++){const a=e.getByIndex(o);i.push(this.queries[a.indexInDeclarationView].clone())}return new nE(i)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==AM(n,e).matches&&this.queries[e].setDirty()}}class CM{constructor(n,e,r=null){this.predicate=n,this.flags=e,this.read=r}}class rE{constructor(n=[]){this.queries=n}elementStart(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let r=0;r<this.length;r++){const i=null!==e?e.length:0,o=this.getByIndex(r).embeddedTView(n,i);o&&(o.indexInDeclarationView=r,null!==e?e.push(o):e=[o])}return null!==e?new rE(e):null}template(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class iE{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new iE(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=n.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const o=r[i];this.matchTNodeWithReadOption(n,e,jj(e,o)),this.matchTNodeWithReadOption(n,e,xl(e,n,o,!1,!1))}else r===Zl?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,xl(e,n,r,!1,!1))}matchTNodeWithReadOption(n,e,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===$r||i===Ml||i===Zl&&4&e.type)this.addMatch(e.index,-2);else{const o=xl(e,n,i,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,r)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function jj(t,n){const e=t.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===n)return e[r+1];return null}function Uj(t,n,e,r){return-1===e?function Vj(t,n){return 11&t.type?h1(t,n):4&t.type?iy(t,n):null}(n,t):-2===e?function Hj(t,n,e){return e===$r?h1(n,t):e===Zl?iy(n,t):e===Ml?xM(n,t):void 0}(t,n,r):Bc(t,t[ar],e,n)}function EM(t,n,e,r){const i=n[M].queries[r];if(null===i.matches){const o=t.data,a=e.matches,s=[];for(let l=0;l<a.length;l+=2){const c=a[l];s.push(c<0?null:Uj(n,o[c],a[l+1],e.metadata.read))}i.matches=s}return i.matches}function oE(t,n,e,r){const i=t.queries.getByIndex(e),o=i.matches;if(null!==o){const a=EM(t,n,i,e);for(let s=0;s<o.length;s+=2){const l=o[s];if(l>0)r.push(a[s/2]);else{const c=o[s+1],f=n[-l];for(let v=be;v<f.length;v++){const E=f[v];E[S]===E[Vo]&&oE(E[ar],E,c,r)}if(null!==f[ce]){const v=f[ce];for(let E=0;E<v.length;E++){const D=v[E];oE(D[ar],D,c,r)}}}}}return r}function Er(t){const n=fn(),e=zr(),r=jm();Vm(r+1);const i=AM(e,r);if(t.dirty&&function Jn(t){return 4==(4&t[ui])}(n)===(2==(2&i.metadata.flags))){if(null===i.matches)t.reset([]);else{const o=i.crossesNgTemplate?oE(e,n,r,[]):EM(e,n,i,r);t.reset(o,PL),t.notifyOnChanges()}return!0}return!1}function Ko(t,n,e){const r=zr();r.firstCreatePass&&(DM(r,new CM(t,n,e),-1),2==(2&n)&&(r.staticViewQueries=!0)),SM(r,fn(),n)}function so(t,n,e,r){const i=zr();if(i.firstCreatePass){const o=mr();DM(i,new CM(n,e,r),o.index),function $j(t,n){const e=t.contentQueries||(t.contentQueries=[]);n!==(e.length?e[e.length-1]:-1)&&e.push(t.queries.length-1,n)}(i,t),2==(2&e)&&(i.staticContentQueries=!0)}SM(i,fn(),e)}function Sr(){return function zj(t,n){return t[M].queries[n].queryList}(fn(),jm())}function SM(t,n,e){const r=new Hp(4==(4&e));b3(t,n,r,r.destroy),null===n[M]&&(n[M]=new nE),n[M].queries.push(new tE(r))}function DM(t,n,e){null===t.queries&&(t.queries=new rE),t.queries.track(new iE(n,e))}function AM(t,n){return t.queries.getByIndex(n)}function TM(t,n){return iy(t,n)}function ay(...t){}const bv=new U("Application Initializer");let sy=(()=>{class t{constructor(e){this.appInits=e,this.resolve=ay,this.reject=ay,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const o=this.appInits[i]();if(sv(o))e.push(o);else if(LC(o)){const a=new Promise((s,l)=>{o.subscribe({complete:s,error:l})});e.push(a)}}Promise.all(e).then(()=>{r()}).catch(i=>{this.reject(i)}),0===e.length&&r(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(it(bv,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const yv=new U("AppId",{providedIn:"root",factory:function qM(){return`${dE()}${dE()}${dE()}`}});function dE(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const GM=new U("Platform Initializer"),ly=new U("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),kl=new U("AnimationModuleType");let uV=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const yf=new U("LocaleId",{providedIn:"root",factory:()=>Xr(yf,Cr.Optional|Cr.SkipSelf)||function dV(){return typeof $localize<"u"&&$localize.locale||k1}()}),fV=new U("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class hV{constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}}let YM=(()=>{class t{compileModuleSync(e){return new KC(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),o=mh(Os(e).declarations).reduce((a,s)=>{const l=oi(s);return l&&a.push(new ov(l)),a},[]);return new hV(r,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const gV=(()=>Promise.resolve(0))();function fE(t){typeof Zone>"u"?gV.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Wr{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Vr(!1),this.onMicrotaskEmpty=new Vr(!1),this.onStable=new Vr(!1),this.onError=new Vr(!1),typeof Zone>"u")throw new Vt(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&e,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function _V(){let t=Vi.requestAnimationFrame,n=Vi.cancelAnimationFrame;if(typeof Zone<"u"&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function yV(t){const n=()=>{!function bV(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Vi,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,pE(t),t.isCheckStableRunning=!0,hE(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),pE(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,i,o,a,s)=>{try{return ZM(t),e.invokeTask(i,o,a,s)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),QM(t)}},onInvoke:(e,r,i,o,a,s,l)=>{try{return ZM(t),e.invoke(i,o,a,s,l)}finally{t.shouldCoalesceRunChangeDetection&&n(),QM(t)}},onHasTask:(e,r,i,o)=>{e.hasTask(i,o),r===i&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,pE(t),hE(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,r,i,o)=>(e.handleError(i,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Wr.isInAngularZone())throw new Vt(909,!1)}static assertNotInAngularZone(){if(Wr.isInAngularZone())throw new Vt(909,!1)}run(n,e,r){return this._inner.run(n,e,r)}runTask(n,e,r,i){const o=this._inner,a=o.scheduleEventTask("NgZoneEvent: "+i,n,vV,ay,ay);try{return o.runTask(a,e,r)}finally{o.cancelTask(a)}}runGuarded(n,e,r){return this._inner.runGuarded(n,e,r)}runOutsideAngular(n){return this._outer.run(n)}}const vV={};function hE(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function pE(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function ZM(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function QM(t){t._nesting--,hE(t)}class wV{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Vr,this.onMicrotaskEmpty=new Vr,this.onStable=new Vr,this.onError=new Vr}run(n,e,r){return n.apply(e,r)}runGuarded(n,e,r){return n.apply(e,r)}runOutsideAngular(n){return n()}runTask(n,e,r,i){return n.apply(e,r)}}const JM=new U(""),cy=new U("");let _E,mE=(()=>{class t{constructor(e,r,i){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,_E||(function xV(t){_E=t}(i),i.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Wr.assertNotInAngularZone(),fE(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())fE(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:i})}whenStable(e,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,i){return[]}}return t.\u0275fac=function(e){return new(e||t)(it(Wr),it(gE),it(cy))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})(),gE=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return _E?.findTestabilityInTree(this,e,r)??null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const vh=!1;let zp=null;const e4=new U("AllowMultipleToken"),vE=new U("PlatformDestroyListeners"),t4=new U("appBootstrapListener");class n4{constructor(n,e){this.name=n,this.token=e}}function o4(t,n,e=[]){const r=`Platform: ${n}`,i=new U(r);return(o=[])=>{let a=bE();if(!a||a.injector.get(e4,!1)){const s=[...e,...o,{provide:i,useValue:!0}];t?t(s):function SV(t){if(zp&&!zp.get(e4,!1))throw new Vt(400,!1);zp=t;const n=t.get(s4);(function r4(t){const n=t.get(GM,null);n&&n.forEach(e=>e())})(t)}(function a4(t=[],n){return js.create({name:n,providers:[{provide:dC,useValue:"platform"},{provide:vE,useValue:new Set([()=>zp=null])},...t]})}(s,r))}return function AV(t){const n=bE();if(!n)throw new Vt(401,!1);return n}()}}function bE(){return zp?.get(s4)??null}let s4=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const i=function c4(t,n){let e;return e="noop"===t?new wV:("zone.js"===t?void 0:t)||new Wr(n),e}(r?.ngZone,function l4(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(r)),o=[{provide:Wr,useValue:i}];return i.run(()=>{const a=js.create({providers:o,parent:this.injector,name:e.moduleType.name}),s=e.create(a),l=s.injector.get(ph,null);if(!l)throw new Vt(402,!1);return i.runOutsideAngular(()=>{const c=i.onError.subscribe({next:f=>{l.handleError(f)}});s.onDestroy(()=>{uy(this._modules,s),c.unsubscribe()})}),function u4(t,n,e){try{const r=e();return sv(r)?r.catch(i=>{throw n.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw n.runOutsideAngular(()=>t.handleError(r)),r}}(l,i,()=>{const c=s.injector.get(sy);return c.runInitializers(),c.donePromise.then(()=>(function OT(t){Js(t,"Expected localeId to be defined"),"string"==typeof t&&(PT=t.toLowerCase().replace(/_/g,"-"))}(s.injector.get(yf,k1)||k1),this._moduleDoBootstrap(s),s))})})}bootstrapModule(e,r=[]){const i=d4({},r);return function CV(t,n,e){const r=new KC(e);return Promise.resolve(r)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,i))}_moduleDoBootstrap(e){const r=e.injector.get(N1);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!e.instance.ngDoBootstrap)throw new Vt(-403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Vt(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(vE,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(it(js))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function d4(t,n){return Array.isArray(n)?n.reduce(d4,t):{...t,...n}}let N1=(()=>{class t{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(e,r,i){this._zone=e,this._injector=r,this._exceptionHandler=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new Ht(s=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{s.next(this._stable),s.complete()})}),a=new Ht(s=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{Wr.assertNotInAngularZone(),fE(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,s.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{Wr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{s.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=Ea(o,a.pipe(Yh()))}bootstrap(e,r){const i=e instanceof XA;if(!this._injector.get(sy).done){!i&&function _s(t){const n=oi(t)||ns(t)||Ps(t);return null!==n&&n.standalone}(e);throw new Vt(405,vh)}let a;a=i?e:this._injector.get(Bp).resolveComponentFactory(e),this.componentTypes.push(a.componentType);const s=function EV(t){return t.isBoundToModule}(a)?void 0:this._injector.get(F1),c=a.create(js.NULL,[],r||a.selector,s),f=c.location.nativeElement,v=c.injector.get(JM,null);return v?.registerApplication(f),c.onDestroy(()=>{this.detachView(c.hostView),uy(this.components,c),v?.unregisterApplication(f)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new Vt(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;uy(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const r=this._injector.get(t4,[]);r.push(...this._bootstrapListeners),r.forEach(i=>i(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>uy(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Vt(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(e){return new(e||t)(it(Wr),it(mf),it(ph))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function uy(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let Zo=(()=>{class t{}return t.__NG_ELEMENT_ID__=kV,t})();function kV(t){return function FV(t,n,e){if(At(t)&&!e){const r=Hr(t.index,n);return new iv(r,r)}return 47&t.type?new iv(n[b],n):null}(mr(),fn(),16==(16&t))}class g4{constructor(){}supports(n){return X2(n)}create(n){return new LV(n)}}const RV=(t,n)=>n;class LV{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||RV}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,r=this._removalsHead,i=0,o=null;for(;e||r;){const a=!r||e&&e.currentIndex<v4(r,i,o)?e:r,s=v4(a,i,o),l=a.currentIndex;if(a===r)i--,r=r._nextRemoved;else if(e=e._next,null==a.previousIndex)i++;else{o||(o=[]);const c=s-i,f=l-i;if(c!=f){for(let E=0;E<c;E++){const D=E<o.length?o[E]:o[E]=0,k=D+E;f<=k&&k<c&&(o[E]=D+1)}o[a.previousIndex]=f-c}}s!==l&&n(a,s,l)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!X2(n))throw new Vt(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let i,o,a,e=this._itHead,r=!1;if(Array.isArray(n)){this.length=n.length;for(let s=0;s<this.length;s++)o=n[s],a=this._trackByFn(s,o),null!==e&&Object.is(e.trackById,a)?(r&&(e=this._verifyReinsertion(e,o,a,s)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,a,s),r=!0),e=e._next}else i=0,function _B(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let r;for(;!(r=e.next()).done;)n(r.value)}}(n,s=>{a=this._trackByFn(i,s),null!==e&&Object.is(e.trackById,a)?(r&&(e=this._verifyReinsertion(e,s,a,i)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,a,i),r=!0),e=e._next,i++}),this.length=i;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,r,i){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,i)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,i)):n=this._addAfter(new BV(e,r),o,i),n}_verifyReinsertion(n,e,r,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==o?n=this._reinsertAfter(o,n._prev,i):n.currentIndex!=i&&(n.currentIndex=i,this._addToMoves(n,i)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const i=n._prevRemoved,o=n._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(n,e,r),this._addToMoves(n,r),n}_moveAfter(n,e,r){return this._unlink(n),this._insertAfter(n,e,r),this._addToMoves(n,r),n}_addAfter(n,e,r){return this._insertAfter(n,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,r){const i=null===e?this._itHead:e._next;return n._next=i,n._prev=e,null===i?this._itTail=n:i._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new _4),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,r=n._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _4),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class BV{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class jV{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){const e=n._prevDup,r=n._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class _4{constructor(){this.map=new Map}put(n){const e=n.trackById;let r=this.map.get(e);r||(r=new jV,this.map.set(e,r)),r.add(n)}get(n,e){const i=this.map.get(n);return i?i.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function v4(t,n,e){const r=t.previousIndex;if(null===r)return r;let i=0;return e&&r<e.length&&(i=e[r]),r+n+i}class b4{constructor(){}supports(n){return n instanceof Map||NC(n)}create(){return new VV}}class VV{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||NC(n)))throw new Vt(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(r,i)=>{if(e&&e.key===i)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(i,r);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const r=n._prev;return e._next=n,e._prev=r,n._prev=e,r&&(r._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const i=this._records.get(n);this._maybeAddToChanges(i,e);const o=i._prev,a=i._next;return o&&(o._next=a),a&&(a._prev=o),i._next=null,i._prev=null,i}const r=new UV(n);return this._records.set(n,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(r=>e(n[r],r))}}class UV{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function y4(){return new hy([new g4])}let hy=(()=>{class t{constructor(e){this.factories=e}static create(e,r){if(null!=r){const i=r.factories.slice();e=e.concat(i)}return new t(e)}static extend(e){return{provide:t,useFactory:r=>t.create(e,r||y4()),deps:[[t,new ws,new Uc]]}}find(e){const r=this.factories.find(i=>i.supports(e));if(null!=r)return r;throw new Vt(901,!1)}}return t.\u0275prov=Gt({token:t,providedIn:"root",factory:y4}),t})();function w4(){return new wv([new b4])}let wv=(()=>{class t{constructor(e){this.factories=e}static create(e,r){if(r){const i=r.factories.slice();e=e.concat(i)}return new t(e)}static extend(e){return{provide:t,useFactory:r=>t.create(e,r||w4()),deps:[[t,new ws,new Uc]]}}find(e){const r=this.factories.find(i=>i.supports(e));if(r)return r;throw new Vt(901,!1)}}return t.\u0275prov=Gt({token:t,providedIn:"root",factory:w4}),t})();const $V=o4(null,"core",[]);let WV=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(it(N1))},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({}),t})();function R1(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let EE=null;function bh(){return EE}class YV{}const si=new U("DocumentToken");let SE=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:function(){return function XV(){return it(x4)}()},providedIn:"platform"}),t})();const KV=new U("Location Initialized");let x4=(()=>{class t extends SE{constructor(e){super(),this._doc=e,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return bh().getBaseHref(this._doc)}onPopState(e){const r=bh().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=bh().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,r,i){C4()?this._history.pushState(e,r,i):this._location.hash=i}replaceState(e,r,i){C4()?this._history.replaceState(e,r,i):this._location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(it(si))},t.\u0275prov=Gt({token:t,factory:function(){return function ZV(){return new x4(it(si))}()},providedIn:"platform"}),t})();function C4(){return!!window.history.pushState}function DE(t,n){if(0==t.length)return n;if(0==n.length)return t;let e=0;return t.endsWith("/")&&e++,n.startsWith("/")&&e++,2==e?t+n.substring(1):1==e?t+n:t+"/"+n}function E4(t){const n=t.match(/#|\?|$/),e=n&&n.index||t.length;return t.slice(0,e-("/"===t[e-1]?1:0))+t.slice(e)}function yh(t){return t&&"?"!==t[0]?"?"+t:t}let Eg=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:function(){return Xr(D4)},providedIn:"root"}),t})();const S4=new U("appBaseHref");let D4=(()=>{class t extends Eg{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Xr(si).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return DE(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+yh(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${r}${i}`:r}pushState(e,r,i,o){const a=this.prepareExternalUrl(i+yh(o));this._platformLocation.pushState(e,r,a)}replaceState(e,r,i,o){const a=this.prepareExternalUrl(i+yh(o));this._platformLocation.replaceState(e,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return t.\u0275fac=function(e){return new(e||t)(it(SE),it(S4,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),QV=(()=>{class t extends Eg{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=DE(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,i,o){let a=this.prepareExternalUrl(i+yh(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(e,r,a)}replaceState(e,r,i,o){let a=this.prepareExternalUrl(i+yh(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return t.\u0275fac=function(e){return new(e||t)(it(SE),it(S4,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})(),xv=(()=>{class t{constructor(e){this._subject=new Vr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._basePath=function tU(t){if(new RegExp("^(https?:)?//").test(t)){const[,e]=t.split(/\/\/[^\/]+/);return e}return t}(E4(A4(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+yh(r))}normalize(e){return t.stripTrailingSlash(function eU(t,n){if(!t||!n.startsWith(t))return n;const e=n.substring(t.length);return""===e||["/",";","?","#"].includes(e[0])?e:n}(this._basePath,A4(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",i=null){this._locationStrategy.pushState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+yh(r)),i)}replaceState(e,r="",i=null){this._locationStrategy.replaceState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+yh(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(i=>i(e,r))}subscribe(e,r,i){return this._subject.subscribe({next:e,error:r,complete:i})}}return t.normalizeQueryParams=yh,t.joinWithSlash=DE,t.stripTrailingSlash=E4,t.\u0275fac=function(e){return new(e||t)(it(Eg))},t.\u0275prov=Gt({token:t,factory:function(){return function JV(){return new xv(it(Eg))}()},providedIn:"root"}),t})();function A4(t){return t.replace(/\/index.html$/,"")}const T4={ADP:[void 0,void 0,0],AFN:[void 0,"\u060b",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058f",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20bc"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09f3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xa5","\xa5"],COP:[void 0,"$",2],CRC:[void 0,"\u20a1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010d",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xa3"],ESP:[void 0,"\u20a7",0],EUR:["\u20ac"],FJD:[void 0,"$"],FKP:[void 0,"\xa3"],GBP:["\xa3"],GEL:[void 0,"\u20be"],GHS:[void 0,"GH\u20b5"],GIP:[void 0,"\xa3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20aa"],INR:["\u20b9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xa5",void 0,0],KHR:[void 0,"\u17db"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20a9",0],KRW:["\u20a9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20b8"],LAK:[void 0,"\u20ad",0],LBP:[void 0,"L\xa3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20ae",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20a6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20b1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20b2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20bd"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xa3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xa3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xa3",0],THB:[void 0,"\u0e3f"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20ba"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20b4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20ab",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202fCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xa4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]};var Ec=(()=>((Ec=Ec||{})[Ec.Decimal=0]="Decimal",Ec[Ec.Percent=1]="Percent",Ec[Ec.Currency=2]="Currency",Ec[Ec.Scientific=3]="Scientific",Ec))(),Wa=(()=>((Wa=Wa||{})[Wa.Format=0]="Format",Wa[Wa.Standalone=1]="Standalone",Wa))(),Li=(()=>((Li=Li||{})[Li.Narrow=0]="Narrow",Li[Li.Abbreviated=1]="Abbreviated",Li[Li.Wide=2]="Wide",Li[Li.Short=3]="Short",Li))(),ba=(()=>((ba=ba||{})[ba.Short=0]="Short",ba[ba.Medium=1]="Medium",ba[ba.Long=2]="Long",ba[ba.Full=3]="Full",ba))(),Yr=(()=>((Yr=Yr||{})[Yr.Decimal=0]="Decimal",Yr[Yr.Group=1]="Group",Yr[Yr.List=2]="List",Yr[Yr.PercentSign=3]="PercentSign",Yr[Yr.PlusSign=4]="PlusSign",Yr[Yr.MinusSign=5]="MinusSign",Yr[Yr.Exponential=6]="Exponential",Yr[Yr.SuperscriptingExponent=7]="SuperscriptingExponent",Yr[Yr.PerMille=8]="PerMille",Yr[Yr.Infinity=9]="Infinity",Yr[Yr.NaN=10]="NaN",Yr[Yr.TimeSeparator=11]="TimeSeparator",Yr[Yr.CurrencyDecimal=12]="CurrencyDecimal",Yr[Yr.CurrencyGroup=13]="CurrencyGroup",Yr))();function py(t,n){return Ru(Kl(t)[cr.DateFormat],n)}function my(t,n){return Ru(Kl(t)[cr.TimeFormat],n)}function gy(t,n){return Ru(Kl(t)[cr.DateTimeFormat],n)}function Nu(t,n){const e=Kl(t),r=e[cr.NumberSymbols][n];if(typeof r>"u"){if(n===Yr.CurrencyDecimal)return e[cr.NumberSymbols][Yr.Decimal];if(n===Yr.CurrencyGroup)return e[cr.NumberSymbols][Yr.Group]}return r}function AE(t,n){return Kl(t)[cr.NumberFormats][n]}function M4(t){if(!t[cr.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[cr.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ru(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function TE(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const fU=2,pU=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Cv={},mU=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Es=(()=>((Es=Es||{})[Es.Short=0]="Short",Es[Es.ShortGMT=1]="ShortGMT",Es[Es.Long=2]="Long",Es[Es.Extended=3]="Extended",Es))(),Qr=(()=>((Qr=Qr||{})[Qr.FullYear=0]="FullYear",Qr[Qr.Month=1]="Month",Qr[Qr.Date=2]="Date",Qr[Qr.Hours=3]="Hours",Qr[Qr.Minutes=4]="Minutes",Qr[Qr.Seconds=5]="Seconds",Qr[Qr.FractionalSeconds=6]="FractionalSeconds",Qr[Qr.Day=7]="Day",Qr))(),Ci=(()=>((Ci=Ci||{})[Ci.DayPeriods=0]="DayPeriods",Ci[Ci.Days=1]="Days",Ci[Ci.Months=2]="Months",Ci[Ci.Eras=3]="Eras",Ci))();function gU(t,n,e,r){let i=function SU(t){if(I4(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[i,o=1,a=1]=t.split("-").map(s=>+s);return _y(i,o-1,a)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let r;if(r=t.match(pU))return function DU(t){const n=new Date(0);let e=0,r=0;const i=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),r=Number(t[9]+t[11])),i.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const a=Number(t[4]||0)-e,s=Number(t[5]||0)-r,l=Number(t[6]||0),c=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,a,s,l,c),n}(r)}const n=new Date(t);if(!I4(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=wh(e,n)||n;let s,a=[];for(;n;){if(s=mU.exec(n),!s){a.push(n);break}{a=a.concat(s.slice(1));const f=a.pop();if(!f)break;n=f}}let l=i.getTimezoneOffset();r&&(l=F4(r,l),i=function EU(t,n,e){const r=e?-1:1,i=t.getTimezoneOffset();return function CU(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,r*(F4(n,i)-i))}(i,r,!0));let c="";return a.forEach(f=>{const v=function xU(t){if(kE[t])return kE[t];let n;switch(t){case"G":case"GG":case"GGG":n=Qo(Ci.Eras,Li.Abbreviated);break;case"GGGG":n=Qo(Ci.Eras,Li.Wide);break;case"GGGGG":n=Qo(Ci.Eras,Li.Narrow);break;case"y":n=cs(Qr.FullYear,1,0,!1,!0);break;case"yy":n=cs(Qr.FullYear,2,0,!0,!0);break;case"yyy":n=cs(Qr.FullYear,3,0,!1,!0);break;case"yyyy":n=cs(Qr.FullYear,4,0,!1,!0);break;case"Y":n=wy(1);break;case"YY":n=wy(2,!0);break;case"YYY":n=wy(3);break;case"YYYY":n=wy(4);break;case"M":case"L":n=cs(Qr.Month,1,1);break;case"MM":case"LL":n=cs(Qr.Month,2,1);break;case"MMM":n=Qo(Ci.Months,Li.Abbreviated);break;case"MMMM":n=Qo(Ci.Months,Li.Wide);break;case"MMMMM":n=Qo(Ci.Months,Li.Narrow);break;case"LLL":n=Qo(Ci.Months,Li.Abbreviated,Wa.Standalone);break;case"LLLL":n=Qo(Ci.Months,Li.Wide,Wa.Standalone);break;case"LLLLL":n=Qo(Ci.Months,Li.Narrow,Wa.Standalone);break;case"w":n=ME(1);break;case"ww":n=ME(2);break;case"W":n=ME(1,!0);break;case"d":n=cs(Qr.Date,1);break;case"dd":n=cs(Qr.Date,2);break;case"c":case"cc":n=cs(Qr.Day,1);break;case"ccc":n=Qo(Ci.Days,Li.Abbreviated,Wa.Standalone);break;case"cccc":n=Qo(Ci.Days,Li.Wide,Wa.Standalone);break;case"ccccc":n=Qo(Ci.Days,Li.Narrow,Wa.Standalone);break;case"cccccc":n=Qo(Ci.Days,Li.Short,Wa.Standalone);break;case"E":case"EE":case"EEE":n=Qo(Ci.Days,Li.Abbreviated);break;case"EEEE":n=Qo(Ci.Days,Li.Wide);break;case"EEEEE":n=Qo(Ci.Days,Li.Narrow);break;case"EEEEEE":n=Qo(Ci.Days,Li.Short);break;case"a":case"aa":case"aaa":n=Qo(Ci.DayPeriods,Li.Abbreviated);break;case"aaaa":n=Qo(Ci.DayPeriods,Li.Wide);break;case"aaaaa":n=Qo(Ci.DayPeriods,Li.Narrow);break;case"b":case"bb":case"bbb":n=Qo(Ci.DayPeriods,Li.Abbreviated,Wa.Standalone,!0);break;case"bbbb":n=Qo(Ci.DayPeriods,Li.Wide,Wa.Standalone,!0);break;case"bbbbb":n=Qo(Ci.DayPeriods,Li.Narrow,Wa.Standalone,!0);break;case"B":case"BB":case"BBB":n=Qo(Ci.DayPeriods,Li.Abbreviated,Wa.Format,!0);break;case"BBBB":n=Qo(Ci.DayPeriods,Li.Wide,Wa.Format,!0);break;case"BBBBB":n=Qo(Ci.DayPeriods,Li.Narrow,Wa.Format,!0);break;case"h":n=cs(Qr.Hours,1,-12);break;case"hh":n=cs(Qr.Hours,2,-12);break;case"H":n=cs(Qr.Hours,1);break;case"HH":n=cs(Qr.Hours,2);break;case"m":n=cs(Qr.Minutes,1);break;case"mm":n=cs(Qr.Minutes,2);break;case"s":n=cs(Qr.Seconds,1);break;case"ss":n=cs(Qr.Seconds,2);break;case"S":n=cs(Qr.FractionalSeconds,1);break;case"SS":n=cs(Qr.FractionalSeconds,2);break;case"SSS":n=cs(Qr.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=by(Es.Short);break;case"ZZZZZ":n=by(Es.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=by(Es.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=by(Es.Long);break;default:return null}return kE[t]=n,n}(f);c+=v?v(i,e,l):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function _y(t,n,e){const r=new Date(0);return r.setFullYear(t,n,e),r.setHours(0,0,0),r}function wh(t,n){const e=function nU(t){return Kl(t)[cr.LocaleId]}(t);if(Cv[e]=Cv[e]||{},Cv[e][n])return Cv[e][n];let r="";switch(n){case"shortDate":r=py(t,ba.Short);break;case"mediumDate":r=py(t,ba.Medium);break;case"longDate":r=py(t,ba.Long);break;case"fullDate":r=py(t,ba.Full);break;case"shortTime":r=my(t,ba.Short);break;case"mediumTime":r=my(t,ba.Medium);break;case"longTime":r=my(t,ba.Long);break;case"fullTime":r=my(t,ba.Full);break;case"short":const i=wh(t,"shortTime"),o=wh(t,"shortDate");r=vy(gy(t,ba.Short),[i,o]);break;case"medium":const a=wh(t,"mediumTime"),s=wh(t,"mediumDate");r=vy(gy(t,ba.Medium),[a,s]);break;case"long":const l=wh(t,"longTime"),c=wh(t,"longDate");r=vy(gy(t,ba.Long),[l,c]);break;case"full":const f=wh(t,"fullTime"),v=wh(t,"fullDate");r=vy(gy(t,ba.Full),[f,v])}return r&&(Cv[e][n]=r),r}function vy(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,r){return null!=n&&r in n?n[r]:e})),t}function bd(t,n,e="-",r,i){let o="";(t<0||i&&t<=0)&&(i?t=1-t:(t=-t,o=e));let a=String(t);for(;a.length<n;)a="0"+a;return r&&(a=a.slice(a.length-n)),o+a}function cs(t,n,e=0,r=!1,i=!1){return function(o,a){let s=function vU(t,n){switch(t){case Qr.FullYear:return n.getFullYear();case Qr.Month:return n.getMonth();case Qr.Date:return n.getDate();case Qr.Hours:return n.getHours();case Qr.Minutes:return n.getMinutes();case Qr.Seconds:return n.getSeconds();case Qr.FractionalSeconds:return n.getMilliseconds();case Qr.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||s>-e)&&(s+=e),t===Qr.Hours)0===s&&-12===e&&(s=12);else if(t===Qr.FractionalSeconds)return function _U(t,n){return bd(t,3).substring(0,n)}(s,n);const l=Nu(a,Yr.MinusSign);return bd(s,n,l,r,i)}}function Qo(t,n,e=Wa.Format,r=!1){return function(i,o){return function bU(t,n,e,r,i,o){switch(e){case Ci.Months:return function oU(t,n,e){const r=Kl(t),o=Ru([r[cr.MonthsFormat],r[cr.MonthsStandalone]],n);return Ru(o,e)}(n,i,r)[t.getMonth()];case Ci.Days:return function iU(t,n,e){const r=Kl(t),o=Ru([r[cr.DaysFormat],r[cr.DaysStandalone]],n);return Ru(o,e)}(n,i,r)[t.getDay()];case Ci.DayPeriods:const a=t.getHours(),s=t.getMinutes();if(o){const c=function cU(t){const n=Kl(t);return M4(n),(n[cr.ExtraData][2]||[]).map(r=>"string"==typeof r?TE(r):[TE(r[0]),TE(r[1])])}(n),f=function uU(t,n,e){const r=Kl(t);M4(r);const o=Ru([r[cr.ExtraData][0],r[cr.ExtraData][1]],n)||[];return Ru(o,e)||[]}(n,i,r),v=c.findIndex(E=>{if(Array.isArray(E)){const[D,k]=E,T=a>=D.hours&&s>=D.minutes,R=a<k.hours||a===k.hours&&s<k.minutes;if(D.hours<k.hours){if(T&&R)return!0}else if(T||R)return!0}else if(E.hours===a&&E.minutes===s)return!0;return!1});if(-1!==v)return f[v]}return function rU(t,n,e){const r=Kl(t),o=Ru([r[cr.DayPeriodsFormat],r[cr.DayPeriodsStandalone]],n);return Ru(o,e)}(n,i,r)[a<12?0:1];case Ci.Eras:return function aU(t,n){return Ru(Kl(t)[cr.Eras],n)}(n,r)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(i,o,t,n,e,r)}}function by(t){return function(n,e,r){const i=-1*r,o=Nu(e,Yr.MinusSign),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(t){case Es.Short:return(i>=0?"+":"")+bd(a,2,o)+bd(Math.abs(i%60),2,o);case Es.ShortGMT:return"GMT"+(i>=0?"+":"")+bd(a,1,o);case Es.Long:return"GMT"+(i>=0?"+":"")+bd(a,2,o)+":"+bd(Math.abs(i%60),2,o);case Es.Extended:return 0===r?"Z":(i>=0?"+":"")+bd(a,2,o)+":"+bd(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}const yU=0,yy=4;function k4(t){return _y(t.getFullYear(),t.getMonth(),t.getDate()+(yy-t.getDay()))}function ME(t,n=!1){return function(e,r){let i;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,a=e.getDate();i=1+Math.floor((a+o)/7)}else{const o=k4(e),a=function wU(t){const n=_y(t,yU,1).getDay();return _y(t,0,1+(n<=yy?yy:yy+7)-n)}(o.getFullYear()),s=o.getTime()-a.getTime();i=1+Math.round(s/6048e5)}return bd(i,t,Nu(r,Yr.MinusSign))}}function wy(t,n=!1){return function(e,r){return bd(k4(e).getFullYear(),t,Nu(r,Yr.MinusSign),n)}}const kE={};function F4(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function I4(t){return t instanceof Date&&!isNaN(t.valueOf())}const AU=/^(\d+)?\.((\d+)(-(\d+))?)?$/,P4=22,xy=".",Ev="0",TU=";",MU=",",FE="#",O4="\xa4";function IE(t,n,e,r,i,o,a=!1){let s="",l=!1;if(isFinite(t)){let c=function NU(t){let r,i,o,a,s,n=Math.abs(t)+"",e=0;for((i=n.indexOf(xy))>-1&&(n=n.replace(xy,"")),(o=n.search(/e/i))>0?(i<0&&(i=o),i+=+n.slice(o+1),n=n.substring(0,o)):i<0&&(i=n.length),o=0;n.charAt(o)===Ev;o++);if(o===(s=n.length))r=[0],i=1;else{for(s--;n.charAt(s)===Ev;)s--;for(i-=o,r=[],a=0;o<=s;o++,a++)r[a]=Number(n.charAt(o))}return i>P4&&(r=r.splice(0,P4-1),e=i-1,i=1),{digits:r,exponent:e,integerLen:i}}(t);a&&(c=function OU(t){if(0===t.digits[0])return t;const n=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(0===n?t.digits.push(0,0):1===n&&t.digits.push(0),t.integerLen+=2),t}(c));let f=n.minInt,v=n.minFrac,E=n.maxFrac;if(o){const Z=o.match(AU);if(null===Z)throw new Error(`${o} is not a valid digit info`);const W=Z[1],Ee=Z[3],Le=Z[5];null!=W&&(f=OE(W)),null!=Ee&&(v=OE(Ee)),null!=Le?E=OE(Le):null!=Ee&&v>E&&(E=v)}!function RU(t,n,e){if(n>e)throw new Error(`The minimum number of digits after fraction (${n}) is higher than the maximum (${e}).`);let r=t.digits,i=r.length-t.integerLen;const o=Math.min(Math.max(n,i),e);let a=o+t.integerLen,s=r[a];if(a>0){r.splice(Math.max(t.integerLen,a));for(let v=a;v<r.length;v++)r[v]=0}else{i=Math.max(0,i),t.integerLen=1,r.length=Math.max(1,a=o+1),r[0]=0;for(let v=1;v<a;v++)r[v]=0}if(s>=5)if(a-1<0){for(let v=0;v>a;v--)r.unshift(0),t.integerLen++;r.unshift(1),t.integerLen++}else r[a-1]++;for(;i<Math.max(0,o);i++)r.push(0);let l=0!==o;const c=n+t.integerLen,f=r.reduceRight(function(v,E,D,k){return k[D]=(E+=v)<10?E:E-10,l&&(0===k[D]&&D>=c?k.pop():l=!1),E>=10?1:0},0);f&&(r.unshift(f),t.integerLen++)}(c,v,E);let D=c.digits,k=c.integerLen;const T=c.exponent;let R=[];for(l=D.every(Z=>!Z);k<f;k++)D.unshift(0);for(;k<0;k++)D.unshift(0);k>0?R=D.splice(k,D.length):(R=D,D=[0]);const q=[];for(D.length>=n.lgSize&&q.unshift(D.splice(-n.lgSize,D.length).join(""));D.length>n.gSize;)q.unshift(D.splice(-n.gSize,D.length).join(""));D.length&&q.unshift(D.join("")),s=q.join(Nu(e,r)),R.length&&(s+=Nu(e,i)+R.join("")),T&&(s+=Nu(e,Yr.Exponential)+"+"+T)}else s=Nu(e,Yr.Infinity);return s=t<0&&!l?n.negPre+s+n.negSuf:n.posPre+s+n.posSuf,s}function PE(t,n="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=t.split(TU),i=r[0],o=r[1],a=-1!==i.indexOf(xy)?i.split(xy):[i.substring(0,i.lastIndexOf(Ev)+1),i.substring(i.lastIndexOf(Ev)+1)],s=a[0],l=a[1]||"";e.posPre=s.substring(0,s.indexOf(FE));for(let f=0;f<l.length;f++){const v=l.charAt(f);v===Ev?e.minFrac=e.maxFrac=f+1:v===FE?e.maxFrac=f+1:e.posSuf+=v}const c=s.split(MU);if(e.gSize=c[1]?c[1].length:0,e.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,o){const f=i.length-e.posPre.length-e.posSuf.length,v=o.indexOf(FE);e.negPre=o.substring(0,v).replace(/'/g,""),e.negSuf=o.slice(v+f).replace(/'/g,"")}else e.negPre=n+e.posPre,e.negSuf=e.posSuf;return e}function OE(t){const n=parseInt(t);if(isNaN(n))throw new Error("Invalid integer literal when parsing "+t);return n}function R4(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const r=e.indexOf("="),[i,o]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(i.trim()===n)return decodeURIComponent(o)}return null}const RE=/\s+/,L4=[];let wf=(()=>{class t{constructor(e,r,i,o){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=i,this._renderer=o,this.initialClasses=L4,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(RE):L4}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(RE):e}ngDoCheck(){for(const r of this.initialClasses)this._updateState(r,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const r of e)this._updateState(r,!0);else if(null!=e)for(const r of Object.keys(e))this._updateState(r,Boolean(e[r]));this._applyStateDiff()}_updateState(e,r){const i=this.stateMap.get(e);void 0!==i?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(e,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const r=e[0],i=e[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(e,r){(e=e.trim()).length>0&&e.split(RE).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}}return t.\u0275fac=function(e){return new(e||t)(X(hy),X(wv),X($r),X(hh))},t.\u0275dir=jn({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),t})();class jU{constructor(n,e,r,i){this.$implicit=n,this.ngForOf=e,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ho=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,r,i){this._viewContainer=e,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((i,o,a)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new jU(i.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)r.remove(null===o?void 0:o);else if(null!==o){const s=r.get(o);r.move(s,a),V4(s,i)}});for(let i=0,o=r.length;i<o;i++){const s=r.get(i).context;s.index=i,s.count=o,s.ngForOf=this._ngForOf}e.forEachIdentityChange(i=>{V4(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(e,r){return!0}}return t.\u0275fac=function(e){return new(e||t)(X(Ml),X(Zl),X(hy))},t.\u0275dir=jn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function V4(t,n){t.context.$implicit=n.item}let Fi=(()=>{class t{constructor(e,r){this._viewContainer=e,this._context=new UU,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){U4("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){U4("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return t.\u0275fac=function(e){return new(e||t)(X(Ml),X(Zl))},t.\u0275dir=jn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class UU{constructor(){this.$implicit=null,this.ngIf=null}}function U4(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${to(n)}'.`)}class LE{constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Cy=(()=>{class t{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const r=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||r,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),r}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const r of this._defaultViews)r.enforceState(e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),t})(),H4=(()=>{class t{constructor(e,r,i){this.ngSwitch=i,i._addCase(),this._view=new LE(e,r)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(X(Ml),X(Zl),X(Cy,9))},t.\u0275dir=jn({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),t})(),Jo=(()=>{class t{constructor(e,r,i){this._ngEl=e,this._differs=r,this._renderer=i,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,r){const[i,o]=e.split("."),a=-1===i.indexOf("-")?void 0:Ls.DashCase;null!=r?this._renderer.setStyle(this._ngEl.nativeElement,i,o?`${r}${o}`:r,a):this._renderer.removeStyle(this._ngEl.nativeElement,i,a)}_applyChanges(e){e.forEachRemovedItem(r=>this._setStyle(r.key,null)),e.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),e.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(wv),X(hh))},t.\u0275dir=jn({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),t})();function yd(t,n){return new Vt(2100,!1)}const KU=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g;let $4=(()=>{class t{transform(e){if(null==e)return null;if("string"!=typeof e)throw yd();return e.replace(KU,r=>r[0].toUpperCase()+r.slice(1).toLowerCase())}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=Eo({name:"titlecase",type:t,pure:!0,standalone:!0}),t})(),BE=(()=>{class t{transform(e){if(null==e)return null;if("string"!=typeof e)throw yd();return e.toUpperCase()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=Eo({name:"uppercase",type:t,pure:!0,standalone:!0}),t})();const QU=new U("DATE_PIPE_DEFAULT_TIMEZONE"),JU=new U("DATE_PIPE_DEFAULT_OPTIONS");let Sc=(()=>{class t{constructor(e,r,i){this.locale=e,this.defaultTimezone=r,this.defaultOptions=i}transform(e,r,i,o){if(null==e||""===e||e!=e)return null;try{return gU(e,r??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,i??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(a){throw yd()}}}return t.\u0275fac=function(e){return new(e||t)(X(yf,16),X(QU,24),X(JU,24))},t.\u0275pipe=Eo({name:"date",type:t,pure:!0,standalone:!0}),t})(),jE=(()=>{class t{constructor(e){this._locale=e}transform(e,r,i){if(!VE(e))return null;i=i||this._locale;try{return function PU(t,n,e){return IE(t,PE(AE(n,Ec.Decimal),Nu(n,Yr.MinusSign)),n,Yr.Group,Yr.Decimal,e)}(UE(e),i,r)}catch(o){throw yd()}}}return t.\u0275fac=function(e){return new(e||t)(X(yf,16))},t.\u0275pipe=Eo({name:"number",type:t,pure:!0,standalone:!0}),t})(),Ey=(()=>{class t{constructor(e,r="USD"){this._locale=e,this._defaultCurrencyCode=r}transform(e,r=this._defaultCurrencyCode,i="symbol",o,a){if(!VE(e))return null;a=a||this._locale,"boolean"==typeof i&&(i=i?"symbol":"code");let s=r||this._defaultCurrencyCode;"code"!==i&&(s="symbol"===i||"symbol-narrow"===i?function dU(t,n,e="en"){const r=function sU(t){return Kl(t)[cr.Currencies]}(e)[t]||T4[t]||[],i=r[1];return"narrow"===n&&"string"==typeof i?i:r[0]||t}(s,"symbol"===i?"wide":"narrow",a):i);try{return function FU(t,n,e,r,i){const a=PE(AE(n,Ec.Currency),Nu(n,Yr.MinusSign));return a.minFrac=function hU(t){let n;const e=T4[t];return e&&(n=e[2]),"number"==typeof n?n:fU}(r),a.maxFrac=a.minFrac,IE(t,a,n,Yr.CurrencyGroup,Yr.CurrencyDecimal,i).replace(O4,e).replace(O4,"").trim()}(UE(e),a,s,r,o)}catch(l){throw yd()}}}return t.\u0275fac=function(e){return new(e||t)(X(yf,16),X(fV,16))},t.\u0275pipe=Eo({name:"currency",type:t,pure:!0,standalone:!0}),t})();function VE(t){return!(null==t||""===t||t!=t)}function UE(t){if("string"==typeof t&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if("number"!=typeof t)throw new Error(`${t} is not a number`);return t}let xf=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({}),t})();const q4="browser";let dH=(()=>{class t{}return t.\u0275prov=Gt({token:t,providedIn:"root",factory:()=>new fH(it(si),window)}),t})();class fH{constructor(n,e){this.document=n,this.window=e,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const e=function hH(t,n){const e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const o=i.shadowRoot;if(o){const a=o.getElementById(n)||o.querySelector(`[name="${n}"]`);if(a)return a}i=r.nextNode()}}return null}(this.document,n);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(n){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=n)}}scrollToElement(n){const e=n.getBoundingClientRect(),r=e.left+this.window.pageXOffset,i=e.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const n=G4(this.window.history)||G4(Object.getPrototypeOf(this.window.history));return!(!n||!n.writable&&!n.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function G4(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class Y4{}class VH extends YV{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class $E extends VH{static makeCurrent(){!function GV(t){EE||(EE=t)}(new $E)}onAndCancel(n,e,r){return n.addEventListener(e,r,!1),()=>{n.removeEventListener(e,r,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function UH(){return Dv=Dv||document.querySelector("base"),Dv?Dv.getAttribute("href"):null}();return null==e?null:function HH(t){Ay=Ay||document.createElement("a"),Ay.setAttribute("href",t);const n=Ay.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){Dv=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return R4(document.cookie,n)}}let Ay,Dv=null;const J4=new U("TRANSITION_ID"),$H=[{provide:bv,useFactory:function zH(t,n,e){return()=>{e.get(sy).donePromise.then(()=>{const r=bh(),i=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<i.length;o++)r.remove(i[o])})}},deps:[J4,si,js],multi:!0}];let qH=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();const Ty=new U("EventManagerPlugins");let My=(()=>{class t{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(i=>{i.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,r,i){return this._findPluginFor(r).addEventListener(e,r,i)}addGlobalEventListener(e,r,i){return this._findPluginFor(r).addGlobalEventListener(e,r,i)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const i=this._plugins;for(let o=0;o<i.length;o++){const a=i[o];if(a.supports(e))return this._eventNameToPlugin.set(e,a),a}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(it(Ty),it(Wr))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();class ek{constructor(n){this._doc=n}addGlobalEventListener(n,e,r){const i=bh().getGlobalEventTarget(this._doc,n);if(!i)throw new Error(`Unsupported event target ${i} for event ${e}`);return this.addEventListener(i,e,r)}}let tk=(()=>{class t{constructor(){this.usageCount=new Map}addStyles(e){for(const r of e)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(e){for(const r of e)0===this.changeUsageCount(r,-1)&&this.onStyleRemoved(r)}onStyleRemoved(e){}onStyleAdded(e){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(e,r){const i=this.usageCount;let o=i.get(e)??0;return o+=r,o>0?i.set(e,o):i.delete(e),o}ngOnDestroy(){for(const e of this.getAllStyles())this.onStyleRemoved(e);this.usageCount.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})(),Av=(()=>{class t extends tk{constructor(e){super(),this.doc=e,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(e){for(const r of this.hostNodes)this.addStyleToHost(r,e)}onStyleRemoved(e){const r=this.styleRef;r.get(e)?.forEach(o=>o.remove()),r.delete(e)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const r of this.getAllStyles())this.addStyleToHost(e,r)}removeHost(e){this.hostNodes.delete(e)}addStyleToHost(e,r){const i=this.doc.createElement("style");i.textContent=r,e.appendChild(i);const o=this.styleRef.get(r);o?o.push(i):this.styleRef.set(r,[i])}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return t.\u0275fac=function(e){return new(e||t)(it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();const WE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},qE=/%COMP%/g,ik=new U("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function ok(t,n){return n.flat(100).map(e=>e.replace(qE,t))}function ak(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let ky=(()=>{class t{constructor(e,r,i,o){this.eventManager=e,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestory=o,this.rendererByCompId=new Map,this.defaultRenderer=new GE(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;const i=this.getOrCreateRenderer(e,r);return i instanceof ck?i.applyToHost(e):i instanceof YE&&i.applyStyles(),i}getOrCreateRenderer(e,r){const i=this.rendererByCompId;let o=i.get(r.id);if(!o){const a=this.eventManager,s=this.sharedStylesHost,l=this.removeStylesOnCompDestory;switch(r.encapsulation){case bl.Emulated:o=new ck(a,s,r,this.appId,l);break;case bl.ShadowDom:return new JH(a,s,e,r);default:o=new YE(a,s,r,l)}o.onDestroy=()=>i.delete(r.id),i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(it(My),it(Av),it(yv),it(ik))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();class GE{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(WE[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){(lk(n)?n.content:n).appendChild(e)}insertBefore(n,e,r){n&&(lk(n)?n.content:n).insertBefore(e,r)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let r="string"==typeof n?document.querySelector(n):n;if(!r)throw new Error(`The selector "${n}" did not match any elements`);return e||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,r,i){if(i){e=i+":"+e;const o=WE[i];o?n.setAttributeNS(o,e,r):n.setAttribute(e,r)}else n.setAttribute(e,r)}removeAttribute(n,e,r){if(r){const i=WE[r];i?n.removeAttributeNS(i,e):n.removeAttribute(`${r}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,r,i){i&(Ls.DashCase|Ls.Important)?n.style.setProperty(e,r,i&Ls.Important?"important":""):n.style[e]=r}removeStyle(n,e,r){r&Ls.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,r){n[e]=r}setValue(n,e){n.nodeValue=e}listen(n,e,r){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,ak(r)):this.eventManager.addEventListener(n,e,ak(r))}}function lk(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class JH extends GE{constructor(n,e,r,i){super(n),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=ok(i.id,i.styles);for(const a of o){const s=document.createElement("style");s.textContent=a,this.shadowRoot.appendChild(s)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,r){return super.insertBefore(this.nodeOrShadowRoot(n),e,r)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class YE extends GE{constructor(n,e,r,i,o=r.id){super(n),this.sharedStylesHost=e,this.removeStylesOnCompDestory=i,this.rendererUsageCount=0,this.styles=ok(o,r.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class ck extends YE{constructor(n,e,r,i,o){const a=i+"-"+r.id;super(n,e,r,o,a),this.contentAttr=function KH(t){return"_ngcontent-%COMP%".replace(qE,t)}(a),this.hostAttr=function ZH(t){return"_nghost-%COMP%".replace(qE,t)}(a)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const r=super.createElement(n,e);return super.setAttribute(r,this.contentAttr,""),r}}let ez=(()=>{class t extends ek{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,i){return e.addEventListener(r,i,!1),()=>this.removeEventListener(e,r,i)}removeEventListener(e,r,i){return e.removeEventListener(r,i)}}return t.\u0275fac=function(e){return new(e||t)(it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();const uk=["alt","control","meta","shift"],tz={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},nz={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let rz=(()=>{class t extends ek{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,r,i){const o=t.parseEventName(r),a=t.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>bh().onAndCancel(e,o.domEventName,a))}static parseEventName(e){const r=e.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=t._normalizeKey(r.pop());let a="",s=r.indexOf("code");if(s>-1&&(r.splice(s,1),a="code."),uk.forEach(c=>{const f=r.indexOf(c);f>-1&&(r.splice(f,1),a+=c+".")}),a+=o,0!=r.length||0===o.length)return null;const l={};return l.domEventName=i,l.fullKey=a,l}static matchEventFullKeyCode(e,r){let i=tz[e.key]||e.key,o="";return r.indexOf("code.")>-1&&(i=e.code,o="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),uk.forEach(a=>{a!==i&&(0,nz[a])(e)&&(o+=a+".")}),o+=i,o===r)}static eventCallback(e,r,i){return o=>{t.matchEventFullKeyCode(o,e)&&i.runGuarded(()=>r(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();const sz=o4($V,"browser",[{provide:ly,useValue:q4},{provide:GM,useValue:function iz(){$E.makeCurrent()},multi:!0},{provide:si,useFactory:function az(){return function ka(t){Bs=t}(document),document},deps:[]}]),hk=new U(""),pk=[{provide:cy,useClass:class WH{addToWindow(n){Vi.getAngularTestability=(r,i=!0)=>{const o=n.findTestabilityInTree(r,i);if(null==o)throw new Error("Could not find testability for element.");return o},Vi.getAllAngularTestabilities=()=>n.getAllTestabilities(),Vi.getAllAngularRootElements=()=>n.getAllRootElements(),Vi.frameworkStabilizers||(Vi.frameworkStabilizers=[]),Vi.frameworkStabilizers.push(r=>{const i=Vi.getAllAngularTestabilities();let o=i.length,a=!1;const s=function(l){a=a||l,o--,0==o&&r(a)};i.forEach(function(l){l.whenStable(s)})})}findTestabilityInTree(n,e,r){return null==e?null:n.getTestability(e)??(r?bh().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:JM,useClass:mE,deps:[Wr,gE,cy]},{provide:mE,useClass:mE,deps:[Wr,gE,cy]}],mk=[{provide:dC,useValue:"root"},{provide:ph,useFactory:function oz(){return new ph},deps:[]},{provide:Ty,useClass:ez,multi:!0,deps:[si,Wr,ly]},{provide:Ty,useClass:rz,multi:!0,deps:[si]},{provide:ky,useClass:ky,deps:[My,Av,yv,ik]},{provide:nv,useExisting:ky},{provide:tk,useExisting:Av},{provide:Av,useClass:Av,deps:[si]},{provide:My,useClass:My,deps:[Ty,Wr]},{provide:Y4,useClass:qH,deps:[]},[]];let gk=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:yv,useValue:e.appId},{provide:J4,useExisting:yv},$H]}}}return t.\u0275fac=function(e){return new(e||t)(it(hk,12))},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:[...mk,...pk],imports:[xf,WV]}),t})(),_k=(()=>{class t{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return t.\u0275fac=function(e){return new(e||t)(it(si))},t.\u0275prov=Gt({token:t,factory:function(e){let r=null;return r=e?new e:function cz(){return new _k(it(si))}(),r},providedIn:"root"}),t})();typeof window<"u"&&window;let ZE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:function(e){let r=null;return r=e?new(e||t):it(yk),r},providedIn:"root"}),t})(),yk=(()=>{class t extends ZE{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case Ji.NONE:return r;case Ji.HTML:return xs(r,"HTML")?ss(r):X_(this._doc,String(r)).toString();case Ji.STYLE:return xs(r,"Style")?ss(r):r;case Ji.SCRIPT:if(xs(r,"Script"))return ss(r);throw new Error("unsafe value used in a script context");case Ji.URL:return xs(r,"URL")?ss(r):fh(String(r));case Ji.RESOURCE_URL:if(xs(r,"ResourceURL"))return ss(r);throw new Error(`unsafe value used in a resource URL context (see ${Xh})`);default:throw new Error(`Unexpected SecurityContext ${e} (see ${Xh})`)}}bypassSecurityTrustHtml(e){return function q_(t){return new wc(t)}(e)}bypassSecurityTrustStyle(e){return function F2(t){return new ku(t)}(e)}bypassSecurityTrustScript(e){return function I2(t){return new as(t)}(e)}bypassSecurityTrustUrl(e){return function n1(t){return new pd(t)}(e)}bypassSecurityTrustResourceUrl(e){return function fg(t){return new dh(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(it(si))},t.\u0275prov=Gt({token:t,factory:function(e){let r=null;return r=e?new e:function pz(t){return new yk(t.get(si))}(it(js)),r},providedIn:"root"}),t})();function On(...t){return Br(t,_u(t))}function xh(t,n){return zn(n)?ko(t,n,1):ko(t,1)}function _o(t,n){return wn((e,r)=>{let i=0;e.subscribe(Rr(r,o=>t.call(n,o,i++)&&r.next(o)))})}class Fy{}class QE{}class Ch{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?this.lazyInit="string"==typeof n?()=>{this.headers=new Map,n.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const i=e.slice(0,r),o=i.toLowerCase(),a=e.slice(r+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(a):this.headers.set(o,[a])}})}:()=>{this.headers=new Map,Object.entries(n).forEach(([e,r])=>{let i;if(i="string"==typeof r?[r]:"number"==typeof r?[r.toString()]:r.map(o=>o.toString()),i.length>0){const o=e.toLowerCase();this.headers.set(o,i),this.maybeSetNormalizedName(e,o)}})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof Ch?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){const e=new Ch;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Ch?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){const e=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(n.name,e);const i=("a"===n.op?this.headers.get(e):void 0)||[];i.push(...r),this.headers.set(e,i);break;case"d":const o=n.value;if(o){let a=this.headers.get(e);if(!a)return;a=a.filter(s=>-1===o.indexOf(s)),0===a.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,a)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}}class mz{encodeKey(n){return wk(n)}encodeValue(n){return wk(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const _z=/%(\d[a-f0-9])/gi,vz={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function wk(t){return encodeURIComponent(t).replace(_z,(n,e)=>vz[e]??n)}function Iy(t){return`${t}`}class Pn{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new mz,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function gz(t,n){const e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[a,s]=-1==o?[n.decodeKey(i),""]:[n.decodeKey(i.slice(0,o)),n.decodeValue(i.slice(o+1))],l=e.get(a)||[];l.push(s),e.set(a,l)}),e}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{const r=n.fromObject[e],i=Array.isArray(r)?r.map(Iy):[Iy(r)];this.map.set(e,i)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){const e=[];return Object.keys(n).forEach(r=>{const i=n[r];Array.isArray(i)?i.forEach(o=>{e.push({param:r,value:o,op:"a"})}):e.push({param:r,value:i,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const e=this.encoder.encodeKey(n);return this.map.get(n).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const e=new Pn({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const e=("a"===n.op?this.map.get(n.param):void 0)||[];e.push(Iy(n.value)),this.map.set(n.param,e);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let r=this.map.get(n.param)||[];const i=r.indexOf(Iy(n.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class bz{constructor(){this.map=new Map}set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function xk(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function Ck(t){return typeof Blob<"u"&&t instanceof Blob}function Ek(t){return typeof FormData<"u"&&t instanceof FormData}class Tv{constructor(n,e,r,i){let o;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function yz(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new Ch),this.context||(this.context=new bz),this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=e;else{const s=e.indexOf("?");this.urlWithParams=e+(-1===s?"?":s<e.length-1?"&":"")+a}}else this.params=new Pn,this.urlWithParams=e}serializeBody(){return null===this.body?null:xk(this.body)||Ck(this.body)||Ek(this.body)||function wz(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Pn?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Ek(this.body)?null:Ck(this.body)?this.body.type||null:xk(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Pn?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const e=n.method||this.method,r=n.url||this.url,i=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,a=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,s=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let l=n.headers||this.headers,c=n.params||this.params;const f=n.context??this.context;return void 0!==n.setHeaders&&(l=Object.keys(n.setHeaders).reduce((v,E)=>v.set(E,n.setHeaders[E]),l)),n.setParams&&(c=Object.keys(n.setParams).reduce((v,E)=>v.set(E,n.setParams[E]),c)),new Tv(e,r,o,{params:c,headers:l,context:f,reportProgress:s,responseType:i,withCredentials:a})}}var us=(()=>((us=us||{})[us.Sent=0]="Sent",us[us.UploadProgress=1]="UploadProgress",us[us.ResponseHeader=2]="ResponseHeader",us[us.DownloadProgress=3]="DownloadProgress",us[us.Response=4]="Response",us[us.User=5]="User",us))();class JE{constructor(n,e=200,r="OK"){this.headers=n.headers||new Ch,this.status=void 0!==n.status?n.status:e,this.statusText=n.statusText||r,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class e5 extends JE{constructor(n={}){super(n),this.type=us.ResponseHeader}clone(n={}){return new e5({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Py extends JE{constructor(n={}){super(n),this.type=us.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new Py({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Sk extends JE{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function t5(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Fl=(()=>{class t{constructor(e){this.handler=e}request(e,r,i={}){let o;if(e instanceof Tv)o=e;else{let l,c;l=i.headers instanceof Ch?i.headers:new Ch(i.headers),i.params&&(c=i.params instanceof Pn?i.params:new Pn({fromObject:i.params})),o=new Tv(e,r,void 0!==i.body?i.body:null,{headers:l,context:i.context,params:c,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const a=On(o).pipe(xh(l=>this.handler.handle(l)));if(e instanceof Tv||"events"===i.observe)return a;const s=a.pipe(_o(l=>l instanceof Py));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return s.pipe(gr(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return s.pipe(gr(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return s.pipe(gr(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return s.pipe(gr(l=>l.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new Pn).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,i={}){return this.request("PATCH",e,t5(i,r))}post(e,r,i={}){return this.request("POST",e,t5(i,r))}put(e,r,i={}){return this.request("PUT",e,t5(i,r))}}return t.\u0275fac=function(e){return new(e||t)(it(Fy))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();function Dk(t,n){return n(t)}function xz(t,n){return(e,r)=>n.intercept(e,{handle:i=>t(i,r)})}const Ez=new U("HTTP_INTERCEPTORS"),Mv=new U("HTTP_INTERCEPTOR_FNS");function Sz(){let t=null;return(n,e)=>(null===t&&(t=(Xr(Ez,{optional:!0})??[]).reduceRight(xz,Dk)),t(n,e))}let Ak=(()=>{class t extends Fy{constructor(e,r){super(),this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=Array.from(new Set(this.injector.get(Mv)));this.chain=r.reduceRight((i,o)=>function Cz(t,n,e){return(r,i)=>e.runInContext(()=>n(r,o=>t(o,i)))}(i,o,this.injector),Dk)}return this.chain(e,r=>this.backend.handle(r))}}return t.\u0275fac=function(e){return new(e||t)(it(QE),it(mf))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();const Mz=/^\)\]\}',?\n/;let Mk=(()=>{class t{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Ht(r=>{const i=this.xhrFactory.build();if(i.open(e.method,e.urlWithParams),e.withCredentials&&(i.withCredentials=!0),e.headers.forEach((D,k)=>i.setRequestHeader(D,k.join(","))),e.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const D=e.detectContentTypeHeader();null!==D&&i.setRequestHeader("Content-Type",D)}if(e.responseType){const D=e.responseType.toLowerCase();i.responseType="json"!==D?D:"text"}const o=e.serializeBody();let a=null;const s=()=>{if(null!==a)return a;const D=i.statusText||"OK",k=new Ch(i.getAllResponseHeaders()),T=function kz(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(i)||e.url;return a=new e5({headers:k,status:i.status,statusText:D,url:T}),a},l=()=>{let{headers:D,status:k,statusText:T,url:R}=s(),q=null;204!==k&&(q=typeof i.response>"u"?i.responseText:i.response),0===k&&(k=q?200:0);let Z=k>=200&&k<300;if("json"===e.responseType&&"string"==typeof q){const W=q;q=q.replace(Mz,"");try{q=""!==q?JSON.parse(q):null}catch(Ee){q=W,Z&&(Z=!1,q={error:Ee,text:q})}}Z?(r.next(new Py({body:q,headers:D,status:k,statusText:T,url:R||void 0})),r.complete()):r.error(new Sk({error:q,headers:D,status:k,statusText:T,url:R||void 0}))},c=D=>{const{url:k}=s(),T=new Sk({error:D,status:i.status||0,statusText:i.statusText||"Unknown Error",url:k||void 0});r.error(T)};let f=!1;const v=D=>{f||(r.next(s()),f=!0);let k={type:us.DownloadProgress,loaded:D.loaded};D.lengthComputable&&(k.total=D.total),"text"===e.responseType&&i.responseText&&(k.partialText=i.responseText),r.next(k)},E=D=>{let k={type:us.UploadProgress,loaded:D.loaded};D.lengthComputable&&(k.total=D.total),r.next(k)};return i.addEventListener("load",l),i.addEventListener("error",c),i.addEventListener("timeout",c),i.addEventListener("abort",c),e.reportProgress&&(i.addEventListener("progress",v),null!==o&&i.upload&&i.upload.addEventListener("progress",E)),i.send(o),r.next({type:us.Sent}),()=>{i.removeEventListener("error",c),i.removeEventListener("abort",c),i.removeEventListener("load",l),i.removeEventListener("timeout",c),e.reportProgress&&(i.removeEventListener("progress",v),null!==o&&i.upload&&i.upload.removeEventListener("progress",E)),i.readyState!==i.DONE&&i.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(it(Y4))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();const n5=new U("XSRF_ENABLED"),kk=new U("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Fk=new U("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Ik{}let Pz=(()=>{class t{constructor(e,r,i){this.doc=e,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=R4(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(it(si),it(ly),it(kk))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();function Oz(t,n){const e=t.url.toLowerCase();if(!Xr(n5)||"GET"===t.method||"HEAD"===t.method||e.startsWith("http://")||e.startsWith("https://"))return n(t);const r=Xr(Ik).getToken(),i=Xr(Fk);return null!=r&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,r)})),n(t)}var Ga=(()=>((Ga=Ga||{})[Ga.Interceptors=0]="Interceptors",Ga[Ga.LegacyInterceptors=1]="LegacyInterceptors",Ga[Ga.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",Ga[Ga.NoXsrfProtection=3]="NoXsrfProtection",Ga[Ga.JsonpSupport=4]="JsonpSupport",Ga[Ga.RequestsMadeViaParent=5]="RequestsMadeViaParent",Ga))();function L1(t,n){return{\u0275kind:t,\u0275providers:n}}function Nz(...t){const n=[Fl,Mk,Ak,{provide:Fy,useExisting:Ak},{provide:QE,useExisting:Mk},{provide:Mv,useValue:Oz,multi:!0},{provide:n5,useValue:!0},{provide:Ik,useClass:Pz}];for(const e of t)n.push(...e.\u0275providers);return function hf(t){return{\u0275providers:t}}(n)}const Pk=new U("LEGACY_INTERCEPTOR_FN");let Lz=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:[Nz(L1(Ga.LegacyInterceptors,[{provide:Pk,useFactory:Sz},{provide:Mv,useExisting:Pk,multi:!0}]))]}),t})();const{isArray:Bz}=Array,{getPrototypeOf:jz,prototype:Vz,keys:Uz}=Object;function Ok(t){if(1===t.length){const n=t[0];if(Bz(n))return{args:n,keys:null};if(function Hz(t){return t&&"object"==typeof t&&jz(t)===Vz}(n)){const e=Uz(n);return{args:e.map(r=>n[r]),keys:e}}}return{args:t,keys:null}}const{isArray:zz}=Array;function r5(t){return gr(n=>function $z(t,n){return zz(n)?t(...n):t(n)}(t,n))}function Nk(t,n){return t.reduce((e,r,i)=>(e[r]=n[i],e),{})}function Rk(...t){const n=b0(t),{args:e,keys:r}=Ok(t),i=new Ht(o=>{const{length:a}=e;if(!a)return void o.complete();const s=new Array(a);let l=a,c=a;for(let f=0;f<a;f++){let v=!1;ja(e[f]).subscribe(Rr(o,E=>{v||(v=!0,c--),s[f]=E},()=>l--,void 0,()=>{(!l||!v)&&(c||o.next(r?Nk(r,s):s),o.complete())}))}});return n?i.pipe(r5(n)):i}let Lk=(()=>{class t{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(X(hh),X($r))},t.\u0275dir=jn({type:t}),t})(),Sg=(()=>{class t extends Lk{}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,features:[_r]}),t})();const Gc=new U("NgValueAccessor"),Wz={provide:Gc,useExisting:Ir(()=>sl),multi:!0};let sl=(()=>{class t extends Sg{writeValue(e){this.setProperty("checked",e)}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,r){1&e&&De("change",function(o){return r.onChange(o.target.checked)})("blur",function(){return r.onTouched()})},features:[ki([Wz]),_r]}),t})();const qz={provide:Gc,useExisting:Ir(()=>vo),multi:!0},Yz=new U("CompositionEventMode");let vo=(()=>{class t extends Lk{constructor(e,r,i){super(e,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Gz(){const t=bh()?bh().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(X(hh),X($r),X(Yz,8))},t.\u0275dir=jn({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&De("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[ki([qz]),_r]}),t})();const Xz=!1;function Wp(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function Bk(t){return null!=t&&"number"==typeof t.length}const ll=new U("NgValidators"),qp=new U("NgAsyncValidators"),Kz=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Zn{static min(n){return function jk(t){return n=>{if(Wp(n.value)||Wp(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(n)}static max(n){return function Vk(t){return n=>{if(Wp(n.value)||Wp(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(n)}static required(n){return Uk(n)}static requiredTrue(n){return function Hk(t){return!0===t.value?null:{required:!0}}(n)}static email(n){return function zk(t){return Wp(t.value)||Kz.test(t.value)?null:{email:!0}}(n)}static minLength(n){return function $k(t){return n=>Wp(n.value)||!Bk(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(n)}static maxLength(n){return Wk(n)}static pattern(n){return function qk(t){if(!t)return Oy;let n,e;return"string"==typeof t?(e="","^"!==t.charAt(0)&&(e+="^"),e+=t,"$"!==t.charAt(t.length-1)&&(e+="$"),n=new RegExp(e)):(e=t.toString(),n=t),r=>{if(Wp(r.value))return null;const i=r.value;return n.test(i)?null:{pattern:{requiredPattern:e,actualValue:i}}}}(n)}static nullValidator(n){return null}static compose(n){return Qk(n)}static composeAsync(n){return Jk(n)}}function Uk(t){return Wp(t.value)?{required:!0}:null}function Wk(t){return n=>Bk(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}function Oy(t){return null}function Gk(t){return null!=t}function Yk(t){const n=sv(t)?Br(t):t;if(Xz&&!LC(n)){let e="Expected async validator to return Promise or Observable.";throw"object"==typeof t&&(e+=" Are you using a synchronous validator where an async validator is expected?"),new Vt(-1101,e)}return n}function Xk(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function Kk(t,n){return n.map(e=>e(t))}function Zk(t){return t.map(n=>function Zz(t){return!t.validate}(n)?n:e=>n.validate(e))}function Qk(t){if(!t)return null;const n=t.filter(Gk);return 0==n.length?null:function(e){return Xk(Kk(e,n))}}function o5(t){return null!=t?Qk(Zk(t)):null}function Jk(t){if(!t)return null;const n=t.filter(Gk);return 0==n.length?null:function(e){return Rk(Kk(e,n).map(Yk)).pipe(gr(Xk))}}function a5(t){return null!=t?Jk(Zk(t)):null}function eF(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function tF(t){return t._rawValidators}function nF(t){return t._rawAsyncValidators}function s5(t){return t?Array.isArray(t)?t:[t]:[]}function Ny(t,n){return Array.isArray(t)?t.includes(n):t===n}function rF(t,n){const e=s5(n);return s5(t).forEach(i=>{Ny(e,i)||e.push(i)}),e}function iF(t,n){return s5(n).filter(e=>!Ny(t,e))}class oF{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=o5(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=a5(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Jl extends oF{get formDirective(){return null}get path(){return null}}class Eh extends oF{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class aF{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let No=(()=>{class t extends aF{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(X(Eh,2))},t.\u0275dir=jn({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&Ai("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[_r]}),t})(),zo=(()=>{class t extends aF{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(X(Jl,10))},t.\u0275dir=jn({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&Ai("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[_r]}),t})();function sF(t,n){return t?`with name: '${n}'`:`at index: ${n}`}const u5=!1,kv="VALID",Ly="INVALID",B1="PENDING",Fv="DISABLED";function d5(t){return(By(t)?t.validators:t)||null}function f5(t,n){return(By(n)?n.asyncValidators:t)||null}function By(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}function lF(t,n,e){const r=t.controls;if(!(n?Object.keys(r):r).length)throw new Vt(1e3,u5?function t$(t){return`\n    There are no form controls registered with this ${t?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(n):"");if(!r[e])throw new Vt(1001,u5?function n$(t,n){return`Cannot find form control ${sF(t,n)}`}(n,e):"")}function cF(t,n,e){t._forEachChild((r,i)=>{if(void 0===e[i])throw new Vt(1002,u5?function r$(t,n){return`Must supply a value for form control ${sF(t,n)}`}(n,i):"")})}class jy{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===kv}get invalid(){return this.status===Ly}get pending(){return this.status==B1}get disabled(){return this.status===Fv}get enabled(){return this.status!==Fv}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(rF(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(rF(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(iF(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(iF(n,this._rawAsyncValidators))}hasValidator(n){return Ny(this._rawValidators,n)}hasAsyncValidator(n){return Ny(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=B1,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Fv,this.errors=null,this._forEachChild(r=>{r.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=kv,this._forEachChild(r=>{r.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===kv||this.status===B1)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fv:kv}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=B1,this._hasOwnPendingAsyncValidator=!0;const e=Yk(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,i)=>r&&r._find(i),this)}getError(n,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Vr,this.statusChanges=new Vr}_calculateStatus(){return this._allControlsDisabled()?Fv:this.errors?Ly:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(B1)?B1:this._anyControlsHaveStatus(Ly)?Ly:kv}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){By(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function i$(t){return Array.isArray(t)?o5(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function o$(t){return Array.isArray(t)?a5(t):t||null}(this._rawAsyncValidators)}}class Iv extends jy{constructor(n,e,r){super(d5(e),f5(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,r={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){cF(this,!0,n),Object.keys(n).forEach(r=>{lF(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(r=>{const i=this.controls[r];i&&i.patchValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((r,i)=>{r.reset(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,r)=>(n[r]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&n(r,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&n(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,i)=>((r.enabled||this.disabled)&&(e[i]=r.value),e))}_reduceChildren(n,e){let r=n;return this._forEachChild((i,o)=>{r=e(r,i,o)}),r}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class uF extends Iv{}const Dg=new U("CallSetDisabledState",{providedIn:"root",factory:()=>Pv}),Pv="always";function Vy(t,n){return[...n.path,t]}function Ov(t,n,e=Pv){h5(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function s$(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&dF(t,n)})}(t,n),function c$(t,n){const e=(r,i)=>{n.valueAccessor.writeValue(r),i&&n.viewToModelUpdate(r)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function l$(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&dF(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function a$(t,n){if(n.valueAccessor.setDisabledState){const e=r=>{n.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function Uy(t,n,e=!0){const r=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(r),n.valueAccessor.registerOnTouched(r)),zy(t,n),t&&(n._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Hy(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function h5(t,n){const e=tF(t);null!==n.validator?t.setValidators(eF(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const r=nF(t);null!==n.asyncValidator?t.setAsyncValidators(eF(r,n.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();Hy(n._rawValidators,i),Hy(n._rawAsyncValidators,i)}function zy(t,n){let e=!1;if(null!==t){if(null!==n.validator){const i=tF(t);if(Array.isArray(i)&&i.length>0){const o=i.filter(a=>a!==n.validator);o.length!==i.length&&(e=!0,t.setValidators(o))}}if(null!==n.asyncValidator){const i=nF(t);if(Array.isArray(i)&&i.length>0){const o=i.filter(a=>a!==n.asyncValidator);o.length!==i.length&&(e=!0,t.setAsyncValidators(o))}}}const r=()=>{};return Hy(n._rawValidators,r),Hy(n._rawAsyncValidators,r),e}function dF(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function fF(t,n){h5(t,n)}function m5(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}function hF(t,n){t._syncPendingControls(),n.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function g5(t,n){if(!n)return null;let e,r,i;return Array.isArray(n),n.forEach(o=>{o.constructor===vo?e=o:function f$(t){return Object.getPrototypeOf(t.constructor)===Sg}(o)?r=o:i=o}),i||r||e||null}const p$={provide:Jl,useExisting:Ir(()=>$y)},Nv=(()=>Promise.resolve())();let $y=(()=>{class t extends Jl{constructor(e,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Vr,this.form=new Iv({},o5(e),a5(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Nv.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),Ov(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Nv.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Nv.then(()=>{const r=this._findContainer(e.path),i=new Iv({});fF(i,e),r.registerControl(e.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Nv.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){Nv.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,hF(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(X(ll,10),X(qp,10),X(Dg,8))},t.\u0275dir=jn({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&De("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ki([p$]),_r]}),t})();function pF(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function mF(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const Rv=class extends jy{constructor(n=null,e,r){super(d5(e),f5(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),By(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=mF(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){pF(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){pF(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){mF(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}};let gF=(()=>{class t extends Jl{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return Vy(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,features:[_r]}),t})();const _$={provide:Eh,useExisting:Ir(()=>Ag)},vF=(()=>Promise.resolve())();let Ag=(()=>{class t extends Eh{constructor(e,r,i,o,a,s){super(),this._changeDetectorRef=a,this.callSetDisabledState=s,this.control=new Rv,this._registered=!1,this.update=new Vr,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=g5(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),m5(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Ov(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){vF.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,i=0!==r&&R1(r);vF.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Vy(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(X(Jl,9),X(ll,10),X(qp,10),X(Gc,10),X(Zo,8),X(Dg,8))},t.\u0275dir=jn({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ki([_$]),_r,gn]}),t})(),Vs=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const v$={provide:Gc,useExisting:Ir(()=>wd),multi:!0};let wd=(()=>{class t extends Sg{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,r){1&e&&De("input",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},features:[ki([v$]),_r]}),t})();const b$={provide:Gc,useExisting:Ir(()=>Wy),multi:!0};let bF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({}),t})(),y$=(()=>{class t{constructor(){this._accessors=[]}add(e,r){this._accessors.push([e,r])}remove(e){for(let r=this._accessors.length-1;r>=0;--r)if(this._accessors[r][1]===e)return void this._accessors.splice(r,1)}select(e){this._accessors.forEach(r=>{this._isSameGroup(r,e)&&r[1]!==e&&r[1].fireUncheck(e.value)})}_isSameGroup(e,r){return!!e[0].control&&e[0]._parent===r._control._parent&&e[1].name===r.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:bF}),t})(),Wy=(()=>{class t extends Sg{constructor(e,r,i,o){super(e,r),this._registry=i,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=Xr(Dg,{optional:!0})??Pv}ngOnInit(){this._control=this._injector.get(Eh),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}setDisabledState(e){(this.setDisabledStateFired||e||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",e),this.setDisabledStateFired=!0}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(X(hh),X($r),X(y$),X(js))},t.\u0275dir=jn({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,r){1&e&&De("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[ki([b$]),_r]}),t})();const _5=new U("NgModelWithFormControlWarning"),C$={provide:Jl,useExisting:Ir(()=>bo)};let bo=(()=>{class t extends Jl{constructor(e,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Vr,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(zy(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return Ov(r,e,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){Uy(e.control||null,e,!1),function h$(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,hF(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,i=this.form.get(e.path);r!==i&&(Uy(r||null,e),(t=>t instanceof Rv)(i)&&(Ov(i,e,this.callSetDisabledState),e.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);fF(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function u$(t,n){return zy(t,n)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){h5(this.form,this),this._oldForm&&zy(this._oldForm,this)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(X(ll,10),X(qp,10),X(Dg,8))},t.\u0275dir=jn({type:t,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&De("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ki([C$]),_r,gn]}),t})();const E$={provide:Jl,useExisting:Ir(()=>v5)};let v5=(()=>{class t extends gF{constructor(e,r,i){super(),this._parent=e,this._setValidators(r),this._setAsyncValidators(i)}_checkParentType(){xF(this._parent)}}return t.\u0275fac=function(e){return new(e||t)(X(Jl,13),X(ll,10),X(qp,10))},t.\u0275dir=jn({type:t,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[ki([E$]),_r]}),t})();const S$={provide:Jl,useExisting:Ir(()=>qy)};let qy=(()=>{class t extends Jl{constructor(e,r,i){super(),this._parent=e,this._setValidators(r),this._setAsyncValidators(i)}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return Vy(null==this.name?this.name:this.name.toString(),this._parent)}_checkParentType(){xF(this._parent)}}return t.\u0275fac=function(e){return new(e||t)(X(Jl,13),X(ll,10),X(qp,10))},t.\u0275dir=jn({type:t,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[ki([S$]),_r]}),t})();function xF(t){return!(t instanceof v5||t instanceof bo||t instanceof qy)}const D$={provide:Eh,useExisting:Ir(()=>Ro)};let Ro=(()=>{class t extends Eh{set isDisabled(e){}constructor(e,r,i,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.update=new Vr,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=g5(0,o)}ngOnChanges(e){this._added||this._setUpControl(),m5(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Vy(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return t._ngModelWarningSentOnce=!1,t.\u0275fac=function(e){return new(e||t)(X(Jl,13),X(ll,10),X(qp,10),X(Gc,10),X(_5,8))},t.\u0275dir=jn({type:t,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[ki([D$]),_r,gn]}),t})();const A$={provide:Gc,useExisting:Ir(()=>Ss),multi:!0};function CF(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let Ss=(()=>{class t extends Sg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const i=CF(this._getOptionId(e),e);this.setProperty("value",i)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function T$(t){return t.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&De("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[ki([A$]),_r]}),t})(),cl=(()=>{class t{constructor(e,r,i){this._element=e,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(CF(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(hh),X(Ss,9))},t.\u0275dir=jn({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const M$={provide:Gc,useExisting:Ir(()=>b5),multi:!0};function EF(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let b5=(()=>{class t extends Sg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const i=e.map(o=>this._getOptionId(o));r=(o,a)=>{o._setSelected(i.indexOf(a.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const i=[],o=r.selectedOptions;if(void 0!==o){const a=o;for(let s=0;s<a.length;s++){const c=this._getOptionValue(a[s].value);i.push(c)}}else{const a=r.options;for(let s=0;s<a.length;s++){const l=a[s];if(l.selected){const c=this._getOptionValue(l.value);i.push(c)}}}this.value=i,e(i)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function k$(t){return t.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&De("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[ki([M$]),_r]}),t})(),ul=(()=>{class t{constructor(e,r,i){this._element=e,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(EF(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(EF(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(hh),X(b5,9))},t.\u0275dir=jn({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();let Tg=(()=>{class t{constructor(){this._validator=Oy}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Oy,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,features:[gn]}),t})();const P$={provide:ll,useExisting:Ir(()=>Dc),multi:!0};let Dc=(()=>{class t extends Tg{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=R1,this.createValidator=e=>Uk}enabled(e){return e}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,r){2&e&&kr("required",r._enabled?"":null)},inputs:{required:"required"},features:[ki([P$]),_r]}),t})();const L$={provide:ll,useExisting:Ir(()=>Gy),multi:!0};let Gy=(()=>{class t extends Tg{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function SF(t){return"number"==typeof t?t:parseInt(t,10)}(e),this.createValidator=e=>Wk(e)}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&kr("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[ki([L$]),_r]}),t})(),IF=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[bF]}),t})();class PF extends jy{constructor(n,e,r){super(d5(e),f5(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,r={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(n,e={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,r={}){let i=this._adjustIndex(n);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),e&&(this.controls.splice(i,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){cF(this,!1,n),n.forEach((r,i)=>{lF(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((r,i)=>{r.reset(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,r)=>{n(e,r)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}function OF(t){return!!t&&(void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn)}let ea=(()=>{class t{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new t;return e.useNonNullable=!0,e}group(e,r=null){const i=this._reduceControls(e);let o={};return OF(r)?o=r:null!==r&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new Iv(i,o)}record(e,r=null){const i=this._reduceControls(e);return new uF(i,r)}control(e,r,i){let o={};return this.useNonNullable?(OF(r)?o=r:(o.validators=r,o.asyncValidators=i),new Rv(e,{...o,nonNullable:!0})):new Rv(e,r,i)}array(e,r,i){const o=e.map(a=>this._createControl(a));return new PF(o,r,i)}_reduceControls(e){const r={};return Object.keys(e).forEach(i=>{r[i]=this._createControl(e[i])}),r}_createControl(e){return e instanceof Rv||e instanceof jy?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),j$=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Dg,useValue:e.callSetDisabledState??Pv}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[IF]}),t})(),V$=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:_5,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:Dg,useValue:e.callSetDisabledState??Pv}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[IF]}),t})();class Yc extends Bt{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:r}=this;if(n)throw e;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}}let U$=(()=>{class t{constructor(e){this.http=e,this.permisosSubject=new Yc([]),this.permisos$=this.permisosSubject.asObservable()}cargarPermisos(){this.http.get("/api/permisos").subscribe(e=>this.permisosSubject.next(e),e=>{console.error("Error al cargar permisos:",e),this.permisosSubject.next([])})}tienePermiso(e){return this.permisosSubject.value.includes(e)}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Yy=pl(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function w5(...t){const n=_u(t),e=b0(t),{args:r,keys:i}=Ok(t);if(0===r.length)return Br([],n);const o=new Ht(function H$(t,n,e=xr){return r=>{NF(n,()=>{const{length:i}=t,o=new Array(i);let a=i,s=i;for(let l=0;l<i;l++)NF(n,()=>{const c=Br(t[l],n);let f=!1;c.subscribe(Rr(r,v=>{o[l]=v,f||(f=!0,s--),s||r.next(e(o.slice()))},()=>{--a||r.complete()}))},r)},r)}}(r,n,i?a=>Nk(i,a):xr));return e?o.pipe(r5(e)):o}function NF(t,n,e){t?gu(e,t,n):n()}function Lv(...t){return function z$(){return zf(1)}()(Br(t,_u(t)))}function Xy(t){return new Ht(n=>{ja(t()).subscribe(n)})}function It(t,n){const e=zn(t)?t:()=>t,r=i=>i.error(e());return new Ht(n?i=>n.schedule(r,0,i):r)}function x5(){return wn((t,n)=>{let e=null;t._refCount++;const r=Rr(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const i=t._connection,o=e;e=null,i&&(!o||i===o)&&i.unsubscribe(),n.unsubscribe()});t.subscribe(r),r.closed||(e=t.connect())})}class RF extends Ht{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Dr(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new br;const e=this.getSubject();n.add(this.source.subscribe(Rr(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=br.EMPTY)}return n}refCount(){return x5()(this)}}function Di(t,n){return wn((e,r)=>{let i=null,o=0,a=!1;const s=()=>a&&!i&&r.complete();e.subscribe(Rr(r,l=>{i?.unsubscribe();let c=0;const f=o++;ja(t(l,f)).subscribe(i=Rr(r,v=>r.next(n?n(l,v,f,c++):v),()=>{i=null,s()}))},()=>{a=!0,s()}))})}function ra(t){return t<=0?()=>Zs:wn((n,e)=>{let r=0;n.subscribe(Rr(e,i=>{++r<=t&&(e.next(i),t<=r&&e.complete())}))})}function ec(...t){const n=_u(t);return wn((e,r)=>{(n?Lv(t,e,n):Lv(t,e)).subscribe(r)})}function Ky(t){return wn((n,e)=>{let r=!1;n.subscribe(Rr(e,i=>{r=!0,e.next(i)},()=>{r||e.next(t),e.complete()}))})}function LF(t=$$){return wn((n,e)=>{let r=!1;n.subscribe(Rr(e,i=>{r=!0,e.next(i)},()=>r?e.complete():e.error(t())))})}function $$(){return new Yy}function Gp(t,n){const e=arguments.length>=2;return r=>r.pipe(t?_o((i,o)=>t(i,o,r)):xr,ra(1),e?Ky(n):LF(()=>new Yy))}function Ya(t,n,e){const r=zn(t)||n||e?{next:t,error:n,complete:e}:t;return r?wn((i,o)=>{var a;null===(a=r.subscribe)||void 0===a||a.call(r);let s=!0;i.subscribe(Rr(o,l=>{var c;null===(c=r.next)||void 0===c||c.call(r,l),o.next(l)},()=>{var l;s=!1,null===(l=r.complete)||void 0===l||l.call(r),o.complete()},l=>{var c;s=!1,null===(c=r.error)||void 0===c||c.call(r,l),o.error(l)},()=>{var l,c;s&&(null===(l=r.unsubscribe)||void 0===l||l.call(r)),null===(c=r.finalize)||void 0===c||c.call(r)}))}):xr}function Pt(t){return wn((n,e)=>{let o,r=null,i=!1;r=n.subscribe(Rr(e,void 0,void 0,a=>{o=ja(t(a,Pt(t)(n))),r?(r.unsubscribe(),r=null,o.subscribe(e)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(e))})}function BF(t,n){return wn(function W$(t,n,e,r,i){return(o,a)=>{let s=e,l=n,c=0;o.subscribe(Rr(a,f=>{const v=c++;l=s?t(l,f,v):(s=!0,f),r&&a.next(l)},i&&(()=>{s&&a.next(l),a.complete()})))}}(t,n,arguments.length>=2,!0))}function C5(t){return t<=0?()=>Zs:wn((n,e)=>{let r=[];n.subscribe(Rr(e,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)e.next(i);e.complete()},void 0,()=>{r=null}))})}function jF(t,n){const e=arguments.length>=2;return r=>r.pipe(t?_o((i,o)=>t(i,o,r)):xr,C5(1),e?Ky(n):LF(()=>new Yy))}function Zy(t){return gr(()=>t)}function Bv(t){return wn((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}const vi="primary",jv=Symbol("RouteTitle");class G${constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function j1(t){return new G$(t)}function Y$(t,n,e){const r=e.path.split("/");if(r.length>t.length||"full"===e.pathMatch&&(n.hasChildren()||r.length<t.length))return null;const i={};for(let o=0;o<r.length;o++){const a=r[o],s=t[o];if(a.startsWith(":"))i[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function Cf(t,n){const e=t?Object.keys(t):void 0,r=n?Object.keys(n):void 0;if(!e||!r||e.length!=r.length)return!1;let i;for(let o=0;o<e.length;o++)if(i=e[o],!VF(t[i],n[i]))return!1;return!0}function VF(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const e=[...t].sort(),r=[...n].sort();return e.every((i,o)=>r[o]===i)}return t===n}function UF(t){return Array.prototype.concat.apply([],t)}function HF(t){return t.length>0?t[t.length-1]:null}function dl(t,n){for(const e in t)t.hasOwnProperty(e)&&n(t[e],e)}function Yp(t){return LC(t)?t:sv(t)?Br(Promise.resolve(t)):On(t)}const Qy=!1,K$={exact:function WF(t,n,e){if(!Mg(t.segments,n.segments)||!Jy(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children)if(!t.children[r]||!WF(t.children[r],n.children[r],e))return!1;return!0},subset:qF},zF={exact:function Z$(t,n){return Cf(t,n)},subset:function Q$(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>VF(t[e],n[e]))},ignored:()=>!0};function $F(t,n,e){return K$[e.paths](t.root,n.root,e.matrixParams)&&zF[e.queryParams](t.queryParams,n.queryParams)&&!("exact"===e.fragment&&t.fragment!==n.fragment)}function qF(t,n,e){return GF(t,n,n.segments,e)}function GF(t,n,e,r){if(t.segments.length>e.length){const i=t.segments.slice(0,e.length);return!(!Mg(i,e)||n.hasChildren()||!Jy(i,e,r))}if(t.segments.length===e.length){if(!Mg(t.segments,e)||!Jy(t.segments,e,r))return!1;for(const i in n.children)if(!t.children[i]||!qF(t.children[i],n.children[i],r))return!1;return!0}{const i=e.slice(0,t.segments.length),o=e.slice(t.segments.length);return!!(Mg(t.segments,i)&&Jy(t.segments,i,r)&&t.children[vi])&&GF(t.children[vi],n,o,r)}}function Jy(t,n,e){return n.every((r,i)=>zF[e](t[i].parameters,r.parameters))}class Xp{constructor(n=new Ti([],{}),e={},r=null){this.root=n,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=j1(this.queryParams)),this._queryParamMap}toString(){return tW.serialize(this)}}class Ti{constructor(n,e){this.segments=n,this.children=e,this.parent=null,dl(e,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ew(this)}}class Vv{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=j1(this.parameters)),this._parameterMap}toString(){return KF(this)}}function Mg(t,n){return t.length===n.length&&t.every((e,r)=>e.path===n[r].path)}let Uv=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:function(){return new E5},providedIn:"root"}),t})();class E5{parse(n){const e=new uW(n);return new Xp(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){const e=`/${Hv(n.root,!0)}`,r=function iW(t){const n=Object.keys(t).map(e=>{const r=t[e];return Array.isArray(r)?r.map(i=>`${tw(e)}=${tw(i)}`).join("&"):`${tw(e)}=${tw(r)}`}).filter(e=>!!e);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${e}${r}${"string"==typeof n.fragment?`#${function nW(t){return encodeURI(t)}(n.fragment)}`:""}`}}const tW=new E5;function ew(t){return t.segments.map(n=>KF(n)).join("/")}function Hv(t,n){if(!t.hasChildren())return ew(t);if(n){const e=t.children[vi]?Hv(t.children[vi],!1):"",r=[];return dl(t.children,(i,o)=>{o!==vi&&r.push(`${o}:${Hv(i,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function eW(t,n){let e=[];return dl(t.children,(r,i)=>{i===vi&&(e=e.concat(n(r,i)))}),dl(t.children,(r,i)=>{i!==vi&&(e=e.concat(n(r,i)))}),e}(t,(r,i)=>i===vi?[Hv(t.children[vi],!1)]:[`${i}:${Hv(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[vi]?`${ew(t)}/${e[0]}`:`${ew(t)}/(${e.join("//")})`}}function YF(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function tw(t){return YF(t).replace(/%3B/gi,";")}function S5(t){return YF(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function nw(t){return decodeURIComponent(t)}function XF(t){return nw(t.replace(/\+/g,"%20"))}function KF(t){return`${S5(t.path)}${function rW(t){return Object.keys(t).map(n=>`;${S5(n)}=${S5(t[n])}`).join("")}(t.parameters)}`}const oW=/^[^\/()?;=#]+/;function rw(t){const n=t.match(oW);return n?n[0]:""}const aW=/^[^=?&#]+/,lW=/^[^&#]+/;class uW{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ti([],{}):new Ti([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(r[vi]=new Ti(n,e)),r}parseSegment(){const n=rw(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new Vt(4009,Qy);return this.capture(n),new Vv(nw(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const e=rw(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const i=rw(this.remaining);i&&(r=i,this.capture(r))}n[nw(e)]=nw(r)}parseQueryParam(n){const e=function sW(t){const n=t.match(aW);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const a=function cW(t){const n=t.match(lW);return n?n[0]:""}(this.remaining);a&&(r=a,this.capture(r))}const i=XF(e),o=XF(r);if(n.hasOwnProperty(i)){let a=n[i];Array.isArray(a)||(a=[a],n[i]=a),a.push(o)}else n[i]=o}parseParens(n){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=rw(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new Vt(4010,Qy);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):n&&(o=vi);const a=this.parseChildren();e[o]=1===Object.keys(a).length?a[vi]:new Ti([],a),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new Vt(4011,Qy)}}function D5(t){return t.segments.length>0?new Ti([],{[vi]:t}):t}function iw(t){const n={};for(const r of Object.keys(t.children)){const o=iw(t.children[r]);(o.segments.length>0||o.hasChildren())&&(n[r]=o)}return function dW(t){if(1===t.numberOfChildren&&t.children[vi]){const n=t.children[vi];return new Ti(t.segments.concat(n.segments),n.children)}return t}(new Ti(t.segments,n))}function kg(t){return t instanceof Xp}const A5=!1;function fW(t,n,e,r,i){if(0===e.length)return V1(n.root,n.root,n.root,r,i);const o=function tI(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new eI(!0,0,t);let n=0,e=!1;const r=t.reduce((i,o,a)=>{if("object"==typeof o&&null!=o){if(o.outlets){const s={};return dl(o.outlets,(l,c)=>{s[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:s}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===a?(o.split("/").forEach((s,l)=>{0==l&&"."===s||(0==l&&""===s?e=!0:".."===s?n++:""!=s&&i.push(s))}),i):[...i,o]},[]);return new eI(e,n,r)}(e);return o.toRoot()?V1(n.root,n.root,new Ti([],{}),r,i):function a(l){const c=function pW(t,n,e,r){if(t.isAbsolute)return new U1(n.root,!0,0);if(-1===r)return new U1(e,e===n.root,0);return function nI(t,n,e){let r=t,i=n,o=e;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Vt(4005,A5&&"Invalid number of '../'");i=r.segments.length}return new U1(r,!1,i-o)}(e,r+(zv(t.commands[0])?0:1),t.numberOfDoubleDots)}(o,n,t.snapshot?._urlSegment,l),f=c.processChildren?H1(c.segmentGroup,c.index,o.commands):T5(c.segmentGroup,c.index,o.commands);return V1(n.root,c.segmentGroup,f,r,i)}(t.snapshot?._lastPathIndex)}function zv(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function $v(t){return"object"==typeof t&&null!=t&&t.outlets}function V1(t,n,e,r,i){let a,o={};r&&dl(r,(l,c)=>{o[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`}),a=t===n?e:JF(t,n,e);const s=D5(iw(a));return new Xp(s,o,i)}function JF(t,n,e){const r={};return dl(t.children,(i,o)=>{r[o]=i===n?e:JF(i,n,e)}),new Ti(t.segments,r)}class eI{constructor(n,e,r){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=r,n&&r.length>0&&zv(r[0]))throw new Vt(4003,A5&&"Root segment cannot have matrix parameters");const i=r.find($v);if(i&&i!==HF(r))throw new Vt(4004,A5&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class U1{constructor(n,e,r){this.segmentGroup=n,this.processChildren=e,this.index=r}}function T5(t,n,e){if(t||(t=new Ti([],{})),0===t.segments.length&&t.hasChildren())return H1(t,n,e);const r=function gW(t,n,e){let r=0,i=n;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=e.length)return o;const a=t.segments[i],s=e[r];if($v(s))break;const l=`${s}`,c=r<e.length-1?e[r+1]:null;if(i>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!iI(l,c,a))return o;r+=2}else{if(!iI(l,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,n,e),i=e.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const o=new Ti(t.segments.slice(0,r.pathIndex),{});return o.children[vi]=new Ti(t.segments.slice(r.pathIndex),t.children),H1(o,0,i)}return r.match&&0===i.length?new Ti(t.segments,{}):r.match&&!t.hasChildren()?M5(t,n,e):r.match?H1(t,0,i):M5(t,n,e)}function H1(t,n,e){if(0===e.length)return new Ti(t.segments,{});{const r=function mW(t){return $v(t[0])?t[0].outlets:{[vi]:t}}(e),i={};if(!r[vi]&&t.children[vi]&&1===t.numberOfChildren&&0===t.children[vi].segments.length){const o=H1(t.children[vi],n,e);return new Ti(t.segments,o.children)}return dl(r,(o,a)=>{"string"==typeof o&&(o=[o]),null!==o&&(i[a]=T5(t.children[a],n,o))}),dl(t.children,(o,a)=>{void 0===r[a]&&(i[a]=o)}),new Ti(t.segments,i)}}function M5(t,n,e){const r=t.segments.slice(0,n);let i=0;for(;i<e.length;){const o=e[i];if($v(o)){const l=_W(o.outlets);return new Ti(r,l)}if(0===i&&zv(e[0])){r.push(new Vv(t.segments[n].path,rI(e[0]))),i++;continue}const a=$v(o)?o.outlets[vi]:`${o}`,s=i<e.length-1?e[i+1]:null;a&&s&&zv(s)?(r.push(new Vv(a,rI(s))),i+=2):(r.push(new Vv(a,{})),i++)}return new Ti(r,{})}function _W(t){const n={};return dl(t,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(n[r]=M5(new Ti([],{}),0,e))}),n}function rI(t){const n={};return dl(t,(e,r)=>n[r]=`${e}`),n}function iI(t,n,e){return t==e.path&&Cf(n,e.parameters)}const Wv="imperative";class Ef{constructor(n,e){this.id=n,this.url=e}}class k5 extends Ef{constructor(n,e,r="imperative",i=null){super(n,e),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Fg extends Ef{constructor(n,e,r){super(n,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class ow extends Ef{constructor(n,e,r,i){super(n,e),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class aw extends Ef{constructor(n,e,r,i){super(n,e),this.reason=r,this.code=i,this.type=16}}class F5 extends Ef{constructor(n,e,r,i){super(n,e),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class vW extends Ef{constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bW extends Ef{constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yW extends Ef{constructor(n,e,r,i,o){super(n,e),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class wW extends Ef{constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xW extends Ef{constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class CW{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class EW{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class SW{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class DW{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class AW{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class TW{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class oI{constructor(n,e,r){this.routerEvent=n,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let FW=(()=>{class t{createUrlTree(e,r,i,o,a,s){return fW(e||r.root,i,o,a,s)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})(),PW=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:function(n){return FW.\u0275fac(n)},providedIn:"root"}),t})();class aI{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){const e=I5(n,this._root);return e?e.children.map(r=>r.value):[]}firstChild(n){const e=I5(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){const e=P5(n,this._root);return e.length<2?[]:e[e.length-2].children.map(i=>i.value).filter(i=>i!==n)}pathFromRoot(n){return P5(n,this._root).map(e=>e.value)}}function I5(t,n){if(t===n.value)return n;for(const e of n.children){const r=I5(t,e);if(r)return r}return null}function P5(t,n){if(t===n.value)return[n];for(const e of n.children){const r=P5(t,e);if(r.length)return r.unshift(n),r}return[]}class Sh{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}}function z1(t){const n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}class sI extends aI{constructor(n,e){super(n),this.snapshot=e,O5(this,n)}toString(){return this.snapshot.toString()}}function lI(t,n){const e=function OW(t,n){const a=new sw([],{},{},"",{},vi,n,null,t.root,-1,{});return new uI("",new Sh(a,[]))}(t,n),r=new Yc([new Vv("",{})]),i=new Yc({}),o=new Yc({}),a=new Yc({}),s=new Yc(""),l=new Us(r,i,a,s,o,vi,n,e.root);return l.snapshot=e.root,new sI(new Sh(l,[]),e)}class Us{constructor(n,e,r,i,o,a,s,l){this.url=n,this.params=e,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this.title=this.data?.pipe(gr(c=>c[jv]))??On(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(gr(n=>j1(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(gr(n=>j1(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function cI(t,n="emptyOnly"){const e=t.pathFromRoot;let r=0;if("always"!==n)for(r=e.length-1;r>=1;){const i=e[r],o=e[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(o.component)break;r--}}return function NW(t){return t.reduce((n,e)=>({params:{...n.params,...e.params},data:{...n.data,...e.data},resolve:{...e.data,...n.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class sw{get title(){return this.data?.[jv]}constructor(n,e,r,i,o,a,s,l,c,f,v){this.url=n,this.params=e,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=f,this._resolve=v}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=j1(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=j1(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class uI extends aI{constructor(n,e){super(e),this.url=n,O5(this,e)}toString(){return dI(this._root)}}function O5(t,n){n.value._routerState=t,n.children.forEach(e=>O5(t,e))}function dI(t){const n=t.children.length>0?` { ${t.children.map(dI).join(", ")} } `:"";return`${t.value}${n}`}function N5(t){if(t.snapshot){const n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,Cf(n.queryParams,e.queryParams)||t.queryParams.next(e.queryParams),n.fragment!==e.fragment&&t.fragment.next(e.fragment),Cf(n.params,e.params)||t.params.next(e.params),function X$(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!Cf(t[e],n[e]))return!1;return!0}(n.url,e.url)||t.url.next(e.url),Cf(n.data,e.data)||t.data.next(e.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function R5(t,n){const e=Cf(t.params,n.params)&&function J$(t,n){return Mg(t,n)&&t.every((e,r)=>Cf(e.parameters,n[r].parameters))}(t.url,n.url);return e&&!(!t.parent!=!n.parent)&&(!t.parent||R5(t.parent,n.parent))}function qv(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=n.value;const i=function LW(t,n,e){return n.children.map(r=>{for(const i of e.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return qv(t,r,i);return qv(t,r)})}(t,n,e);return new Sh(r,i)}{if(t.shouldAttach(n.value)){const o=t.retrieve(n.value);if(null!==o){const a=o.route;return a.value._futureSnapshot=n.value,a.children=n.children.map(s=>qv(t,s)),a}}const r=function BW(t){return new Us(new Yc(t.url),new Yc(t.params),new Yc(t.queryParams),new Yc(t.fragment),new Yc(t.data),t.outlet,t.component,t)}(n.value),i=n.children.map(o=>qv(t,o));return new Sh(r,i)}}const L5="ngNavigationCancelingError";function fI(t,n){const{redirectTo:e,navigationBehaviorOptions:r}=kg(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,i=hI(!1,0,n);return i.url=e,i.navigationBehaviorOptions=r,i}function hI(t,n,e){const r=new Error("NavigationCancelingError: "+(t||""));return r[L5]=!0,r.cancellationCode=n,e&&(r.url=e),r}function pI(t){return mI(t)&&kg(t.url)}function mI(t){return t&&t[L5]}class jW{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Gv,this.attachRef=null}}let Gv=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const i=this.getOrCreateContext(e);i.outlet=r,this.contexts.set(e,i)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new jW,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const lw=!1;let cw=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=vi,this.activateEvents=new Vr,this.deactivateEvents=new Vr,this.attachEvents=new Vr,this.detachEvents=new Vr,this.parentContexts=Xr(Gv),this.location=Xr(Ml),this.changeDetector=Xr(Zo),this.environmentInjector=Xr(mf)}ngOnChanges(e){if(e.name){const{firstChange:r,previousValue:i}=e.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Vt(4012,lw);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Vt(4012,lw);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Vt(4012,lw);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Vt(4013,lw);this._activatedRoute=e;const i=this.location,a=e.snapshot.component,s=this.parentContexts.getOrCreateContext(this.name).children,l=new VW(e,s,i.injector);if(r&&function UW(t){return!!t.resolveComponentFactory}(r)){const c=r.resolveComponentFactory(a);this.activated=i.createComponent(c,i.length,l)}else this.activated=i.createComponent(a,{index:i.length,injector:l,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[gn]}),t})();class VW{constructor(n,e,r){this.route=n,this.childContexts=e,this.parent=r}get(n,e){return n===Us?this.route:n===Gv?this.childContexts:this.parent.get(n,e)}}let B5=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=pr({type:t,selectors:[["ng-component"]],standalone:!0,features:[sM],decls:1,vars:0,template:function(e,r){1&e&&qe(0,"router-outlet")},dependencies:[cw],encapsulation:2}),t})();function gI(t,n){return t.providers&&!t._injector&&(t._injector=ry(t.providers,n,`Route: ${t.path}`)),t._injector??n}function V5(t){const n=t.children&&t.children.map(V5),e=n?{...t,children:n}:{...t};return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==vi&&(e.component=B5),e}function Lu(t){return t.outlet||vi}function _I(t,n){const e=t.filter(r=>Lu(r)===n);return e.push(...t.filter(r=>Lu(r)!==n)),e}function Yv(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let n=t.parent;n;n=n.parent){const e=n.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class qW{constructor(n,e,r,i){this.routeReuseStrategy=n,this.futureState=e,this.currState=r,this.forwardEvent=i}activate(n){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,n),N5(this.futureState.root),this.activateChildRoutes(e,r,n)}deactivateChildRoutes(n,e,r){const i=z1(e);n.children.forEach(o=>{const a=o.value.outlet;this.deactivateRoutes(o,i[a],r),delete i[a]}),dl(i,(o,a)=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(n,e,r){const i=n.value,o=e?e.value:null;if(i===o)if(i.component){const a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(n,e,a.children)}else this.deactivateChildRoutes(n,e,r);else o&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){const r=e.getContext(n.value.outlet),i=r&&n.value.component?r.children:e,o=z1(n);for(const a of Object.keys(o))this.deactivateRouteAndItsChildren(o[a],i);if(r&&r.outlet){const a=r.outlet.detach(),s=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:a,route:n,contexts:s})}}deactivateRouteAndOutlet(n,e){const r=e.getContext(n.value.outlet),i=r&&n.value.component?r.children:e,o=z1(n);for(const a of Object.keys(o))this.deactivateRouteAndItsChildren(o[a],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(n,e,r){const i=z1(e);n.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new TW(o.value.snapshot))}),n.children.length&&this.forwardEvent(new DW(n.value.snapshot))}activateRoutes(n,e,r){const i=n.value,o=e?e.value:null;if(N5(i),i===o)if(i.component){const a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(n,e,a.children)}else this.activateChildRoutes(n,e,r);else if(i.component){const a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const s=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(s.contexts),a.attachRef=s.componentRef,a.route=s.route.value,a.outlet&&a.outlet.attach(s.componentRef,s.route.value),N5(s.route.value),this.activateChildRoutes(n,null,a.children)}else{const s=Yv(i.snapshot),l=s?.get(Bp)??null;a.attachRef=null,a.route=i,a.resolver=l,a.injector=s,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(n,null,a.children)}}else this.activateChildRoutes(n,null,r)}}class vI{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class uw{constructor(n,e){this.component=n,this.route=e}}function GW(t,n,e){const r=t._root;return Xv(r,n?n._root:null,e,[r.value])}function $1(t,n){const e=Symbol(),r=n.get(t,e);return r===e?"function"!=typeof t||function Bd(t){return null!==Qh(t)}(t)?n.get(t):t:r}function Xv(t,n,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=z1(n);return t.children.forEach(a=>{(function XW(t,n,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=t.value,a=n?n.value:null,s=e?e.getContext(t.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){const l=function KW(t,n,e){if("function"==typeof e)return e(t,n);switch(e){case"pathParamsChange":return!Mg(t.url,n.url);case"pathParamsOrQueryParamsChange":return!Mg(t.url,n.url)||!Cf(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!R5(t,n)||!Cf(t.queryParams,n.queryParams);default:return!R5(t,n)}}(a,o,o.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new vI(r)):(o.data=a.data,o._resolvedData=a._resolvedData),Xv(t,n,o.component?s?s.children:null:e,r,i),l&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new uw(s.outlet.component,a))}else a&&Kv(n,s,i),i.canActivateChecks.push(new vI(r)),Xv(t,null,o.component?s?s.children:null:e,r,i)})(a,o[a.value.outlet],e,r.concat([a.value]),i),delete o[a.value.outlet]}),dl(o,(a,s)=>Kv(a,e.getContext(s),i)),i}function Kv(t,n,e){const r=z1(t),i=t.value;dl(r,(o,a)=>{Kv(o,i.component?n?n.children.getContext(a):null:n,e)}),e.canDeactivateChecks.push(new uw(i.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,i))}function Zv(t){return"function"==typeof t}function U5(t){return t instanceof Yy||"EmptyError"===t?.name}const dw=Symbol("INITIAL_VALUE");function W1(){return Di(t=>w5(t.map(n=>n.pipe(ra(1),ec(dw)))).pipe(gr(n=>{for(const e of n)if(!0!==e){if(e===dw)return dw;if(!1===e||e instanceof Xp)return e}return!0}),_o(n=>n!==dw),ra(1)))}function bI(t){return function tt(...t){return mt(t)}(Ya(n=>{if(kg(n))throw fI(0,n)}),gr(n=>!0===n))}const H5={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function yI(t,n,e,r,i){const o=z5(t,n,e);return o.matched?function hq(t,n,e,r){const i=n.canMatch;return i&&0!==i.length?On(i.map(a=>{const s=$1(a,t);return Yp(function nq(t){return t&&Zv(t.canMatch)}(s)?s.canMatch(n,e):t.runInContext(()=>s(n,e)))})).pipe(W1(),bI()):On(!0)}(r=gI(n,r),n,e).pipe(gr(a=>!0===a?o:{...H5})):On(o)}function z5(t,n,e){if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||e.length>0)?{...H5}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const i=(n.matcher||Y$)(e,t,n);if(!i)return{...H5};const o={};dl(i.posParams,(s,l)=>{o[l]=s.path});const a=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:e.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function fw(t,n,e,r){if(e.length>0&&function gq(t,n,e){return e.some(r=>hw(t,n,r)&&Lu(r)!==vi)}(t,e,r)){const o=new Ti(n,function mq(t,n,e,r){const i={};i[vi]=r,r._sourceSegment=t,r._segmentIndexShift=n.length;for(const o of e)if(""===o.path&&Lu(o)!==vi){const a=new Ti([],{});a._sourceSegment=t,a._segmentIndexShift=n.length,i[Lu(o)]=a}return i}(t,n,r,new Ti(e,t.children)));return o._sourceSegment=t,o._segmentIndexShift=n.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function _q(t,n,e){return e.some(r=>hw(t,n,r))}(t,e,r)){const o=new Ti(t.segments,function pq(t,n,e,r,i){const o={};for(const a of r)if(hw(t,e,a)&&!i[Lu(a)]){const s=new Ti([],{});s._sourceSegment=t,s._segmentIndexShift=n.length,o[Lu(a)]=s}return{...i,...o}}(t,n,e,r,t.children));return o._sourceSegment=t,o._segmentIndexShift=n.length,{segmentGroup:o,slicedSegments:e}}const i=new Ti(t.segments,t.children);return i._sourceSegment=t,i._segmentIndexShift=n.length,{segmentGroup:i,slicedSegments:e}}function hw(t,n,e){return(!(t.hasChildren()||n.length>0)||"full"!==e.pathMatch)&&""===e.path}function wI(t,n,e,r){return!!(Lu(t)===r||r!==vi&&hw(n,e,t))&&("**"===t.path||z5(n,t,e).matched)}function xI(t,n,e){return 0===n.length&&!t.children[e]}const pw=!1;class mw{constructor(n){this.segmentGroup=n||null}}class CI{constructor(n){this.urlTree=n}}function Qv(t){return It(new mw(t))}function EI(t){return It(new CI(t))}class wq{constructor(n,e,r,i,o){this.injector=n,this.configLoader=e,this.urlSerializer=r,this.urlTree=i,this.config=o,this.allowRedirects=!0}apply(){const n=fw(this.urlTree.root,[],[],this.config).segmentGroup,e=new Ti(n.segments,n.children);return this.expandSegmentGroup(this.injector,this.config,e,vi).pipe(gr(o=>this.createUrlTree(iw(o),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Pt(o=>{if(o instanceof CI)return this.allowRedirects=!1,this.match(o.urlTree);throw o instanceof mw?this.noMatchError(o):o}))}match(n){return this.expandSegmentGroup(this.injector,this.config,n.root,vi).pipe(gr(i=>this.createUrlTree(iw(i),n.queryParams,n.fragment))).pipe(Pt(i=>{throw i instanceof mw?this.noMatchError(i):i}))}noMatchError(n){return new Vt(4002,pw)}createUrlTree(n,e,r){const i=D5(n);return new Xp(i,e,r)}expandSegmentGroup(n,e,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(n,e,r).pipe(gr(o=>new Ti([],o))):this.expandSegment(n,r,e,r.segments,i,!0)}expandChildren(n,e,r){const i=[];for(const o of Object.keys(r.children))"primary"===o?i.unshift(o):i.push(o);return Br(i).pipe(xh(o=>{const a=r.children[o],s=_I(e,o);return this.expandSegmentGroup(n,s,a,o).pipe(gr(l=>({segment:l,outlet:o})))}),BF((o,a)=>(o[a.outlet]=a.segment,o),{}),jF())}expandSegment(n,e,r,i,o,a){return Br(r).pipe(xh(s=>this.expandSegmentAgainstRoute(n,e,r,s,i,o,a).pipe(Pt(c=>{if(c instanceof mw)return On(null);throw c}))),Gp(s=>!!s),Pt((s,l)=>{if(U5(s))return xI(e,i,o)?On(new Ti([],{})):Qv(e);throw s}))}expandSegmentAgainstRoute(n,e,r,i,o,a,s){return wI(i,e,o,a)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(n,e,i,o,a):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,e,r,i,o,a):Qv(e):Qv(e)}expandSegmentAgainstRouteUsingRedirect(n,e,r,i,o,a){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,r,i,a):this.expandRegularSegmentAgainstRouteUsingRedirect(n,e,r,i,o,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,e,r,i){const o=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?EI(o):this.lineralizeSegments(r,o).pipe(ko(a=>{const s=new Ti(a,{});return this.expandSegment(n,s,e,a,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,e,r,i,o,a){const{matched:s,consumedSegments:l,remainingSegments:c,positionalParamSegments:f}=z5(e,i,o);if(!s)return Qv(e);const v=this.applyRedirectCommands(l,i.redirectTo,f);return i.redirectTo.startsWith("/")?EI(v):this.lineralizeSegments(i,v).pipe(ko(E=>this.expandSegment(n,e,r,E.concat(c),a,!1)))}matchSegmentAgainstRoute(n,e,r,i,o){return"**"===r.path?(n=gI(r,n),r.loadChildren?(r._loadedRoutes?On({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(n,r)).pipe(gr(s=>(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,new Ti(i,{})))):On(new Ti(i,{}))):yI(e,r,i,n).pipe(Di(({matched:a,consumedSegments:s,remainingSegments:l})=>a?this.getChildConfig(n=r._injector??n,r,i).pipe(ko(f=>{const v=f.injector??n,E=f.routes,{segmentGroup:D,slicedSegments:k}=fw(e,s,l,E),T=new Ti(D.segments,D.children);if(0===k.length&&T.hasChildren())return this.expandChildren(v,E,T).pipe(gr(W=>new Ti(s,W)));if(0===E.length&&0===k.length)return On(new Ti(s,{}));const R=Lu(r)===o;return this.expandSegment(v,T,E,k,R?vi:o,!0).pipe(gr(Z=>new Ti(s.concat(Z.segments),Z.children)))})):Qv(e)))}getChildConfig(n,e,r){return e.children?On({routes:e.children,injector:n}):e.loadChildren?void 0!==e._loadedRoutes?On({routes:e._loadedRoutes,injector:e._loadedInjector}):function fq(t,n,e,r){const i=n.canLoad;return void 0===i||0===i.length?On(!0):On(i.map(a=>{const s=$1(a,t);return Yp(function QW(t){return t&&Zv(t.canLoad)}(s)?s.canLoad(n,e):t.runInContext(()=>s(n,e)))})).pipe(W1(),bI())}(n,e,r).pipe(ko(i=>i?this.configLoader.loadChildren(n,e).pipe(Ya(o=>{e._loadedRoutes=o.routes,e._loadedInjector=o.injector})):function bq(t){return It(hI(pw,3))}())):On({routes:[],injector:n})}lineralizeSegments(n,e){let r=[],i=e.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return On(r);if(i.numberOfChildren>1||!i.children[vi])return n.redirectTo,It(new Vt(4e3,pw));i=i.children[vi]}}applyRedirectCommands(n,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),n,r)}applyRedirectCreateUrlTree(n,e,r,i){const o=this.createSegmentGroup(n,e.root,r,i);return new Xp(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){const r={};return dl(n,(i,o)=>{if("string"==typeof i&&i.startsWith(":")){const s=i.substring(1);r[o]=e[s]}else r[o]=i}),r}createSegmentGroup(n,e,r,i){const o=this.createSegments(n,e.segments,r,i);let a={};return dl(e.children,(s,l)=>{a[l]=this.createSegmentGroup(n,s,r,i)}),new Ti(o,a)}createSegments(n,e,r,i){return e.map(o=>o.path.startsWith(":")?this.findPosParam(n,o,i):this.findOrReturn(o,r))}findPosParam(n,e,r){const i=r[e.path.substring(1)];if(!i)throw new Vt(4001,pw);return i}findOrReturn(n,e){let r=0;for(const i of e){if(i.path===n.path)return e.splice(r),i;r++}return n}}class Cq{}class Dq{constructor(n,e,r,i,o,a,s){this.injector=n,this.rootComponentType=e,this.config=r,this.urlTree=i,this.url=o,this.paramsInheritanceStrategy=a,this.urlSerializer=s}recognize(){const n=fw(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,vi).pipe(gr(e=>{if(null===e)return null;const r=new sw([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},vi,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Sh(r,e),o=new uI(this.url,i);return this.inheritParamsAndData(o._root),o}))}inheritParamsAndData(n){const e=n.value,r=cI(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),n.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(n,e,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(n,e,r):this.processSegment(n,e,r,r.segments,i)}processChildren(n,e,r){return Br(Object.keys(r.children)).pipe(xh(i=>{const o=r.children[i],a=_I(e,i);return this.processSegmentGroup(n,a,o,i)}),BF((i,o)=>i&&o?(i.push(...o),i):null),function q$(t,n=!1){return wn((e,r)=>{let i=0;e.subscribe(Rr(r,o=>{const a=t(o,i++);(a||n)&&r.next(o),!a&&r.complete()}))})}(i=>null!==i),Ky(null),jF(),gr(i=>{if(null===i)return null;const o=DI(i);return function Aq(t){t.sort((n,e)=>n.value.outlet===vi?-1:e.value.outlet===vi?1:n.value.outlet.localeCompare(e.value.outlet))}(o),o}))}processSegment(n,e,r,i,o){return Br(e).pipe(xh(a=>this.processSegmentAgainstRoute(a._injector??n,a,r,i,o)),Gp(a=>!!a),Pt(a=>{if(U5(a))return xI(r,i,o)?On([]):On(null);throw a}))}processSegmentAgainstRoute(n,e,r,i,o){if(e.redirectTo||!wI(e,r,i,o))return On(null);let a;if("**"===e.path){const s=i.length>0?HF(i).parameters:{},l=TI(r)+i.length;a=On({snapshot:new sw(i,s,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,MI(e),Lu(e),e.component??e._loadedComponent??null,e,AI(r),l,kI(e)),consumedSegments:[],remainingSegments:[]})}else a=yI(r,e,i,n).pipe(gr(({matched:s,consumedSegments:l,remainingSegments:c,parameters:f})=>{if(!s)return null;const v=TI(r)+l.length;return{snapshot:new sw(l,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,MI(e),Lu(e),e.component??e._loadedComponent??null,e,AI(r),v,kI(e)),consumedSegments:l,remainingSegments:c}}));return a.pipe(Di(s=>{if(null===s)return On(null);const{snapshot:l,consumedSegments:c,remainingSegments:f}=s;n=e._injector??n;const v=e._loadedInjector??n,E=function Tq(t){return t.children?t.children:t.loadChildren?t._loadedRoutes:[]}(e),{segmentGroup:D,slicedSegments:k}=fw(r,c,f,E.filter(R=>void 0===R.redirectTo));if(0===k.length&&D.hasChildren())return this.processChildren(v,E,D).pipe(gr(R=>null===R?null:[new Sh(l,R)]));if(0===E.length&&0===k.length)return On([new Sh(l,[])]);const T=Lu(e)===o;return this.processSegment(v,E,D,k,T?vi:o).pipe(gr(R=>null===R?null:[new Sh(l,R)]))}))}}function Mq(t){const n=t.value.routeConfig;return n&&""===n.path&&void 0===n.redirectTo}function DI(t){const n=[],e=new Set;for(const r of t){if(!Mq(r)){n.push(r);continue}const i=n.find(o=>r.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...r.children),e.add(i)):n.push(r)}for(const r of e){const i=DI(r.children);n.push(new Sh(r.value,i))}return n.filter(r=>!e.has(r))}function AI(t){let n=t;for(;n._sourceSegment;)n=n._sourceSegment;return n}function TI(t){let n=t,e=n._segmentIndexShift??0;for(;n._sourceSegment;)n=n._sourceSegment,e+=n._segmentIndexShift??0;return e-1}function MI(t){return t.data||{}}function kI(t){return t.resolve||{}}function FI(t){return"string"==typeof t.title||null===t.title}function $5(t){return Di(n=>{const e=t(n);return e?Br(e).pipe(gr(()=>n)):On(n)})}const q1=new U("ROUTES");let W5=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Xr(YM)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return On(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=Yp(e.loadComponent()).pipe(gr(PI),Ya(o=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=o}),Bv(()=>{this.componentLoaders.delete(e)})),i=new RF(r,()=>new Bt).pipe(x5());return this.componentLoaders.set(e,i),i}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return On({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const o=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(gr(s=>{this.onLoadEndListener&&this.onLoadEndListener(r);let l,c,f=!1;Array.isArray(s)?c=s:(l=s.create(e).injector,c=UF(l.get(q1,[],Cr.Self|Cr.Optional)));return{routes:c.map(V5),injector:l}}),Bv(()=>{this.childrenLoaders.delete(r)})),a=new RF(o,()=>new Bt).pipe(x5());return this.childrenLoaders.set(r,a),a}loadModuleFactoryOrRoutes(e){return Yp(e()).pipe(gr(PI),ko(r=>r instanceof oM||Array.isArray(r)?On(r):Br(this.compiler.compileModuleAsync(r))))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function PI(t){return function Lq(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let _w=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Bt,this.configLoader=Xr(W5),this.environmentInjector=Xr(mf),this.urlSerializer=Xr(Uv),this.rootContexts=Xr(Gv),this.navigationId=0,this.afterPreactivation=()=>On(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new EW(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new CW(i))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:r})}setupNavigations(e){return this.transitions=new Yc({id:0,targetPageId:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Wv,restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(_o(r=>0!==r.id),gr(r=>({...r,extractedUrl:e.urlHandlingStrategy.extract(r.rawUrl)})),Di(r=>{let i=!1,o=!1;return On(r).pipe(Ya(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Di(a=>{const s=e.browserUrlTree.toString(),l=!e.navigated||a.extractedUrl.toString()!==s||s!==e.currentUrlTree.toString();if(!l&&"reload"!==(a.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const f="";return this.events.next(new aw(a.id,e.serializeUrl(r.rawUrl),f,0)),e.rawUrlTree=a.rawUrl,a.resolve(null),Zs}if(e.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return OI(a.source)&&(e.browserUrlTree=a.extractedUrl),On(a).pipe(Di(f=>{const v=this.transitions?.getValue();return this.events.next(new k5(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),v!==this.transitions?.getValue()?Zs:Promise.resolve(f)}),function xq(t,n,e,r){return Di(i=>function yq(t,n,e,r,i){return new wq(t,n,e,r,i).apply()}(t,n,e,i.extractedUrl,r).pipe(gr(o=>({...i,urlAfterRedirects:o}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,e.config),Ya(f=>{this.currentNavigation={...this.currentNavigation,finalUrl:f.urlAfterRedirects},r.urlAfterRedirects=f.urlAfterRedirects}),function Fq(t,n,e,r,i){return ko(o=>function Sq(t,n,e,r,i,o,a="emptyOnly"){return new Dq(t,n,e,r,i,a,o).recognize().pipe(Di(s=>null===s?function Eq(t){return new Ht(n=>n.error(t))}(new Cq):On(s)))}(t,n,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,i).pipe(gr(a=>({...o,targetSnapshot:a}))))}(this.environmentInjector,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),Ya(f=>{if(r.targetSnapshot=f.targetSnapshot,"eager"===e.urlUpdateStrategy){if(!f.extras.skipLocationChange){const E=e.urlHandlingStrategy.merge(f.urlAfterRedirects,f.rawUrl);e.setBrowserUrl(E,f)}e.browserUrlTree=f.urlAfterRedirects}const v=new vW(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(v)}));if(l&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:f,extractedUrl:v,source:E,restoredState:D,extras:k}=a,T=new k5(f,this.urlSerializer.serialize(v),E,D);this.events.next(T);const R=lI(v,this.rootComponentType).snapshot;return On(r={...a,targetSnapshot:R,urlAfterRedirects:v,extras:{...k,skipLocationChange:!1,replaceUrl:!1}})}{const f="";return this.events.next(new aw(a.id,e.serializeUrl(r.extractedUrl),f,1)),e.rawUrlTree=a.rawUrl,a.resolve(null),Zs}}),Ya(a=>{const s=new bW(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(s)}),gr(a=>r={...a,guards:GW(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function iq(t,n){return ko(e=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:a}}=e;return 0===a.length&&0===o.length?On({...e,guardsResult:!0}):function oq(t,n,e,r){return Br(t).pipe(ko(i=>function dq(t,n,e,r,i){const o=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return o&&0!==o.length?On(o.map(s=>{const l=Yv(n)??i,c=$1(s,l);return Yp(function tq(t){return t&&Zv(t.canDeactivate)}(c)?c.canDeactivate(t,n,e,r):l.runInContext(()=>c(t,n,e,r))).pipe(Gp())})).pipe(W1()):On(!0)}(i.component,i.route,e,n,r)),Gp(i=>!0!==i,!0))}(a,r,i,t).pipe(ko(s=>s&&function ZW(t){return"boolean"==typeof t}(s)?function aq(t,n,e,r){return Br(n).pipe(xh(i=>Lv(function lq(t,n){return null!==t&&n&&n(new SW(t)),On(!0)}(i.route.parent,r),function sq(t,n){return null!==t&&n&&n(new AW(t)),On(!0)}(i.route,r),function uq(t,n,e){const r=n[n.length-1],o=n.slice(0,n.length-1).reverse().map(a=>function YW(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(a)).filter(a=>null!==a).map(a=>Xy(()=>On(a.guards.map(l=>{const c=Yv(a.node)??e,f=$1(l,c);return Yp(function eq(t){return t&&Zv(t.canActivateChild)}(f)?f.canActivateChild(r,t):c.runInContext(()=>f(r,t))).pipe(Gp())})).pipe(W1())));return On(o).pipe(W1())}(t,i.path,e),function cq(t,n,e){const r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||0===r.length)return On(!0);const i=r.map(o=>Xy(()=>{const a=Yv(n)??e,s=$1(o,a);return Yp(function JW(t){return t&&Zv(t.canActivate)}(s)?s.canActivate(n,t):a.runInContext(()=>s(n,t))).pipe(Gp())}));return On(i).pipe(W1())}(t,i.route,e))),Gp(i=>!0!==i,!0))}(r,o,t,n):On(s)),gr(s=>({...e,guardsResult:s})))})}(this.environmentInjector,a=>this.events.next(a)),Ya(a=>{if(r.guardsResult=a.guardsResult,kg(a.guardsResult))throw fI(0,a.guardsResult);const s=new yW(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(s)}),_o(a=>!!a.guardsResult||(e.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),$5(a=>{if(a.guards.canActivateChecks.length)return On(a).pipe(Ya(s=>{const l=new wW(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(l)}),Di(s=>{let l=!1;return On(s).pipe(function Iq(t,n){return ko(e=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=e;if(!i.length)return On(e);let o=0;return Br(i).pipe(xh(a=>function Pq(t,n,e,r){const i=t.routeConfig,o=t._resolve;return void 0!==i?.title&&!FI(i)&&(o[jv]=i.title),function Oq(t,n,e,r){const i=function Nq(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===i.length)return On({});const o={};return Br(i).pipe(ko(a=>function Rq(t,n,e,r){const i=Yv(n)??r,o=$1(t,i);return Yp(o.resolve?o.resolve(n,e):i.runInContext(()=>o(n,e)))}(t[a],n,e,r).pipe(Gp(),Ya(s=>{o[a]=s}))),C5(1),Zy(o),Pt(a=>U5(a)?Zs:It(a)))}(o,t,n,r).pipe(gr(a=>(t._resolvedData=a,t.data=cI(t,e).resolve,i&&FI(i)&&(t.data[jv]=i.title),null)))}(a.route,r,t,n)),Ya(()=>o++),C5(1),ko(a=>o===i.length?On(e):Zs))})}(e.paramsInheritanceStrategy,this.environmentInjector),Ya({next:()=>l=!0,complete:()=>{l||(e.restoreHistory(s),this.cancelNavigationTransition(s,"",2))}}))}),Ya(s=>{const l=new xW(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(l)}))}),$5(a=>{const s=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(Ya(f=>{l.component=f}),gr(()=>{})));for(const f of l.children)c.push(...s(f));return c};return w5(s(a.targetSnapshot.root)).pipe(Ky(),ra(1))}),$5(()=>this.afterPreactivation()),gr(a=>{const s=function RW(t,n,e){const r=qv(t,n._root,e?e._root:void 0);return new sI(r,n)}(e.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return r={...a,targetRouterState:s}}),Ya(a=>{e.currentUrlTree=a.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),e.routerState=a.targetRouterState,"deferred"===e.urlUpdateStrategy&&(a.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,a),e.browserUrlTree=a.urlAfterRedirects)}),((t,n,e)=>gr(r=>(new qW(n,r.targetRouterState,r.currentRouterState,e).activate(t),r)))(this.rootContexts,e.routeReuseStrategy,a=>this.events.next(a)),ra(1),Ya({next:a=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new Fg(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{i=!0}}),Bv(()=>{i||o||this.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),Pt(a=>{if(o=!0,mI(a)){pI(a)||(e.navigated=!0,e.restoreHistory(r,!0));const s=new ow(r.id,this.urlSerializer.serialize(r.extractedUrl),a.message,a.cancellationCode);if(this.events.next(s),pI(a)){const l=e.urlHandlingStrategy.merge(a.url,e.rawUrlTree),c={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||OI(r.source)};e.scheduleNavigation(l,Wv,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{e.restoreHistory(r,!0);const s=new F5(r.id,this.urlSerializer.serialize(r.extractedUrl),a,r.targetSnapshot??void 0);this.events.next(s);try{r.resolve(e.errorHandler(a))}catch(l){r.reject(l)}}return Zs}))}))}cancelNavigationTransition(e,r,i){const o=new ow(e.id,this.urlSerializer.serialize(e.extractedUrl),r,i);this.events.next(o),e.resolve(!1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function OI(t){return t!==Wv}let NI=(()=>{class t{buildTitle(e){let r,i=e.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===vi);return r}getResolvedTitleForRoute(e){return e.data[jv]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:function(){return Xr(Bq)},providedIn:"root"}),t})(),Bq=(()=>{class t extends NI{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return t.\u0275fac=function(e){return new(e||t)(it(_k))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),jq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:function(){return Xr(Uq)},providedIn:"root"}),t})();class Vq{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}}let Uq=(()=>{class t extends Vq{}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const vw=new U("",{providedIn:"root",factory:()=>({})});let zq=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:function(){return Xr($q)},providedIn:"root"}),t})(),$q=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,r){return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Wq(t){throw t}function qq(t,n,e){return n.parse("/")}const Gq={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Yq={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ds=(()=>{class t{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Xr(uV),this.isNgZoneEnabled=!1,this.options=Xr(vw,{optional:!0})||{},this.errorHandler=this.options.errorHandler||Wq,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||qq,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Xr(zq),this.routeReuseStrategy=Xr(jq),this.urlCreationStrategy=Xr(PW),this.titleStrategy=Xr(NI),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=UF(Xr(q1,{optional:!0})??[]),this.navigationTransitions=Xr(_w),this.urlSerializer=Xr(Uv),this.location=Xr(xv),this.isNgZoneEnabled=Xr(Wr)instanceof Wr&&Wr.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Xp,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=lI(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId??0},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Wv,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,r,e.state)},0)}))}navigateToSyncWithBrowser(e,r,i){const o={replaceUrl:!0},a=i?.navigationId?i:null;if(i){const l={...i};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const s=this.parseUrl(e);this.scheduleNavigation(s,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(e){this.config=e.map(V5),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:i,queryParams:o,fragment:a,queryParamsHandling:s,preserveFragment:l}=r,c=l?this.currentUrlTree.fragment:a;let f=null;switch(s){case"merge":f={...this.currentUrlTree.queryParams,...o};break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=o||null}return null!==f&&(f=this.removeEmptyProps(f)),this.urlCreationStrategy.createUrlTree(i,this.routerState,this.currentUrlTree,e,f,c??null)}navigateByUrl(e,r={skipLocationChange:!1}){const i=kg(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Wv,null,r)}navigate(e,r={skipLocationChange:!1}){return function Xq(t){for(let n=0;n<t.length;n++){const e=t[n];if(null==e)throw new Vt(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,e)}return r}isActive(e,r){let i;if(i=!0===r?{...Gq}:!1===r?{...Yq}:r,kg(e))return $F(this.currentUrlTree,e,i);const o=this.parseUrl(e);return $F(this.currentUrlTree,o,i)}removeEmptyProps(e){return Object.keys(e).reduce((r,i)=>{const o=e[i];return null!=o&&(r[i]=o),r},{})}scheduleNavigation(e,r,i,o,a){if(this.disposed)return Promise.resolve(!1);let s,l,c,f;return a?(s=a.resolve,l=a.reject,c=a.promise):c=new Promise((v,E)=>{s=v,l=E}),f="computed"===this.canceledNavigationResolution?i&&i.\u0275routerPageId?i.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:f,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:o,resolve:s,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(v=>Promise.reject(v))}setBrowserUrl(e,r){const i=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const a={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",a)}else{const o={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.go(i,"",o)}}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-(this.browserPageId??this.currentPageId);0!==o?this.location.historyGo(o):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===o&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Hs=(()=>{class t{constructor(e,r,i,o,a,s){this.router=e,this.route=r,this.tabIndexAttribute=i,this.renderer=o,this.el=a,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Bt;const l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=e.events.subscribe(c=>{c instanceof Fg&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=R1(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=R1(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=R1(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,r,i,o,a){return!!(null===this.urlTree||this.isAnchorElement&&(0!==e||r||i||o||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const e=null===this.href?null:function ev(t,n,e){return function lC(t,n){return"src"===n&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===n&&("base"===t||"link"===t)?J_:Q_}(n,e)(t)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",e)}applyAttributeValue(e,r){const i=this.renderer,o=this.el.nativeElement;null!==r?i.setAttribute(o,e,r):i.removeAttribute(o,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return t.\u0275fac=function(e){return new(e||t)(X(Ds),X(Us),jc("tabindex"),X(hh),X($r),X(Eg))},t.\u0275dir=jn({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(e,r){1&e&&De("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&e&&kr("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[gn]}),t})(),RI=(()=>{class t{get isActive(){return this._isActive}constructor(e,r,i,o,a){this.router=e,this.element=r,this.renderer=i,this.cdr=o,this.link=a,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Vr,this.routerEventsSubscription=e.events.subscribe(s=>{s instanceof Fg&&this.update()})}ngAfterContentInit(){On(this.links.changes,On(null)).pipe(zf()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=Br(e).pipe(zf()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){const r=Array.isArray(e)?e:e.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.classes.forEach(r=>{e?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(e))})}isLinkActive(e){const r=function Kq(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>!!i.urlTree&&e.isActive(i.urlTree,r)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}}return t.\u0275fac=function(e){return new(e||t)(X(Ds),X($r),X(hh),X(Zo),X(Hs,8))},t.\u0275dir=jn({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(e,r,i){if(1&e&&so(i,Hs,5),2&e){let o;Er(o=Sr())&&(r.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[gn]}),t})();class LI{}let Zq=(()=>{class t{constructor(e,r,i,o,a){this.router=e,this.injector=i,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(_o(e=>e instanceof Fg),xh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const i=[];for(const o of r){o.providers&&!o._injector&&(o._injector=ry(o.providers,e,`Route: ${o.path}`));const a=o._injector??e,s=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(s,o.children??o._loadedRoutes))}return Br(i).pipe(zf())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):On(null);const o=i.pipe(ko(a=>null===a?On(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,this.processRoutes(a.injector??e,a.routes))));return r.loadComponent&&!r._loadedComponent?Br([o,this.loader.loadComponent(r)]).pipe(zf()):o})}}return t.\u0275fac=function(e){return new(e||t)(it(Ds),it(YM),it(mf),it(LI),it(W5))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const G5=new U("");let BI=(()=>{class t{constructor(e,r,i,o,a={}){this.urlSerializer=e,this.transitions=r,this.viewportScroller=i,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof k5?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Fg&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof oI&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new oI(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return t.\u0275fac=function(e){U2()},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();var Xc=(()=>((Xc=Xc||{})[Xc.COMPLETE=0]="COMPLETE",Xc[Xc.FAILED=1]="FAILED",Xc[Xc.REDIRECTING=2]="REDIRECTING",Xc))();const G1=!1;function Kp(t,n){return{\u0275kind:t,\u0275providers:n}}const Y5=new U("",{providedIn:"root",factory:()=>!1});function VI(){const t=Xr(js);return n=>{const e=t.get(N1);if(n!==e.components[0])return;const r=t.get(Ds),i=t.get(UI);1===t.get(X5)&&r.initialNavigation(),t.get(HI,null,Cr.Optional)?.setUpPreloading(),t.get(G5,null,Cr.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const UI=new U(G1?"bootstrap done indicator":"",{factory:()=>new Bt}),X5=new U(G1?"initial navigation":"",{providedIn:"root",factory:()=>1});function nG(){let t=[];return t=G1?[{provide:ff,multi:!0,useFactory:()=>{const n=Xr(Ds);return()=>n.events.subscribe(e=>{console.group?.(`Router Event: ${e.constructor.name}`),console.log(function MW(t){if(!("type"in t))return`Unknown Router Event: ${t.constructor.name}`;switch(t.type){case 14:return`ActivationEnd(path: '${t.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${t.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${t.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${t.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state}, shouldActivate: ${t.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 2:return`NavigationCancel(id: ${t.id}, url: '${t.url}')`;case 16:return`NavigationSkipped(id: ${t.id}, url: '${t.url}')`;case 1:return`NavigationEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${t.id}, url: '${t.url}', error: ${t.error})`;case 0:return`NavigationStart(id: ${t.id}, url: '${t.url}')`;case 6:return`ResolveEnd(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 5:return`ResolveStart(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 10:return`RouteConfigLoadEnd(path: ${t.route.path})`;case 9:return`RouteConfigLoadStart(path: ${t.route.path})`;case 4:return`RoutesRecognized(id: ${t.id}, url: '${t.url}', urlAfterRedirects: '${t.urlAfterRedirects}', state: ${t.state})`;case 15:return`Scroll(anchor: '${t.anchor}', position: '${t.position?`${t.position[0]}, ${t.position[1]}`:null}')`}}(e)),console.log(e),console.groupEnd?.()})}}]:[],Kp(1,t)}const HI=new U(G1?"router preloader":"");function rG(t){return Kp(0,[{provide:HI,useExisting:Zq},{provide:LI,useExisting:t}])}const Jv=!1,zI=new U(Jv?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),iG=[xv,{provide:Uv,useClass:E5},Ds,Gv,{provide:Us,useFactory:function jI(t){return t.routerState.root},deps:[Ds]},W5,Jv?{provide:Y5,useValue:!0}:[]];function oG(){return new n4("Router",Ds)}let $I=(()=>{class t{constructor(e){}static forRoot(e,r){return{ngModule:t,providers:[iG,Jv&&r?.enableTracing?nG().\u0275providers:[],{provide:q1,multi:!0,useValue:e},{provide:zI,useFactory:cG,deps:[[Ds,new Uc,new ws]]},{provide:vw,useValue:r||{}},r?.useHash?{provide:Eg,useClass:QV}:{provide:Eg,useClass:D4},{provide:G5,useFactory:()=>{const t=Xr(dH),n=Xr(Wr),e=Xr(vw),r=Xr(_w),i=Xr(Uv);return e.scrollOffset&&t.setOffset(e.scrollOffset),new BI(i,r,t,n,e)}},r?.preloadingStrategy?rG(r.preloadingStrategy).\u0275providers:[],{provide:n4,multi:!0,useFactory:oG},r?.initialNavigation?uG(r):[],[{provide:WI,useFactory:VI},{provide:t4,multi:!0,useExisting:WI}]]}}static forChild(e){return{ngModule:t,providers:[{provide:q1,multi:!0,useValue:e}]}}}return t.\u0275fac=function(e){return new(e||t)(it(zI,8))},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[B5]}),t})();function cG(t){if(Jv&&t)throw new Vt(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function uG(t){return["disabled"===t.initialNavigation?Kp(3,[{provide:bv,multi:!0,useFactory:()=>{const n=Xr(Ds);return()=>{n.setUpLocationChangeListener()}}},{provide:X5,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?Kp(2,[{provide:X5,useValue:0},{provide:bv,multi:!0,deps:[js],useFactory:n=>{const e=n.get(KV,Promise.resolve());return()=>e.then(()=>new Promise(r=>{const i=n.get(Ds),o=n.get(UI);(function Qq(t,n){t.events.pipe(_o(e=>e instanceof Fg||e instanceof ow||e instanceof F5||e instanceof aw),gr(e=>e instanceof Fg||e instanceof aw?Xc.COMPLETE:e instanceof ow&&(0===e.code||1===e.code)?Xc.REDIRECTING:Xc.FAILED),_o(e=>e!==Xc.REDIRECTING),ra(1)).subscribe(()=>{n()})})(i,()=>{r(!0)}),n.get(_w).afterPreactivation=()=>(r(!0),o.closed?On(void 0):o),i.initialNavigation()}))}}]).\u0275providers:[]]}const WI=new U(Jv?"Router Initializer":"");var hi=qi(5861),fG=qi(5226),z=qi.n(fG),Kc=qi(6166),hG=qi(2983),Zc=qi.n(hG),eb={version:"0.18.5"},Qc=1200,Ig=1252,pG=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],K5={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},bw=function(t){-1!=pG.indexOf(t)&&(Ig=K5[0]=t)},Bu=function(t){Qc=t,bw(t)};function yw(){Bu(1200),function mG(){bw(1252)}()}function ww(t){for(var n=[],e=0,r=t.length;e<r;++e)n[e]=t.charCodeAt(e);return n}function qI(t){for(var n=[],e=0;e<t.length>>1;++e)n[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return n.join("")}var eo,Y1=function(t){var n=t.charCodeAt(0),e=t.charCodeAt(1);return 255==n&&254==e?function gG(t){for(var n=[],e=0;e<t.length>>1;++e)n[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return n.join("")}(t.slice(2)):254==n&&255==e?qI(t.slice(2)):65279==n?t.slice(1):t},tb=function(n){return String.fromCharCode(n)},Z5=function(n){return String.fromCharCode(n)},Pa=null,nb=!0,Zp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function rb(t){for(var n="",e=0,r=0,i=0,o=0,a=0,s=0,l=0,c=0;c<t.length;)o=(e=t.charCodeAt(c++))>>2,a=(3&e)<<4|(r=t.charCodeAt(c++))>>4,s=(15&r)<<2|(i=t.charCodeAt(c++))>>6,l=63&i,isNaN(r)?s=l=64:isNaN(i)&&(l=64),n+=Zp.charAt(o)+Zp.charAt(a)+Zp.charAt(s)+Zp.charAt(l);return n}function Jc(t){var n="",o=0,a=0,s=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)o=Zp.indexOf(t.charAt(c++)),a=Zp.indexOf(t.charAt(c++)),n+=String.fromCharCode(o<<2|a>>4),64!==(s=Zp.indexOf(t.charAt(c++)))&&(n+=String.fromCharCode((15&a)<<4|s>>2)),64!==(l=Zp.indexOf(t.charAt(c++)))&&(n+=String.fromCharCode((3&s)<<6|l));return n}var Mi=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Dh=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(n,e){return e?new Buffer(n,e):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function Qp(t){return Mi?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function GI(t){return Mi?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var eu=function(n){return Mi?Dh(n,"binary"):n.split("").map(function(e){return 255&e.charCodeAt(0)})};function ib(t){if(typeof ArrayBuffer>"u")return eu(t);for(var n=new ArrayBuffer(t.length),e=new Uint8Array(n),r=0;r!=t.length;++r)e[r]=255&t.charCodeAt(r);return n}function Jp(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],e=0;e<t.length;++e)n[e]=String.fromCharCode(t[e]);return n.join("")}function Q5(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Q5(new Uint8Array(t));for(var n=new Array(t.length),e=0;e<t.length;++e)n[e]=t[e];return n}var zs=Mi?function(t){return Buffer.concat(t.map(function(n){return Buffer.isBuffer(n)?n:Dh(n)}))}:function(t){if(typeof Uint8Array<"u"){var n=0,e=0;for(n=0;n<t.length;++n)e+=t[n].length;var r=new Uint8Array(e),i=0;for(n=0,e=0;n<t.length;e+=i,++n)if(i=t[n].length,t[n]instanceof Uint8Array)r.set(t[n],e);else{if("string"==typeof t[n])throw"wtf";r.set(new Uint8Array(t[n]),e)}return r}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))},Il=/\u0000/g,ob=/[\u0001-\u0006]/g;function X1(t){for(var n="",e=t.length-1;e>=0;)n+=t.charAt(e--);return n}function xd(t,n){var e=""+t;return e.length>=n?e:Na("0",n-e.length)+e}function J5(t,n){var e=""+t;return e.length>=n?e:Na(" ",n-e.length)+e}function xw(t,n){var e=""+t;return e.length>=n?e:e+Na(" ",n-e.length)}var YI=Math.pow(2,32);function K1(t,n){return t>YI||t<-YI?function bG(t,n){var e=""+Math.round(t);return e.length>=n?e:Na("0",n-e.length)+e}(t,n):function yG(t,n){var e=""+t;return e.length>=n?e:Na("0",n-e.length)+e}(Math.round(t),n)}function Cw(t,n){return t.length>=7+(n=n||0)&&103==(32|t.charCodeAt(n))&&101==(32|t.charCodeAt(n+1))&&110==(32|t.charCodeAt(n+2))&&101==(32|t.charCodeAt(n+3))&&114==(32|t.charCodeAt(n+4))&&97==(32|t.charCodeAt(n+5))&&108==(32|t.charCodeAt(n+6))}var XI=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],eS=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],qr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},KI={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},xG={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ew(t,n,e){for(var r=t<0?-1:1,i=t*r,o=0,a=1,s=0,l=1,c=0,f=0,v=Math.floor(i);c<n&&(s=(v=Math.floor(i))*a+o,f=v*c+l,!(i-v<5e-8));)i=1/(i-v),o=a,a=s,l=c,c=f;if(f>n&&(c>n?(f=l,s=o):(f=c,s=a)),!e)return[0,r*s,f];var E=Math.floor(r*s/f);return[E,r*s-E*f,f]}function em(t,n,e){if(t>2958465||t<0)return null;var r=0|t,i=Math.floor(86400*(t-r)),o=0,a=[],s={D:r,T:i,u:86400*(t-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),n&&n.date1904&&(r+=1462),s.u>.9999&&(s.u=0,86400==++i&&(s.T=i=0,++r,++s.D)),60===r)a=e?[1317,10,29]:[1900,2,29],o=3;else if(0===r)a=e?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),r<60&&(o=(o+6)%7),e&&(o=function TG(t,n){n[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}(l,a))}return s.y=a[0],s.m=a[1],s.d=a[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=o,s}var ZI=new Date(1899,11,31,0,0,0),CG=ZI.getTime(),EG=new Date(1900,2,1,0,0,0);function QI(t,n){var e=t.getTime();return n?e-=1262304e5:t>=EG&&(e+=864e5),(e-(CG+6e4*(t.getTimezoneOffset()-ZI.getTimezoneOffset())))/864e5}function tS(t){return-1==t.indexOf(".")?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ab(t){var e,n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return e=n>=-4&&n<=-1?t.toPrecision(10+n):Math.abs(n)<=9?function DG(t){var n=t<0?12:11,e=tS(t.toFixed(12));return e.length<=n||(e=t.toPrecision(10)).length<=n?e:t.toExponential(5)}(t):10===n?t.toFixed(10).substr(0,12):function AG(t){var n=tS(t.toFixed(11));return n.length>(t<0?12:11)||"0"===n||"-0"===n?t.toPrecision(6):n}(t),tS(function SG(t){return-1==t.indexOf("E")?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(e.toUpperCase()))}function Pg(t,n){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?t.toString(10):ab(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return tu(14,QI(t,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+t)}function MG(t,n,e,r){var l,i="",o=0,a=0,s=e.y,c=0;switch(t){case 98:s=e.y+543;case 121:switch(n.length){case 1:case 2:l=s%100,c=2;break;default:l=s%1e4,c=4}break;case 109:switch(n.length){case 1:case 2:l=e.m,c=n.length;break;case 3:return eS[e.m-1][1];case 5:return eS[e.m-1][0];default:return eS[e.m-1][2]}break;case 100:switch(n.length){case 1:case 2:l=e.d,c=n.length;break;case 3:return XI[e.q][0];default:return XI[e.q][1]}break;case 104:switch(n.length){case 1:case 2:l=1+(e.H+11)%12,c=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:l=e.H,c=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:l=e.M,c=n.length;break;default:throw"bad minute format: "+n}break;case 115:if("s"!=n&&"ss"!=n&&".0"!=n&&".00"!=n&&".000"!=n)throw"bad second format: "+n;return 0!==e.u||"s"!=n&&"ss"!=n?(a=r>=2?3===r?1e3:100:1===r?10:1,(o=Math.round(a*(e.S+e.u)))>=60*a&&(o=0),"s"===n?0===o?"0":""+o/a:(i=xd(o,2+r),"ss"===n?i.substr(0,2):"."+i.substr(2,n.length-1))):xd(e.S,n.length);case 90:switch(n){case"[h]":case"[hh]":l=24*e.D+e.H;break;case"[m]":case"[mm]":l=60*(24*e.D+e.H)+e.M;break;case"[s]":case"[ss]":l=60*(60*(24*e.D+e.H)+e.M)+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+n}c=3===n.length?1:2;break;case 101:l=s,c=1}return c>0?xd(l,c):""}function tm(t){if(t.length<=3)return t;for(var e=t.length%3,r=t.substr(0,e);e!=t.length;e+=3)r+=(r.length>0?",":"")+t.substr(e,3);return r}var JI=/%/g;function eP(t,n){var e,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+eP(t,-n);var i=t.indexOf(".");-1===i&&(i=t.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),-1===(e=(n/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).indexOf("e")){var a=Math.floor(Math.log(n)*Math.LOG10E);for(-1===e.indexOf(".")?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+o):e+="E+"+(a-o);"0."===e.substr(0,2);)e=(e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,c,f){return l+c+f.substr(0,(i+o)%i)+"."+f.substr(o)+"E"})}else e=n.toExponential(r);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var tP=/# (\?+)( ?)\/( ?)(\d+)/,nP=/^#*0*\.([0#]+)/,rP=/\).*[0#]/,iP=/\(###\) ###\\?-####/;function tc(t){for(var e,n="",r=0;r!=t.length;++r)switch(e=t.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(e)}return n}function oP(t,n){var e=Math.pow(10,n);return""+Math.round(t*e)/e}function aP(t,n){var e=t-Math.floor(t),r=Math.pow(10,n);return n<(""+Math.round(e*r)).length?0:Math.round(e*r)}function ju(t,n,e){if(40===t.charCodeAt(0)&&!n.match(rP)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?ju("n",r,e):"("+ju("n",r,-e)+")"}if(44===n.charCodeAt(n.length-1))return function FG(t,n,e){for(var r=n.length-1;44===n.charCodeAt(r-1);)--r;return Ah(t,n.substr(0,r),e/Math.pow(10,3*(n.length-r)))}(t,n,e);if(-1!==n.indexOf("%"))return function kG(t,n,e){var r=n.replace(JI,""),i=n.length-r.length;return Ah(t,r,e*Math.pow(10,2*i))+Na("%",i)}(t,n,e);if(-1!==n.indexOf("E"))return eP(n,e);if(36===n.charCodeAt(0))return"$"+ju(t,n.substr(" "==n.charAt(1)?2:1),e);var i,o,a,s,l=Math.abs(e),c=e<0?"-":"";if(n.match(/^00+$/))return c+K1(l,n.length);if(n.match(/^[#?]+$/))return"0"===(i=K1(e,0))&&(i=""),i.length>n.length?i:tc(n.substr(0,n.length-i.length))+i;if(o=n.match(tP))return function IG(t,n,e){var r=parseInt(t[4],10),i=Math.round(n*r),o=Math.floor(i/r),a=i-o*r,s=r;return e+(0===o?"":""+o)+" "+(0===a?Na(" ",t[1].length+1+t[4].length):J5(a,t[1].length)+t[2]+"/"+t[3]+xd(s,t[4].length))}(o,l,c);if(n.match(/^#+0+$/))return c+K1(l,n.length-n.indexOf("0"));if(o=n.match(nP))return i=oP(e,o[1].length).replace(/^([^\.]+)$/,"$1."+tc(o[1])).replace(/\.$/,"."+tc(o[1])).replace(/\.(\d*)$/,function(k,T){return"."+T+Na("0",tc(o[1]).length-T.length)}),-1!==n.indexOf("0.")?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return c+oP(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return c+tm(K1(l,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+ju(t,n,-e):tm(""+(Math.floor(e)+function OG(t,n){return n<(""+Math.round((t-Math.floor(t))*Math.pow(10,n))).length?1:0}(e,o[1].length)))+"."+xd(aP(e,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return ju(t,n.replace(/^#,#*,/,""),e);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=X1(ju(t,n.replace(/[\\-]/g,""),e)),a=0,X1(X1(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return a<i.length?i.charAt(a++):"0"===k?"0":""}));if(n.match(iP))return"("+(i=ju(t,"##########",e)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),s=Ew(l,Math.pow(10,a)-1,!1),i=""+c," "==(f=Ah("n",o[1],s[1])).charAt(f.length-1)&&(f=f.substr(0,f.length-1)+"0"),i+=f+o[2]+"/"+o[3],(f=xw(s[2],a)).length<o[4].length&&(f=tc(o[4].substr(o[4].length-f.length))+f),i+=f;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),c+((s=Ew(l,Math.pow(10,a)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?J5(s[1],a)+o[2]+"/"+o[3]+xw(s[2],a):Na(" ",2*a+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return i=K1(e,0),n.length<=i.length?i:tc(n.substr(0,n.length-i.length))+i;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var v=n.indexOf(".")-a,E=n.length-i.length-v;return tc(n.substr(0,v)+i+n.substr(n.length-E))}if(o=n.match(/^00,000\.([#0]*0)$/))return a=aP(e,o[1].length),e<0?"-"+ju(t,n,-e):tm(function NG(t){return t<2147483647&&t>-2147483648?""+(t>=0?0|t:t-1|0):""+Math.floor(t)}(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?xd(0,3-k.length):"")+k})+"."+xd(a,o[1].length);switch(n){case"###,##0.00":return ju(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var D=tm(K1(l,0));return"0"!==D?c+D:"";case"###,###.00":return ju(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return ju(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function sP(t,n){var e,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+sP(t,-n);var i=t.indexOf(".");-1===i&&(i=t.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),!(e=(n/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).match(/[Ee]/)){var a=Math.floor(Math.log(n)*Math.LOG10E);-1===e.indexOf(".")?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+o):e+="E+"+(a-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(s,l,c,f){return l+c+f.substr(0,(i+o)%i)+"."+f.substr(o)+"E"})}else e=n.toExponential(r);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Sf(t,n,e){if(40===t.charCodeAt(0)&&!n.match(rP)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Sf("n",r,e):"("+Sf("n",r,-e)+")"}if(44===n.charCodeAt(n.length-1))return function RG(t,n,e){for(var r=n.length-1;44===n.charCodeAt(r-1);)--r;return Ah(t,n.substr(0,r),e/Math.pow(10,3*(n.length-r)))}(t,n,e);if(-1!==n.indexOf("%"))return function LG(t,n,e){var r=n.replace(JI,""),i=n.length-r.length;return Ah(t,r,e*Math.pow(10,2*i))+Na("%",i)}(t,n,e);if(-1!==n.indexOf("E"))return sP(n,e);if(36===n.charCodeAt(0))return"$"+Sf(t,n.substr(" "==n.charAt(1)?2:1),e);var i,o,a,s,l=Math.abs(e),c=e<0?"-":"";if(n.match(/^00+$/))return c+xd(l,n.length);if(n.match(/^[#?]+$/))return i=""+e,0===e&&(i=""),i.length>n.length?i:tc(n.substr(0,n.length-i.length))+i;if(o=n.match(tP))return function PG(t,n,e){return e+(0===n?"":""+n)+Na(" ",t[1].length+2+t[4].length)}(o,l,c);if(n.match(/^#+0+$/))return c+xd(l,n.length-n.indexOf("0"));if(o=n.match(nP))return i=(i=(""+e).replace(/^([^\.]+)$/,"$1."+tc(o[1])).replace(/\.$/,"."+tc(o[1]))).replace(/\.(\d*)$/,function(k,T){return"."+T+Na("0",tc(o[1]).length-T.length)}),-1!==n.indexOf("0.")?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return c+tm(""+l);if(o=n.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Sf(t,n,-e):tm(""+e)+"."+Na("0",o[1].length);if(o=n.match(/^#,#*,#0/))return Sf(t,n.replace(/^#,#*,/,""),e);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=X1(Sf(t,n.replace(/[\\-]/g,""),e)),a=0,X1(X1(n.replace(/\\/g,"")).replace(/[0#]/g,function(k){return a<i.length?i.charAt(a++):"0"===k?"0":""}));if(n.match(iP))return"("+(i=Sf(t,"##########",e)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),s=Ew(l,Math.pow(10,a)-1,!1),i=""+c," "==(f=Ah("n",o[1],s[1])).charAt(f.length-1)&&(f=f.substr(0,f.length-1)+"0"),i+=f+o[2]+"/"+o[3],(f=xw(s[2],a)).length<o[4].length&&(f=tc(o[4].substr(o[4].length-f.length))+f),i+=f;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),c+((s=Ew(l,Math.pow(10,a)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?J5(s[1],a)+o[2]+"/"+o[3]+xw(s[2],a):Na(" ",2*a+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return n.length<=(i=""+e).length?i:tc(n.substr(0,n.length-i.length))+i;if(o=n.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var v=n.indexOf(".")-a,E=n.length-i.length-v;return tc(n.substr(0,v)+i+n.substr(n.length-E))}if(o=n.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Sf(t,n,-e):tm(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?xd(0,3-k.length):"")+k})+"."+xd(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var D=tm(""+l);return"0"!==D?c+D:"";default:if(n.match(/\.[0#?]*$/))return Sf(t,n.slice(0,n.lastIndexOf(".")),e)+tc(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Ah(t,n,e){return(0|e)===e?Sf(t,n,e):ju(t,n,e)}var lP=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Og(t){for(var n=0,e="",r="";n<t.length;)switch(e=t.charAt(n)){case"G":Cw(t,n)&&(n+=6),n++;break;case'"':for(;34!==t.charCodeAt(++n)&&n<t.length;);++n;break;case"\\":case"_":n+=2;break;case"@":++n;break;case"B":case"b":if("1"===t.charAt(n+1)||"2"===t.charAt(n+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===t.substr(n,3).toUpperCase()||"AM/PM"===t.substr(n,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===t.substr(n,5).toUpperCase())return!0;++n;break;case"[":for(r=e;"]"!==t.charAt(n++)&&n<t.length;)r+=t.charAt(n);if(r.match(lP))return!0;break;case".":case"0":case"#":for(;n<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++n))>-1||"\\"==e&&"-"==t.charAt(n+1)&&"0#".indexOf(t.charAt(n+2))>-1););break;case"?":for(;t.charAt(++n)===e;);break;case"*":++n,(" "==t.charAt(n)||"*"==t.charAt(n))&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<t.length&&"0123456789".indexOf(t.charAt(++n))>-1;);break;default:++n}return!1}var cP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function uP(t,n){if(null==n)return!1;var e=parseFloat(n[2]);switch(n[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0}return!1}function tu(t,n,e){null==e&&(e={});var r="";switch(typeof t){case"string":r="m/d/yy"==t&&e.dateNF?e.dateNF:t;break;case"number":null==(r=14==t&&e.dateNF?e.dateNF:(null!=e.table?e.table:qr)[t])&&(r=e.table&&e.table[KI[t]]||qr[KI[t]]),null==r&&(r=xG[t]||"General")}if(Cw(r,0))return Pg(n,e);n instanceof Date&&(n=QI(n,e.date1904));var i=function VG(t,n){var e=function BG(t){for(var n=[],e=!1,r=0,i=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:e=!e;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=t.substr(i,r-i),i=r+1}if(n[n.length]=t.substr(i),!0===e)throw new Error("Format |"+t+"| unterminated string ");return n}(t),r=e.length,i=e[r-1].indexOf("@");if(r<4&&i>-1&&--r,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if("number"!=typeof n)return[4,4===e.length||i>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"]}var o=n>0?e[0]:n<0?e[1]:e[2];if(-1===e[0].indexOf("[")&&-1===e[1].indexOf("["))return[r,o];if(null!=e[0].match(/\[[=<>]/)||null!=e[1].match(/\[[=<>]/)){var a=e[0].match(cP),s=e[1].match(cP);return uP(n,a)?[r,e[0]]:uP(n,s)?[r,e[1]]:[r,e[null!=a&&null!=s?2:1]]}return[r,o]}(r,n);if(Cw(i[1]))return Pg(n,e);if(!0===n)n="TRUE";else if(!1===n)n="FALSE";else if(""===n||null==n)return"";return function jG(t,n,e,r){for(var c,f,v,i=[],o="",a=0,s="",l="t",E="H";a<t.length;)switch(s=t.charAt(a)){case"G":if(!Cw(t,a))throw new Error("unrecognized character "+s+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(o="";34!==(v=t.charCodeAt(++a))&&a<t.length;)o+=String.fromCharCode(v);i[i.length]={t:"t",v:o},++a;break;case"\\":var D=t.charAt(++a);i[i.length]={t:"("===D||")"===D?D:"t",v:D},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:n},++a;break;case"B":case"b":if("1"===t.charAt(a+1)||"2"===t.charAt(a+1)){if(null==c&&null==(c=em(n,e,"2"===t.charAt(a+1))))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=s,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||null==c&&null==(c=em(n,e)))return"";for(o=s;++a<t.length&&t.charAt(a).toLowerCase()===s;)o+=s;"m"===s&&"h"===l.toLowerCase()&&(s="M"),"h"===s&&(s=E),i[i.length]={t:s,v:o},l=s;break;case"A":case"a":case"\u4e0a":var T={t:s,v:s};if(null==c&&(c=em(n,e)),"A/P"===t.substr(a,3).toUpperCase()?(null!=c&&(T.v=c.H>=12?"P":"A"),T.t="T",E="h",a+=3):"AM/PM"===t.substr(a,5).toUpperCase()?(null!=c&&(T.v=c.H>=12?"PM":"AM"),T.t="T",a+=5,E="h"):"\u4e0a\u5348/\u4e0b\u5348"===t.substr(a,5).toUpperCase()?(null!=c&&(T.v=c.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),T.t="T",a+=5,E="h"):(T.t="t",++a),null==c&&"T"===T.t)return"";i[i.length]=T,l=s;break;case"[":for(o=s;"]"!==t.charAt(a++)&&a<t.length;)o+=t.charAt(a);if("]"!==o.slice(-1))throw'unterminated "[" block: |'+o+"|";if(o.match(lP)){if(null==c&&null==(c=em(n,e)))return"";i[i.length]={t:"Z",v:o.toLowerCase()},l=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Og(t)||(i[i.length]={t:"t",v:o}));break;case".":if(null!=c){for(o=s;++a<t.length&&"0"===(s=t.charAt(a));)o+=s;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=s;++a<t.length&&"0#?.,E+-%".indexOf(s=t.charAt(a))>-1;)o+=s;i[i.length]={t:"n",v:o};break;case"?":for(o=s;t.charAt(++a)===s;)o+=s;i[i.length]={t:s,v:o},l=s;break;case"*":++a,(" "==t.charAt(a)||"*"==t.charAt(a))&&++a;break;case"(":case")":i[i.length]={t:1===r?"t":s,v:s},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=s;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)o+=t.charAt(a);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:s,v:s},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(s))throw new Error("unrecognized character "+s+" in "+t);i[i.length]={t:"t",v:s},++a}var Z,R=0,q=0;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=E,l="h",R<1&&(R=1);break;case"s":(Z=i[a].v.match(/\.0+$/))&&(q=Math.max(q,Z[0].length-1)),R<3&&(R=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":"s"===l&&(i[a].t="M",R<2&&(R=2));break;case"X":break;case"Z":R<1&&i[a].v.match(/[Hh]/)&&(R=1),R<2&&i[a].v.match(/[Mm]/)&&(R=2),R<3&&i[a].v.match(/[Ss]/)&&(R=3)}switch(R){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M)}var Ee,W="";for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=MG(i[a].t.charCodeAt(0),i[a].v,c,q),i[a].t="t";break;case"n":case"?":for(Ee=a+1;null!=i[Ee]&&("?"===(s=i[Ee].t)||"D"===s||(" "===s||"t"===s)&&null!=i[Ee+1]&&("?"===i[Ee+1].t||"t"===i[Ee+1].t&&"/"===i[Ee+1].v)||"("===i[a].t&&(" "===s||"n"===s||")"===s)||"t"===s&&("/"===i[Ee].v||" "===i[Ee].v&&null!=i[Ee+1]&&"?"==i[Ee+1].t));)i[a].v+=i[Ee].v,i[Ee]={v:"",t:";"},++Ee;W+=i[a].v,a=Ee-1;break;case"G":i[a].t="t",i[a].v=Pg(n,e)}var Pe,ge,Le="";if(W.length>0){40==W.charCodeAt(0)?(Pe=n<0&&45===W.charCodeAt(0)?-n:n,ge=Ah("n",W,Pe)):(ge=Ah("n",W,Pe=n<0&&r>1?-n:n),Pe<0&&i[0]&&"t"==i[0].t&&(ge=ge.substr(1),i[0].v="-"+i[0].v)),Ee=ge.length-1;var Ye=i.length;for(a=0;a<i.length;++a)if(null!=i[a]&&"t"!=i[a].t&&i[a].v.indexOf(".")>-1){Ye=a;break}var Ge=i.length;if(Ye===i.length&&-1===ge.indexOf("E")){for(a=i.length-1;a>=0;--a)null==i[a]||-1==="n?".indexOf(i[a].t)||(Ee>=i[a].v.length-1?i[a].v=ge.substr(1+(Ee-=i[a].v.length),i[a].v.length):Ee<0?i[a].v="":(i[a].v=ge.substr(0,Ee+1),Ee=-1),i[a].t="t",Ge=a);Ee>=0&&Ge<i.length&&(i[Ge].v=ge.substr(0,Ee+1)+i[Ge].v)}else if(Ye!==i.length&&-1===ge.indexOf("E")){for(Ee=ge.indexOf(".")-1,a=Ye;a>=0;--a)if(null!=i[a]&&-1!=="n?".indexOf(i[a].t)){for(f=i[a].v.indexOf(".")>-1&&a===Ye?i[a].v.indexOf(".")-1:i[a].v.length-1,Le=i[a].v.substr(f+1);f>=0;--f)Ee>=0&&("0"===i[a].v.charAt(f)||"#"===i[a].v.charAt(f))&&(Le=ge.charAt(Ee--)+Le);i[a].v=Le,i[a].t="t",Ge=a}for(Ee>=0&&Ge<i.length&&(i[Ge].v=ge.substr(0,Ee+1)+i[Ge].v),Ee=ge.indexOf(".")+1,a=Ye;a<i.length;++a)if(null!=i[a]&&(-1!=="n?(".indexOf(i[a].t)||a===Ye)){for(f=i[a].v.indexOf(".")>-1&&a===Ye?i[a].v.indexOf(".")+1:0,Le=i[a].v.substr(0,f);f<i[a].v.length;++f)Ee<ge.length&&(Le+=ge.charAt(Ee++));i[a].v=Le,i[a].t="t",Ge=a}}}for(a=0;a<i.length;++a)null!=i[a]&&"n?".indexOf(i[a].t)>-1&&(i[a].v=Ah(i[a].t,i[a].v,Pe=r>1&&n<0&&a>0&&"-"===i[a-1].v?-n:n),i[a].t="t");var wt="";for(a=0;a!==i.length;++a)null!=i[a]&&(wt+=i[a].v);return wt}(i[1],n,e,i[0])}function Df(t,n){if("number"!=typeof n){n=+n||-1;for(var e=0;e<392;++e)if(null!=qr[e]){if(qr[e]==t){n=e;break}}else n<0&&(n=e);n<0&&(n=391)}return qr[n]=t,n}function sb(t){for(var n=0;392!=n;++n)void 0!==t[n]&&Df(t[n],n)}function Z1(){qr=function wG(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',t}()}var HG={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dP=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,WG=function(){var t={version:"1.2.0"},e=function n(){for(var ge=0,Ye=new Array(256),Ge=0;256!=Ge;++Ge)Ye[Ge]=ge=1&(ge=1&(ge=1&(ge=1&(ge=1&(ge=1&(ge=1&(ge=1&(ge=Ge)?-306674912^ge>>>1:ge>>>1)?-306674912^ge>>>1:ge>>>1)?-306674912^ge>>>1:ge>>>1)?-306674912^ge>>>1:ge>>>1)?-306674912^ge>>>1:ge>>>1)?-306674912^ge>>>1:ge>>>1)?-306674912^ge>>>1:ge>>>1)?-306674912^ge>>>1:ge>>>1;return typeof Int32Array<"u"?new Int32Array(Ye):Ye}(),i=function r(ge){var Ye=0,Ge=0,wt=0,Mt=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(wt=0;256!=wt;++wt)Mt[wt]=ge[wt];for(wt=0;256!=wt;++wt)for(Ge=ge[wt],Ye=256+wt;Ye<4096;Ye+=256)Ge=Mt[Ye]=Ge>>>8^ge[255&Ge];var Qe=[];for(wt=1;16!=wt;++wt)Qe[wt-1]=typeof Int32Array<"u"?Mt.subarray(256*wt,256*wt+256):Mt.slice(256*wt,256*wt+256);return Qe}(e),o=i[0],a=i[1],s=i[2],l=i[3],c=i[4],f=i[5],v=i[6],E=i[7],D=i[8],k=i[9],T=i[10],R=i[11],q=i[12],Z=i[13],W=i[14];return t.table=e,t.bstr=function Ee(ge,Ye){for(var Ge=-1^Ye,wt=0,Mt=ge.length;wt<Mt;)Ge=Ge>>>8^e[255&(Ge^ge.charCodeAt(wt++))];return~Ge},t.buf=function Le(ge,Ye){for(var Ge=-1^Ye,wt=ge.length-15,Mt=0;Mt<wt;)Ge=W[ge[Mt++]^255&Ge]^Z[ge[Mt++]^Ge>>8&255]^q[ge[Mt++]^Ge>>16&255]^R[ge[Mt++]^Ge>>>24]^T[ge[Mt++]]^k[ge[Mt++]]^D[ge[Mt++]]^E[ge[Mt++]]^v[ge[Mt++]]^f[ge[Mt++]]^c[ge[Mt++]]^l[ge[Mt++]]^s[ge[Mt++]]^a[ge[Mt++]]^o[ge[Mt++]]^e[ge[Mt++]];for(wt+=15;Mt<wt;)Ge=Ge>>>8^e[255&(Ge^ge[Mt++])];return~Ge},t.str=function Pe(ge,Ye){for(var Ge=-1^Ye,wt=0,Mt=ge.length,Qe=0,An=0;wt<Mt;)(Qe=ge.charCodeAt(wt++))<128?Ge=Ge>>>8^e[255&(Ge^Qe)]:Qe<2048?Ge=(Ge=Ge>>>8^e[255&(Ge^(192|Qe>>6&31))])>>>8^e[255&(Ge^(128|63&Qe))]:Qe>=55296&&Qe<57344?(Qe=64+(1023&Qe),An=1023&ge.charCodeAt(wt++),Ge=(Ge=(Ge=(Ge=Ge>>>8^e[255&(Ge^(240|Qe>>8&7))])>>>8^e[255&(Ge^(128|Qe>>2&63))])>>>8^e[255&(Ge^(128|An>>6&15|(3&Qe)<<4))])>>>8^e[255&(Ge^(128|63&An))]):Ge=(Ge=(Ge=Ge>>>8^e[255&(Ge^(224|Qe>>12&15))])>>>8^e[255&(Ge^(128|Qe>>6&63))])>>>8^e[255&(Ge^(128|63&Qe))];return~Ge},t}(),Fr=function(){var l,n={};function r(te){if("/"==te.charAt(te.length-1))return-1===te.slice(0,-1).indexOf("/")?te:r(te.slice(0,-1));var ye=te.lastIndexOf("/");return-1===ye?te:te.slice(0,ye+1)}function i(te){if("/"==te.charAt(te.length-1))return i(te.slice(0,-1));var ye=te.lastIndexOf("/");return-1===ye?te:te.slice(ye+1)}function o(te,ye){"string"==typeof ye&&(ye=new Date(ye));var ue=ye.getHours();ue=(ue=ue<<6|ye.getMinutes())<<5|ye.getSeconds()>>>1,te.write_shift(2,ue);var pe=ye.getFullYear()-1980;pe=(pe=pe<<4|ye.getMonth()+1)<<5|ye.getDate(),te.write_shift(2,pe)}function s(te){hl(te,0);for(var ye={},ue=0;te.l<=te.length-4;){var pe=te.read_shift(2),Ce=te.read_shift(2),Se=te.l+Ce,yt={};21589===pe&&(1&(ue=te.read_shift(1))&&(yt.mtime=te.read_shift(4)),Ce>5&&(2&ue&&(yt.atime=te.read_shift(4)),4&ue&&(yt.ctime=te.read_shift(4))),yt.mtime&&(yt.mt=new Date(1e3*yt.mtime))),te.l=Se,ye[pe]=yt}return ye}function c(){return l||(l={})}function f(te,ye){if(80==te[0]&&75==te[1])return wL(te,ye);if(109==(32|te[0])&&105==(32|te[1]))return function _ve(te,ye){if("mime-version:"!=mn(te.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var ue=ye&&ye.root||"",pe=(Mi&&Buffer.isBuffer(te)?te.toString("binary"):mn(te)).split("\r\n"),Ce=0,Se="";for(Ce=0;Ce<pe.length;++Ce)if(/^Content-Location:/i.test(Se=pe[Ce])&&(Se=Se.slice(Se.indexOf("file")),ue||(ue=Se.slice(0,Se.lastIndexOf("/")+1)),Se.slice(0,ue.length)!=ue))for(;ue.length>0&&(ue=(ue=ue.slice(0,ue.length-1)).slice(0,ue.lastIndexOf("/")+1),Se.slice(0,ue.length)!=ue););var yt=(pe[1]||"").match(/boundary="(.*?)"/);if(!yt)throw new Error("MAD cannot find boundary");var $t="--"+(yt[1]||""),Dt={FileIndex:[],FullPaths:[]};ge(Dt);var Mn,Un=0;for(Ce=0;Ce<pe.length;++Ce){var vr=pe[Ce];vr!==$t&&vr!==$t+"--"||(Un++&&gve(Dt,pe.slice(Mn,Ce),ue),Mn=Ce)}return Dt}(te,ye);if(te.length<512)throw new Error("CFB file size "+te.length+" < 512");var ue,Ce,Se,yt,$t,Ct,pe=512,xt=[],Dt=te.slice(0,512);hl(Dt,0);var Mn=function v(te){if(80==te[te.l]&&75==te[te.l+1])return[0,0];te.chk(rr,"Header Signature: "),te.l+=16;var ye=te.read_shift(2,"u");return[te.read_shift(2,"u"),ye]}(Dt);switch(ue=Mn[0]){case 3:pe=512;break;case 4:pe=4096;break;case 0:if(0==Mn[1])return wL(te,ye);default:throw new Error("Major Version: Expected 3 or 4 saw "+ue)}512!==pe&&hl(Dt=te.slice(0,pe),28);var Un=te.slice(0,pe);!function E(te,ye){var ue;switch(te.l+=2,ue=te.read_shift(2)){case 9:if(3!=ye)throw new Error("Sector Shift: Expected 9 saw "+ue);break;case 12:if(4!=ye)throw new Error("Sector Shift: Expected 12 saw "+ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ue)}te.chk("0600","Mini Sector Shift: "),te.chk("000000000000","Reserved: ")}(Dt,ue);var vr=Dt.read_shift(4,"i");if(3===ue&&0!==vr)throw new Error("# Directory Sectors: Expected 0 saw "+vr);Dt.l+=4,yt=Dt.read_shift(4,"i"),Dt.l+=4,Dt.chk("00100000","Mini Stream Cutoff Size: "),$t=Dt.read_shift(4,"i"),Ce=Dt.read_shift(4,"i"),Ct=Dt.read_shift(4,"i"),Se=Dt.read_shift(4,"i");for(var Hn=-1,Gn=0;Gn<109&&!((Hn=Dt.read_shift(4,"i"))<0);++Gn)xt[Gn]=Hn;var pi=function D(te,ye){for(var ue=Math.ceil(te.length/ye)-1,pe=[],Ce=1;Ce<ue;++Ce)pe[Ce-1]=te.slice(Ce*ye,(Ce+1)*ye);return pe[ue-1]=te.slice(ue*ye),pe}(te,pe);R(Ct,Se,pi,pe,xt);var sa=function Z(te,ye,ue,pe){var Ce=te.length,Se=[],yt=[],$t=[],Ct=[],xt=pe-1,Dt=0,Mn=0,Un=0,vr=0;for(Dt=0;Dt<Ce;++Dt)if($t=[],(Un=Dt+ye)>=Ce&&(Un-=Ce),!yt[Un]){Ct=[];var Hn=[];for(Mn=Un;Mn>=0;){Hn[Mn]=!0,yt[Mn]=!0,$t[$t.length]=Mn,Ct.push(te[Mn]);var Gn=ue[Math.floor(4*Mn/pe)];if(pe<4+(vr=4*Mn&xt))throw new Error("FAT boundary crossed: "+Mn+" 4 "+pe);if(!te[Gn]||Hn[Mn=Rg(te[Gn],vr)])break}Se[Un]={nodes:$t,data:PP([Ct])}}return Se}(pi,yt,xt,pe);sa[yt].name="!Directory",Ce>0&&$t!==An&&(sa[$t].name="!MiniFAT"),sa[xt[0]].name="!FAT",sa.fat_addrs=xt,sa.ssz=pe;var gs=[],fu=[],l2=[];(function W(te,ye,ue,pe,Ce,Se,yt,$t){for(var vr,Ct=0,xt=pe.length?2:0,Dt=ye[te].data,Mn=0,Un=0;Mn<Dt.length;Mn+=128){var Hn=Dt.slice(Mn,Mn+128);hl(Hn,64),Un=Hn.read_shift(2),vr=kw(Hn,0,Un-xt),pe.push(vr);var Gn={name:vr,type:Hn.read_shift(1),color:Hn.read_shift(1),L:Hn.read_shift(4,"i"),R:Hn.read_shift(4,"i"),C:Hn.read_shift(4,"i"),clsid:Hn.read_shift(16),state:Hn.read_shift(4,"i"),start:0,size:0};0!==Hn.read_shift(2)+Hn.read_shift(2)+Hn.read_shift(2)+Hn.read_shift(2)&&(Gn.ct=Ee(Hn,Hn.l-8)),0!==Hn.read_shift(2)+Hn.read_shift(2)+Hn.read_shift(2)+Hn.read_shift(2)&&(Gn.mt=Ee(Hn,Hn.l-8)),Gn.start=Hn.read_shift(4,"i"),Gn.size=Hn.read_shift(4,"i"),Gn.size<0&&Gn.start<0&&(Gn.size=Gn.type=0,Gn.start=An,Gn.name=""),5===Gn.type?(Ct=Gn.start,Ce>0&&Ct!==An&&(ye[Ct].name="!StreamData")):Gn.size>=4096?(Gn.storage="fat",void 0===ye[Gn.start]&&(ye[Gn.start]=q(ue,Gn.start,ye.fat_addrs,ye.ssz)),ye[Gn.start].name=Gn.name,Gn.content=ye[Gn.start].data.slice(0,Gn.size)):(Gn.storage="minifat",Gn.size<0?Gn.size=0:Ct!==An&&Gn.start!==An&&ye[Ct]&&(Gn.content=T(Gn,ye[Ct].data,(ye[$t]||{}).data))),Gn.content&&hl(Gn.content,0),Se[vr]=Gn,yt.push(Gn)}})(yt,sa,pi,gs,Ce,{},fu,$t),function k(te,ye,ue){for(var pe=0,Ce=0,Se=0,yt=0,$t=0,Ct=ue.length,xt=[],Dt=[];pe<Ct;++pe)xt[pe]=Dt[pe]=pe,ye[pe]=ue[pe];for(;$t<Dt.length;++$t)Ce=te[pe=Dt[$t]].L,Se=te[pe].R,yt=te[pe].C,xt[pe]===pe&&(-1!==Ce&&xt[Ce]!==Ce&&(xt[pe]=xt[Ce]),-1!==Se&&xt[Se]!==Se&&(xt[pe]=xt[Se])),-1!==yt&&(xt[yt]=pe),-1!==Ce&&pe!=xt[pe]&&(xt[Ce]=xt[pe],Dt.lastIndexOf(Ce)<$t&&Dt.push(Ce)),-1!==Se&&pe!=xt[pe]&&(xt[Se]=xt[pe],Dt.lastIndexOf(Se)<$t&&Dt.push(Se));for(pe=1;pe<Ct;++pe)xt[pe]===pe&&(-1!==Se&&xt[Se]!==Se?xt[pe]=xt[Se]:-1!==Ce&&xt[Ce]!==Ce&&(xt[pe]=xt[Ce]));for(pe=1;pe<Ct;++pe)if(0!==te[pe].type){if(($t=pe)!=xt[$t])do{ye[pe]=ye[$t=xt[$t]]+"/"+ye[pe]}while(0!==$t&&-1!==xt[$t]&&$t!=xt[$t]);xt[pe]=-1}for(ye[0]+="/",pe=1;pe<Ct;++pe)2!==te[pe].type&&(ye[pe]+="/")}(fu,l2,gs),gs.shift();var c2={FileIndex:fu,FullPaths:l2};return ye&&ye.raw&&(c2.raw={header:Un,sectors:pi}),c2}function T(te,ye,ue){for(var Ce=te.size,Se=[],yt=te.start;ue&&Ce>0&&yt>=0;)Se.push(ye.slice(yt*Qe,yt*Qe+Qe)),Ce-=Qe,yt=Rg(ue,4*yt);return 0===Se.length?Ut(0):zs(Se).slice(0,te.size)}function R(te,ye,ue,pe,Ce){var Se=An;if(te===An){if(0!==ye)throw new Error("DIFAT chain shorter than expected")}else if(-1!==te){var yt=ue[te],$t=(pe>>>2)-1;if(!yt)return;for(var Ct=0;Ct<$t&&(Se=Rg(yt,4*Ct))!==An;++Ct)Ce.push(Se);R(Rg(yt,pe-4),ye-1,ue,pe,Ce)}}function q(te,ye,ue,pe,Ce){var Se=[],yt=[];Ce||(Ce=[]);var $t=pe-1,Ct=0,xt=0;for(Ct=ye;Ct>=0;){Ce[Ct]=!0,Se[Se.length]=Ct,yt.push(te[Ct]);var Dt=ue[Math.floor(4*Ct/pe)];if(pe<4+(xt=4*Ct&$t))throw new Error("FAT boundary crossed: "+Ct+" 4 "+pe);if(!te[Dt])break;Ct=Rg(te[Dt],xt)}return{nodes:Se,data:PP([yt])}}function Ee(te,ye){return new Date(1e3*($s(te,ye+4)/1e7*Math.pow(2,32)+$s(te,ye)/1e7-11644473600))}function ge(te,ye){var ue=ye||{},pe=ue.root||"Root Entry";if(te.FullPaths||(te.FullPaths=[]),te.FileIndex||(te.FileIndex=[]),te.FullPaths.length!==te.FileIndex.length)throw new Error("inconsistent CFB structure");0===te.FullPaths.length&&(te.FullPaths[0]=pe+"/",te.FileIndex[0]={name:pe,type:5}),ue.CLSID&&(te.FileIndex[0].clsid=ue.CLSID),function Ye(te){var ye="\x01Sh33tJ5";if(!Fr.find(te,"/"+ye)){var ue=Ut(4);ue[0]=55,ue[1]=ue[3]=50,ue[2]=54,te.FileIndex.push({name:ye,type:2,content:ue,size:4,L:69,R:69,C:69}),te.FullPaths.push(te.FullPaths[0]+ye),Ge(te)}}(te)}function Ge(te,ye){ge(te);for(var ue=!1,pe=!1,Ce=te.FullPaths.length-1;Ce>=0;--Ce){var Se=te.FileIndex[Ce];switch(Se.type){case 0:pe?ue=!0:(te.FileIndex.pop(),te.FullPaths.pop());break;case 1:case 2:case 5:pe=!0,isNaN(Se.R*Se.L*Se.C)&&(ue=!0),Se.R>-1&&Se.L>-1&&Se.R==Se.L&&(ue=!0);break;default:ue=!0}}if(ue||ye){var yt=new Date(1987,1,19),$t=0,Ct=Object.create?Object.create(null):{},xt=[];for(Ce=0;Ce<te.FullPaths.length;++Ce)Ct[te.FullPaths[Ce]]=!0,0!==te.FileIndex[Ce].type&&xt.push([te.FullPaths[Ce],te.FileIndex[Ce]]);for(Ce=0;Ce<xt.length;++Ce){var Dt=r(xt[Ce][0]);(pe=Ct[Dt])||(xt.push([Dt,{name:i(Dt).replace("/",""),type:1,clsid:rn,ct:yt,mt:yt,content:null}]),Ct[Dt]=!0)}for(xt.sort(function(vr,Hn){return function e(te,ye){for(var ue=te.split("/"),pe=ye.split("/"),Ce=0,Se=0,yt=Math.min(ue.length,pe.length);Ce<yt;++Ce){if(Se=ue[Ce].length-pe[Ce].length)return Se;if(ue[Ce]!=pe[Ce])return ue[Ce]<pe[Ce]?-1:1}return ue.length-pe.length}(vr[0],Hn[0])}),te.FullPaths=[],te.FileIndex=[],Ce=0;Ce<xt.length;++Ce)te.FullPaths[Ce]=xt[Ce][0],te.FileIndex[Ce]=xt[Ce][1];for(Ce=0;Ce<xt.length;++Ce){var Mn=te.FileIndex[Ce],Un=te.FullPaths[Ce];if(Mn.name=i(Un).replace("/",""),Mn.L=Mn.R=Mn.C=-(Mn.color=1),Mn.size=Mn.content?Mn.content.length:0,Mn.start=0,Mn.clsid=Mn.clsid||rn,0===Ce)Mn.C=xt.length>1?1:-1,Mn.size=0,Mn.type=5;else if("/"==Un.slice(-1)){for($t=Ce+1;$t<xt.length&&r(te.FullPaths[$t])!=Un;++$t);for(Mn.C=$t>=xt.length?-1:$t,$t=Ce+1;$t<xt.length&&r(te.FullPaths[$t])!=r(Un);++$t);Mn.R=$t>=xt.length?-1:$t,Mn.type=1}else r(te.FullPaths[Ce+1]||"")==r(Un)&&(Mn.R=Ce+1),Mn.type=2}}}function wt(te,ye){var ue=ye||{};if("mad"==ue.fileType)return function vve(te,ye){for(var ue=ye||{},pe=ue.boundary||"SheetJS",Ce=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(pe="------="+pe).slice(2)+'"',"","",""],Se=te.FullPaths[0],yt=Se,$t=te.FileIndex[0],Ct=1;Ct<te.FullPaths.length;++Ct)if(yt=te.FullPaths[Ct].slice(Se.length),($t=te.FileIndex[Ct]).size&&$t.content&&"\x01Sh33tJ5"!=yt){yt=yt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pi){return"_x"+pi.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pi){return"_u"+pi.charCodeAt(0).toString(16)+"_"});for(var xt=$t.content,Dt=Mi&&Buffer.isBuffer(xt)?xt.toString("binary"):mn(xt),Mn=0,Un=Math.min(1024,Dt.length),vr=0,Hn=0;Hn<=Un;++Hn)(vr=Dt.charCodeAt(Hn))>=32&&vr<128&&++Mn;var Gn=Mn>=4*Un/5;Ce.push(pe),Ce.push("Content-Location: "+(ue.root||"file:///C:/SheetJS/")+yt),Ce.push("Content-Transfer-Encoding: "+(Gn?"quoted-printable":"base64")),Ce.push("Content-Type: "+fve($t,yt)),Ce.push(""),Ce.push(Gn?pve(Dt):hve(Dt))}return Ce.push(pe+"--\r\n"),Ce.join("\r\n")}(te,ue);if("zip"===(Ge(te),ue.fileType))return function dve(te,ye){var ue=ye||{},pe=[],Ce=[],Se=Ut(1),yt=ue.compression?8:0,$t=0,xt=0,Dt=0,Mn=0,Un=0,vr=te.FullPaths[0],Hn=vr,Gn=te.FileIndex[0],pi=[],sa=0;for(xt=1;xt<te.FullPaths.length;++xt)if(Hn=te.FullPaths[xt].slice(vr.length),(Gn=te.FileIndex[xt]).size&&Gn.content&&"\x01Sh33tJ5"!=Hn){var Tc=Mn,gs=Ut(Hn.length);for(Dt=0;Dt<Hn.length;++Dt)gs.write_shift(1,127&Hn.charCodeAt(Dt));gs=gs.slice(0,gs.l),pi[Un]=WG.buf(Gn.content,0);var fu=Gn.content;8==yt&&(fu=Fe(fu)),(Se=Ut(30)).write_shift(4,67324752),Se.write_shift(2,20),Se.write_shift(2,$t),Se.write_shift(2,yt),Gn.mt?o(Se,Gn.mt):Se.write_shift(4,0),Se.write_shift(-4,8&$t?0:pi[Un]),Se.write_shift(4,8&$t?0:fu.length),Se.write_shift(4,8&$t?0:Gn.content.length),Se.write_shift(2,gs.length),Se.write_shift(2,0),Mn+=Se.length,pe.push(Se),Mn+=gs.length,pe.push(gs),Mn+=fu.length,pe.push(fu),8&$t&&((Se=Ut(12)).write_shift(-4,pi[Un]),Se.write_shift(4,fu.length),Se.write_shift(4,Gn.content.length),Mn+=Se.l,pe.push(Se)),(Se=Ut(46)).write_shift(4,33639248),Se.write_shift(2,0),Se.write_shift(2,20),Se.write_shift(2,$t),Se.write_shift(2,yt),Se.write_shift(4,0),Se.write_shift(-4,pi[Un]),Se.write_shift(4,fu.length),Se.write_shift(4,Gn.content.length),Se.write_shift(2,gs.length),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(4,0),Se.write_shift(4,Tc),sa+=Se.l,Ce.push(Se),sa+=gs.length,Ce.push(gs),++Un}return(Se=Ut(22)).write_shift(4,101010256),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,Un),Se.write_shift(2,Un),Se.write_shift(4,sa),Se.write_shift(4,Mn),Se.write_shift(2,0),zs([zs(pe),zs(Ce),Se])}(te,ue);var pe=function(vr){for(var Hn=0,Gn=0,pi=0;pi<vr.FileIndex.length;++pi){var sa=vr.FileIndex[pi];if(sa.content){var Tc=sa.content.length;Tc>0&&(Tc<4096?Hn+=Tc+63>>6:Gn+=Tc+511>>9)}}for(var gs=vr.FullPaths.length+3>>2,l2=Hn+127>>7,c2=(Hn+7>>3)+Gn+gs+l2,m0=c2+127>>7,BA=m0<=109?0:Math.ceil((m0-109)/127);c2+m0+BA+127>>7>m0;)BA=++m0<=109?0:Math.ceil((m0-109)/127);var Vh=[1,BA,m0,l2,gs,Gn,Hn,0];return vr.FileIndex[0].size=Hn<<6,Vh[7]=(vr.FileIndex[0].start=Vh[0]+Vh[1]+Vh[2]+Vh[3]+Vh[4]+Vh[5])+(Vh[6]+7>>3),Vh}(te),Ce=Ut(pe[7]<<9),Se=0,yt=0;for(Se=0;Se<8;++Se)Ce.write_shift(1,Nn[Se]);for(Se=0;Se<8;++Se)Ce.write_shift(2,0);for(Ce.write_shift(2,62),Ce.write_shift(2,3),Ce.write_shift(2,65534),Ce.write_shift(2,9),Ce.write_shift(2,6),Se=0;Se<3;++Se)Ce.write_shift(2,0);for(Ce.write_shift(4,0),Ce.write_shift(4,pe[2]),Ce.write_shift(4,pe[0]+pe[1]+pe[2]+pe[3]-1),Ce.write_shift(4,0),Ce.write_shift(4,4096),Ce.write_shift(4,pe[3]?pe[0]+pe[1]+pe[2]-1:An),Ce.write_shift(4,pe[3]),Ce.write_shift(-4,pe[1]?pe[0]-1:An),Ce.write_shift(4,pe[1]),Se=0;Se<109;++Se)Ce.write_shift(-4,Se<pe[2]?pe[1]+Se:-1);if(pe[1])for(yt=0;yt<pe[1];++yt){for(;Se<236+127*yt;++Se)Ce.write_shift(-4,Se<pe[2]?pe[1]+Se:-1);Ce.write_shift(-4,yt===pe[1]-1?An:yt+1)}var $t=function(vr){for(yt+=vr;Se<yt-1;++Se)Ce.write_shift(-4,Se+1);vr&&(++Se,Ce.write_shift(-4,An))};for(yt=Se=0,yt+=pe[1];Se<yt;++Se)Ce.write_shift(-4,an.DIFSECT);for(yt+=pe[2];Se<yt;++Se)Ce.write_shift(-4,an.FATSECT);$t(pe[3]),$t(pe[4]);for(var Ct=0,xt=0,Dt=te.FileIndex[0];Ct<te.FileIndex.length;++Ct)(Dt=te.FileIndex[Ct]).content&&!((xt=Dt.content.length)<4096)&&(Dt.start=yt,$t(xt+511>>9));for($t(pe[6]+7>>3);511&Ce.l;)Ce.write_shift(-4,an.ENDOFCHAIN);for(yt=Se=0,Ct=0;Ct<te.FileIndex.length;++Ct)(Dt=te.FileIndex[Ct]).content&&(xt=Dt.content.length)&&!(xt>=4096)&&(Dt.start=yt,$t(xt+63>>6));for(;511&Ce.l;)Ce.write_shift(-4,an.ENDOFCHAIN);for(Se=0;Se<pe[4]<<2;++Se){var Mn=te.FullPaths[Se];if(Mn&&0!==Mn.length){Dt=te.FileIndex[Se],0===Se&&(Dt.start=Dt.size?Dt.start-1:An);var Un=0===Se&&ue.root||Dt.name;if(xt=2*(Un.length+1),Ce.write_shift(64,Un,"utf16le"),Ce.write_shift(2,xt),Ce.write_shift(1,Dt.type),Ce.write_shift(1,Dt.color),Ce.write_shift(-4,Dt.L),Ce.write_shift(-4,Dt.R),Ce.write_shift(-4,Dt.C),Dt.clsid)Ce.write_shift(16,Dt.clsid,"hex");else for(Ct=0;Ct<4;++Ct)Ce.write_shift(4,0);Ce.write_shift(4,Dt.state||0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,Dt.start),Ce.write_shift(4,Dt.size),Ce.write_shift(4,0)}else{for(Ct=0;Ct<17;++Ct)Ce.write_shift(4,0);for(Ct=0;Ct<3;++Ct)Ce.write_shift(4,-1);for(Ct=0;Ct<12;++Ct)Ce.write_shift(4,0)}}for(Se=1;Se<te.FileIndex.length;++Se)if((Dt=te.FileIndex[Se]).size>=4096)if(Ce.l=Dt.start+1<<9,Mi&&Buffer.isBuffer(Dt.content))Dt.content.copy(Ce,Ce.l,0,Dt.size),Ce.l+=Dt.size+511&-512;else{for(Ct=0;Ct<Dt.size;++Ct)Ce.write_shift(1,Dt.content[Ct]);for(;511&Ct;++Ct)Ce.write_shift(1,0)}for(Se=1;Se<te.FileIndex.length;++Se)if((Dt=te.FileIndex[Se]).size>0&&Dt.size<4096)if(Mi&&Buffer.isBuffer(Dt.content))Dt.content.copy(Ce,Ce.l,0,Dt.size),Ce.l+=Dt.size+63&-64;else{for(Ct=0;Ct<Dt.size;++Ct)Ce.write_shift(1,Dt.content[Ct]);for(;63&Ct;++Ct)Ce.write_shift(1,0)}if(Mi)Ce.l=Ce.length;else for(;Ce.l<Ce.length;)Ce.write_shift(1,0);return Ce}n.version="1.2.1";var qt,Qe=64,An=-2,rr="d0cf11e0a1b11ae1",Nn=[208,207,17,224,161,177,26,225],rn="00000000000000000000000000000000",an={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:An,FREESECT:-1,HEADER_SIGNATURE:rr,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:rn,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function mn(te){for(var ye=new Array(te.length),ue=0;ue<te.length;++ue)ye[ue]=String.fromCharCode(te[ue]);return ye.join("")}function Fe(te){return qt?qt.deflateRawSync(te):Ii(te)}for(var te,ye,Re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Xt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],En=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],bn=typeof Uint8Array<"u",dn=bn?new Uint8Array(256):[],li=0;li<256;++li)dn[li]=(void 0,255&((ye=139536&((te=li)<<1|te<<11)|558144&(te<<5|te<<15))>>16|ye>>8|ye));function ke(te,ye){var ue=dn[255&te];return ye<=8?ue>>>8-ye:(ue=ue<<8|dn[te>>8&255],ye<=16?ue>>>16-ye:(ue=ue<<8|dn[te>>16&255])>>>24-ye)}function To(te,ye){var ue=7&ye,pe=ye>>>3;return(te[pe]|(ue<=6?0:te[pe+1]<<8))>>>ue&3}function Bi(te,ye){var ue=7&ye,pe=ye>>>3;return(te[pe]|(ue<=5?0:te[pe+1]<<8))>>>ue&7}function ji(te,ye){var ue=7&ye,pe=ye>>>3;return(te[pe]|(ue<=3?0:te[pe+1]<<8))>>>ue&31}function er(te,ye){var ue=7&ye,pe=ye>>>3;return(te[pe]|(ue<=1?0:te[pe+1]<<8))>>>ue&127}function Za(te,ye,ue){var pe=7&ye,Ce=ye>>>3,yt=te[Ce]>>>pe;return ue<8-pe||(yt|=te[Ce+1]<<8-pe,ue<16-pe)||(yt|=te[Ce+2]<<16-pe,ue<24-pe)||(yt|=te[Ce+3]<<24-pe),yt&(1<<ue)-1}function Ku(te,ye,ue){var pe=7&ye,Ce=ye>>>3;return pe<=5?te[Ce]|=(7&ue)<<pe:(te[Ce]|=ue<<pe&255,te[Ce+1]=(7&ue)>>8-pe),ye+3}function Rf(te,ye,ue){return te[ye>>>3]|=ue=(1&ue)<<(7&ye),ye+1}function Bh(te,ye,ue){var Ce=ye>>>3;return te[Ce]|=255&(ue<<=7&ye),te[Ce+1]=ue>>>=8,ye+8}function a2(te,ye,ue){var Ce=ye>>>3;return te[Ce]|=255&(ue<<=7&ye),te[Ce+1]=255&(ue>>>=8),te[Ce+2]=ue>>>8,ye+16}function ym(te,ye){var ue=te.length,pe=2*ue>ye?2*ue:ye+5,Ce=0;if(ue>=ye)return te;if(Mi){var Se=GI(pe);if(te.copy)te.copy(Se);else for(;Ce<te.length;++Ce)Se[Ce]=te[Ce];return Se}if(bn){var yt=new Uint8Array(pe);if(yt.set)yt.set(te);else for(;Ce<ue;++Ce)yt[Ce]=te[Ce];return yt}return te.length=pe,te}function du(te){for(var ye=new Array(te),ue=0;ue<te;++ue)ye[ue]=0;return ye}function jh(te,ye,ue){var pe=1,Ce=0,Se=0,yt=0,$t=0,Ct=te.length,xt=bn?new Uint16Array(32):du(32);for(Se=0;Se<32;++Se)xt[Se]=0;for(Se=Ct;Se<ue;++Se)te[Se]=0;Ct=te.length;var Dt=bn?new Uint16Array(Ct):du(Ct);for(Se=0;Se<Ct;++Se)xt[Ce=te[Se]]++,pe<Ce&&(pe=Ce),Dt[Se]=0;for(xt[0]=0,Se=1;Se<=pe;++Se)xt[Se+16]=$t=$t+xt[Se-1]<<1;for(Se=0;Se<Ct;++Se)0!=($t=te[Se])&&(Dt[Se]=xt[$t+16]++);var Mn=0;for(Se=0;Se<Ct;++Se)if(0!=(Mn=te[Se]))for($t=ke(Dt[Se],pe)>>pe-Mn,yt=(1<<pe+4-Mn)-1;yt>=0;--yt)ye[$t|yt<<Mn]=15&Mn|Se<<4;return pe}var wm=bn?new Uint16Array(512):du(512),s2=bn?new Uint16Array(32):du(32);if(!bn){for(var oc=0;oc<512;++oc)wm[oc]=0;for(oc=0;oc<32;++oc)s2[oc]=0}!function(){for(var te=[],ye=0;ye<32;ye++)te.push(5);jh(te,s2,32);var ue=[];for(ye=0;ye<=143;ye++)ue.push(8);for(;ye<=255;ye++)ue.push(9);for(;ye<=279;ye++)ue.push(7);for(;ye<=287;ye++)ue.push(8);jh(ue,wm,288)}();var Lf=function(){for(var ye=bn?new Uint8Array(32768):[],ue=0,pe=0;ue<En.length-1;++ue)for(;pe<En[ue+1];++pe)ye[pe]=ue;for(;pe<32768;++pe)ye[pe]=29;var Ce=bn?new Uint8Array(259):[];for(ue=0,pe=0;ue<Xt.length-1;++ue)for(;pe<Xt[ue+1];++pe)Ce[pe]=ue;return function(Ct,xt){return Ct.length<8?function Se($t,Ct){for(var xt=0;xt<$t.length;){var Dt=Math.min(65535,$t.length-xt);for(Ct.write_shift(1,+(xt+Dt==$t.length)),Ct.write_shift(2,Dt),Ct.write_shift(2,65535&~Dt);Dt-- >0;)Ct[Ct.l++]=$t[xt++]}return Ct.l}(Ct,xt):function yt($t,Ct){for(var xt=0,Dt=0,Mn=bn?new Uint16Array(32768):[];Dt<$t.length;){var Un=Math.min(65535,$t.length-Dt);if(Un<10){for(7&(xt=Ku(Ct,xt,+(Dt+Un==$t.length)))&&(xt+=8-(7&xt)),Ct.l=xt/8|0,Ct.write_shift(2,Un),Ct.write_shift(2,65535&~Un);Un-- >0;)Ct[Ct.l++]=$t[Dt++];xt=8*Ct.l}else{xt=Ku(Ct,xt,+(Dt+Un==$t.length)+2);for(var vr=0;Un-- >0;){var Hn=$t[Dt],Gn=-1,pi=0;if((Gn=Mn[vr=32767&(vr<<5^Hn)])&&((Gn|=-32768&Dt)>Dt&&(Gn-=32768),Gn<Dt))for(;$t[Gn+pi]==$t[Dt+pi]&&pi<250;)++pi;if(pi>2){(Hn=Ce[pi])<=22?xt=Bh(Ct,xt,dn[Hn+1]>>1)-1:(Bh(Ct,xt,3),Bh(Ct,xt+=5,dn[Hn-23]>>5),xt+=3);var sa=Hn<8?0:Hn-4>>2;sa>0&&(a2(Ct,xt,pi-Xt[Hn]),xt+=sa),xt=Bh(Ct,xt,dn[Hn=ye[Dt-Gn]]>>3),xt-=3;var Tc=Hn<4?0:Hn-2>>1;Tc>0&&(a2(Ct,xt,Dt-Gn-En[Hn]),xt+=Tc);for(var gs=0;gs<pi;++gs)Mn[vr]=32767&Dt,vr=32767&(vr<<5^$t[Dt]),++Dt;Un-=pi-1}else Hn<=143?Hn+=48:xt=Rf(Ct,xt,1),xt=Bh(Ct,xt,dn[Hn]),Mn[vr]=32767&Dt,++Dt}xt=Bh(Ct,xt,0)-1}}return Ct.l=(xt+7)/8|0,Ct.l}(Ct,xt)}}();function Ii(te){var ye=Ut(50+Math.floor(1.1*te.length)),ue=Lf(te,ye);return ye.slice(0,ue)}var Qa=bn?new Uint16Array(32768):du(32768),Zu=bn?new Uint16Array(32768):du(32768),Ms=bn?new Uint16Array(128):du(128),p0=1,vL=1;function lve(te,ye){var ue=ji(te,ye)+257,pe=ji(te,ye+=5)+1,Ce=function Mo(te,ye){var ue=7&ye,pe=ye>>>3;return(te[pe]|(ue<=4?0:te[pe+1]<<8))>>>ue&15}(te,ye+=5)+4;ye+=4;for(var Se=0,yt=bn?new Uint8Array(19):du(19),$t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ct=1,xt=bn?new Uint8Array(8):du(8),Dt=bn?new Uint8Array(8):du(8),Mn=yt.length,Un=0;Un<Ce;++Un)yt[Re[Un]]=Se=Bi(te,ye),Ct<Se&&(Ct=Se),xt[Se]++,ye+=3;var vr=0;for(xt[0]=0,Un=1;Un<=Ct;++Un)Dt[Un]=vr=vr+xt[Un-1]<<1;for(Un=0;Un<Mn;++Un)0!=(vr=yt[Un])&&($t[Un]=Dt[vr]++);var Hn=0;for(Un=0;Un<Mn;++Un)if(0!=(Hn=yt[Un])){vr=dn[$t[Un]]>>8-Hn;for(var Gn=(1<<7-Hn)-1;Gn>=0;--Gn)Ms[vr|Gn<<Hn]=7&Hn|Un<<3}var pi=[];for(Ct=1;pi.length<ue+pe;)switch(vr=Ms[er(te,ye)],ye+=7&vr,vr>>>=3){case 16:for(Se=3+To(te,ye),ye+=2,vr=pi[pi.length-1];Se-- >0;)pi.push(vr);break;case 17:for(Se=3+Bi(te,ye),ye+=3;Se-- >0;)pi.push(0);break;case 18:for(Se=11+er(te,ye),ye+=7;Se-- >0;)pi.push(0);break;default:pi.push(vr),Ct<vr&&(Ct=vr)}var sa=pi.slice(0,ue),Tc=pi.slice(ue);for(Un=ue;Un<286;++Un)sa[Un]=0;for(Un=pe;Un<30;++Un)Tc[Un]=0;return p0=jh(sa,Qa,286),vL=jh(Tc,Zu,30),ye}function bL(te,ye){var pe=function cve(te,ye){if(3==te[0]&&!(3&te[1]))return[Qp(ye),2];for(var ue=0,pe=0,Ce=GI(ye||1<<18),Se=0,yt=Ce.length>>>0,$t=0,Ct=0;!(1&pe);)if(pe=Bi(te,ue),ue+=3,pe>>>1)for(pe>>1==1?($t=9,Ct=5):(ue=lve(te,ue),$t=p0,Ct=vL);;){!ye&&yt<Se+32767&&(yt=(Ce=ym(Ce,Se+32767)).length);var Dt=Za(te,ue,$t),Mn=pe>>>1==1?wm[Dt]:Qa[Dt];if(ue+=15&Mn,(Mn>>>=4)>>>8&255){if(256==Mn)break;var Un=(Mn-=257)<8?0:Mn-4>>2;Un>5&&(Un=0);var vr=Se+Xt[Mn];Un>0&&(vr+=Za(te,ue,Un),ue+=Un),Dt=Za(te,ue,Ct),ue+=15&(Mn=pe>>>1==1?s2[Dt]:Zu[Dt]);var Hn=(Mn>>>=4)<4?0:Mn-2>>1,Gn=En[Mn];for(Hn>0&&(Gn+=Za(te,ue,Hn),ue+=Hn),!ye&&yt<vr&&(yt=(Ce=ym(Ce,vr+100)).length);Se<vr;)Ce[Se]=Ce[Se-Gn],++Se}else Ce[Se++]=Mn}else{7&ue&&(ue+=8-(7&ue));var xt=te[ue>>>3]|te[1+(ue>>>3)]<<8;if(ue+=32,xt>0)for(!ye&&yt<Se+xt&&(yt=(Ce=ym(Ce,Se+xt)).length);xt-- >0;)Ce[Se++]=te[ue>>>3],ue+=8}return ye?[Ce,ue+7>>>3]:[Ce.slice(0,Se),ue+7>>>3]}(te.slice(te.l||0),ye);return te.l+=pe[1],pe[0]}function yL(te,ye){if(!te)throw new Error(ye);typeof console<"u"&&console.error(ye)}function wL(te,ye){var ue=te;hl(ue,0);var Se={FileIndex:[],FullPaths:[]};ge(Se,{root:ye.root});for(var yt=ue.length-4;(80!=ue[yt]||75!=ue[yt+1]||5!=ue[yt+2]||6!=ue[yt+3])&&yt>=0;)--yt;ue.l=yt+4,ue.l+=4;var $t=ue.read_shift(2);ue.l+=6;var Ct=ue.read_shift(4);for(ue.l=Ct,yt=0;yt<$t;++yt){ue.l+=20;var xt=ue.read_shift(4),Dt=ue.read_shift(4),Mn=ue.read_shift(2),Un=ue.read_shift(2),vr=ue.read_shift(2);ue.l+=8;var Hn=ue.read_shift(4),Gn=s(ue.slice(ue.l+Mn,ue.l+Mn+Un));ue.l+=Mn+Un+vr;var pi=ue.l;ue.l=Hn+4,uve(ue,xt,Dt,Se,Gn),ue.l=pi}return Se}function uve(te,ye,ue,pe,Ce){te.l+=2;var Se=te.read_shift(2),yt=te.read_shift(2),$t=function a(te){var ye=65535&te.read_shift(2),ue=65535&te.read_shift(2),pe=new Date,Ce=31&ue,Se=15&(ue>>>=5);ue>>>=4,pe.setMilliseconds(0),pe.setFullYear(ue+1980),pe.setMonth(Se-1),pe.setDate(Ce);var yt=31&ye,$t=63&(ye>>>=5);return pe.setHours(ye>>>=6),pe.setMinutes($t),pe.setSeconds(yt<<1),pe}(te);if(8257&Se)throw new Error("Unsupported ZIP encryption");te.read_shift(4);for(var xt=te.read_shift(4),Dt=te.read_shift(4),Mn=te.read_shift(2),Un=te.read_shift(2),vr="",Hn=0;Hn<Mn;++Hn)vr+=String.fromCharCode(te[te.l++]);if(Un){var Gn=s(te.slice(te.l,te.l+Un));(Gn[21589]||{}).mt&&($t=Gn[21589].mt),((Ce||{})[21589]||{}).mt&&($t=Ce[21589].mt)}te.l+=Un;var pi=te.slice(te.l,te.l+xt);switch(yt){case 8:pi=function dt(te,ye){if(!qt)return bL(te,ye);var pe=new(0,qt.InflateRaw),Ce=pe._processChunk(te.slice(te.l),pe._finishFlushFlag);return te.l+=pe.bytesRead,Ce}(te,Dt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+yt)}var sa=!1;8&Se&&(134695760==te.read_shift(4)&&(te.read_shift(4),sa=!0),xt=te.read_shift(4),Dt=te.read_shift(4)),xt!=ye&&yL(sa,"Bad compressed size: "+ye+" != "+xt),Dt!=ue&&yL(sa,"Bad uncompressed size: "+ue+" != "+Dt),LA(pe,vr,pi,{unsafe:!0,mt:$t})}var zx={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function fve(te,ye){if(te.ctype)return te.ctype;var ue=te.name||"",pe=ue.match(/\.([^\.]+)$/);return pe&&zx[pe[1]]||ye&&(pe=(ue=ye).match(/[\.\\]([^\.\\])+$/))&&zx[pe[1]]?zx[pe[1]]:"application/octet-stream"}function hve(te){for(var ye=rb(te),ue=[],pe=0;pe<ye.length;pe+=76)ue.push(ye.slice(pe,pe+76));return ue.join("\r\n")+"\r\n"}function pve(te){var ye=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xt){var Dt=xt.charCodeAt(0).toString(16).toUpperCase();return"="+(1==Dt.length?"0"+Dt:Dt)});"\n"==(ye=ye.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(ye="=0D"+ye.slice(1));for(var ue=[],pe=(ye=ye.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),Ce=0;Ce<pe.length;++Ce){var Se=pe[Ce];if(0!=Se.length)for(var yt=0;yt<Se.length;){var $t=76,Ct=Se.slice(yt,yt+$t);"="==Ct.charAt($t-1)?$t--:"="==Ct.charAt($t-2)?$t-=2:"="==Ct.charAt($t-3)&&($t-=3),Ct=Se.slice(yt,yt+$t),(yt+=$t)<Se.length&&(Ct+="="),ue.push(Ct)}else ue.push("")}return ue.join("\r\n")}function gve(te,ye,ue){for(var yt,pe="",Ce="",Se="",$t=0;$t<10;++$t){var Ct=ye[$t];if(!Ct||Ct.match(/^\s*$/))break;var xt=Ct.match(/^(.*?):\s*([^\s].*)$/);if(xt)switch(xt[1].toLowerCase()){case"content-location":pe=xt[2].trim();break;case"content-type":Se=xt[2].trim();break;case"content-transfer-encoding":Ce=xt[2].trim()}}switch(++$t,Ce.toLowerCase()){case"base64":yt=eu(Jc(ye.slice($t).join("")));break;case"quoted-printable":yt=function mve(te){for(var ye=[],ue=0;ue<te.length;++ue){for(var pe=te[ue];ue<=te.length&&"="==pe.charAt(pe.length-1);)pe=pe.slice(0,pe.length-1)+te[++ue];ye.push(pe)}for(var Ce=0;Ce<ye.length;++Ce)ye[Ce]=ye[Ce].replace(/[=][0-9A-Fa-f]{2}/g,function(Se){return String.fromCharCode(parseInt(Se.slice(1),16))});return eu(ye.join("\r\n"))}(ye.slice($t));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ce)}var Dt=LA(te,pe.slice(ue.length),yt,{unsafe:!0});Se&&(Dt.ctype=Se)}function LA(te,ye,ue,pe){var Ce=pe&&pe.unsafe;Ce||ge(te);var Se=!Ce&&Fr.find(te,ye);if(!Se){var yt=te.FullPaths[0];ye.slice(0,yt.length)==yt?yt=ye:("/"!=yt.slice(-1)&&(yt+="/"),yt=(yt+ye).replace("//","/")),Se={name:i(ye),type:2},te.FileIndex.push(Se),te.FullPaths.push(yt),Ce||Fr.utils.cfb_gc(te)}return Se.content=ue,Se.size=ue?ue.length:0,pe&&(pe.CLSID&&(Se.clsid=pe.CLSID),pe.mt&&(Se.mt=pe.mt),pe.ct&&(Se.ct=pe.ct)),Se}return n.find=function Mt(te,ye){var ue=te.FullPaths.map(function(Ct){return Ct.toUpperCase()}),pe=ue.map(function(Ct){var xt=Ct.split("/");return xt[xt.length-("/"==Ct.slice(-1)?2:1)]}),Ce=!1;47===ye.charCodeAt(0)?(Ce=!0,ye=ue[0].slice(0,-1)+ye):Ce=-1!==ye.indexOf("/");var Se=ye.toUpperCase(),yt=!0===Ce?ue.indexOf(Se):pe.indexOf(Se);if(-1!==yt)return te.FileIndex[yt];var $t=!Se.match(ob);for(Se=Se.replace(Il,""),$t&&(Se=Se.replace(ob,"!")),yt=0;yt<ue.length;++yt)if(($t?ue[yt].replace(ob,"!"):ue[yt]).replace(Il,"")==Se||($t?pe[yt].replace(ob,"!"):pe[yt]).replace(Il,"")==Se)return te.FileIndex[yt];return null},n.read=function Pe(te,ye){var ue=ye&&ye.type;switch(ue||Mi&&Buffer.isBuffer(te)&&(ue="buffer"),ue||"base64"){case"file":return function Le(te,ye){return c(),f(l.readFileSync(te),ye)}(te,ye);case"base64":return f(eu(Jc(te)),ye);case"binary":return f(eu(te),ye)}return f(te,ye)},n.parse=f,n.write=function Wn(te,ye){var ue=wt(te,ye);switch(ye&&ye.type||"buffer"){case"file":return c(),l.writeFileSync(ye.filename,ue),ue;case"binary":return"string"==typeof ue?ue:mn(ue);case"base64":return rb("string"==typeof ue?ue:mn(ue));case"buffer":if(Mi)return Buffer.isBuffer(ue)?ue:Dh(ue);case"array":return"string"==typeof ue?eu(ue):ue}return ue},n.writeFile=function Ln(te,ye,ue){c();var pe=wt(te,ue);l.writeFileSync(ye,pe)},n.utils={cfb_new:function bve(te){var ye={};return ge(ye,te),ye},cfb_add:LA,cfb_del:function yve(te,ye){ge(te);var ue=Fr.find(te,ye);if(ue)for(var pe=0;pe<te.FileIndex.length;++pe)if(te.FileIndex[pe]==ue)return te.FileIndex.splice(pe,1),te.FullPaths.splice(pe,1),!0;return!1},cfb_mov:function wve(te,ye,ue){ge(te);var pe=Fr.find(te,ye);if(pe)for(var Ce=0;Ce<te.FileIndex.length;++Ce)if(te.FileIndex[Ce]==pe)return te.FileIndex[Ce].name=i(ue),te.FullPaths[Ce]=ue,!0;return!1},cfb_gc:function xve(te){Ge(te,!0)},ReadShift:hb,CheckField:WP,prep_blob:hl,bconcat:zs,use_zlib:function Ae(te){try{var ue=new(0,te.InflateRaw);if(ue._processChunk(new Uint8Array([3,0]),ue._finishFlushFlag),!ue.bytesRead)throw new Error("zlib does not expose bytesRead");qt=te}catch(pe){console.error("cannot use native zlib: "+(pe.message||pe))}},_deflateRaw:Ii,_inflateRaw:bL,consts:an},n}();let nm;function qG(t){return"string"==typeof t?ib(t):Array.isArray(t)?function _G(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}(t):t}function lb(t,n,e){if(typeof nm<"u"&&nm.writeFileSync)return e?nm.writeFileSync(t,n,e):nm.writeFileSync(t,n);if(typeof Deno<"u"){if(e&&"string"==typeof n)switch(e){case"utf8":n=new TextEncoder(e).encode(n);break;case"binary":n=ib(n);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,n)}var r="utf8"==e?Tf(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var i=new Blob([qG(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var a=document.createElement("a");if(null!=a.download)return a.download=t,a.href=o,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var s=File(t);return s.open("w"),s.encoding="binary",Array.isArray(n)&&(n=Jp(n)),s.write(n),s.close(),n}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function Oa(t){for(var n=Object.keys(t),e=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(t,n[r])&&e.push(n[r]);return e}function fP(t,n){for(var e=[],r=Oa(t),i=0;i!==r.length;++i)null==e[t[r[i]][n]]&&(e[t[r[i]][n]]=r[i]);return e}function Sw(t){for(var n=[],e=Oa(t),r=0;r!==e.length;++r)n[t[e[r]]]=e[r];return n}function Dw(t){for(var n=[],e=Oa(t),r=0;r!==e.length;++r)n[t[e[r]]]=parseInt(e[r],10);return n}var Aw=new Date(1899,11,30,0,0,0);function As(t,n){var e=t.getTime();return n&&(e-=1263168e5),(e-(Aw.getTime()+6e4*(t.getTimezoneOffset()-Aw.getTimezoneOffset())))/864e5}var hP=new Date,XG=Aw.getTime()+6e4*(hP.getTimezoneOffset()-Aw.getTimezoneOffset()),pP=hP.getTimezoneOffset();function Tw(t){var n=new Date;return n.setTime(24*t*60*60*1e3+XG),n.getTimezoneOffset()!==pP&&n.setTime(n.getTime()+6e4*(n.getTimezoneOffset()-pP)),n}function KG(t){var n=0,e=0,r=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(e=1,o>3&&(r=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":e*=24;case"H":e*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");e*=60}n+=e*parseInt(i[o],10)}return n}var mP=new Date("2017-02-19T19:06:09.000Z"),gP=isNaN(mP.getFullYear())?new Date("2/19/17"):mP,ZG=2017==gP.getFullYear();function ia(t,n){var e=new Date(t);if(ZG)return n>0?e.setTime(e.getTime()+60*e.getTimezoneOffset()*1e3):n<0&&e.setTime(e.getTime()-60*e.getTimezoneOffset()*1e3),e;if(t instanceof Date)return t;if(1917==gP.getFullYear()&&!isNaN(e.getFullYear())){var r=e.getFullYear();return t.indexOf(""+r)>-1||e.setFullYear(e.getFullYear()+100),e}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}function Ng(t,n){if(Mi&&Buffer.isBuffer(t)){if(n){if(255==t[0]&&254==t[1])return Tf(t.slice(2).toString("utf16le"));if(254==t[1]&&255==t[2])return Tf(qI(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(255==t[0]&&254==t[1])return Tf(new TextDecoder("utf-16le").decode(t.slice(2)));if(254==t[0]&&255==t[1])return Tf(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(o){return e[o]||o})}catch{}for(var r=[],i=0;i!=t.length;++i)r.push(String.fromCharCode(t[i]));return r.join("")}function $o(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if("object"!=typeof t||null==t)return t;if(t instanceof Date)return new Date(t.getTime());var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=$o(t[e]));return n}function Na(t,n){for(var e="";e.length<n;)e+=t;return e}function Cd(t){var n=Number(t);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(t))return n;var e=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return isNaN(n=Number(r))&&(r=r.replace(/[(](.*)[)]/,function(i,o){return e=-e,o}),isNaN(n=Number(r)))?n:n/e}var QG=["january","february","march","april","may","june","july","august","september","october","november","december"];function Q1(t){var n=new Date(t),e=new Date(NaN),r=n.getYear(),i=n.getMonth(),o=n.getDate();if(isNaN(o))return e;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==QG.indexOf(a))return e}else if(a.match(/[a-z]/))return e;return r<0||r>8099?e:(i>0||o>1)&&101!=r?n:t.match(/[^-0-9:,\/\\]/)?e:n}var JG=function(){var t=5=="abacaba".split(/(:?b)/i).length;return function(e,r,i){if(t||"string"==typeof r)return e.split(r);for(var o=e.split(r),a=[o[0]],s=1;s<o.length;++s)a.push(i),a.push(o[s]);return a}}();function _P(t){return t?t.content&&t.type?Ng(t.content,!0):t.data?Y1(t.data):t.asNodeBuffer&&Mi?Y1(t.asNodeBuffer().toString("binary")):t.asBinary?Y1(t.asBinary()):t._data&&t._data.getContent?Y1(Ng(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function vP(t){if(!t)return null;if(t.data)return ww(t.data);if(t.asNodeBuffer&&Mi)return t.asNodeBuffer();if(t._data&&t._data.getContent){var n=t._data.getContent();return"string"==typeof n?ww(n):Array.prototype.slice.call(n)}return t.content&&t.type?t.content:null}function Vu(t,n){for(var e=t.FullPaths||Oa(t.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),o=0;o<e.length;++o){var a=e[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==a||i==a)return t.files?t.files[e[o]]:t.FileIndex[o]}return null}function nS(t,n){var e=Vu(t,n);if(null==e)throw new Error("Cannot find file "+n+" in zip");return e}function ds(t,n,e){if(!e)return function eY(t){return t&&".bin"===t.name.slice(-4)?vP(t):_P(t)}(nS(t,n));if(!n)return null;try{return ds(t,n)}catch{return null}}function nu(t,n,e){if(!e)return _P(nS(t,n));if(!n)return null;try{return nu(t,n)}catch{return null}}function bP(t,n,e){if(!e)return vP(nS(t,n));if(!n)return null;try{return bP(t,n)}catch{return null}}function yP(t){for(var n=t.FullPaths||Oa(t.files),e=[],r=0;r<n.length;++r)"/"!=n[r].slice(-1)&&e.push(n[r].replace(/^Root Entry[\/]/,""));return e.sort()}function Ei(t,n,e){if(t.FullPaths){var r;if("string"==typeof e)return r=Mi?Dh(e):function vG(t){for(var n=[],e=0,r=t.length+250,i=Qp(t.length+255),o=0;o<t.length;++o){var a=t.charCodeAt(o);if(a<128)i[e++]=a;else if(a<2048)i[e++]=192|a>>6&31,i[e++]=128|63&a;else if(a>=55296&&a<57344){a=64+(1023&a);var s=1023&t.charCodeAt(++o);i[e++]=240|a>>8&7,i[e++]=128|a>>2&63,i[e++]=128|s>>6&15|(3&a)<<4,i[e++]=128|63&s}else i[e++]=224|a>>12&15,i[e++]=128|a>>6&63,i[e++]=128|63&a;e>r&&(n.push(i.slice(0,e)),e=0,i=Qp(65535),r=65530)}return n.push(i.slice(0,e)),zs(n)}(e),Fr.utils.cfb_add(t,n,r);Fr.utils.cfb_add(t,n,e)}else t.file(n,e)}function rS(){return Fr.utils.cfb_new()}function wP(t,n){switch(n.type){case"base64":return Fr.read(t,{type:"base64"});case"binary":return Fr.read(t,{type:"binary"});case"buffer":case"array":return Fr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function cb(t,n){if("/"==t.charAt(0))return t.slice(1);var e=n.split("/");"/"!=n.slice(-1)&&e.pop();for(var r=t.split("/");0!==r.length;){var i=r.shift();".."===i?e.pop():"."!==i&&e.push(i)}return e.join("/")}var Ra='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',tY=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,xP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Pl=Ra.match(xP)?xP:/<[^>]*>/g,rY=/<\w*:/,iY=/<(\/?)\w+:/;function ri(t,n,e){for(var r={},i=0,o=0;i!==t.length&&32!==(o=t.charCodeAt(i))&&10!==o&&13!==o;++i);if(n||(r[0]=t.slice(0,i)),i===t.length)return r;var a=t.match(tY),s=0,l="",c=0,f="",v="",E=1;if(a)for(c=0;c!=a.length;++c){for(v=a[c],o=0;o!=v.length&&61!==v.charCodeAt(o);++o);for(f=v.slice(0,o).trim();32==v.charCodeAt(o+1);)++o;for(E=34==(i=v.charCodeAt(o+1))||39==i?1:0,l=v.slice(o+1+E,v.length-E),s=0;s!=f.length&&58!==f.charCodeAt(s);++s);if(s===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),r[f]=l,e||(r[f.toLowerCase()]=l);else{var D=(5===s&&"xmlns"===f.slice(0,5)?"xmlns":"")+f.slice(s+1);if(r[D]&&"ext"==f.slice(s-3,s))continue;r[D]=l,e||(r[D.toLowerCase()]=l)}}return r}function Af(t){return t.replace(iY,"<$1")}var CP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},iS=Sw(CP),ro=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,n=/_x([\da-fA-F]{4})_/gi;return function e(r){var i=r+"",o=i.indexOf("<![CDATA[");if(-1==o)return i.replace(t,function(s,l){return CP[s]||String.fromCharCode(parseInt(l,s.indexOf("x")>-1?16:10))||s}).replace(n,function(s,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return e(i.slice(0,o))+i.slice(o+9,a)+e(i.slice(a+3))}}(),oS=/[&<>'"]/g,oY=/[\u0000-\u0008\u000b-\u001f]/g;function Ao(t){return(t+"").replace(oS,function(e){return iS[e]}).replace(oY,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function EP(t){return Ao(t).replace(/ /g,"_x0020_")}var SP=/[\u0000-\u001f]/g;function aS(t){return(t+"").replace(oS,function(e){return iS[e]}).replace(/\n/g,"<br/>").replace(SP,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var DP=function(){var t=/&#(\d+);/g;function n(e,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,n)}}();function oa(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sS(t){for(var n="",e=0,r=0,i=0,o=0,a=0,s=0;e<t.length;)(r=t.charCodeAt(e++))<128?n+=String.fromCharCode(r):(i=t.charCodeAt(e++),r>191&&r<224?(a=(31&r)<<6,a|=63&i,n+=String.fromCharCode(a)):(o=t.charCodeAt(e++),r<240?n+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o):(s=((7&r)<<18|(63&i)<<12|(63&o)<<6|63&(a=t.charCodeAt(e++)))-65536,n+=String.fromCharCode(55296+(s>>>10&1023)),n+=String.fromCharCode(56320+(1023&s)))));return n}function AP(t){var e,r,s,n=Qp(2*t.length),i=1,o=0,a=0;for(r=0;r<t.length;r+=i)i=1,(s=t.charCodeAt(r))<128?e=s:s<224?(e=64*(31&s)+(63&t.charCodeAt(r+1)),i=2):s<240?(e=4096*(15&s)+64*(63&t.charCodeAt(r+1))+(63&t.charCodeAt(r+2)),i=3):(i=4,e=262144*(7&s)+4096*(63&t.charCodeAt(r+1))+64*(63&t.charCodeAt(r+2))+(63&t.charCodeAt(r+3)),a=55296+((e-=65536)>>>10&1023),e=56320+(1023&e)),0!==a&&(n[o++]=255&a,n[o++]=a>>>8,a=0),n[o++]=e%256,n[o++]=e>>>8;return n.slice(0,o).toString("ucs2")}function TP(t){return Dh(t,"binary").toString("utf8")}var Mw="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Lo=Mi&&(TP(Mw)==sS(Mw)&&TP||AP(Mw)==sS(Mw)&&AP)||sS,Tf=Mi?function(t){return Dh(t,"utf8").toString("binary")}:function(t){for(var n=[],e=0,r=0,i=0;e<t.length;)switch(r=t.charCodeAt(e++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,i=t.charCodeAt(e++)-56320+(r<<10),n.push(String.fromCharCode(240+(i>>18&7))),n.push(String.fromCharCode(144+(i>>12&63))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(63&i)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(63&r)))}return n.join("")},ub=function(){var t={};return function(e,r){var i=e+"|"+(r||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",r||"")}}(),MP=function(){var t=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(e){for(var r=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),i=0;i<t.length;++i)r=r.replace(t[i][0],t[i][1]);return r}}(),lY=function(){var t={};return function(e){return void 0!==t[e]?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),cY=/<\/?(?:vt:)?variant>/g,uY=/<(?:vt:)([^>]*)>([\s\S]*)</;function kP(t,n){var e=ri(t),r=t.match(lY(e.baseType))||[],i=[];if(r.length!=e.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+e.size);return i}return r.forEach(function(o){var a=o.replace(cY,"").match(uY);a&&i.push({v:Lo(a[2]),t:a[1]})}),i}var FP=/(^\s|\s$|\n)/;function fl(t,n){return"<"+t+(n.match(FP)?' xml:space="preserve"':"")+">"+n+"</"+t+">"}function db(t){return Oa(t).map(function(n){return" "+n+'="'+t[n]+'"'}).join("")}function Bn(t,n,e){return"<"+t+(null!=e?db(e):"")+(null!=n?(n.match(FP)?' xml:space="preserve"':"")+">"+n+"</"+t:"/")+">"}function lS(t,n){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(n)throw e}return""}function cS(t){if(Mi&&Buffer.isBuffer(t))return t.toString("utf8");if("string"==typeof t)return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Lo(Jp(Q5(t)));throw new Error("Bad input format: expected Buffer or string")}var fb=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,fs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},rm=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ru={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},IP=function(t){for(var n=[],r=0;r<t[0].length;++r)if(t[0][r])for(var i=0,o=t[0][r].length;i<o;i+=10240)n.push.apply(n,t[0][r].slice(i,i+10240));return n},PP=Mi?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(n){return Buffer.isBuffer(n)?n:Dh(n)})):IP(t)}:IP,OP=function(t,n,e){for(var r=[],i=n;i<e;i+=2)r.push(String.fromCharCode(Th(t,i)));return r.join("").replace(Il,"")},kw=Mi?function(t,n,e){return Buffer.isBuffer(t)?t.toString("utf16le",n,e).replace(Il,""):OP(t,n,e)}:OP,NP=function(t,n,e){for(var r=[],i=n;i<n+e;++i)r.push(("0"+t[i].toString(16)).slice(-2));return r.join("")},RP=Mi?function(t,n,e){return Buffer.isBuffer(t)?t.toString("hex",n,n+e):NP(t,n,e)}:NP,LP=function(t,n,e){for(var r=[],i=n;i<e;i++)r.push(String.fromCharCode(e_(t,i)));return r.join("")},J1=Mi?function(n,e,r){return Buffer.isBuffer(n)?n.toString("utf8",e,r):LP(n,e,r)}:LP,BP=function(t,n){var e=$s(t,n);return e>0?J1(t,n+4,n+4+e-1):""},uS=BP,jP=function(t,n){var e=$s(t,n);return e>0?J1(t,n+4,n+4+e-1):""},dS=jP,VP=function(t,n){var e=2*$s(t,n);return e>0?J1(t,n+4,n+4+e-1):""},fS=VP,UP=function(n,e){var r=$s(n,e);return r>0?kw(n,e+4,e+4+r):""},hS=UP,HP=function(t,n){var e=$s(t,n);return e>0?J1(t,n+4,n+4+e):""},pS=HP,zP=function(t,n){return function fY(t,n){for(var e=1-2*(t[n+7]>>>7),r=((127&t[n+7])<<4)+(t[n+6]>>>4&15),i=15&t[n+6],o=5;o>=0;--o)i=256*i+t[n+o];return 2047==r?0==i?e*(1/0):NaN:(0==r?r=-1022:(r-=1023,i+=Math.pow(2,52)),e*Math.pow(2,r-52)*i)}(t,n)},Fw=zP,mS=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Mi&&(uS=function(n,e){if(!Buffer.isBuffer(n))return BP(n,e);var r=n.readUInt32LE(e);return r>0?n.toString("utf8",e+4,e+4+r-1):""},dS=function(n,e){if(!Buffer.isBuffer(n))return jP(n,e);var r=n.readUInt32LE(e);return r>0?n.toString("utf8",e+4,e+4+r-1):""},fS=function(n,e){if(!Buffer.isBuffer(n))return VP(n,e);var r=2*n.readUInt32LE(e);return n.toString("utf16le",e+4,e+4+r-1)},hS=function(n,e){if(!Buffer.isBuffer(n))return UP(n,e);var r=n.readUInt32LE(e);return n.toString("utf16le",e+4,e+4+r)},pS=function(n,e){if(!Buffer.isBuffer(n))return HP(n,e);var r=n.readUInt32LE(e);return n.toString("utf8",e+4,e+4+r)},Fw=function(n,e){return Buffer.isBuffer(n)?n.readDoubleLE(e):zP(n,e)},mS=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array}),typeof eo<"u"&&function $P(){kw=function(t,n,e){return eo.utils.decode(1200,t.slice(n,e)).replace(Il,"")},J1=function(t,n,e){return eo.utils.decode(65001,t.slice(n,e))},uS=function(t,n){var e=$s(t,n);return e>0?eo.utils.decode(Ig,t.slice(n+4,n+4+e-1)):""},dS=function(t,n){var e=$s(t,n);return e>0?eo.utils.decode(Qc,t.slice(n+4,n+4+e-1)):""},fS=function(t,n){var e=2*$s(t,n);return e>0?eo.utils.decode(1200,t.slice(n+4,n+4+e-1)):""},hS=function(t,n){var e=$s(t,n);return e>0?eo.utils.decode(1200,t.slice(n+4,n+4+e)):""},pS=function(t,n){var e=$s(t,n);return e>0?eo.utils.decode(65001,t.slice(n+4,n+4+e)):""}}();var e_=function(t,n){return t[n]},Th=function(t,n){return 256*t[n+1]+t[n]},pY=function(t,n){var e=256*t[n+1]+t[n];return e<32768?e:-1*(65535-e+1)},$s=function(t,n){return t[n+3]*(1<<24)+(t[n+2]<<16)+(t[n+1]<<8)+t[n]},Rg=function(t,n){return t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]},mY=function(t,n){return t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]};function hb(t,n){var r,i,a,s,l,c,e="",o=[];switch(n){case"dbcs":if(c=this.l,Mi&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)e+=String.fromCharCode(Th(this,c)),c+=2;t*=2;break;case"utf8":e=J1(this,this.l,this.l+t);break;case"utf16le":e=kw(this,this.l,this.l+(t*=2));break;case"wstr":if(!(typeof eo<"u"))return hb.call(this,t,"dbcs");e=eo.utils.decode(Qc,this.slice(this.l,this.l+2*t)),t*=2;break;case"lpstr-ansi":e=uS(this,this.l),t=4+$s(this,this.l);break;case"lpstr-cp":e=dS(this,this.l),t=4+$s(this,this.l);break;case"lpwstr":e=fS(this,this.l),t=4+2*$s(this,this.l);break;case"lpp4":t=4+$s(this,this.l),e=hS(this,this.l),2&t&&(t+=2);break;case"8lpp4":t=4+$s(this,this.l),e=pS(this,this.l),3&t&&(t+=4-(3&t));break;case"cstr":for(t=0,e="";0!==(a=e_(this,this.l+t++));)o.push(tb(a));e=o.join("");break;case"_wstr":for(t=0,e="";0!==(a=Th(this,this.l+t));)o.push(tb(a)),t+=2;t+=2,e=o.join("");break;case"dbcs-cont":for(e="",c=this.l,l=0;l<t;++l){if(this.lens&&-1!==this.lens.indexOf(c))return a=e_(this,c),this.l=c+1,s=hb.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),o.join("")+s;o.push(tb(Th(this,c))),c+=2}e=o.join(""),t*=2;break;case"cpstr":if(typeof eo<"u"){e=eo.utils.decode(Qc,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(e="",c=this.l,l=0;l!=t;++l){if(this.lens&&-1!==this.lens.indexOf(c))return a=e_(this,c),this.l=c+1,s=hb.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),o.join("")+s;o.push(tb(e_(this,c))),c+=1}e=o.join("");break;default:switch(t){case 1:return r=e_(this,this.l),this.l++,r;case 2:return r=("i"===n?pY:Th)(this,this.l),this.l+=2,r;case 4:case-4:return"i"!==n&&128&this[this.l+3]?(i=$s(this,this.l),this.l+=4,i):(r=(t>0?Rg:mY)(this,this.l),this.l+=4,r);case 8:case-8:if("f"===n)return i=8==t?Fw(this,this.l):Fw([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:e=RP(this,this.l,t)}}return this.l+=t,e}var gY=function(t,n,e){t[e]=255&n,t[e+1]=n>>>8&255,t[e+2]=n>>>16&255,t[e+3]=n>>>24&255},_Y=function(t,n,e){t[e]=255&n,t[e+1]=n>>8&255,t[e+2]=n>>16&255,t[e+3]=n>>24&255},vY=function(t,n,e){t[e]=255&n,t[e+1]=n>>>8&255};function bY(t,n,e){var r=0,i=0;if("dbcs"===e){for(i=0;i!=n.length;++i)vY(this,n.charCodeAt(i),this.l+2*i);r=2*n.length}else if("sbcs"===e){if(typeof eo<"u"&&874==Ig)for(i=0;i!=n.length;++i){var o=eo.utils.encode(Ig,n.charAt(i));this[this.l+i]=o[0]}else for(n=n.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=n.length;++i)this[this.l+i]=255&n.charCodeAt(i);r=n.length}else{if("hex"===e){for(;i<t;++i)this[this.l++]=parseInt(n.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===e){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(n.length,t);++i){var s=n.charCodeAt(i);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}switch(t){case 1:r=1,this[this.l]=255&n;break;case 2:r=2,this[this.l]=255&n,this[this.l+1]=255&(n>>>=8);break;case 3:r=3,this[this.l]=255&n,this[this.l+1]=255&(n>>>=8),this[this.l+2]=255&(n>>>=8);break;case 4:r=4,gY(this,n,this.l);break;case 8:if(r=8,"f"===e){!function hY(t,n,e){var r=(n<0||1/n==-1/0?1:0)<<7,i=0,o=0,a=r?-n:n;isFinite(a)?0==a?i=o=0:(i=Math.floor(Math.log(a)/Math.LN2),o=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(n)?26985:0);for(var s=0;s<=5;++s,o/=256)t[e+s]=255&o;t[e+6]=(15&i)<<4|15&o,t[e+7]=i>>4|r}(this,n,this.l);break}case 16:break;case-4:r=4,_Y(this,n,this.l)}}return this.l+=r,this}function WP(t,n){var e=RP(this,this.l,t.length>>1);if(e!==t)throw new Error(n+"Expected "+t+" saw "+e);this.l+=t.length>>1}function hl(t,n){t.l=n,t.read_shift=hb,t.chk=WP,t.write_shift=bY}function Ol(t,n){t.l+=n}function Ut(t){var n=Qp(t);return hl(n,0),n}function Mh(t,n,e){if(t){var r,i,o;hl(t,t.l||0);for(var a=t.length,s=0,l=0;t.l<a;){128&(s=t.read_shift(1))&&(s=(127&s)+((127&t.read_shift(1))<<7));var c=Ib[s]||Ib[65535];for(o=127&(r=t.read_shift(1)),i=1;i<4&&128&r;++i)o+=(127&(r=t.read_shift(1)))<<7*i;l=t.l+o;var f=c.f&&c.f(t,o,e);if(t.l=l,n(f,c,s))return}}}function nc(){var t=[],n=Mi?256:2048,e=function(c){var f=Ut(c);return hl(f,0),f},r=e(n),i=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&t.push(r),r=null)},o=function(c){return r&&c<r.length-r.l?r:(i(),r=e(Math.max(c+1,n)))};return{next:o,push:function(c){i(),null==(r=c).l&&(r.l=r.length),o(n)},end:function(){return i(),zs(t)},_bufs:t}}function _n(t,n,e,r){var o,i=+n;if(!isNaN(i)){r||(r=Ib[i].p||(e||[]).length||0),o=1+(i>=128?1:0)+1,r>=128&&++o,r>=16384&&++o,r>=2097152&&++o;var a=t.next(o);i<=127?a.write_shift(1,i):(a.write_shift(1,128+(127&i)),a.write_shift(1,i>>7));for(var s=0;4!=s;++s){if(!(r>=128)){a.write_shift(1,r);break}a.write_shift(1,128+(127&r)),r>>=7}r>0&&mS(e)&&t.push(e)}}function pb(t,n,e){var r=$o(t);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!e||e.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function qP(t,n,e){var r=$o(t);return r.s=pb(r.s,n.s,e),r.e=pb(r.e,n.s,e),r}function mb(t,n){if(t.cRel&&t.c<0)for(t=$o(t);t.c<0;)t.c+=n>8?16384:256;if(t.rRel&&t.r<0)for(t=$o(t);t.r<0;)t.r+=n>8?1048576:n>5?65536:16384;var e=Jr(t);return!t.cRel&&null!=t.cRel&&(e=function xY(t){return t.replace(/^([A-Z])/,"$$$1")}(e)),!t.rRel&&null!=t.rRel&&(e=function yY(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(e)),e}function gS(t,n){return 0!=t.s.r||t.s.rRel||t.e.r!=(n.biff>=12?1048575:n.biff>=8?65536:16384)||t.e.rRel?0!=t.s.c||t.s.cRel||t.e.c!=(n.biff>=12?16383:255)||t.e.cRel?mb(t.s,n.biff)+":"+mb(t.e,n.biff):(t.s.rRel?"":"$")+La(t.s.r)+":"+(t.e.rRel?"":"$")+La(t.e.r):(t.s.cRel?"":"$")+aa(t.s.c)+":"+(t.e.cRel?"":"$")+aa(t.e.c)}function _S(t){return parseInt(function wY(t){return t.replace(/\$(\d+)$/,"$1")}(t),10)-1}function La(t){return""+(t+1)}function vS(t){for(var n=function CY(t){return t.replace(/^\$([A-Z])/,"$1")}(t),e=0,r=0;r!==n.length;++r)e=26*e+n.charCodeAt(r)-64;return e-1}function aa(t){if(t<0)throw new Error("invalid column "+t);var n="";for(++t;t;t=Math.floor((t-1)/26))n=String.fromCharCode((t-1)%26+65)+n;return n}function ya(t){for(var n=0,e=0,r=0;r<t.length;++r){var i=t.charCodeAt(r);i>=48&&i<=57?n=10*n+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:n-1}}function Jr(t){for(var n=t.c+1,e="";n;n=(n-1)/26|0)e=String.fromCharCode((n-1)%26+65)+e;return e+(t.r+1)}function rc(t){var n=t.indexOf(":");return-1==n?{s:ya(t),e:ya(t)}:{s:ya(t.slice(0,n)),e:ya(t.slice(n+1))}}function bi(t,n){return typeof n>"u"||"number"==typeof n?bi(t.s,t.e):("string"!=typeof t&&(t=Jr(t)),"string"!=typeof n&&(n=Jr(n)),t==n?t:t+":"+n)}function zi(t){var n={s:{c:0,r:0},e:{c:0,r:0}},e=0,r=0,i=0,o=t.length;for(e=0;r<o&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)e=26*e+i;for(n.s.c=--e,e=0;r<o&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)e=10*e+i;if(n.s.r=--e,r===o||10!=i)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,e=0;r!=o&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)e=26*e+i;for(n.e.c=--e,e=0;r!=o&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)e=10*e+i;return n.e.r=--e,n}function Mf(t,n,e){return null==t||null==t.t||"z"==t.t?"":void 0!==t.w?t.w:("d"==t.t&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),"e"==t.t?kh[t.v]||t.v:function GP(t,n){var e="d"==t.t&&n instanceof Date;if(null!=t.z)try{return t.w=tu(t.z,e?As(n):n)}catch{}try{return t.w=tu((t.XF||{}).numFmtId||(e?14:0),e?As(n):n)}catch{return""+n}}(t,null==n?t.v:n))}function im(t,n){var e=n&&n.sheet?n.sheet:"Sheet1",r={};return r[e]=t,{SheetNames:[e],Sheets:r}}function YP(t,n,e){var r=e||{},i=t?Array.isArray(t):r.dense;null!=Pa&&null==i&&(i=Pa);var o=t||(i?[]:{}),a=0,s=0;if(o&&null!=r.origin){if("number"==typeof r.origin)a=r.origin;else{var l="string"==typeof r.origin?ya(r.origin):r.origin;a=l.r,s=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var f=zi(o["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),-1==a&&(c.e.r=a=f.e.r+1)}for(var v=0;v!=n.length;++v)if(n[v]){if(!Array.isArray(n[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var E=0;E!=n[v].length;++E)if(!(typeof n[v][E]>"u")){var D={v:n[v][E]},k=a+v,T=s+E;if(c.s.r>k&&(c.s.r=k),c.s.c>T&&(c.s.c=T),c.e.r<k&&(c.e.r=k),c.e.c<T&&(c.e.c=T),!n[v][E]||"object"!=typeof n[v][E]||Array.isArray(n[v][E])||n[v][E]instanceof Date)if(Array.isArray(D.v)&&(D.f=n[v][E][1],D.v=D.v[0]),null===D.v)if(D.f)D.t="n";else if(r.nullError)D.t="e",D.v=0;else{if(!r.sheetStubs)continue;D.t="z"}else"number"==typeof D.v?D.t="n":"boolean"==typeof D.v?D.t="b":D.v instanceof Date?(D.z=r.dateNF||qr[14],r.cellDates?(D.t="d",D.w=tu(D.z,As(D.v))):(D.t="n",D.v=As(D.v),D.w=tu(D.z,D.v))):D.t="s";else D=n[v][E];if(i)o[k]||(o[k]=[]),o[k][T]&&o[k][T].z&&(D.z=o[k][T].z),o[k][T]=D;else{var R=Jr({c:T,r:k});o[R]&&o[R].z&&(D.z=o[R].z),o[R]=D}}}return c.s.c<1e7&&(o["!ref"]=bi(c)),o}function t_(t,n){return YP(null,t,n)}function Ed(t,n){return n||(n=Ut(4)),n.write_shift(4,t),n}function Nl(t){var n=t.read_shift(4);return 0===n?"":t.read_shift(n,"dbcs")}function Ws(t,n){var e=!1;return null==n&&(e=!0,n=Ut(4+2*t.length)),n.write_shift(4,t.length),t.length>0&&n.write_shift(0,t,"dbcs"),e?n.slice(0,n.l):n}function DY(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function bS(t,n){var e=t.l,r=t.read_shift(1),i=Nl(t),o=[],a={t:i,h:i};if(1&r){for(var s=t.read_shift(4),l=0;l!=s;++l)o.push(DY(t));a.r=o}else a.r=[{ich:0,ifnt:0}];return t.l=e+n,a}var MY=bS;function Uu(t){var n=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:n,iStyleRef:e}}function Lg(t,n){return null==n&&(n=Ut(8)),n.write_shift(-4,t.c),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}function Bg(t){var n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:n}}function jg(t,n){return null==n&&(n=Ut(4)),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}var FY=Nl,XP=Ws;function yS(t){var n=t.read_shift(4);return 0===n||4294967295===n?"":t.read_shift(n,"dbcs")}function Iw(t,n){var e=!1;return null==n&&(e=!0,n=Ut(127)),n.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&n.write_shift(0,t,"dbcs"),e?n.slice(0,n.l):n}var IY=Nl,wS=yS,xS=Iw;function CS(t){var n=t.slice(t.l,t.l+4),e=1&n[0],r=2&n[0];t.l+=4;var i=0===r?Fw([0,0,0,0,252&n[0],n[1],n[2],n[3]],0):Rg(n,0)>>2;return e?i/100:i}function KP(t,n){null==n&&(n=Ut(4));var e=0,r=0,i=100*t;if(t==(0|t)&&t>=-(1<<29)&&t<1<<29?r=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(r=1,e=1),!r)throw new Error("unsupported RkNumber "+t);n.write_shift(-4,((e?i:t)<<2)+(e+2))}function ZP(t){var n={s:{},e:{}};return n.s.r=t.read_shift(4),n.e.r=t.read_shift(4),n.s.c=t.read_shift(4),n.e.c=t.read_shift(4),n}var Vg=ZP,n_=function PY(t,n){return n||(n=Ut(16)),n.write_shift(4,t.s.r),n.write_shift(4,t.e.r),n.write_shift(4,t.s.c),n.write_shift(4,t.e.c),n};function Rl(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ug(t,n){return(n||Ut(8)).write_shift(8,t,"f")}function Pw(t,n){if(n||(n=Ut(8)),!t||t.auto)return n.write_shift(4,0),n.write_shift(4,0),n;null!=t.index?(n.write_shift(1,2),n.write_shift(1,t.index)):null!=t.theme?(n.write_shift(1,6),n.write_shift(1,t.theme)):(n.write_shift(1,5),n.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),n.write_shift(2,e),t.rgb&&null==t.theme){var r=t.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),n.write_shift(1,parseInt(r.slice(0,2),16)),n.write_shift(1,parseInt(r.slice(2,4),16)),n.write_shift(1,parseInt(r.slice(4,6),16)),n.write_shift(1,255)}else n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n}function QP(t,n){var r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,1==n?"lpstr":"lpwstr")}var ES=2,Ac=3,JP=12,eO=81,zY=[80,eO],SS={1:{n:"CodePage",t:ES},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:Ac},5:{n:"LineCount",t:Ac},6:{n:"ParagraphCount",t:Ac},7:{n:"SlideCount",t:Ac},8:{n:"NoteCount",t:Ac},9:{n:"HiddenCount",t:Ac},10:{n:"MultimediaClipCount",t:Ac},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:Ac},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:Ac,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},DS={1:{n:"CodePage",t:ES},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:Ac},15:{n:"WordCount",t:Ac},16:{n:"CharCount",t:Ac},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:Ac},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},tO={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},$Y=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function WY(t){return t.map(function(n){return[n>>16&255,n>>8&255,255&n]})}var Hg=$o(WY([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),kh={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},nO={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},AS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Lw={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function rO(t,n){var i,e=function YG(t){for(var n=[],e=Oa(t),r=0;r!==e.length;++r)null==n[t[e[r]]]&&(n[t[e[r]]]=[]),n[t[e[r]]].push(e[r]);return n}(AS),r=[];r[r.length]=Ra,r[r.length]=Bn("Types",null,{xmlns:fs.CT,"xmlns:xsd":fs.xsd,"xmlns:xsi":fs.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Bn("Default",null,{Extension:l[0],ContentType:l[1]})}));var o=function(l){t[l]&&t[l].length>0&&(r[r.length]=Bn("Override",null,{PartName:("/"==(i=t[l][0])[0]?"":"/")+i,ContentType:Lw[l][n.bookType]||Lw[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){r[r.length]=Bn("Override",null,{PartName:("/"==c[0]?"":"/")+c,ContentType:Lw[l][n.bookType]||Lw[l].xlsx})})},s=function(l){(t[l]||[]).forEach(function(c){r[r.length]=Bn("Override",null,{PartName:("/"==c[0]?"":"/")+c,ContentType:e[l][0]})})};return o("workbooks"),a("sheets"),a("charts"),s("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),a("metadata"),s("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var yi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gb(t){var n=t.lastIndexOf("/");return t.slice(0,n+1)+"_rels/"+t.slice(n+1)+".rels"}function _b(t,n){var e={"!id":{}};if(!t)return e;"/"!==n.charAt(0)&&(n="/"+n);var r={};return(t.match(Pl)||[]).forEach(function(i){var o=ri(i);if("<Relationship"===o[0]){var a={};a.Type=o.Type,a.Target=o.Target,a.Id=o.Id,o.TargetMode&&(a.TargetMode=o.TargetMode);var s="External"===o.TargetMode?o.Target:cb(o.Target,n);e[s]=a,r[o.Id]=a}}),e["!id"]=r,e}function r_(t){var n=[Ra,Bn("Relationships",null,{xmlns:fs.RELS})];return Oa(t["!id"]).forEach(function(e){n[n.length]=Bn("Relationship",null,t["!id"][e])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function yo(t,n,e,r,i,o){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),n<0)for(n=t["!idx"];t["!id"]["rId"+n];++n);if(t["!idx"]=n+1,i.Id="rId"+n,i.Type=r,i.Target=e,o?i.TargetMode=o:[yi.HLINK,yi.XPATH,yi.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+n);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,n}var YY="application/vnd.oasis.opendocument.spreadsheet";function iO(t,n,e){return['  <rdf:Description rdf:about="'+t+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+n+'"/>\n',"  </rdf:Description>\n"].join("")}function ZY(t,n){return['  <rdf:Description rdf:about="'+t+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+'"/>\n',"  </rdf:Description>\n"].join("")}function oO(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+eb.version+"</meta:generator></office:meta></office:document-meta>"}var Hu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],JY=function(){for(var t=new Array(Hu.length),n=0;n<Hu.length;++n){var e=Hu[n],r="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function aO(t){var n={};t=Lo(t);for(var e=0;e<Hu.length;++e){var r=Hu[e],i=t.match(JY[e]);null!=i&&i.length>0&&(n[r[1]]=ro(i[1])),"date"===r[2]&&n[r[1]]&&(n[r[1]]=ia(n[r[1]]))}return n}function MS(t,n,e,r,i){null!=i[t]||null==n||""===n||(i[t]=n,n=Ao(n),r[r.length]=e?Bn(t,n,e):fl(t,n))}function sO(t,n){var e=n||{},r=[Ra,Bn("cp:coreProperties",null,{"xmlns:cp":fs.CORE_PROPS,"xmlns:dc":fs.dc,"xmlns:dcterms":fs.dcterms,"xmlns:dcmitype":fs.dcmitype,"xmlns:xsi":fs.xsi})],i={};if(!t&&!e.Props)return r.join("");t&&(null!=t.CreatedDate&&MS("dcterms:created","string"==typeof t.CreatedDate?t.CreatedDate:lS(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=t.ModifiedDate&&MS("dcterms:modified","string"==typeof t.ModifiedDate?t.ModifiedDate:lS(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var o=0;o!=Hu.length;++o){var a=Hu[o],s=e.Props&&null!=e.Props[a[1]]?e.Props[a[1]]:t?t[a[1]]:null;!0===s?s="1":!1===s?s="0":"number"==typeof s&&(s=String(s)),null!=s&&MS(a[0],s,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var zg=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],lO=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function cO(t,n,e,r){var i=[];if("string"==typeof t)i=kP(t,r);else for(var o=0;o<t.length;++o)i=i.concat(t[o].map(function(f){return{v:f}}));var a="string"==typeof n?kP(n,r).map(function(f){return f.v}):n,s=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":e.Worksheets=l,e.SheetNames=a.slice(s,s+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":e.NamedRanges=l,e.DefinedNames=a.slice(s,s+l);break;case"Charts":case"Diagramme":e.Chartsheets=l,e.ChartNames=a.slice(s,s+l)}s+=l}}function uO(t){var n=[],e=Bn;return t||(t={}),t.Application="SheetJS",n[n.length]=Ra,n[n.length]=Bn("Properties",null,{xmlns:fs.EXT_PROPS,"xmlns:vt":fs.vt}),zg.forEach(function(r){if(void 0!==t[r[1]]){var i;switch(r[2]){case"string":i=Ao(String(t[r[1]]));break;case"bool":i=t[r[1]]?"true":"false"}void 0!==i&&(n[n.length]=e(r[0],i))}}),n[n.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+Ao(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var tX=/<[^>]+>[^<]*/g;function dO(t){var n=[Ra,Bn("Properties",null,{xmlns:fs.CUST_PROPS,"xmlns:vt":fs.vt})];if(!t)return n.join("");var e=1;return Oa(t).forEach(function(i){++e,n[n.length]=Bn("property",function dY(t,n){switch(typeof t){case"string":var e=Bn("vt:lpwstr",Ao(t));return n&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return Bn((0|t)==t?"vt:i4":"vt:r8",Ao(String(t)));case"boolean":return Bn("vt:bool",t?"true":"false")}if(t instanceof Date)return Bn("vt:filetime",lS(t));throw new Error("Unable to serialize "+t)}(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Ao(i)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var FS,kS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function rX(t,n,e){FS||(FS=Sw(kS)),t[n=FS[n]||n]=e}function IS(t){var n=t.read_shift(4),e=t.read_shift(4);return new Date(1e3*(e/1e7*Math.pow(2,32)+n/1e7-11644473600)).toISOString().replace(/\.000/,"")}function fO(t,n,e){var r=t.l,i=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-r&3;)++t.l;return i}function hO(t,n,e){var r=t.read_shift(0,"lpwstr");return e&&(t.l+=4-(r.length+1&3)&3),r}function pO(t,n,e){return 31===n?hO(t):fO(t,0,e)}function PS(t,n,e){return pO(t,n,!1===e?0:4)}function uX(t){var n=t.l,e=Bw(t,eO);return 0==t[t.l]&&0==t[t.l+1]&&t.l-n&2&&(t.l+=2),[e,Bw(t,Ac)]}function mO(t,n){for(var e=t.read_shift(4),r={},i=0;i!=e;++i){var o=t.read_shift(4),a=t.read_shift(4);r[o]=t.read_shift(a,1200===n?"utf16le":"utf8").replace(Il,"").replace(ob,"!"),1200===n&&a%2&&(t.l+=2)}return 3&t.l&&(t.l=t.l>>3<<2),r}function gO(t){var n=t.read_shift(4),e=t.slice(t.l,t.l+n);return t.l+=n,(3&n)>0&&(t.l+=4-(3&n)&3),e}function Bw(t,n,e){var i,r=t.read_shift(2),o=e||{};if(t.l+=2,n!==JP&&r!==n&&-1===zY.indexOf(n)&&(4126!=(65534&n)||4126!=(65534&r)))throw new Error("Expected type "+n+" saw "+r);switch(n===JP?r:n){case 2:return i=t.read_shift(2,"i"),o.raw||(t.l+=2),i;case 3:return t.read_shift(4,"i");case 11:return 0!==t.read_shift(4);case 19:return t.read_shift(4);case 30:return fO(t,0,4).replace(Il,"");case 31:return hO(t);case 64:return IS(t);case 65:return gO(t);case 71:return function fX(t){var n={};return n.Size=t.read_shift(4),t.l+=n.Size+3-(n.Size-1)%4,n}(t);case 80:return PS(t,r,!o.raw).replace(Il,"");case 81:return function sX(t,n){if(!n)throw new Error("VtUnalignedString must have positive length");return pO(t,n,0)}(t,r).replace(Il,"");case 4108:return function dX(t){for(var n=t.read_shift(4),e=[],r=0;r<n/2;++r)e.push(uX(t));return e}(t);case 4126:case 4127:return 4127==r?function lX(t){for(var n=t.read_shift(4),e=[],r=0;r!=n;++r){var i=t.l;e[r]=t.read_shift(0,"lpwstr").replace(Il,""),t.l-i&2&&(t.l+=2)}return e}(t):function cX(t){for(var n=t.read_shift(4),e=[],r=0;r!=n;++r)e[r]=t.read_shift(0,"lpstr-cp").replace(Il,"");return e}(t);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function _O(t,n){var e=Ut(4),r=Ut(4);switch(e.write_shift(4,80==t?31:t),t){case 3:r.write_shift(-4,n);break;case 5:(r=Ut(8)).write_shift(8,n,"f");break;case 11:r.write_shift(4,n?1:0);break;case 64:r=function aX(t){var e=("string"==typeof t?new Date(Date.parse(t)):t).getTime()/1e3+11644473600,r=e%Math.pow(2,32),i=(e-r)/Math.pow(2,32);i*=1e7;var o=(r*=1e7)/Math.pow(2,32)|0;o>0&&(r%=Math.pow(2,32),i+=o);var a=Ut(8);return a.write_shift(4,r),a.write_shift(4,i),a}(n);break;case 31:case 80:for((r=Ut(4+2*(n.length+1)+(n.length%2?0:2))).write_shift(4,n.length+1),r.write_shift(0,n,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}return zs([e,r])}function vO(t,n){var e=t.l,r=t.read_shift(4),i=t.read_shift(4),o=[],a=0,s=0,l=-1,c={};for(a=0;a!=i;++a){var f=t.read_shift(4),v=t.read_shift(4);o[a]=[f,v+e]}o.sort(function(Z,W){return Z[1]-W[1]});var E={};for(a=0;a!=i;++a){if(t.l!==o[a][1]){var D=!0;if(a>0&&n)switch(n[o[a-1][0]].t){case 2:t.l+2===o[a][1]&&(t.l+=2,D=!1);break;case 80:case 4108:t.l<=o[a][1]&&(t.l=o[a][1],D=!1)}if((!n||0==a)&&t.l<=o[a][1]&&(D=!1,t.l=o[a][1]),D)throw new Error("Read Error: Expected address "+o[a][1]+" at "+t.l+" :"+a)}if(n){var k=n[o[a][0]];if(E[k.n]=Bw(t,k.t,{raw:!0}),"version"===k.p&&(E[k.n]=String(E[k.n]>>16)+"."+("0000"+String(65535&E[k.n])).slice(-4)),"CodePage"==k.n)switch(E[k.n]){case 0:E[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Bu(s=E[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+E[k.n])}}else if(1===o[a][0]){if(s=E.CodePage=Bw(t,ES),Bu(s),-1!==l){var T=t.l;t.l=o[l][1],c=mO(t,s),t.l=T}}else if(0===o[a][0]){if(0===s){l=a,t.l=o[a+1][1];continue}c=mO(t,s)}else{var q,R=c[o[a][0]];switch(t[t.l]){case 65:t.l+=4,q=gO(t);break;case 30:case 31:t.l+=4,q=PS(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,q=t.read_shift(4,"i");break;case 19:t.l+=4,q=t.read_shift(4);break;case 5:t.l+=4,q=t.read_shift(8,"f");break;case 11:t.l+=4,q=Xa(t,4);break;case 64:t.l+=4,q=ia(IS(t));break;default:throw new Error("unparsed value: "+t[t.l])}E[R]=q}}return t.l=e+r,E}var bO=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function hX(t){switch(typeof t){case"boolean":return 11;case"number":return(0|t)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64}return-1}function yO(t,n,e){var r=Ut(8),i=[],o=[],a=8,s=0,l=Ut(8),c=Ut(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),o.push(l),i.push(c),a+=8+l.length,!n){(c=Ut(8)).write_shift(4,0),i.unshift(c);var f=[Ut(4)];for(f[0].write_shift(4,t.length),s=0;s<t.length;++s){var v=t[s][0];for((l=Ut(8+2*(v.length+1)+(v.length%2?0:2))).write_shift(4,s+2),l.write_shift(4,v.length+1),l.write_shift(0,v,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=zs(f),o.unshift(l),a+=8+l.length}for(s=0;s<t.length;++s)if((!n||n[t[s][0]])&&!(bO.indexOf(t[s][0])>-1||lO.indexOf(t[s][0])>-1)&&null!=t[s][1]){var E=t[s][1],D=0;if(n){var k=e[D=+n[t[s][0]]];if("version"==k.p&&"string"==typeof E){var T=E.split(".");E=(+T[0]<<16)+(+T[1]||0)}l=_O(k.t,E)}else{var R=hX(E);-1==R&&(R=31,E=String(E)),l=_O(R,E)}o.push(l),(c=Ut(8)).write_shift(4,n?D:2+s),i.push(c),a+=8+l.length}var q=8*(o.length+1);for(s=0;s<o.length;++s)i[s].write_shift(4,q),q+=o[s].length;return r.write_shift(4,a),r.write_shift(4,o.length),zs([r].concat(i).concat(o))}function wO(t,n,e){var r=t.content;if(!r)return{};hl(r,0);var i,o,a,s,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),f=r.read_shift(16);if(f!==Fr.utils.consts.HEADER_CLSID&&f!==e)throw new Error("Bad PropertySet CLSID "+f);if(1!==(i=r.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(o=r.read_shift(16),s=r.read_shift(4),1===i&&s!==r.l)throw new Error("Length mismatch: "+s+" !== "+r.l);2===i&&(a=r.read_shift(16),l=r.read_shift(4));var k,v=vO(r,n),E={SystemIdentifier:c};for(var D in v)E[D]=v[D];if(E.FMTID=o,1===i)return E;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{k=vO(r,null)}catch{}for(D in k)E[D]=k[D];return E.FMTID=[o,a],E}function xO(t,n,e,r,i,o){var a=Ut(i?68:48),s=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Fr.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,n,"hex"),a.write_shift(4,i?68:48);var l=yO(t,e,r);if(s.push(l),i){var c=yO(i,null,null);a.write_shift(16,o,"hex"),a.write_shift(4,68+l.length),s.push(c)}return zs(s)}function om(t,n){return t.read_shift(n),null}function Xa(t,n){return 1===t.read_shift(n)}function ic(t,n){return n||(n=Ut(2)),n.write_shift(2,+!!t),n}function hs(t){return t.read_shift(2,"u")}function zu(t,n){return n||(n=Ut(2)),n.write_shift(2,t),n}function CO(t,n){return function mX(t,n,e){for(var r=[],i=t.l+n;t.l<i;)r.push(e(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return r}(t,n,hs)}function EO(t,n,e){return e||(e=Ut(2)),e.write_shift(1,"e"==n?+t:+!!t),e.write_shift(1,"e"==n?1:0),e}function vb(t,n,e){var r=t.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont",o=Qc;e&&e.biff>=8&&(Qc=1200),e&&8!=e.biff?12==e.biff&&(i="wstr"):t.read_shift(1)&&(i="dbcs-cont"),e.biff>=2&&e.biff<=5&&(i="cpstr");var s=r?t.read_shift(r,i):"";return Qc=o,s}function _X(t){var n=Qc;Qc=1200;var l,e=t.read_shift(2),r=t.read_shift(1),i=4&r,o=8&r,a=1+(1&r),s=0,c={};o&&(s=t.read_shift(2)),i&&(l=t.read_shift(4));var v=0===e?"":t.read_shift(e,2==a?"dbcs-cont":"sbcs-cont");return o&&(t.l+=4*s),i&&(t.l+=l),c.t=v,o||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Qc=n,c}function vX(t){var n=t.t||"",r=Ut(3);r.write_shift(2,n.length),r.write_shift(1,1);var i=Ut(2*n.length);return i.write_shift(2*n.length,n,"utf16le"),zs([r,i])}function $g(t,n,e){if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(n,"cpstr");if(e.biff>=12)return t.read_shift(n,"dbcs-cont")}var i=t.read_shift(1);return t.read_shift(n,0===i?"sbcs-cont":"dbcs-cont")}function bb(t,n,e){var r=t.read_shift(e&&2==e.biff?1:2);return 0===r?(t.l++,""):$g(t,r,e)}function Wg(t,n,e){if(e.biff>5)return bb(t,0,e);var r=t.read_shift(1);return 0===r?(t.l++,""):t.read_shift(r,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function SO(t,n,e){return e||(e=Ut(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function jw(t){var n=t.read_shift(4);return n>0?t.read_shift(n,"utf16le").replace(Il,""):""}function DO(t,n){n||(n=Ut(6+2*t.length)),n.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)n.write_shift(2,t.charCodeAt(e));return n.write_shift(2,0),n}function EX(t){var n=Ut(512),e=0,r=t.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var i=r.indexOf("#"),o=i>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3}n.write_shift(4,2),n.write_shift(4,o);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)n.write_shift(4,a[e]);if(28==o)DO(r=r.slice(1),n);else if(2&o){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)n.write_shift(1,parseInt(a[e],16));var s=i>-1?r.slice(0,i):r;for(n.write_shift(4,2*(s.length+1)),e=0;e<s.length;++e)n.write_shift(2,s.charCodeAt(e));n.write_shift(2,0),8&o&&DO(i>-1?r.slice(i+1):"",n)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)n.write_shift(1,parseInt(a[e],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(n.write_shift(2,l),n.write_shift(4,r.length-3*l+1),e=0;e<r.length-3*l;++e)n.write_shift(1,255&r.charCodeAt(e+3*l));for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),e=0;e<6;++e)n.write_shift(4,0)}return n.slice(0,n.l)}function AO(t){return[t.read_shift(1),t.read_shift(1),t.read_shift(1),t.read_shift(1)]}function TO(t,n){var e=AO(t);return e[3]=0,e}function kf(t){return{r:t.read_shift(2),c:t.read_shift(2),ixfe:t.read_shift(2)}}function qg(t,n,e,r){return r||(r=Ut(6)),r.write_shift(2,t),r.write_shift(2,n),r.write_shift(2,e||0),r}function AX(t,n,e){var r=e.biff>8?4:2;return[t.read_shift(r),t.read_shift(r,"i"),t.read_shift(r,"i")]}function MO(t){return[t.read_shift(2),CS(t)]}function Vw(t){var n=t.read_shift(2),e=t.read_shift(2);return{s:{c:t.read_shift(2),r:n},e:{c:t.read_shift(2),r:e}}}function kO(t,n){return n||(n=Ut(8)),n.write_shift(2,t.s.r),n.write_shift(2,t.e.r),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c),n}function FO(t){var n=t.read_shift(2),e=t.read_shift(2);return{s:{c:t.read_shift(1),r:n},e:{c:t.read_shift(1),r:e}}}var MX=FO;function IO(t){t.l+=4;var n=t.read_shift(2),e=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[e,n,r]}function Ll(t){t.l+=2,t.l+=t.read_shift(2)}var IX={0:Ll,4:Ll,5:Ll,6:Ll,7:function FX(t){return t.l+=4,t.cf=t.read_shift(2),{}},8:Ll,9:Ll,10:Ll,11:Ll,12:Ll,13:function kX(t){var n={};return t.l+=4,t.l+=16,n.fSharedNote=t.read_shift(2),t.l+=4,n},14:Ll,15:Ll,16:Ll,17:Ll,18:Ll,19:Ll,20:Ll,21:IO};function Uw(t,n){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),(n-=2)>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(n),e}function OS(t,n,e){var r=1536,i=16;switch(e.bookType){case"biff8":case"xla":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;default:throw new Error("unsupported BIFF version")}var o=Ut(i);return o.write_shift(2,r),o.write_shift(2,n),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function jX(t,n){var e=!n||n.biff>=8?2:1,r=Ut(8+e*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),n.biff>=8&&r.write_shift(1,1),r.write_shift(e*t.name.length,t.name,n.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function PO(t,n,e){var r=0;e&&2==e.biff||(r=t.read_shift(2));var i=t.read_shift(2);return e&&2==e.biff&&(r=1-(i>>15),i&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},i]}function iK(t,n,e,r){var i=e&&5==e.biff;r||(r=Ut(i?3+n.length:5+2*n.length)),r.write_shift(2,t),r.write_shift(i?1:2,n.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*n.length,n,i?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return null==o.l&&(o.l=o.length),o}var oK=Wg;function OO(t,n,e){var r=t.l+n,i=8!=e.biff&&e.biff?2:4,o=t.read_shift(i),a=t.read_shift(i),s=t.read_shift(2),l=t.read_shift(2);return t.l=r,{s:{r:o,c:s},e:{r:a,c:l}}}function NO(t,n,e,r){var i=e&&5==e.biff;r||(r=Ut(i?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,n<<4));var o=0;return t.numFmtId>0&&i&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function RO(t,n,e){var r=kf(t);(2==e.biff||9==n)&&++t.l;var i=function gX(t){var n=t.read_shift(1);return 1===t.read_shift(1)?n:1===n}(t);return r.val=i,r.t=!0===i||!1===i?"b":"e",r}var LO=function DX(t,n,e){return 0===n?"":Wg(t,0,e)};function BO(t,n,e){var i,r=t.read_shift(2),o={fBuiltIn:1&r,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return 14849===e.sbcch&&(i=function TX(t,n,e){t.l+=4;var r=t.l+(n-=4),i=vb(t,0,e),o=t.read_shift(2);if(o!==(r-=t.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return t.l+=o,i}(t,n-2,e)),o.body=i||t.read_shift(n-2),"string"==typeof i&&(o.Name=i),o}var vK=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function jO(t,n,e){var r=t.l+n,i=t.read_shift(2),o=t.read_shift(1),a=t.read_shift(1),s=t.read_shift(e&&2==e.biff?1:2),l=0;(!e||e.biff>=5)&&(5!=e.biff&&(t.l+=2),l=t.read_shift(2),5==e.biff&&(t.l+=2),t.l+=4);var c=$g(t,a,e);32&i&&(c=vK[c.charCodeAt(0)]);var f=r-t.l;e&&2==e.biff&&--f;var v=r!=t.l&&0!==s&&f>0?function Pee(t,n,e,r){var a,i=t.l+n,o=Ab(t,r,e);return i!==t.l&&(a=Db(t,i-t.l,o,e)),[o,a]}(t,f,e,s):[];return{chKey:o,Name:c,itab:l,rgce:v}}function VO(t,n,e){if(e.biff<8)return function bK(t,n,e){3==t[t.l+1]&&t[t.l]++;var r=vb(t,0,e);return 3==r.charCodeAt(0)?r.slice(1):r}(t,0,e);for(var r=[],i=t.l+n,o=t.read_shift(e.biff>8?4:2);0!=o--;)r.push(AX(t,0,e));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return r}function UO(t,n,e){var r=MX(t,6);switch(e.biff){case 2:t.l++,n-=7;break;case 3:case 4:t.l+=2,n-=8;break;default:t.l+=6,n-=12}return[r,Fee(t,n,e)]}var TK={8:function(t,n){var e=t.l+n;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=e,{fmt:r}}};function IK(t){var n=Ut(24),e=ya(t[0]);n.write_shift(2,e.r),n.write_shift(2,e.r),n.write_shift(2,e.c),n.write_shift(2,e.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)n.write_shift(1,parseInt(r[i],16));return zs([n,EX(t[1])])}function OK(t){var n=t[1].Tooltip,e=Ut(10+2*(n.length+1));e.write_shift(2,2048);var r=ya(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var i=0;i<n.length;++i)e.write_shift(2,n.charCodeAt(i));return e.write_shift(2,0),e}function HO(t,n,e){if(!e.cellStyles)return Ol(t,n);var r=e&&e.biff>=12?4:2,i=t.read_shift(r),o=t.read_shift(r),a=t.read_shift(r),s=t.read_shift(r),l=t.read_shift(2);2==r&&(t.l+=2);var c={s:i,e:o,w:a,ixfe:s,flags:l};return(e.biff>=5||!e.biff)&&(c.level=l>>8&7),c}var $K=kf,WK=CO,qK=bb,nZ=[2,3,48,49,131,139,140,245],NS=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=Sw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(s,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=t_(function e(s,l){var c=[],f=Qp(1);switch(l.type){case"base64":f=eu(Jc(s));break;case"binary":f=eu(s);break;case"buffer":case"array":f=s}hl(f,0);var v=f.read_shift(1),E=!!(136&v),D=!1,k=!1;switch(v){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:D=!0,E=!0;break;case 140:k=!0;break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var T=0,R=521;2==v&&(T=f.read_shift(2)),f.l+=3,2!=v&&(T=f.read_shift(4)),T>1048576&&(T=1e6),2!=v&&(R=f.read_shift(2));var q=f.read_shift(2),Z=l.codepage||1252;2!=v&&(f.l+=16,f.read_shift(1),0!==f[f.l]&&(Z=t[f[f.l]]),f.l+=1,f.l+=2),k&&(f.l+=36);for(var W=[],Ee={},Le=Math.min(f.length,2==v?521:R-10-(D?264:0)),Pe=k?32:11;f.l<Le&&13!=f[f.l];)switch(Ee={},Ee.name=eo.utils.decode(Z,f.slice(f.l,f.l+Pe)).replace(/[\u0000\r\n].*$/g,""),f.l+=Pe,Ee.type=String.fromCharCode(f.read_shift(1)),2!=v&&!k&&(Ee.offset=f.read_shift(4)),Ee.len=f.read_shift(1),2==v&&(Ee.offset=f.read_shift(2)),Ee.dec=f.read_shift(1),Ee.name.length&&W.push(Ee),2!=v&&(f.l+=k?13:14),Ee.type){case"B":(!D||8!=Ee.len)&&l.WTF&&console.log("Skipping "+Ee.name+":"+Ee.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+Ee.name+":"+Ee.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Ee.type)}if(13!==f[f.l]&&(f.l=R-1),13!==f.read_shift(1))throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=R;var ge=0,Ye=0;for(c[0]=[],Ye=0;Ye!=W.length;++Ye)c[0][Ye]=W[Ye].name;for(;T-- >0;)if(42!==f[f.l])for(++f.l,c[++ge]=[],Ye=0,Ye=0;Ye!=W.length;++Ye){var Ge=f.slice(f.l,f.l+W[Ye].len);f.l+=W[Ye].len,hl(Ge,0);var wt=eo.utils.decode(Z,Ge);switch(W[Ye].type){case"C":wt.trim().length&&(c[ge][Ye]=wt.replace(/\s+$/,""));break;case"D":c[ge][Ye]=8===wt.length?new Date(+wt.slice(0,4),+wt.slice(4,6)-1,+wt.slice(6,8)):wt;break;case"F":c[ge][Ye]=parseFloat(wt.trim());break;case"+":case"I":c[ge][Ye]=k?2147483648^Ge.read_shift(-4,"i"):Ge.read_shift(4,"i");break;case"L":switch(wt.trim().toUpperCase()){case"Y":case"T":c[ge][Ye]=!0;break;case"N":case"F":c[ge][Ye]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+wt+"|")}break;case"M":if(!E)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));c[ge][Ye]="##MEMO##"+(k?parseInt(wt.trim(),10):Ge.read_shift(4));break;case"N":(wt=wt.replace(/\u0000/g,"").trim())&&"."!=wt&&(c[ge][Ye]=+wt||0);break;case"@":c[ge][Ye]=new Date(Ge.read_shift(-8,"f")-621356832e5);break;case"T":c[ge][Ye]=new Date(864e5*(Ge.read_shift(4)-2440588)+Ge.read_shift(4));break;case"Y":c[ge][Ye]=Ge.read_shift(4,"i")/1e4+Ge.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[ge][Ye]=-Ge.read_shift(-8,"f");break;case"B":if(D&&8==W[Ye].len){c[ge][Ye]=Ge.read_shift(8,"f");break}case"G":case"P":Ge.l+=W[Ye].len;break;case"0":if("_NullFlags"===W[Ye].name)break;default:throw new Error("DBF Unsupported data type "+W[Ye].type)}}else f.l+=q;if(2!=v&&f.l<f.length&&26!=f[f.l++])throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=W,c}(s,c),c);return f["!cols"]=c.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete c.DBF,f}var o={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function i(s,l){try{return im(r(s,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function a(s,l){var c=l||{};if(+c.codepage>=0&&Bu(+c.codepage),"string"==c.type)throw new Error("Cannot write DBF to JS string");var f=nc(),v=Zw(s,{header:1,raw:!0,cellDates:!0}),E=v[0],D=v.slice(1),k=s["!cols"]||[],T=0,R=0,q=0,Z=1;for(T=0;T<E.length;++T)if(((k[T]||{}).DBF||{}).name)E[T]=k[T].DBF.name,++q;else if(null!=E[T]){if(++q,"number"==typeof E[T]&&(E[T]=E[T].toString(10)),"string"!=typeof E[T])throw new Error("DBF Invalid column name "+E[T]+" |"+typeof E[T]+"|");if(E.indexOf(E[T])!==T)for(R=0;R<1024;++R)if(-1==E.indexOf(E[T]+"_"+R)){E[T]+="_"+R;break}}var W=zi(s["!ref"]),Ee=[],Le=[],Pe=[];for(T=0;T<=W.e.c-W.s.c;++T){var ge="",Ye="",Ge=0,wt=[];for(R=0;R<D.length;++R)null!=D[R][T]&&wt.push(D[R][T]);if(0!=wt.length&&null!=E[T]){for(R=0;R<wt.length;++R){switch(typeof wt[R]){case"number":Ye="B";break;case"string":default:Ye="C";break;case"boolean":Ye="L";break;case"object":Ye=wt[R]instanceof Date?"D":"C"}Ge=Math.max(Ge,String(wt[R]).length),ge=ge&&ge!=Ye?"C":Ye}Ge>250&&(Ge=250),"C"==(Ye=((k[T]||{}).DBF||{}).type)&&k[T].DBF.len>Ge&&(Ge=k[T].DBF.len),"B"==ge&&"N"==Ye&&(ge="N",Pe[T]=k[T].DBF.dec,Ge=k[T].DBF.len),Le[T]="C"==ge||"N"==Ye?Ge:o[ge]||0,Z+=Le[T],Ee[T]=ge}else Ee[T]="?"}var Mt=f.next(32);for(Mt.write_shift(4,318902576),Mt.write_shift(4,D.length),Mt.write_shift(2,296+32*q),Mt.write_shift(2,Z),T=0;T<4;++T)Mt.write_shift(4,0);for(Mt.write_shift(4,0|(+n[Ig]||3)<<8),T=0,R=0;T<E.length;++T)if(null!=E[T]){var Qe=f.next(32),An=(E[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Qe.write_shift(1,An,"sbcs"),Qe.write_shift(1,"?"==Ee[T]?"C":Ee[T],"sbcs"),Qe.write_shift(4,R),Qe.write_shift(1,Le[T]||o[Ee[T]]||0),Qe.write_shift(1,Pe[T]||0),Qe.write_shift(1,2),Qe.write_shift(4,0),Qe.write_shift(1,0),Qe.write_shift(4,0),Qe.write_shift(4,0),R+=Le[T]||o[Ee[T]]||0}var rr=f.next(264);for(rr.write_shift(4,13),T=0;T<65;++T)rr.write_shift(4,0);for(T=0;T<D.length;++T){var Nn=f.next(Z);for(Nn.write_shift(1,0),R=0;R<E.length;++R)if(null!=E[R])switch(Ee[R]){case"L":Nn.write_shift(1,null==D[T][R]?63:D[T][R]?84:70);break;case"B":Nn.write_shift(8,D[T][R]||0,"f");break;case"N":var rn="0";for("number"==typeof D[T][R]&&(rn=D[T][R].toFixed(Pe[R]||0)),q=0;q<Le[R]-rn.length;++q)Nn.write_shift(1,32);Nn.write_shift(1,rn,"sbcs");break;case"D":D[T][R]?(Nn.write_shift(4,("0000"+D[T][R].getFullYear()).slice(-4),"sbcs"),Nn.write_shift(2,("00"+(D[T][R].getMonth()+1)).slice(-2),"sbcs"),Nn.write_shift(2,("00"+D[T][R].getDate()).slice(-2),"sbcs")):Nn.write_shift(8,"00000000","sbcs");break;case"C":var an=String(null!=D[T][R]?D[T][R]:"").slice(0,Le[R]);for(Nn.write_shift(1,an,"sbcs"),q=0;q<Le[R]-an.length;++q)Nn.write_shift(1,32)}}return f.next(1).write_shift(1,26),f.end()}}}(),zO=function(){var t={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1bN("+Oa(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(E,D){var k=t[D];return"number"==typeof k?Z5(k):k},r=function(E,D,k){var T=D.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return 59==T?E:Z5(T)};function o(E,D){var Mt,k=E.split(/[\n\r]+/),T=-1,R=-1,q=0,Z=0,W=[],Ee=[],Le=null,Pe={},ge=[],Ye=[],Ge=[],wt=0;for(+D.codepage>=0&&Bu(+D.codepage);q!==k.length;++q){wt=0;var Nn,Qe=k[q].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,e),An=Qe.replace(/;;/g,"\0").split(";").map(function(Re){return Re.replace(/\u0000/g,";")});if(Qe.length>0)switch(An[0]){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==An[1].charAt(0)&&Ee.push(Qe.slice(3).replace(/;;/g,";"));break;case"C":var rn=!1,an=!1,Ln=!1,mn=!1,Wn=-1,qt=-1;for(Z=1;Z<An.length;++Z)switch(An[Z].charAt(0)){case"A":case"G":break;case"X":R=parseInt(An[Z].slice(1))-1,an=!0;break;case"Y":for(T=parseInt(An[Z].slice(1))-1,an||(R=0),Mt=W.length;Mt<=T;++Mt)W[Mt]=[];break;case"K":'"'===(Nn=An[Z].slice(1)).charAt(0)?Nn=Nn.slice(1,Nn.length-1):"TRUE"===Nn?Nn=!0:"FALSE"===Nn?Nn=!1:isNaN(Cd(Nn))?isNaN(Q1(Nn).getDate())||(Nn=ia(Nn)):(Nn=Cd(Nn),null!==Le&&Og(Le)&&(Nn=Tw(Nn))),typeof eo<"u"&&"string"==typeof Nn&&"string"!=(D||{}).type&&(D||{}).codepage&&(Nn=eo.utils.decode(D.codepage,Nn)),rn=!0;break;case"E":mn=!0;var Ae=s_(An[Z].slice(1),{r:T,c:R});W[T][R]=[W[T][R],Ae];break;case"S":Ln=!0,W[T][R]=[W[T][R],"S5S"];break;case"R":Wn=parseInt(An[Z].slice(1))-1;break;case"C":qt=parseInt(An[Z].slice(1))-1;break;default:if(D&&D.WTF)throw new Error("SYLK bad record "+Qe)}if(rn&&(W[T][R]&&2==W[T][R].length?W[T][R][0]=Nn:W[T][R]=Nn,Le=null),Ln){if(mn)throw new Error("SYLK shared formula cannot have own formula");var dt=Wn>-1&&W[Wn][qt];if(!dt||!dt[1])throw new Error("SYLK shared formula cannot find base");W[T][R][1]=cN(dt[1],{r:T-Wn,c:R-qt})}break;case"F":var Fe=0;for(Z=1;Z<An.length;++Z)switch(An[Z].charAt(0)){case"X":R=parseInt(An[Z].slice(1))-1,++Fe;break;case"Y":for(T=parseInt(An[Z].slice(1))-1,Mt=W.length;Mt<=T;++Mt)W[Mt]=[];break;case"M":wt=parseInt(An[Z].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":Le=Ee[parseInt(An[Z].slice(1))];break;case"W":for(Ge=An[Z].slice(1).split(" "),Mt=parseInt(Ge[0],10);Mt<=parseInt(Ge[1],10);++Mt)wt=parseInt(Ge[2],10),Ye[Mt-1]=0===wt?{hidden:!0}:{wch:wt},am(Ye[Mt-1]);break;case"C":Ye[R=parseInt(An[Z].slice(1))-1]||(Ye[R]={});break;case"R":ge[T=parseInt(An[Z].slice(1))-1]||(ge[T]={}),wt>0?(ge[T].hpt=wt,ge[T].hpx=o_(wt)):0===wt&&(ge[T].hidden=!0);break;default:if(D&&D.WTF)throw new Error("SYLK bad record "+Qe)}Fe<1&&(Le=null);break;default:if(D&&D.WTF)throw new Error("SYLK bad record "+Qe)}}return ge.length>0&&(Pe["!rows"]=ge),Ye.length>0&&(Pe["!cols"]=Ye),D&&D.sheetRows&&(W=W.slice(0,D.sheetRows)),[W,Pe]}function a(E,D){var k=function i(E,D){switch(D.type){case"base64":return o(Jc(E),D);case"binary":return o(E,D);case"buffer":return o(Mi&&Buffer.isBuffer(E)?E.toString("binary"):Jp(E),D);case"array":return o(Ng(E),D)}throw new Error("Unrecognized type "+D.type)}(E,D),R=k[1],q=t_(k[0],D);return Oa(R).forEach(function(Z){q[Z]=R[Z]}),q}function l(E,D,k,T){var R="C;Y"+(k+1)+";X"+(T+1)+";K";switch(E.t){case"n":R+=E.v||0,E.f&&!E.F&&(R+=";E"+zS(E.f,{r:k,c:T}));break;case"b":R+=E.v?"TRUE":"FALSE";break;case"e":R+=E.w||E.v;break;case"d":R+='"'+(E.w||E.v)+'"';break;case"s":R+='"'+E.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return R}return t["|"]=254,{to_workbook:function s(E,D){return im(a(E,D),D)},to_sheet:a,from_sheet:function v(E,D){var q,k=["ID;PWXL;N;E"],T=[],R=zi(E["!ref"]),Z=Array.isArray(E),W="\r\n";k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),E["!cols"]&&function c(E,D){D.forEach(function(k,T){var R="F;W"+(T+1)+" "+(T+1)+" ";k.hidden?R+="0":("number"==typeof k.width&&!k.wpx&&(k.wpx=wb(k.width)),"number"==typeof k.wpx&&!k.wch&&(k.wch=xb(k.wpx)),"number"==typeof k.wch&&(R+=Math.round(k.wch)))," "!=R.charAt(R.length-1)&&E.push(R)})}(k,E["!cols"]),E["!rows"]&&function f(E,D){D.forEach(function(k,T){var R="F;";k.hidden?R+="M0;":k.hpt?R+="M"+20*k.hpt+";":k.hpx&&(R+="M"+20*Cb(k.hpx)+";"),R.length>2&&E.push(R+"R"+(T+1))})}(k,E["!rows"]),k.push("B;Y"+(R.e.r-R.s.r+1)+";X"+(R.e.c-R.s.c+1)+";D"+[R.s.c,R.s.r,R.e.c,R.e.r].join(" "));for(var Ee=R.s.r;Ee<=R.e.r;++Ee)for(var Le=R.s.c;Le<=R.e.c;++Le){var Pe=Jr({r:Ee,c:Le});(q=Z?(E[Ee]||[])[Le]:E[Pe])&&(null!=q.v||q.f&&!q.F)&&T.push(l(q,0,Ee,Le))}return k.join(W)+W+T.join(W)+W+"E"+W}}}(),$O=function(){function n(o,a){for(var s=o.split("\n"),l=-1,c=-1,f=0,v=[];f!==s.length;++f)if("BOT"!==s[f].trim()){if(!(l<0)){for(var E=s[f].trim().split(","),D=E[0],k=E[1],T=s[++f]||"";1&(T.match(/["]/g)||[]).length&&f<s.length-1;)T+="\n"+s[++f];switch(T=T.trim(),+D){case-1:if("BOT"===T){v[++l]=[],c=0;continue}if("EOD"!==T)throw new Error("Unrecognized DIF special command "+T);break;case 0:v[l][c]="TRUE"===T||"FALSE"!==T&&(isNaN(Cd(k))?isNaN(Q1(k).getDate())?k:ia(k):Cd(k)),++c;break;case 1:T=(T=T.slice(1,T.length-1)).replace(/""/g,'"'),nb&&T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),v[l][c++]=""!==T?T:null}if("EOD"===T)break}}else v[++l]=[],c=0;return a&&a.sheetRows&&(v=v.slice(0,a.sheetRows)),v}function e(o,a){return t_(function t(o,a){switch(a.type){case"base64":return n(Jc(o),a);case"binary":return n(o,a);case"buffer":return n(Mi&&Buffer.isBuffer(o)?o.toString("binary"):Jp(o),a);case"array":return n(Ng(o),a)}throw new Error("Unrecognized type "+a.type)}(o,a),a)}return{to_workbook:function r(o,a){return im(e(o,a),a)},to_sheet:e,from_sheet:function(){var o=function(l,c,f,v,E){l.push(c),l.push(f+","+v),l.push('"'+E.replace(/"/g,'""')+'"')},a=function(l,c,f,v){l.push(c+","+f),l.push(1==c?'"'+v.replace(/"/g,'""')+'"':v)};return function(l){var v,c=[],f=zi(l["!ref"]),E=Array.isArray(l);o(c,"TABLE",0,1,"sheetjs"),o(c,"VECTORS",0,f.e.r-f.s.r+1,""),o(c,"TUPLES",0,f.e.c-f.s.c+1,""),o(c,"DATA",0,0,"");for(var D=f.s.r;D<=f.e.r;++D){a(c,-1,0,"BOT");for(var k=f.s.c;k<=f.e.c;++k){var T=Jr({r:D,c:k});if(v=E?(l[D]||[])[k]:l[T])switch(v.t){case"n":var R=nb?v.w:v.v;!R&&null!=v.v&&(R=v.v),null==R?a(c,1,0,nb&&v.f&&!v.F?"="+v.f:""):a(c,0,R,"V");break;case"b":a(c,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":a(c,1,0,!nb||isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=tu(v.z||qr[14],As(ia(v.v)))),nb?a(c,0,v.w,"V"):a(c,1,0,v.w);break;default:a(c,1,0,"")}else a(c,1,0,"")}}return a(c,-1,0,"EOD"),c.join("\r\n")}}()}}(),WO=function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function n(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,E){return t_(function e(v,E){for(var D=v.split("\n"),k=-1,T=-1,R=0,q=[];R!==D.length;++R){var Z=D[R].trim().split(":");if("cell"===Z[0]){var W=ya(Z[1]);if(q.length<=W.r)for(k=q.length;k<=W.r;++k)q[k]||(q[k]=[]);switch(k=W.r,T=W.c,Z[2]){case"t":q[k][T]=t(Z[3]);break;case"v":q[k][T]=+Z[3];break;case"vtf":var Ee=Z[Z.length-1];case"vtc":q[k][T]="nl"===Z[3]?!!+Z[4]:+Z[4],"vtf"==Z[2]&&(q[k][T]=[q[k][T],Ee])}}}return E&&E.sheetRows&&(q=q.slice(0,E.sheetRows)),q}(v,E),E)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),l="--SocialCalcSpreadsheetControlSave--";function c(v){if(!v||!v["!ref"])return"";for(var k,E=[],D=[],T="",R=rc(v["!ref"]),q=Array.isArray(v),Z=R.s.r;Z<=R.e.r;++Z)for(var W=R.s.c;W<=R.e.c;++W)if(T=Jr({r:Z,c:W}),(k=q?(v[Z]||[])[W]:v[T])&&null!=k.v&&"z"!==k.t){switch(D=["cell",T,"t"],k.t){case"s":case"str":D.push(n(k.v));break;case"n":k.f?(D[2]="vtf",D[3]="n",D[4]=k.v,D[5]=n(k.f)):(D[2]="v",D[3]=k.v);break;case"b":D[2]="vt"+(k.f?"f":"c"),D[3]="nl",D[4]=k.v?"1":"0",D[5]=n(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var Ee=As(ia(k.v));D[2]="vtc",D[3]="nd",D[4]=""+Ee,D[5]=k.w||tu(k.z||qr[14],Ee);break;case"e":continue}E.push(D.join(":"))}return E.push("sheet:c:"+(R.e.c-R.s.c+1)+":r:"+(R.e.r-R.s.r+1)+":tvf:1"),E.push("valueformat:1:text-wiki"),E.join("\n")}return{to_workbook:function i(v,E){return im(r(v,E),E)},to_sheet:r,from_sheet:function f(v){return[o,a,s,a,c(v),l].join("\n")}}}(),i_=function(){function t(f,v,E,D,k){k.raw?v[E][D]=f:""===f||(v[E][D]="TRUE"===f||"FALSE"!==f&&(isNaN(Cd(f))?isNaN(Q1(f).getDate())?f:ia(f):Cd(f)))}var e={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(f){for(var v={},E=!1,D=0,k=0;D<f.length;++D)34==(k=f.charCodeAt(D))?E=!E:!E&&k in e&&(v[k]=(v[k]||0)+1);for(D in k=[],v)Object.prototype.hasOwnProperty.call(v,D)&&k.push([v[D],D]);if(!k.length)for(D in v=r)Object.prototype.hasOwnProperty.call(v,D)&&k.push([v[D],D]);return k.sort(function(T,R){return T[0]-R[0]||r[T[1]]-r[R[1]]}),e[k.pop()[1]]||44}function a(f,v){return!v||!v.PRN||v.FS||"sep="==f.slice(0,4)||f.indexOf("\t")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?function o(f,v){var E=v||{},D="";null!=Pa&&null==E.dense&&(E.dense=Pa);var k=E.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};"sep="==f.slice(0,4)?13==f.charCodeAt(5)&&10==f.charCodeAt(6)?(D=f.charAt(4),f=f.slice(7)):13==f.charCodeAt(5)||10==f.charCodeAt(5)?(D=f.charAt(4),f=f.slice(6)):D=i(f.slice(0,1024)):D=E&&E.FS?E.FS:i(f.slice(0,1024));var R=0,q=0,Z=0,W=0,Ee=0,Le=D.charCodeAt(0),Pe=!1,ge=0,Ye=f.charCodeAt(0);f=f.replace(/\r\n/gm,"\n");var Ge=null!=E.dateNF?function zG(t){var n="number"==typeof t?qr[t]:t;return n=n.replace(dP,"(\\d+)"),new RegExp("^"+n+"$")}(E.dateNF):null;function wt(){var Mt=f.slice(W,Ee),Qe={};if('"'==Mt.charAt(0)&&'"'==Mt.charAt(Mt.length-1)&&(Mt=Mt.slice(1,-1).replace(/""/g,'"')),0===Mt.length)Qe.t="z";else if(E.raw)Qe.t="s",Qe.v=Mt;else if(0===Mt.trim().length)Qe.t="s",Qe.v=Mt;else if(61==Mt.charCodeAt(0))34==Mt.charCodeAt(1)&&34==Mt.charCodeAt(Mt.length-1)?(Qe.t="s",Qe.v=Mt.slice(2,-1).replace(/""/g,'"')):function _J(t){return 1!=t.length}(Mt)?(Qe.t="n",Qe.f=Mt.slice(1)):(Qe.t="s",Qe.v=Mt);else if("TRUE"==Mt)Qe.t="b",Qe.v=!0;else if("FALSE"==Mt)Qe.t="b",Qe.v=!1;else if(isNaN(Z=Cd(Mt)))if(!isNaN(Q1(Mt).getDate())||Ge&&Mt.match(Ge)){Qe.z=E.dateNF||qr[14];var An=0;Ge&&Mt.match(Ge)&&(Mt=function $G(t,n,e){var r=-1,i=-1,o=-1,a=-1,s=-1,l=-1;(n.match(dP)||[]).forEach(function(v,E){var D=parseInt(e[E+1],10);switch(v.toLowerCase().charAt(0)){case"y":r=D;break;case"d":o=D;break;case"h":a=D;break;case"s":l=D;break;case"m":a>=0?s=D:i=D}}),l>=0&&-1==s&&i>=0&&(s=i,i=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==a&&-1==s&&-1==l?c:-1==r&&-1==i&&-1==o?f:c+"T"+f}(0,E.dateNF,Mt.match(Ge)||[]),An=1),E.cellDates?(Qe.t="d",Qe.v=ia(Mt,An)):(Qe.t="n",Qe.v=As(ia(Mt,An))),!1!==E.cellText&&(Qe.w=tu(Qe.z,Qe.v instanceof Date?As(Qe.v):Qe.v)),E.cellNF||delete Qe.z}else Qe.t="s",Qe.v=Mt;else Qe.t="n",!1!==E.cellText&&(Qe.w=Mt),Qe.v=Z;if("z"==Qe.t||(E.dense?(k[R]||(k[R]=[]),k[R][q]=Qe):k[Jr({c:q,r:R})]=Qe),Ye=f.charCodeAt(W=Ee+1),T.e.c<q&&(T.e.c=q),T.e.r<R&&(T.e.r=R),ge==Le)++q;else if(q=0,++R,E.sheetRows&&E.sheetRows<=R)return!0}e:for(;Ee<f.length;++Ee)switch(ge=f.charCodeAt(Ee)){case 34:34===Ye&&(Pe=!Pe);break;case Le:case 10:case 13:if(!Pe&&wt())break e}return Ee-W>0&&wt(),k["!ref"]=bi(T),k}(f,v):t_(function n(f,v){var E=v||{},D=[];if(!f||0===f.length)return D;for(var k=f.split(/[\r\n]/),T=k.length-1;T>=0&&0===k[T].length;)--T;for(var R=10,q=0,Z=0;Z<=T;++Z)-1==(q=k[Z].indexOf(" "))?q=k[Z].length:q++,R=Math.max(R,q);for(Z=0;Z<=T;++Z){D[Z]=[];var W=0;for(t(k[Z].slice(0,R).trim(),D,Z,W,E),W=1;W<=(k[Z].length-R)/10+1;++W)t(k[Z].slice(R+10*(W-1),R+10*W).trim(),D,Z,W,E)}return E.sheetRows&&(D=D.slice(0,E.sheetRows)),D}(f,v),v)}function s(f,v){var E="",D="string"==v.type?[0,0,0,0]:aD(f,v);switch(v.type){case"base64":E=Jc(f);break;case"binary":case"string":E=f;break;case"buffer":E=65001==v.codepage?f.toString("utf8"):v.codepage&&typeof eo<"u"?eo.utils.decode(v.codepage,f):Mi&&Buffer.isBuffer(f)?f.toString("binary"):Jp(f);break;case"array":E=Ng(f);break;default:throw new Error("Unrecognized type "+v.type)}return 239==D[0]&&187==D[1]&&191==D[2]?E=Lo(E.slice(3)):"string"!=v.type&&"buffer"!=v.type&&65001==v.codepage?E=Lo(E):"binary"==v.type&&typeof eo<"u"&&v.codepage&&(E=eo.utils.decode(v.codepage,eo.utils.encode(28591,E))),"socialcalc:version:"==E.slice(0,19)?WO.to_sheet("string"==v.type?E:Lo(E),v):a(E,v)}return{to_workbook:function l(f,v){return im(s(f,v),v)},to_sheet:s,from_sheet:function c(f){for(var D,v=[],E=zi(f["!ref"]),k=Array.isArray(f),T=E.s.r;T<=E.e.r;++T){for(var R=[],q=E.s.c;q<=E.e.c;++q){var Z=Jr({r:T,c:q});if((D=k?(f[T]||[])[q]:f[Z])&&null!=D.v){for(var W=(D.w||(Mf(D),D.w)||"").slice(0,10);W.length<10;)W+=" ";R.push(W+(0===q?" ":""))}else R.push("          ")}v.push(R.join(""))}return v.join("\n")}}}(),Gg=function(){function t(Ae,dt,Fe){if(Ae){hl(Ae,Ae.l||0);for(var Re=Fe.Enum||Wn;Ae.l<Ae.length;){var Xt=Ae.read_shift(2),En=Re[Xt]||Re[65535],Sn=Ae.read_shift(2),bn=Ae.l+Sn,dn=En.f&&En.f(Ae,Sn,Fe);if(Ae.l=bn,dt(dn,En,Xt))return}}}function e(Ae,dt){if(!Ae)return Ae;var Fe=dt||{};null!=Pa&&null==Fe.dense&&(Fe.dense=Pa);var Re=Fe.dense?[]:{},Xt="Sheet1",En="",Sn=0,bn={},dn=[],li=[],ke={s:{r:0,c:0},e:{r:0,c:0}},To=Fe.sheetRows||0;if(0==Ae[2]&&(8==Ae[3]||9==Ae[3])&&Ae.length>=16&&5==Ae[14]&&108===Ae[15])throw new Error("Unsupported Works 3 for Mac file");if(2==Ae[2])Fe.Enum=Wn,t(Ae,function(er,Za,Ku){switch(Ku){case 0:Fe.vers=er,er>=4096&&(Fe.qpro=!0);break;case 6:ke=er;break;case 204:er&&(En=er);break;case 222:En=er;break;case 15:case 51:Fe.qpro||(er[1].v=er[1].v.slice(1));case 13:case 14:case 16:14==Ku&&112==(112&er[2])&&(15&er[2])>1&&(15&er[2])<15&&(er[1].z=Fe.dateNF||qr[14],Fe.cellDates&&(er[1].t="d",er[1].v=Tw(er[1].v))),Fe.qpro&&er[3]>Sn&&(Re["!ref"]=bi(ke),bn[Xt]=Re,dn.push(Xt),Re=Fe.dense?[]:{},ke={s:{r:0,c:0},e:{r:0,c:0}},Sn=er[3],Xt=En||"Sheet"+(Sn+1),En="");var Rf=Fe.dense?(Re[er[0].r]||[])[er[0].c]:Re[Jr(er[0])];if(Rf){Rf.t=er[1].t,Rf.v=er[1].v,null!=er[1].z&&(Rf.z=er[1].z),null!=er[1].f&&(Rf.f=er[1].f);break}Fe.dense?(Re[er[0].r]||(Re[er[0].r]=[]),Re[er[0].r][er[0].c]=er[1]):Re[Jr(er[0])]=er[1]}},Fe);else{if(26!=Ae[2]&&14!=Ae[2])throw new Error("Unrecognized LOTUS BOF "+Ae[2]);Fe.Enum=qt,14==Ae[2]&&(Fe.qpro=!0,Ae.l=0),t(Ae,function(er,Za,Ku){switch(Ku){case 204:Xt=er;break;case 22:er[1].v=er[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(er[3]>Sn&&(Re["!ref"]=bi(ke),bn[Xt]=Re,dn.push(Xt),Re=Fe.dense?[]:{},ke={s:{r:0,c:0},e:{r:0,c:0}},Xt="Sheet"+((Sn=er[3])+1)),To>0&&er[0].r>=To)break;Fe.dense?(Re[er[0].r]||(Re[er[0].r]=[]),Re[er[0].r][er[0].c]=er[1]):Re[Jr(er[0])]=er[1],ke.e.c<er[0].c&&(ke.e.c=er[0].c),ke.e.r<er[0].r&&(ke.e.r=er[0].r);break;case 27:er[14e3]&&(li[er[14e3][0]]=er[14e3][1]);break;case 1537:li[er[0]]=er[1],er[0]==Sn&&(Xt=er[1])}},Fe)}if(Re["!ref"]=bi(ke),bn[En||Xt]=Re,dn.push(En||Xt),!li.length)return{SheetNames:dn,Sheets:bn};for(var Bi={},Mo=[],ji=0;ji<li.length;++ji)bn[dn[ji]]?(Mo.push(li[ji]||dn[ji]),Bi[li[ji]]=bn[li[ji]]||bn[dn[ji]]):(Mo.push(li[ji]),Bi[li[ji]]={"!ref":"A1"});return{SheetNames:Mo,Sheets:Bi}}function c(Ae,dt,Fe){var Re=[{c:0,r:0},{t:"n",v:0},0,0];return Fe.qpro&&20768!=Fe.vers?(Re[0].c=Ae.read_shift(1),Re[3]=Ae.read_shift(1),Re[0].r=Ae.read_shift(2),Ae.l+=2):(Re[2]=Ae.read_shift(1),Re[0].c=Ae.read_shift(2),Re[0].r=Ae.read_shift(2)),Re}function f(Ae,dt,Fe){var Re=Ae.l+dt,Xt=c(Ae,0,Fe);if(Xt[1].t="s",20768==Fe.vers){Ae.l++;var En=Ae.read_shift(1);return Xt[1].v=Ae.read_shift(En,"utf8"),Xt}return Fe.qpro&&Ae.l++,Xt[1].v=Ae.read_shift(Re-Ae.l,"cstr"),Xt}function v(Ae,dt,Fe){var Re=Ut(7+Fe.length);Re.write_shift(1,255),Re.write_shift(2,dt),Re.write_shift(2,Ae),Re.write_shift(1,39);for(var Xt=0;Xt<Re.length;++Xt){var En=Fe.charCodeAt(Xt);Re.write_shift(1,En>=128?95:En)}return Re.write_shift(1,0),Re}function D(Ae,dt,Fe){var Re=Ut(7);return Re.write_shift(1,255),Re.write_shift(2,dt),Re.write_shift(2,Ae),Re.write_shift(2,Fe,"i"),Re}function T(Ae,dt,Fe){var Re=Ut(13);return Re.write_shift(1,255),Re.write_shift(2,dt),Re.write_shift(2,Ae),Re.write_shift(8,Fe,"f"),Re}function q(Ae,dt,Fe){var Re=32768&dt;return dt=(Re?Ae:0)+((dt&=-32769)>=8192?dt-16384:dt),(Re?"":"$")+(Fe?aa(dt):La(dt))}var Z={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},W=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Le(Ae){var dt=[{c:0,r:0},{t:"n",v:0},0];return dt[0].r=Ae.read_shift(2),dt[3]=Ae[Ae.l++],dt[0].c=Ae[Ae.l++],dt}function ge(Ae,dt,Fe,Re){var Xt=Ut(6+Re.length);Xt.write_shift(2,Ae),Xt.write_shift(1,Fe),Xt.write_shift(1,dt),Xt.write_shift(1,39);for(var En=0;En<Re.length;++En){var Sn=Re.charCodeAt(En);Xt.write_shift(1,Sn>=128?95:Sn)}return Xt.write_shift(1,0),Xt}function Ge(Ae,dt){var Fe=Le(Ae),Re=Ae.read_shift(4),Xt=Ae.read_shift(4),En=Ae.read_shift(2);if(65535==En)return 0===Re&&3221225472===Xt?(Fe[1].t="e",Fe[1].v=15):0===Re&&3489660928===Xt?(Fe[1].t="e",Fe[1].v=42):Fe[1].v=0,Fe;var Sn=32768&En;return En=(32767&En)-16446,Fe[1].v=(1-2*Sn)*(Xt*Math.pow(2,En+32)+Re*Math.pow(2,En)),Fe}function wt(Ae,dt,Fe,Re){var Xt=Ut(14);if(Xt.write_shift(2,Ae),Xt.write_shift(1,Fe),Xt.write_shift(1,dt),0==Re)return Xt.write_shift(4,0),Xt.write_shift(4,0),Xt.write_shift(2,65535),Xt;var En=0,Sn=0,dn=0;return Re<0&&(En=1,Re=-Re),Sn=0|Math.log2(Re),2147483648&(dn=(Re/=Math.pow(2,Sn-31))>>>0)||(++Sn,dn=(Re/=2)>>>0),Re-=dn,dn|=2147483648,dn>>>=0,Re*=Math.pow(2,32),Xt.write_shift(4,Re>>>0),Xt.write_shift(4,dn),Xt.write_shift(2,Sn+=16383+(En?32768:0)),Xt}function An(Ae,dt){var Fe=Le(Ae),Re=Ae.read_shift(8,"f");return Fe[1].v=Re,Fe}function Nn(Ae,dt){return 0==Ae[Ae.l+dt-1]?Ae.read_shift(dt,"cstr"):""}function mn(Ae,dt){var Fe=Ut(5+Ae.length);Fe.write_shift(2,14e3),Fe.write_shift(2,dt);for(var Re=0;Re<Ae.length;++Re){var Xt=Ae.charCodeAt(Re);Fe[Fe.l++]=Xt>127?95:Xt}return Fe[Fe.l++]=0,Fe}var Wn={0:{n:"BOF",f:hs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function s(Ae,dt,Fe){var Re={s:{c:0,r:0},e:{c:0,r:0}};return 8==dt&&Fe.qpro?(Re.s.c=Ae.read_shift(1),Ae.l++,Re.s.r=Ae.read_shift(2),Re.e.c=Ae.read_shift(1),Ae.l++,Re.e.r=Ae.read_shift(2),Re):(Re.s.c=Ae.read_shift(2),Re.s.r=Ae.read_shift(2),12==dt&&Fe.qpro&&(Ae.l+=2),Re.e.c=Ae.read_shift(2),Re.e.r=Ae.read_shift(2),12==dt&&Fe.qpro&&(Ae.l+=2),65535==Re.s.c&&(Re.s.c=Re.e.c=Re.s.r=Re.e.r=0),Re)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function E(Ae,dt,Fe){var Re=c(Ae,0,Fe);return Re[1].v=Ae.read_shift(2,"i"),Re}},14:{n:"NUMBER",f:function k(Ae,dt,Fe){var Re=c(Ae,0,Fe);return Re[1].v=Ae.read_shift(8,"f"),Re}},15:{n:"LABEL",f},16:{n:"FORMULA",f:function R(Ae,dt,Fe){var Re=Ae.l+dt,Xt=c(Ae,0,Fe);if(Xt[1].v=Ae.read_shift(8,"f"),Fe.qpro)Ae.l=Re;else{var En=Ae.read_shift(2);(function Ee(Ae,dt){hl(Ae,0);for(var Fe=[],Re=0,Xt="",En="",Sn="",bn="";Ae.l<Ae.length;){var dn=Ae[Ae.l++];switch(dn){case 0:Fe.push(Ae.read_shift(8,"f"));break;case 1:En=q(dt[0].c,Ae.read_shift(2),!0),Xt=q(dt[0].r,Ae.read_shift(2),!1),Fe.push(En+Xt);break;case 2:var li=q(dt[0].c,Ae.read_shift(2),!0),ke=q(dt[0].r,Ae.read_shift(2),!1);En=q(dt[0].c,Ae.read_shift(2),!0),Xt=q(dt[0].r,Ae.read_shift(2),!1),Fe.push(li+ke+":"+En+Xt);break;case 3:if(Ae.l<Ae.length)return void console.error("WK1 premature formula end");break;case 4:Fe.push("("+Fe.pop()+")");break;case 5:Fe.push(Ae.read_shift(2));break;case 6:for(var To="";dn=Ae[Ae.l++];)To+=String.fromCharCode(dn);Fe.push('"'+To.replace(/"/g,'""')+'"');break;case 8:Fe.push("-"+Fe.pop());break;case 23:Fe.push("+"+Fe.pop());break;case 22:Fe.push("NOT("+Fe.pop()+")");break;case 20:case 21:bn=Fe.pop(),Sn=Fe.pop(),Fe.push(["AND","OR"][dn-20]+"("+Sn+","+bn+")");break;default:if(dn<32&&W[dn])bn=Fe.pop(),Sn=Fe.pop(),Fe.push(Sn+W[dn]+bn);else{if(!Z[dn])return dn<=7?console.error("WK1 invalid opcode "+dn.toString(16)):dn<=24?console.error("WK1 unsupported op "+dn.toString(16)):dn<=30?console.error("WK1 invalid opcode "+dn.toString(16)):dn<=115?console.error("WK1 unsupported function opcode "+dn.toString(16)):console.error("WK1 unrecognized opcode "+dn.toString(16));if(69==(Re=Z[dn][1])&&(Re=Ae[Ae.l++]),Re>Fe.length)return void console.error("WK1 bad formula parse 0x"+dn.toString(16)+":|"+Fe.join("|")+"|");var Bi=Fe.slice(-Re);Fe.length-=Re,Fe.push(Z[dn][0]+"("+Bi.join(",")+")")}}}1==Fe.length?dt[1].f=""+Fe[0]:console.error("WK1 bad formula parse |"+Fe.join("|")+"|")})(Ae.slice(Ae.l,Ae.l+En),Xt),Ae.l+=En}return Xt}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Nn},222:{n:"SHEETNAMELP",f:function rn(Ae,dt){var Fe=Ae[Ae.l++];Fe>dt-1&&(Fe=dt-1);for(var Re="";Re.length<Fe;)Re+=String.fromCharCode(Ae[Ae.l++]);return Re}},65535:{n:""}},qt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function Pe(Ae,dt){var Fe=Le(Ae);return Fe[1].t="s",Fe[1].v=Ae.read_shift(dt-4,"cstr"),Fe}},23:{n:"NUMBER17",f:Ge},24:{n:"NUMBER18",f:function Ye(Ae,dt){var Fe=Le(Ae);Fe[1].v=Ae.read_shift(2);var Re=Fe[1].v>>1;if(1&Fe[1].v)switch(7&Re){case 0:Re=5e3*(Re>>3);break;case 1:Re=500*(Re>>3);break;case 2:Re=(Re>>3)/20;break;case 3:Re=(Re>>3)/200;break;case 4:Re=(Re>>3)/2e3;break;case 5:Re=(Re>>3)/2e4;break;case 6:Re=(Re>>3)/16;break;case 7:Re=(Re>>3)/64}return Fe[1].v=Re,Fe}},25:{n:"FORMULA19",f:function Mt(Ae,dt){var Fe=Ge(Ae);return Ae.l+=dt-14,Fe}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Ln(Ae,dt){for(var Fe={},Re=Ae.l+dt;Ae.l<Re;){var Xt=Ae.read_shift(2);if(14e3==Xt){for(Fe[Xt]=[0,""],Fe[Xt][0]=Ae.read_shift(2);Ae[Ae.l];)Fe[Xt][1]+=String.fromCharCode(Ae[Ae.l]),Ae.l++;Ae.l++}}return Fe}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function Qe(Ae,dt){var Fe=Le(Ae),Re=Ae.read_shift(4);return Fe[1].v=Re>>6,Fe}},38:{n:"??"},39:{n:"NUMBER27",f:An},40:{n:"FORMULA28",f:function rr(Ae,dt){var Fe=An(Ae);return Ae.l+=dt-10,Fe}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Nn},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function an(Ae,dt,Fe){if(Fe.qpro&&!(dt<21)){var Re=Ae.read_shift(1);return Ae.l+=17,Ae.l+=1,Ae.l+=2,[Re,Ae.read_shift(dt-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function r(Ae,dt){var Fe=dt||{};if(+Fe.codepage>=0&&Bu(+Fe.codepage),"string"==Fe.type)throw new Error("Cannot write WK1 to JS string");var Re=nc(),Xt=zi(Ae["!ref"]),En=Array.isArray(Ae),Sn=[];Vn(Re,0,function o(Ae){var dt=Ut(2);return dt.write_shift(2,Ae),dt}(1030)),Vn(Re,6,function l(Ae){var dt=Ut(8);return dt.write_shift(2,Ae.s.c),dt.write_shift(2,Ae.s.r),dt.write_shift(2,Ae.e.c),dt.write_shift(2,Ae.e.r),dt}(Xt));for(var bn=Math.min(Xt.e.r,8191),dn=Xt.s.r;dn<=bn;++dn)for(var li=La(dn),ke=Xt.s.c;ke<=Xt.e.c;++ke){dn===Xt.s.r&&(Sn[ke]=aa(ke));var Bi=En?(Ae[dn]||[])[ke]:Ae[Sn[ke]+li];Bi&&"z"!=Bi.t&&("n"==Bi.t?(0|Bi.v)==Bi.v&&Bi.v>=-32768&&Bi.v<=32767?Vn(Re,13,D(dn,ke,Bi.v)):Vn(Re,14,T(dn,ke,Bi.v)):Vn(Re,15,v(dn,ke,Mf(Bi).slice(0,239))))}return Vn(Re,1),Re.end()},book_to_wk3:function i(Ae,dt){var Fe=dt||{};if(+Fe.codepage>=0&&Bu(+Fe.codepage),"string"==Fe.type)throw new Error("Cannot write WK3 to JS string");var Re=nc();Vn(Re,0,function a(Ae){var dt=Ut(26);dt.write_shift(2,4096),dt.write_shift(2,4),dt.write_shift(4,0);for(var Fe=0,Re=0,Xt=0,En=0;En<Ae.SheetNames.length;++En){var bn=Ae.Sheets[Ae.SheetNames[En]];if(bn&&bn["!ref"]){++Xt;var dn=rc(bn["!ref"]);Fe<dn.e.r&&(Fe=dn.e.r),Re<dn.e.c&&(Re=dn.e.c)}}return Fe>8191&&(Fe=8191),dt.write_shift(2,Fe),dt.write_shift(1,Xt),dt.write_shift(1,Re),dt.write_shift(2,0),dt.write_shift(2,0),dt.write_shift(1,1),dt.write_shift(1,2),dt.write_shift(4,0),dt.write_shift(4,0),dt}(Ae));for(var Xt=0,En=0;Xt<Ae.SheetNames.length;++Xt)(Ae.Sheets[Ae.SheetNames[Xt]]||{})["!ref"]&&Vn(Re,27,mn(Ae.SheetNames[Xt],En++));var Sn=0;for(Xt=0;Xt<Ae.SheetNames.length;++Xt){var bn=Ae.Sheets[Ae.SheetNames[Xt]];if(bn&&bn["!ref"]){for(var dn=zi(bn["!ref"]),li=Array.isArray(bn),ke=[],To=Math.min(dn.e.r,8191),Bi=dn.s.r;Bi<=To;++Bi)for(var Mo=La(Bi),ji=dn.s.c;ji<=dn.e.c;++ji){Bi===dn.s.r&&(ke[ji]=aa(ji));var Za=li?(bn[Bi]||[])[ji]:bn[ke[ji]+Mo];Za&&"z"!=Za.t&&("n"==Za.t?Vn(Re,23,wt(Bi,ji,Sn,Za.v)):Vn(Re,22,ge(Bi,ji,Sn,Mf(Za).slice(0,239))))}++Sn}}return Vn(Re,1),Re.end()},to_workbook:function n(Ae,dt){switch(dt.type){case"base64":return e(eu(Jc(Ae)),dt);case"binary":return e(eu(Ae),dt);case"buffer":case"array":return e(Ae,dt)}throw"Unsupported type "+dt.type}}}(),oZ=function(){var t=ub("t"),n=ub("rPr");function e(o){var a=o.match(t);if(!a)return{t:"s",v:""};var s={t:"s",v:ro(a[1])},l=o.match(n);return l&&(s.s=function iZ(t){var n={},e=t.match(Pl),r=0,i=!1;if(e)for(;r!=e.length;++r){var o=ri(e[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==o.val)break;n.cp=K5[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting"}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==o[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+o[0])}}return n}(l[1])),s}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(r,"").split(i).map(e).filter(function(s){return s.v})}}(),aZ=function(){var n=/(\r\n|\n)/g;function r(i){var o=[[],i.v,[]];return i.v?(i.s&&function e(i,o,a){var s=[];i.u&&s.push("text-decoration: underline;"),i.uval&&s.push("text-underline-style:"+i.uval+";"),i.sz&&s.push("font-size:"+i.sz+"pt;"),i.outline&&s.push("text-effect: outline;"),i.shadow&&s.push("text-shadow: auto;"),o.push('<span style="'+s.join("")+'">'),i.b&&(o.push("<b>"),a.push("</b>")),i.i&&(o.push("<i>"),a.push("</i>")),i.strike&&(o.push("<s>"),a.push("</s>"));var l=i.valign||"";"superscript"==l||"super"==l?l="sup":"subscript"==l&&(l="sub"),""!=l&&(o.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>")}(i.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}}(),sZ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,lZ=/<(?:\w+:)?r>/,cZ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function RS(t,n){var e=!n||n.cellHTML,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=ro(Lo(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Lo(t),e&&(r.h=aS(r.t))):t.match(lZ)&&(r.r=Lo(t),r.t=ro(Lo((t.replace(cZ,"").match(sZ)||[]).join("").replace(Pl,""))),e&&(r.h=aZ(oZ(r.r)))),r):{t:""}}var uZ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,dZ=/<(?:\w+:)?(?:si|sstItem)>/g,fZ=/<\/(?:\w+:)?(?:si|sstItem)>/,pZ=/^\s|\s$|[\t\n\r]/;function qO(t,n){if(!n.bookSST)return"";var e=[Ra];e[e.length]=Bn("sst",null,{xmlns:rm[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(null!=t[r]){var i=t[r],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(pZ)&&(o+=' xml:space="preserve"'),o+=">"+Ao(i.t)+"</t>"),e[e.length]=o+="</si>"}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}var vZ=function TY(t,n){var e=!1;return null==n&&(e=!0,n=Ut(15+4*t.t.length)),n.write_shift(1,0),Ws(t.t,n),e?n.slice(0,n.l):n};function bZ(t){var n=nc();_n(n,159,function _Z(t,n){return n||(n=Ut(8)),n.write_shift(4,t.Count),n.write_shift(4,t.Unique),n}(t));for(var e=0;e<t.length;++e)_n(n,19,vZ(t[e]));return _n(n,160),n.end()}function GO(t){if(typeof eo<"u")return eo.utils.encode(Ig,t);for(var n=[],e=t.split(""),r=0;r<e.length;++r)n[r]=e[r].charCodeAt(0);return n}function Fh(t,n){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),n>=4&&(t.l+=n-4),e}function wZ(t){for(var n=t.read_shift(4),e=t.l+n-4,r={},i=t.read_shift(4),o=[];i-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=o,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return r}function YO(t,n){var e=t.l+n,r={};r.Flags=63&t.read_shift(4),t.l+=4,r.AlgID=t.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=36==r.Flags;break;case 26625:i=4==r.Flags;break;case 0:i=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,r}function XO(t,n){var e={},r=t.l+n;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,r),t.l=r,e}function AZ(t){if(36!=(63&t.read_shift(4)))throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4);return{t:"Std",h:YO(t,e),v:XO(t,t.length-t.l)}}function TZ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function MZ(t){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),r={};return e.replace(Pl,function(o){var a=ri(o);switch(Af(a[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":n.forEach(function(s){r[s]=a[s]});break;case"<dataIntegrity":r.encryptedHmacKey=a.encryptedHmacKey,r.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=a.uri;break;case"<encryptedKey":r.encs.push(a);break;default:throw a[0]}}),r}function LS(t){var e,o,n=0,r=GO(t),i=r.length+1;for((e=Qp(i))[0]=r.length,o=1;o!=i;++o)e[o]=r[o-1];for(o=i-1;o>=0;--o)n=((16384&n?1:0)|n<<1&32767)^e[o];return 52811^n}var KO=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(a,s){return function(a){return 255&(a/2|128*a)}(a^s)};return function(a){for(var s=GO(a),l=function(a){for(var s=n[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var f=a[c],v=0;7!=v;++v)64&f&&(s^=e[l]),f*=2,--l;return s}(s),c=s.length,f=Qp(16),v=0;16!=v;++v)f[v]=0;var k;for(1==(1&c)&&(f[c]=i(t[0],l>>8),f[--c]=i(s[s.length-1],255&l));c>0;)f[--c]=i(s[c],l>>8),f[--c]=i(s[c],255&l);for(c=15,k=15-s.length;k>0;)f[c]=i(t[k],l>>8),--k,f[--c]=i(s[c],255&l),--c,--k;return f}}();var ZO=function(){function t(i,o){switch(o.type){case"base64":return n(Jc(i),o);case"binary":return n(i,o);case"buffer":return n(Mi&&Buffer.isBuffer(i)?i.toString("binary"):Jp(i),o);case"array":return n(Ng(i),o)}throw new Error("Unrecognized type "+o.type)}function n(i,o){var s=(o||{}).dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,v){Array.isArray(s)&&(s[v]=[]);for(var k,E=/\\\w+\b/g,D=0,T=-1;k=E.exec(f);){if("\\cell"===k[0]){var R=f.slice(D,E.lastIndex-k[0].length);if(" "==R[0]&&(R=R.slice(1)),++T,R.length){var q={v:R,t:"s"};Array.isArray(s)?s[v][T]=q:s[Jr({r:v,c:T})]=q}}D=E.lastIndex}T>c.e.c&&(c.e.c=T)}),s["!ref"]=bi(c),s}return{to_workbook:function e(i,o){return im(t(i,o),o)},to_sheet:t,from_sheet:function r(i){for(var s,o=["{\\rtf1\\ansi"],a=zi(i["!ref"]),l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){o.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)o.push("\\cellx"+(f+1));for(o.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var v=Jr({r:c,c:f});(s=l?(i[c]||[])[f]:i[v])&&(null!=s.v||s.f&&!s.F)&&(o.push(" "+(s.w||(Mf(s),s.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}}}();function yb(t){for(var n=0,e=1;3!=n;++n)e=256*e+(t[n]>255?255:t[n]<0?0:t[n]);return e.toString(16).toUpperCase().slice(1)}function Hw(t,n){if(0===n)return t;var e=function BZ(t){var n=t[0]/255,e=t[1]/255,r=t[2]/255,i=Math.max(n,e,r),o=Math.min(n,e,r),a=i-o;if(0===a)return[0,0,n];var l,s=0,c=i+o;switch(l=a/(c>1?2-c:c),i){case n:s=((e-r)/a+6)%6;break;case e:s=(r-n)/a+2;break;case r:s=(n-e)/a+4}return[s/6,l,c/2]}(function LZ(t){var n=t.slice("#"===t[0]?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}(t));return e[2]=n<0?e[2]*(1+n):1-(1-e[2])*(1-n),yb(function jZ(t){var l,e=t[1],r=t[2],i=2*e*(r<.5?r:1-r),o=r-i/2,a=[o,o,o],s=6*t[0];if(0!==e)switch(0|s){case 0:case 6:l=i*s,a[0]+=i,a[1]+=l;break;case 1:a[0]+=l=i*(2-s),a[1]+=i;break;case 2:l=i*(s-2),a[1]+=i,a[2]+=l;break;case 3:a[1]+=l=i*(4-s),a[2]+=i;break;case 4:l=i*(s-4),a[2]+=i,a[0]+=l;break;case 5:a[2]+=l=i*(6-s),a[0]+=i}for(var c=0;3!=c;++c)a[c]=Math.round(255*a[c]);return a}(e))}var QO=6,VZ=15,UZ=1,Bl=QO;function wb(t){return Math.floor((t+Math.round(128/Bl)/256)*Bl)}function xb(t){return Math.floor((t-5)/Bl*100+.5)/100}function zw(t){return Math.round((t*Bl+5)/Bl*256)/256}function BS(t){return zw(xb(wb(t)))}function jS(t){var n=Math.abs(t-BS(t)),e=Bl;if(n>.005)for(Bl=UZ;Bl<VZ;++Bl)Math.abs(t-BS(t))<=n&&(n=Math.abs(t-BS(t)),e=Bl);Bl=e}function am(t){t.width?(t.wpx=wb(t.width),t.wch=xb(t.wpx),t.MDW=Bl):t.wpx?(t.wch=xb(t.wpx),t.width=zw(t.wch),t.MDW=Bl):"number"==typeof t.wch&&(t.width=zw(t.wch),t.wpx=wb(t.width),t.MDW=Bl),t.customWidth&&delete t.customWidth}var JO=96;function Cb(t){return 96*t/JO}function o_(t){return t*JO/96}var zZ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},$w=["numFmtId","fillId","fontId","borderId","xfId"],Ww=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],ZZ=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,l,c){var v,f={};return s?((v=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(n))&&function GZ(t,n,e){n.NumberFmt=[];for(var r=Oa(qr),i=0;i<r.length;++i)n.NumberFmt[r[i]]=qr[r[i]];var o=t[0].match(Pl);if(o)for(i=0;i<o.length;++i){var a=ri(o[i]);switch(Af(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var s=ro(Lo(a.formatCode)),l=parseInt(a.numFmtId,10);if(n.NumberFmt[l]=s,l>0){if(l>392){for(l=392;l>60&&null!=n.NumberFmt[l];--l);n.NumberFmt[l]=s}Df(s,l)}break;default:if(e.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}(v,f,c),(v=s.match(i))&&function qZ(t,n,e,r){n.Fonts=[];var i={},o=!1;(t[0].match(Pl)||[]).forEach(function(a){var s=ri(a);switch(Af(s[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":n.Fonts.push(i),i={};break;case"<name":s.val&&(i.name=Lo(s.val));break;case"<b":i.bold=s.val?oa(s.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=s.val?oa(s.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(s.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=s.val?oa(s.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=s.val?oa(s.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=s.val?oa(s.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=s.val?oa(s.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=s.val?oa(s.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":s.val&&(i.sz=+s.val);break;case"<vertAlign":s.val&&(i.vertAlign=s.val);break;case"<family":s.val&&(i.family=parseInt(s.val,10));break;case"<scheme":s.val&&(i.scheme=s.val);break;case"<charset":if("1"==s.val)break;s.codepage=K5[parseInt(s.val,10)];break;case"<color":if(i.color||(i.color={}),s.auto&&(i.color.auto=oa(s.auto)),s.rgb)i.color.rgb=s.rgb.slice(-6);else if(s.indexed){i.color.index=parseInt(s.indexed,10);var l=Hg[i.color.index];81==i.color.index&&(l=Hg[1]),l||(l=Hg[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else s.theme&&(i.color.theme=parseInt(s.theme,10),s.tint&&(i.color.tint=parseFloat(s.tint)),s.theme&&e.themeElements&&e.themeElements.clrScheme&&(i.color.rgb=Hw(e.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":o=!0;break;case"</AlternateContent>":case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+s[0]+" in fonts")}})}(v,f,l,c),(v=s.match(r))&&function WZ(t,n,e,r){n.Fills=[];var i={},o=!1;(t[0].match(Pl)||[]).forEach(function(a){var s=ri(a);switch(Af(s[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":n.Fills.push(i={});break;case"<gradientFill":case"</gradientFill>":n.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":s.patternType&&(i.patternType=s.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),s.indexed&&(i.bgColor.indexed=parseInt(s.indexed,10)),s.theme&&(i.bgColor.theme=parseInt(s.theme,10)),s.tint&&(i.bgColor.tint=parseFloat(s.tint)),s.rgb&&(i.bgColor.rgb=s.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),s.theme&&(i.fgColor.theme=parseInt(s.theme,10)),s.tint&&(i.fgColor.tint=parseFloat(s.tint)),null!=s.rgb&&(i.fgColor.rgb=s.rgb.slice(-6));break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+s[0]+" in fills")}})}(v,f,0,c),(v=s.match(o))&&function $Z(t,n,e,r){n.Borders=[];var i={},o=!1;(t[0].match(Pl)||[]).forEach(function(a){var s=ri(a);switch(Af(s[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},s.diagonalUp&&(i.diagonalUp=oa(s.diagonalUp)),s.diagonalDown&&(i.diagonalDown=oa(s.diagonalDown)),n.Borders.push(i);break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+s[0]+" in borders")}})}(v,f,0,c),(v=s.match(e))&&function XZ(t,n,e){n.CellXf=[];var r,i=!1;(t[0].match(Pl)||[]).forEach(function(o){var a=ri(o),s=0;switch(Af(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=a)[0],s=0;s<$w.length;++s)r[$w[s]]&&(r[$w[s]]=parseInt(r[$w[s]],10));for(s=0;s<Ww.length;++s)r[Ww[s]]&&(r[Ww[s]]=oa(r[Ww[s]]));if(n.NumberFmt&&r.numFmtId>392)for(s=392;s>60;--s)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[s]){r.numFmtId=s;break}n.CellXf.push(r);break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),null!=a.textRotation&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=oa(a.wrapText)),r.alignment=l;break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(e&&e.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}(v,f,c),f):f}}();function eN(t,n){var r,e=[Ra,Bn("styleSheet",null,{xmlns:rm[0],"xmlns:vt":fs.vt})];return t.SSF&&null!=(r=function YZ(t){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&(n[n.length]=Bn("numFmt",null,{numFmtId:r,formatCode:Ao(t[r])}))}),1===n.length?"":(n[n.length]="</numFmts>",n[0]=Bn("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}(t.SSF))&&(e[e.length]=r),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function KZ(t){var n=[];return n[n.length]=Bn("cellXfs",null),t.forEach(function(e){n[n.length]=Bn("xf",null,e)}),n[n.length]="</cellXfs>",2===n.length?"":(n[0]=Bn("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}(n.cellXfs))&&(e[e.length]=r),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function JZ(t,n,e){e||(e=Ut(6+4*n.length)),e.write_shift(2,t),Ws(n,e);var r=e.length>e.l?e.slice(0,e.l):e;return null==e.l&&(e.l=e.length),r}var VS,nQ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rQ=Ol;function tN(t,n){n||(n=Ut(84)),VS||(VS=Sw(nQ));var e=VS[t.patternType];null==e&&(e=40),n.write_shift(4,e);var r=0;if(40!=e)for(Pw({auto:1},n),Pw({auto:1},n);r<12;++r)n.write_shift(4,0);else{for(;r<4;++r)n.write_shift(4,0);for(;r<12;++r)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function nN(t,n,e){return e||(e=Ut(16)),e.write_shift(2,n||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function Eb(t,n){return n||(n=Ut(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var oQ=Ol;function bQ(t,n){var e=nc();return _n(e,278),function uQ(t,n){if(n){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=n[i]&&++e}),0!=e&&(_n(t,615,Ed(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=n[i]&&_n(t,44,JZ(i,n[i]))}),_n(t,616))}}(e,t.SSF),function dQ(t){_n(t,611,Ed(1)),_n(t,43,function tQ(t,n){n||(n=Ut(153)),n.write_shift(2,20*t.sz),function RY(t,n){n||(n=Ut(2)),n.write_shift(1,(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0)),n.write_shift(1,0)}(t,n),n.write_shift(2,t.bold?700:400);var e=0;"superscript"==t.vertAlign?e=1:"subscript"==t.vertAlign&&(e=2),n.write_shift(2,e),n.write_shift(1,t.underline||0),n.write_shift(1,t.family||0),n.write_shift(1,t.charset||0),n.write_shift(1,0),Pw(t.color,n);var r=0;return"major"==t.scheme&&(r=1),"minor"==t.scheme&&(r=2),n.write_shift(1,r),Ws(t.name,n),n.length>n.l?n.slice(0,n.l):n}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),_n(t,612)}(e),function fQ(t){_n(t,603,Ed(2)),_n(t,45,tN({patternType:"none"})),_n(t,45,tN({patternType:"gray125"})),_n(t,604)}(e),function hQ(t){_n(t,613,Ed(1)),_n(t,46,function aQ(t,n){return n||(n=Ut(51)),n.write_shift(1,0),Eb(0,n),Eb(0,n),Eb(0,n),Eb(0,n),Eb(0,n),n.length>n.l?n.slice(0,n.l):n}()),_n(t,614)}(e),function pQ(t){_n(t,626,Ed(1)),_n(t,47,nN({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),_n(t,627)}(e),function mQ(t,n){_n(t,617,Ed(n.length)),n.forEach(function(e){_n(t,47,nN(e,0))}),_n(t,618)}(e,n.cellXfs),function gQ(t){_n(t,619,Ed(1)),_n(t,48,function sQ(t,n){return n||(n=Ut(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),Iw(t.name||"",n),n.length>n.l?n.slice(0,n.l):n}({xfId:0,builtinId:0,name:"Normal"})),_n(t,620)}(e),function _Q(t){_n(t,505,Ed(0)),_n(t,506)}(e),function vQ(t){_n(t,508,function lQ(t,n,e){var r=Ut(2052);return r.write_shift(4,t),Iw(n,r),Iw(e,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),_n(t,509)}(e),_n(e,279),e.end()}var yQ=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function wQ(t,n,e){n.themeElements.clrScheme=[];var r={};(t[0].match(Pl)||[]).forEach(function(i){var o=ri(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===o[0].charAt(1)?(n.themeElements.clrScheme[yQ.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function xQ(){}function CQ(){}var EQ=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,SQ=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,DQ=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,TQ=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function rN(t,n){(!t||0===t.length)&&(t=US());var e,r={};if(!(e=t.match(TQ)))throw new Error("themeElements not found in theme");return function AQ(t,n,e){var r;n.themeElements={},[["clrScheme",EQ,wQ],["fontScheme",SQ,xQ],["fmtScheme",DQ,CQ]].forEach(function(i){if(!(r=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,n,e)})}(e[0],r,n),r.raw=t,r}function US(t,n){if(n&&n.themeXLSX)return n.themeXLSX;if(t&&"string"==typeof t.raw)return t.raw;var e=[Ra];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',e[e.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',e[e.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',e[e.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',e[e.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',e[e.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',e[e.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function OQ(t){var n=t.read_shift(2),e=t.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=function FQ(t){var n={};switch(n.xclrType=t.read_shift(2),n.nTintShade=t.read_shift(2),n.xclrType){case 0:case 4:t.l+=4;break;case 1:n.xclrValue=function IQ(t,n){return Ol(t,n)}(t,4);break;case 2:n.xclrValue=AO(t);break;case 3:n.xclrValue=function kQ(t){return t.read_shift(4)}(t)}return t.l+=8,n}(t);break;case 6:r[1]=function PQ(t,n){return Ol(t,n)}(t,e);break;case 14:case 15:r[1]=t.read_shift(1===e?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+e)}return r}function RQ(t,n){n.forEach(function(e){})}function WQ(){var t=nc();return _n(t,332),_n(t,334,Ed(1)),_n(t,335,function BQ(t){var n=Ut(12+2*t.name.length);return n.write_shift(4,t.flags),n.write_shift(4,t.version),Ws(t.name,n),n.slice(0,n.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),_n(t,336),_n(t,339,function UQ(t,n){var e=Ut(8+2*n.length);return e.write_shift(4,t),Ws(n,e),e.slice(0,e.l)}(1,"XLDAPR")),_n(t,52),_n(t,35,Ed(514)),_n(t,4096,Ed(0)),_n(t,4097,zu(1)),_n(t,36),_n(t,53),_n(t,340),_n(t,337,function zQ(t,n){var e=Ut(8);return e.write_shift(4,t),e.write_shift(4,n?1:0),e}(1,!0)),_n(t,51,function VQ(t){var n=Ut(4+8*t.length);n.write_shift(4,t.length);for(var e=0;e<t.length;++e)n.write_shift(4,t[e][0]),n.write_shift(4,t[e][1]);return n}([[1,0]])),_n(t,338),_n(t,333),t.end()}function iN(){var t=[Ra];return t.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),t.join("")}var a_=1024;function oN(t,n){for(var e=[21600,21600],r=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),i=[Bn("xml",null,{"xmlns:v":ru.v,"xmlns:o":ru.o,"xmlns:x":ru.x,"xmlns:mv":ru.mv}).replace(/\/>/,">"),Bn("o:shapelayout",Bn("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Bn("v:shapetype",[Bn("v:stroke",null,{joinstyle:"miter"}),Bn("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:r})];a_<1e3*t;)a_+=1e3;return n.forEach(function(o){var a=ya(o[0]),s={color2:"#BEFF82",type:"gradient"};"gradient"==s.type&&(s.angle="-180");var l="gradient"==s.type?Bn("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Bn("v:fill",l,s);++a_,i=i.concat(["<v:shape"+db({id:"_x0000_s"+a_,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Bn("v:shadow",null,{on:"t",obscured:"t"}),Bn("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fl("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),fl("x:AutoFill","False"),fl("x:Row",String(a.r)),fl("x:Column",String(a.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function aN(t,n,e,r){var o,i=Array.isArray(t);n.forEach(function(a){var s=ya(a.ref);if(i?(t[s.r]||(t[s.r]=[]),o=t[s.r][s.c]):o=t[a.ref],!o){o={t:"z"},i?t[s.r][s.c]=o:t[a.ref]=o;var l=zi(t["!ref"]||"BDWGO1000001:A1");l.s.r>s.r&&(l.s.r=s.r),l.e.r<s.r&&(l.e.r=s.r),l.s.c>s.c&&(l.s.c=s.c),l.e.c<s.c&&(l.e.c=s.c);var c=bi(l);c!==t["!ref"]&&(t["!ref"]=c)}o.c||(o.c=[]);var f={a:a.author,t:a.t,r:a.r,T:e};a.h&&(f.h=a.h);for(var v=o.c.length-1;v>=0;--v){if(!e&&o.c[v].T)return;e&&!o.c[v].T&&o.c.splice(v,1)}if(e&&r)for(v=0;v<r.length;++v)if(f.a==r[v].id){f.a=r[v].name||f.a;break}o.c.push(f)})}function sN(t){var n=[Ra,Bn("comments",null,{xmlns:rm[0]})],e=[];return n.push("<authors>"),t.forEach(function(r){r[1].forEach(function(i){var o=Ao(i.a);-1==e.indexOf(o)&&(e.push(o),n.push("<author>"+o+"</author>")),i.T&&i.ID&&-1==e.indexOf("tc="+i.ID)&&(e.push("tc="+i.ID),n.push("<author>tc="+i.ID+"</author>"))})}),0==e.length&&(e.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),t.forEach(function(r){var i=0,o=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=e.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=e.indexOf(Ao(l.a))),o.push(l.t||"")}),n.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),o.length<=1)n.push(fl("t",Ao(o[0]||"")));else{for(var a="Comment:\n    "+o[0]+"\n",s=1;s<o.length;++s)a+="Reply:\n    "+o[s]+"\n";n.push(fl("t",Ao(a)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function eJ(t,n,e){var r=[Ra,Bn("ThreadedComments",null,{xmlns:fs.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var o="";(i[1]||[]).forEach(function(a,s){if(a.T){a.a&&-1==n.indexOf(a.a)&&n.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};0==s?o=l.id:l.parentId=o,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(a.a)).slice(-12)+"}"),r.push(Bn("threadedComment",fl("text",a.t||""),l))}else delete a.ID})}),r.push("</ThreadedComments>"),r.join("")}var oJ=Nl;function lJ(t){var n=nc(),e=[];return _n(n,628),_n(n,630),t.forEach(function(r){r[1].forEach(function(i){e.indexOf(i.a)>-1||(e.push(i.a.slice(0,54)),_n(n,632,function aJ(t){return Ws(t.slice(0,54))}(i.a)))})}),_n(n,631),_n(n,633),t.forEach(function(r){r[1].forEach(function(i){i.iauthor=e.indexOf(i.a);var o={s:ya(r[0]),e:ya(r[0])};_n(n,635,function iJ(t,n){return null==n&&(n=Ut(36)),n.write_shift(4,t[1].iauthor),n_(t[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}([o,i])),i.t&&i.t.length>0&&_n(n,637,function kY(t,n){var e=!1;return null==n&&(e=!0,n=Ut(23+4*t.t.length)),n.write_shift(1,1),Ws(t.t,n),n.write_shift(4,1),function AY(t,n){n||(n=Ut(4)),n.write_shift(2,t.ich||0),n.write_shift(2,t.ifnt||0)}({ich:0,ifnt:0},n),e?n.slice(0,n.l):n}(i)),_n(n,636),delete i.iauthor})}),_n(n,634),_n(n,629),n.end()}var cJ="application/vnd.ms-office.vbaProject",lN=["xlsb","xlsm","xlam","biff8","xla"],s_=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function e(r,i,o,a){var s=!1,l=!1;0==o.length?l=!0:"["==o.charAt(0)&&(l=!0,o=o.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var c=o.length>0?0|parseInt(o,10):0,f=a.length>0?0|parseInt(a,10):0;return s?f+=n.c:--f,l?c+=n.r:--c,i+(s?"":"$")+aa(f)+(l?"":"$")+La(c)}return function(i,o){return n=o,i.replace(t,e)}}(),HS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zS=function(){return function(n,e){return n.replace(HS,function(r,i,o,a,s,l){var c=vS(a)-(o?0:e.c),f=_S(l)-(s?0:e.r);return i+"R"+(0==f?"":s?f+1:"["+f+"]")+"C"+(0==c?"":o?c+1:"["+c+"]")})}}();function cN(t,n){return t.replace(HS,function(e,r,i,o,a,s){return r+("$"==i?i+o:aa(vS(o)+n.c))+("$"==a?a+s:La(_S(s)+n.r))})}function gJ(t,n,e){var i=rc(n).s,o=ya(e);return cN(t,{r:o.r-i.r,c:o.c-i.c})}function uN(t){return t.replace(/_xlfn\./g,"")}function ps(t){t.l+=1}function sm(t,n){var e=t.read_shift(1==n?1:2);return[16383&e,e>>14&1,e>>15&1]}function dN(t,n,e){var r=2;if(e){if(e.biff>=2&&e.biff<=5)return fN(t);12==e.biff&&(r=4)}var i=t.read_shift(r),o=t.read_shift(r),a=sm(t,2),s=sm(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:o,c:s[0],cRel:s[1],rRel:s[2]}}}function fN(t){var n=sm(t,2),e=sm(t,2),r=t.read_shift(1),i=t.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function hN(t,n,e){if(e&&e.biff>=2&&e.biff<=5)return function bJ(t){var n=sm(t,2),e=t.read_shift(1);return{r:n[0],c:e,cRel:n[1],rRel:n[2]}}(t);var r=t.read_shift(e&&12==e.biff?4:2),i=sm(t,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function yJ(t){var n=t.read_shift(2),e=t.read_shift(2);return{r:n,c:255&e,fQuoted:!!(16384&e),cRel:e>>15,rRel:e>>15}}function pN(t){var n=1&t[t.l+1];return t.l+=4,[n,1]}function mN(t){return[t.read_shift(1),t.read_shift(1)]}function XJ(t,n){var e=[t.read_shift(1)];if(12==n)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2}switch(e[0]){case 4:e[1]=Xa(t,1)?"TRUE":"FALSE",12!=n&&(t.l+=7);break;case 37:case 16:e[1]=kh[t[t.l]],t.l+=12==n?4:8;break;case 0:t.l+=8;break;case 1:e[1]=Rl(t);break;case 2:e[1]=Wg(t,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function KJ(t,n,e){for(var r=t.read_shift(12==e.biff?4:2),i=[],o=0;o!=r;++o)i.push((12==e.biff?Vg:Vw)(t,8));return i}function ZJ(t,n,e){var r=0,i=0;12==e.biff?(r=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),r=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--r,0==--i&&(i=256));for(var o=0,a=[];o!=r&&(a[o]=[]);++o)for(var s=0;s!=i;++s)a[o][s]=XJ(t,e.biff);return a}function Sb(t,n,e){return t.l+=2,[yJ(t)]}function $S(t){return t.l+=6,[]}function gN(t){return t.l+=2,[hs(t),1&t.read_shift(2)]}var _ee=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],_N={1:{n:"PtgExp",f:function zJ(t,n,e){return t.l++,e&&12==e.biff?[t.read_shift(4,"i"),0]:[t.read_shift(2),t.read_shift(e&&2==e.biff?1:2)]}},2:{n:"PtgTbl",f:Ol},3:{n:"PtgAdd",f:ps},4:{n:"PtgSub",f:ps},5:{n:"PtgMul",f:ps},6:{n:"PtgDiv",f:ps},7:{n:"PtgPower",f:ps},8:{n:"PtgConcat",f:ps},9:{n:"PtgLt",f:ps},10:{n:"PtgLe",f:ps},11:{n:"PtgEq",f:ps},12:{n:"PtgGe",f:ps},13:{n:"PtgGt",f:ps},14:{n:"PtgNe",f:ps},15:{n:"PtgIsect",f:ps},16:{n:"PtgUnion",f:ps},17:{n:"PtgRange",f:ps},18:{n:"PtgUplus",f:ps},19:{n:"PtgUminus",f:ps},20:{n:"PtgPercent",f:ps},21:{n:"PtgParen",f:ps},22:{n:"PtgMissArg",f:ps},23:{n:"PtgStr",f:function YJ(t,n,e){return t.l++,vb(t,0,e)}},26:{n:"PtgSheet",f:function yee(t,n,e){return t.l+=5,t.l+=2,t.l+=2==e.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function wee(t,n,e){return t.l+=2==e.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function $J(t){return t.l++,kh[t.read_shift(1)]}},29:{n:"PtgBool",f:function qJ(t){return t.l++,0!==t.read_shift(1)}},30:{n:"PtgInt",f:function WJ(t){return t.l++,t.read_shift(2)}},31:{n:"PtgNum",f:function GJ(t){return t.l++,Rl(t)}},32:{n:"PtgArray",f:function TJ(t,n,e){var r=(96&t[t.l++])>>5;return t.l+=2==e.biff?6:12==e.biff?14:7,[r]}},33:{n:"PtgFunc",f:function jJ(t,n,e){var r=(96&t[t.l])>>5;t.l+=1;var i=t.read_shift(e&&e.biff<=3?1:2);return[Hee[i],yN[i],r]}},34:{n:"PtgFuncVar",f:function VJ(t,n,e){var r=t[t.l++],i=t.read_shift(1),o=e&&e.biff<=3?[88==r?-1:0,t.read_shift(1)]:function UJ(t){return[t[t.l+1]>>7,32767&t.read_shift(2)]}(t);return[i,(0===o[0]?yN:Uee)[o[1]]]}},35:{n:"PtgName",f:function QJ(t,n,e){var r=t.read_shift(1)>>>5&3,o=t.read_shift(!e||e.biff>=8?4:2);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12}return[r,0,o]}},36:{n:"PtgRef",f:function RJ(t,n,e){var r=(96&t[t.l])>>5;return t.l+=1,[r,hN(t,0,e)]}},37:{n:"PtgArea",f:function CJ(t,n,e){return[(96&t[t.l++])>>5,dN(t,0,e)]}},38:{n:"PtgMemArea",f:function tee(t,n,e){var r=t.read_shift(1)>>>5&3;return t.l+=e&&2==e.biff?3:4,[r,t.read_shift(e&&2==e.biff?1:2)]}},39:{n:"PtgMemErr",f:Ol},40:{n:"PtgMemNoMem",f:Ol},41:{n:"PtgMemFunc",f:function nee(t,n,e){return[t.read_shift(1)>>>5&3,t.read_shift(e&&2==e.biff?1:2)]}},42:{n:"PtgRefErr",f:function ree(t,n,e){var r=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,12==e.biff&&(t.l+=2),[r]}},43:{n:"PtgAreaErr",f:function SJ(t,n,e){var r=(96&t[t.l++])>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function LJ(t,n,e){var r=(96&t[t.l])>>5;t.l+=1;var i=function wJ(t,n,e){var r=e&&e.biff?e.biff:8;if(r>=2&&r<=5)return function xJ(t){var n=t.read_shift(2),e=t.read_shift(1),r=(32768&n)>>15,i=(16384&n)>>14;return n&=16383,1==r&&n>=8192&&(n-=16384),1==i&&e>=128&&(e-=256),{r:n,c:e,cRel:i,rRel:r}}(t);var i=t.read_shift(r>=12?4:2),o=t.read_shift(2),a=(16384&o)>>14,s=(32768&o)>>15;if(o&=16383,1==s)for(;i>524287;)i-=1048576;if(1==a)for(;o>8191;)o-=16384;return{r:i,c:o,cRel:a,rRel:s}}(t,0,e);return[r,i]}},45:{n:"PtgAreaN",f:function AJ(t,n,e){var r=(96&t[t.l++])>>5,i=function vJ(t,n,e){if(e.biff<8)return fN(t);var r=t.read_shift(12==e.biff?4:2),i=t.read_shift(12==e.biff?4:2),o=sm(t,2),a=sm(t,2);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}(t,0,e);return[r,i]}},46:{n:"PtgMemAreaN",f:function xee(t){return[t.read_shift(1)>>>5&3,t.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function Cee(t){return[t.read_shift(1)>>>5&3,t.read_shift(2)]}},57:{n:"PtgNameX",f:function JJ(t,n,e){return 5==e.biff?function eee(t){var n=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[n,e,r]}(t):[t.read_shift(1)>>>5&3,t.read_shift(2),t.read_shift(4)]}},58:{n:"PtgRef3d",f:function BJ(t,n,e){var r=(96&t[t.l])>>5;t.l+=1;var i=t.read_shift(2);return e&&5==e.biff&&(t.l+=12),[r,i,hN(t,0,e)]}},59:{n:"PtgArea3d",f:function EJ(t,n,e){var r=(96&t[t.l++])>>5,i=t.read_shift(2,"i");if(e&&5===e.biff)t.l+=12;return[r,i,dN(t,0,e)]}},60:{n:"PtgRefErr3d",f:function iee(t,n,e){var r=(96&t[t.l++])>>5,i=t.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6}return t.l+=o,[r,i]}},61:{n:"PtgAreaErr3d",f:function DJ(t,n,e){var r=(96&t[t.l++])>>5,i=t.read_shift(2),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12}return t.l+=o,[r,i]}},255:{}},See={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Dee={1:{n:"PtgElfLel",f:gN},2:{n:"PtgElfRw",f:Sb},3:{n:"PtgElfCol",f:Sb},6:{n:"PtgElfRwV",f:Sb},7:{n:"PtgElfColV",f:Sb},10:{n:"PtgElfRadical",f:Sb},11:{n:"PtgElfRadicalS",f:$S},13:{n:"PtgElfColS",f:$S},15:{n:"PtgElfColSV",f:$S},16:{n:"PtgElfRadicalLel",f:gN},25:{n:"PtgList",f:function vee(t){t.l+=2;var n=t.read_shift(2),e=t.read_shift(2),r=t.read_shift(4),i=t.read_shift(2),o=t.read_shift(2);return{ixti:n,coltype:3&e,rt:_ee[e>>2&31],idx:r,c:i,C:o}}},29:{n:"PtgSxName",f:function bee(t){return t.l+=2,[t.read_shift(4)]}},255:{}},Aee={0:{n:"PtgAttrNoop",f:function Eee(t){return t.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function PJ(t,n,e){var r=255&t[t.l+1]?1:0;return t.l+=e&&2==e.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function FJ(t,n,e){var r=255&t[t.l+1]?1:0;return t.l+=2,[r,t.read_shift(e&&2==e.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function MJ(t,n,e){t.l+=2;for(var r=t.read_shift(e&&2==e.biff?1:2),i=[],o=0;o<=r;++o)i.push(t.read_shift(e&&2==e.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function kJ(t,n,e){var r=255&t[t.l+1]?1:0;return t.l+=2,[r,t.read_shift(e&&2==e.biff?1:2)]}},16:{n:"PtgAttrSum",f:function HJ(t,n,e){t.l+=e&&2==e.biff?3:4}},32:{n:"PtgAttrBaxcel",f:pN},33:{n:"PtgAttrBaxcel",f:pN},64:{n:"PtgAttrSpace",f:function OJ(t){return t.read_shift(2),mN(t)}},65:{n:"PtgAttrSpaceSemi",f:function NJ(t){return t.read_shift(2),mN(t)}},128:{n:"PtgAttrIfError",f:function IJ(t){var n=255&t[t.l+1]?1:0;return t.l+=2,[n,t.read_shift(2)]}},255:{}};function Db(t,n,e,r){if(r.biff<8)return Ol(t,n);for(var i=t.l+n,o=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=ZJ(t,0,r),o.push(e[a][1]);break;case"PtgMemArea":e[a][2]=KJ(t,0,r),o.push(e[a][2]);break;case"PtgExp":r&&12==r.biff&&(e[a][1][1]=t.read_shift(4),o.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0]}return 0!=(n=i-t.l)&&o.push(Ol(t,n)),o}function Ab(t,n,e){for(var i,o,r=t.l+n,a=[];r!=t.l;)n=r-t.l,i=_N[o=t[t.l]]||_N[See[o]],(24===o||25===o)&&(i=(24===o?Dee:Aee)[t[t.l+1]]),i&&i.f?a.push([i.n,i.f(t,n,e)]):Ol(t,n);return a}function Tee(t){for(var n=[],e=0;e<t.length;++e){for(var r=t[e],i=[],o=0;o<r.length;++o){var a=r[o];i.push(a?2===a[0]?'"'+a[1].replace(/"/g,'""')+'"':a[1]:"")}n.push(i.join(","))}return n.join(";")}var Mee={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vN(t,n,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[n]))return t.SheetNames[n];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[n];if(e.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),0==n?"":t.XTI[n-1];if(!r)return"SH33TJSERR1";var i="";if(e.biff>8)switch(t[r[0]][0]){case 357:return i=-1==r[1]?"#REF":t.SheetNames[r[1]],r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 358:return null!=e.SID?t.SheetNames[e.SID]:"SH33TJSSAME"+t[r[0]][0];default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return i=-1==r[1]?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[r[0]][0][3]?(i=-1==r[1]?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function bN(t,n,e){var r=vN(t,n,e);return"#REF"==r?r:function kee(t,n){if(!(t||n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}(r,e)}function jl(t,n,e,r,i){var l,c,f,D,o=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},s=[],v=0,E=0,k="";if(!t[0]||!t[0][0])return"";for(var T=-1,R="",q=0,Z=t[0].length;q<Z;++q){var W=t[0][q];switch(W[0]){case"PtgUminus":s.push("-"+s.pop());break;case"PtgUplus":s.push("+"+s.pop());break;case"PtgPercent":s.push(s.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=s.pop(),c=s.pop(),T>=0){switch(t[0][T][1][0]){case 0:R=Na(" ",t[0][T][1][1]);break;case 1:R=Na("\r",t[0][T][1][1]);break;default:if(R="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}c+=R,T=-1}s.push(c+Mee[W[0]]+l);break;case"PtgIsect":l=s.pop(),c=s.pop(),s.push(c+" "+l);break;case"PtgUnion":l=s.pop(),c=s.pop(),s.push(c+","+l);break;case"PtgRange":l=s.pop(),c=s.pop(),s.push(c+":"+l);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":f=pb(W[1][1],a,i),s.push(mb(f,o));break;case"PtgRefN":f=e?pb(W[1][1],e,i):W[1][1],s.push(mb(f,o));break;case"PtgRef3d":v=W[1][1],f=pb(W[1][2],a,i),k=bN(r,v,i),s.push(k+"!"+mb(f,o));break;case"PtgFunc":case"PtgFuncVar":var Le=W[1][0],Pe=W[1][1];Le||(Le=0);var ge=0==(Le&=127)?[]:s.slice(-Le);s.length-=Le,"User"===Pe&&(Pe=ge.shift()),s.push(Pe+"("+ge.join(",")+")");break;case"PtgBool":s.push(W[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":s.push(W[1]);break;case"PtgNum":s.push(String(W[1]));break;case"PtgStr":s.push('"'+W[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":D=qP(W[1][1],e?{s:e}:a,i),s.push(gS(D,i));break;case"PtgArea":D=qP(W[1][1],a,i),s.push(gS(D,i));break;case"PtgArea3d":D=W[1][2],k=bN(r,v=W[1][1],i),s.push(k+"!"+gS(D,i));break;case"PtgAttrSum":s.push("SUM("+s.pop()+")");break;case"PtgName":var Ye=(r.names||[])[(E=W[1][2])-1]||(r[0]||[])[E],Ge=Ye?Ye.Name:"SH33TJSNAME"+String(E);Ge&&"_xlfn."==Ge.slice(0,6)&&!i.xlfn&&(Ge=Ge.slice(6)),s.push(Ge);break;case"PtgNameX":var Mt,wt=W[1][1];if(E=W[1][2],!(i.biff<=5)){var Qe="";if(14849==((r[wt]||[])[0]||[])[0]||(1025==((r[wt]||[])[0]||[])[0]?r[wt][E]&&r[wt][E].itab>0&&(Qe=r.SheetNames[r[wt][E].itab-1]+"!"):Qe=r.SheetNames[E-1]+"!"),r[wt]&&r[wt][E])Qe+=r[wt][E].Name;else if(r[0]&&r[0][E])Qe+=r[0][E].Name;else{var An=(vN(r,wt,i)||"").split(";;");An[E-1]?Qe=An[E-1]:Qe+="SH33TJSERRX"}s.push(Qe);break}wt<0&&(wt=-wt),r[wt]&&(Mt=r[wt][E]),Mt||(Mt={Name:"SH33TJSERRY"}),s.push(Mt.Name);break;case"PtgParen":var rr="(",Nn=")";if(T>=0){switch(R="",t[0][T][1][0]){case 2:rr=Na(" ",t[0][T][1][1])+rr;break;case 3:rr=Na("\r",t[0][T][1][1])+rr;break;case 4:Nn=Na(" ",t[0][T][1][1])+Nn;break;case 5:Nn=Na("\r",t[0][T][1][1])+Nn;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}T=-1}s.push(rr+s.pop()+Nn);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":s.push("#REF!");break;case"PtgExp":var rn={c:e.c,r:e.r};if(r.sharedf[Jr(f={c:W[1][1],r:W[1][0]})]){var an=r.sharedf[Jr(f)];s.push(jl(an,0,rn,r,i))}else{var Ln=!1;for(l=0;l!=r.arrayf.length;++l)if(!(f.c<(c=r.arrayf[l])[0].s.c||f.c>c[0].e.c||f.r<c[0].s.r||f.r>c[0].e.r)){s.push(jl(c[1],0,rn,r,i)),Ln=!0;break}Ln||s.push(W[1])}break;case"PtgArray":s.push("{"+Tee(W[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=q;break;case"PtgMissArg":s.push("");break;case"PtgList":s.push("Table"+W[1].idx+"[#"+W[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(W))}if(3!=i.biff&&T>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(t[0][q][0])){var Wn=!0;switch((W=t[0][T])[1][0]){case 4:Wn=!1;case 0:R=Na(" ",W[1][1]);break;case 5:Wn=!1;case 1:R=Na("\r",W[1][1]);break;default:if(R="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+W[1][0])}s.push((Wn?R:"")+s.pop()+(Wn?"":R)),T=-1}}if(s.length>1&&i.WTF)throw new Error("bad formula stack");return s[0]}function Fee(t,n,e){var o,r=t.l+n,i=2==e.biff?1:2,a=t.read_shift(i);if(65535==a)return[[],Ol(t,n-2)];var s=Ab(t,a,e);return n!==a+i&&(o=Db(t,n-a-i,s,e)),t.l=r,[s,o]}function Oee(t,n,e){var i,r=t.l+n,o=t.read_shift(2),a=Ab(t,o,e);return 65535==o?[[],Ol(t,n-2)]:(n!==o+2&&(i=Db(t,r-o-2,a,e)),[a,i])}function WS(t,n,e){var r=t.l+n,i=kf(t);2==e.biff&&++t.l;var o=function Nee(t){var n;if(65535!==Th(t,t.l+6))return[Rl(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return n=1===t[t.l+2],t.l+=8,[n,"b"];case 2:return n=t[t.l+2],t.l+=8,[n,"e"];case 3:return t.l+=8,["","s"]}return[]}(t),a=t.read_shift(1);2!=e.biff&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var s=function Iee(t,n,e){var o,r=t.l+n,i=2==e.biff?1:2,a=t.read_shift(i);if(65535==a)return[[],Ol(t,n-2)];var s=Ab(t,a,e);return n!==a+i&&(o=Db(t,n-a-i,s,e)),t.l=r,[s,o]}(t,r-t.l,e);return{cell:i,val:o[0],formula:s,shared:a>>3&1,tt:o[1]}}function qw(t,n,e){var r=t.read_shift(4),i=Ab(t,r,e),o=t.read_shift(4);return[i,o>0?Db(t,o,i,e):null]}var Bee=qw,Gw=qw,jee=qw,Vee=qw,Uee={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},yN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hee={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wN(t){return"of:"==t.slice(0,3)&&(t=t.slice(3)),61==t.charCodeAt(0)&&61==(t=t.slice(1)).charCodeAt(0)&&(t=t.slice(1)),(t=(t=(t=t.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,e){return e.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function zee(t){return("of:="+t.replace(HS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function qS(t){var n=t.split(":");return[n[0].split(".")[0],n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}function $ee(t){return t.replace(/\./,"!")}var Tb={},l_={},Mb=typeof Map<"u";function GS(t,n,e){var r=0,i=t.length;if(e){if(Mb?e.has(n):Object.prototype.hasOwnProperty.call(e,n))for(var o=Mb?e.get(n):e[n];r<o.length;++r)if(t[o[r]].t===n)return t.Count++,o[r]}else for(;r<i;++r)if(t[r].t===n)return t.Count++,r;return t[i]={t:n},t.Count++,t.Unique++,e&&(Mb?(e.has(n)||e.set(n,[]),e.get(n).push(i)):(Object.prototype.hasOwnProperty.call(e,n)||(e[n]=[]),e[n].push(i))),i}function Yw(t,n){var e={min:t+1,max:t+1},r=-1;return n.MDW&&(Bl=n.MDW),null!=n.width?e.customWidth=1:null!=n.wpx?r=xb(n.wpx):null!=n.wch&&(r=n.wch),r>-1?(e.width=zw(r),e.customWidth=1):null!=n.width&&(e.width=n.width),n.hidden&&(e.hidden=!0),null!=n.level&&(e.outlineLevel=e.level=n.level),e}function Yg(t,n){if(t){var e=[.7,.7,.75,.75,.3,.3];"xlml"==n&&(e=[1,1,1,1,.5,.5]),null==t.left&&(t.left=e[0]),null==t.right&&(t.right=e[1]),null==t.top&&(t.top=e[2]),null==t.bottom&&(t.bottom=e[3]),null==t.header&&(t.header=e[4]),null==t.footer&&(t.footer=e[5])}}function lm(t,n,e){var r=e.revssf[null!=n.z?n.z:"General"],i=60,o=t.length;if(null==r&&e.ssf)for(;i<392;++i)if(null==e.ssf[i]){Df(n.z,i),e.ssf[i]=n.z,e.revssf[n.z]=r=i;break}for(i=0;i!=o;++i)if(t[i].numFmtId===r)return i;return t[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function xN(t,n,e,r,i,o){try{r.cellNF&&(t.z=qr[n])}catch(s){if(r.WTF)throw s}if("z"!==t.t||r.cellStyles){if("d"===t.t&&"string"==typeof t.v&&(t.v=ia(t.v)),(!r||!1!==r.cellText)&&"z"!==t.t)try{if(null==qr[n]&&Df(HG[n]||"General",n),"e"===t.t)t.w=t.w||kh[t.v];else if(0===n)if("n"===t.t)t.w=(0|t.v)===t.v?t.v.toString(10):ab(t.v);else if("d"===t.t){var a=As(t.v);t.w=(0|a)===a?a.toString(10):ab(a)}else{if(void 0===t.v)return"";t.w=Pg(t.v,l_)}else t.w=tu(n,"d"===t.t?As(t.v):t.v,l_)}catch(s){if(r.WTF)throw s}if(r.cellStyles&&null!=e)try{t.s=o.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Hw(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Hw(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(s){if(r.WTF&&o.Fills)throw s}}}function Wee(t,n,e){if(t&&t["!ref"]){var r=zi(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}var Gee=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Yee=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Xee=/<(?:\w:)?hyperlink [^>]*>/gm,Kee=/"(\w*:\w*)"/,Zee=/<(?:\w:)?col\b[^>]*[\/]?>/g,Qee=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Jee=/<(?:\w:)?pageMargins[^>]*\/>/g,CN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ete=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,tte=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function YS(t,n,e,r){var i=ri(t);e.Sheets[r]||(e.Sheets[r]={}),i.codeName&&(e.Sheets[r].CodeName=ro(Lo(i.codeName)))}var ate=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ste=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],gte=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bte(t,n,e,r){if(t.c&&e["!comments"].push([n,t.c]),void 0===t.v&&"string"!=typeof t.f||"z"===t.t&&!t.f)return"";var i="",o=t.t,a=t.v;if("z"!==t.t)switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=kh[t.v];break;case"d":r&&r.cellDates?i=ia(t.v,-1).toISOString():((t=$o(t)).t="n",i=""+(t.v=As(ia(t.v)))),typeof t.z>"u"&&(t.z=qr[14]);break;default:i=t.v}var s=fl("v",Ao(i)),l={r:n},c=lm(r.cellXfs,t,r);switch(0!==c&&(l.s=c),t.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==t.v){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){s=fl("v",""+GS(r.Strings,t.v,r.revStrings)),l.t="s";break}l.t="str"}if(t.t!=o&&(t.t=o,t.v=a),"string"==typeof t.f&&t.f){var f=t.F&&t.F.slice(0,n.length)==n?{t:"array",ref:t.F}:null;s=Bn("f",Ao(t.f),f)+(null!=t.v?s:"")}return t.l&&e["!links"].push([n,t.l]),t.D&&(l.cm=1),Bn("c",s,l)}var yte=function(){var t=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=ub("v"),a=ub("f");return function(l,c,f,v,E,D){for(var Pe,ge,wt,Mt,Nn,k=0,T="",R=[],q=[],Z=0,W=0,Ee=0,Le="",Ye=0,Ge=0,Qe=0,An=0,rr=Array.isArray(D.CellXf),rn=[],an=[],Ln=Array.isArray(c),mn=[],Wn={},qt=!1,Ae=!!f.sheetStubs,dt=l.split(n),Fe=0,Re=dt.length;Fe!=Re;++Fe){var Xt=(T=dt[Fe].trim()).length;if(0!==Xt){var En=0;e:for(k=0;k<Xt;++k)switch(T[k]){case">":if("/"!=T[k-1]){++k;break e}if(f&&f.cellStyles){if(Ye=null!=(ge=ri(T.slice(En,k),!0)).r?parseInt(ge.r,10):Ye+1,Ge=-1,f.sheetRows&&f.sheetRows<Ye)continue;Wn={},qt=!1,ge.ht&&(qt=!0,Wn.hpt=parseFloat(ge.ht),Wn.hpx=o_(Wn.hpt)),"1"==ge.hidden&&(qt=!0,Wn.hidden=!0),null!=ge.outlineLevel&&(qt=!0,Wn.level=+ge.outlineLevel),qt&&(mn[Ye-1]=Wn)}break;case"<":En=k}if(En>=k)break;if(Ye=null!=(ge=ri(T.slice(En,k),!0)).r?parseInt(ge.r,10):Ye+1,Ge=-1,!(f.sheetRows&&f.sheetRows<Ye)){v.s.r>Ye-1&&(v.s.r=Ye-1),v.e.r<Ye-1&&(v.e.r=Ye-1),f&&f.cellStyles&&(Wn={},qt=!1,ge.ht&&(qt=!0,Wn.hpt=parseFloat(ge.ht),Wn.hpx=o_(Wn.hpt)),"1"==ge.hidden&&(qt=!0,Wn.hidden=!0),null!=ge.outlineLevel&&(qt=!0,Wn.level=+ge.outlineLevel),qt&&(mn[Ye-1]=Wn)),R=T.slice(k).split(t);for(var Sn=0;Sn!=R.length&&"<"==R[Sn].trim().charAt(0);++Sn);for(R=R.slice(Sn),k=0;k!=R.length;++k)if(0!==(T=R[k].trim()).length){if(q=T.match(e),Z=k,W=0,Ee=0,T="<c "+("<"==T.slice(0,1)?">":"")+T,null!=q&&2===q.length){for(Z=0,Le=q[1],W=0;W!=Le.length&&!((Ee=Le.charCodeAt(W)-64)<1||Ee>26);++W)Z=26*Z+Ee;Ge=--Z}else++Ge;for(W=0;W!=T.length&&62!==T.charCodeAt(W);++W);if(++W,(ge=ri(T.slice(0,W),!0)).r||(ge.r=Jr({r:Ye-1,c:Ge})),Pe={t:""},null!=(q=(Le=T.slice(W)).match(o))&&""!==q[1]&&(Pe.v=ro(q[1])),f.cellFormula){if(null!=(q=Le.match(a))&&""!==q[1]){if(Pe.f=ro(Lo(q[1])).replace(/\r\n/g,"\n"),f.xlfn||(Pe.f=uN(Pe.f)),q[0].indexOf('t="array"')>-1)Pe.F=(Le.match(i)||[])[1],Pe.F.indexOf(":")>-1&&rn.push([zi(Pe.F),Pe.F]);else if(q[0].indexOf('t="shared"')>-1){Mt=ri(q[0]);var bn=ro(Lo(q[1]));f.xlfn||(bn=uN(bn)),an[parseInt(Mt.si,10)]=[Mt,bn,ge.r]}}else(q=Le.match(/<f[^>]*\/>/))&&an[(Mt=ri(q[0])).si]&&(Pe.f=gJ(an[Mt.si][1],an[Mt.si][2],ge.r));var dn=ya(ge.r);for(W=0;W<rn.length;++W)dn.r>=rn[W][0].s.r&&dn.r<=rn[W][0].e.r&&dn.c>=rn[W][0].s.c&&dn.c<=rn[W][0].e.c&&(Pe.F=rn[W][1])}if(null==ge.t&&void 0===Pe.v)if(Pe.f||Pe.F)Pe.v=0,Pe.t="n";else{if(!Ae)continue;Pe.t="z"}else Pe.t=ge.t||"n";switch(v.s.c>Ge&&(v.s.c=Ge),v.e.c<Ge&&(v.e.c=Ge),Pe.t){case"n":if(""==Pe.v||null==Pe.v){if(!Ae)continue;Pe.t="z"}else Pe.v=parseFloat(Pe.v);break;case"s":if(typeof Pe.v>"u"){if(!Ae)continue;Pe.t="z"}else wt=Tb[parseInt(Pe.v,10)],Pe.v=wt.t,Pe.r=wt.r,f.cellHTML&&(Pe.h=wt.h);break;case"str":Pe.t="s",Pe.v=null!=Pe.v?Lo(Pe.v):"",f.cellHTML&&(Pe.h=aS(Pe.v));break;case"inlineStr":q=Le.match(r),Pe.t="s",null!=q&&(wt=RS(q[1]))?(Pe.v=wt.t,f.cellHTML&&(Pe.h=wt.h)):Pe.v="";break;case"b":Pe.v=oa(Pe.v);break;case"d":f.cellDates?Pe.v=ia(Pe.v,1):(Pe.v=As(ia(Pe.v,1)),Pe.t="n");break;case"e":(!f||!1!==f.cellText)&&(Pe.w=Pe.v),Pe.v=nO[Pe.v]}if(Qe=An=0,Nn=null,rr&&void 0!==ge.s&&null!=(Nn=D.CellXf[ge.s])&&(null!=Nn.numFmtId&&(Qe=Nn.numFmtId),f.cellStyles&&null!=Nn.fillId&&(An=Nn.fillId)),xN(Pe,Qe,An,f,E,D),f.cellDates&&rr&&"n"==Pe.t&&Og(qr[Qe])&&(Pe.t="d",Pe.v=Tw(Pe.v)),ge.cm&&f.xlmeta){var li=(f.xlmeta.Cell||[])[+ge.cm-1];li&&"XLDAPR"==li.type&&(Pe.D=!0)}if(Ln){var ke=ya(ge.r);c[ke.r]||(c[ke.r]=[]),c[ke.r][ke.c]=Pe}else c[ge.r]=Pe}}}}mn.length>0&&(c["!rows"]=mn)}}();function EN(t,n,e,r){var a,i=[Ra,Bn("worksheet",null,{xmlns:rm[0],"xmlns:r":fs.r})],s="",l=e.Sheets[e.SheetNames[t]];null==l&&(l={});var c=l["!ref"]||"A1",f=zi(c);if(f.e.c>16383||f.e.r>1048575){if(n.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=bi(f)}r||(r={}),l["!comments"]=[];var v=[];(function ote(t,n,e,r,i){var o=!1,a={},s=null;if("xlsx"!==r.bookType&&n.vbaraw){var l=n.SheetNames[e];try{n.Workbook&&(l=n.Workbook.Sheets[e].CodeName||l)}catch{}o=!0,a.codeName=Tf(Ao(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),s=(s||"")+Bn("outlinePr",null,c)}!o&&!s||(i[i.length]=Bn("sheetPr",s,a))})(l,e,t,n,i),i[i.length]=Bn("dimension",null,{ref:c}),i[i.length]=function vte(t,n,e,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Bn("sheetViews",Bn("sheetView",null,i),{})}(0,0,0,e),n.sheetFormat&&(i[i.length]=Bn("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=function hte(t,n){for(var r,e=["<cols>"],i=0;i!=n.length;++i)(r=n[i])&&(e[e.length]=Bn("col",null,Yw(i,r)));return e[e.length]="</cols>",e.join("")}(0,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(s=function wte(t,n,e,r){var l,R,i=[],o=[],a=zi(t["!ref"]),s="",c="",f=[],v=0,E=0,D=t["!rows"],k=Array.isArray(t),T={r:c},q=-1;for(E=a.s.c;E<=a.e.c;++E)f[E]=aa(E);for(v=a.s.r;v<=a.e.r;++v){for(o=[],c=La(v),E=a.s.c;E<=a.e.c;++E){l=f[E]+c;var Z=k?(t[v]||[])[E]:t[l];void 0!==Z&&null!=(s=bte(Z,l,t,n))&&o.push(s)}(o.length>0||D&&D[v])&&(T={r:c},D&&D[v]&&((R=D[v]).hidden&&(T.hidden=1),q=-1,R.hpx?q=Cb(R.hpx):R.hpt&&(q=R.hpt),q>-1&&(T.ht=q,T.customHeight=1),R.level&&(T.outlineLevel=R.level)),i[i.length]=Bn("row",o.join(""),T))}if(D)for(;v<D.length;++v)D&&D[v]&&(T={r:v+1},(R=D[v]).hidden&&(T.hidden=1),q=-1,R.hpx?q=Cb(R.hpx):R.hpt&&(q=R.hpt),q>-1&&(T.ht=q,T.customHeight=1),R.level&&(T.outlineLevel=R.level),i[i.length]=Bn("row","",T));return i.join("")}(l,n),s.length>0&&(i[i.length]=s)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=function lte(t){var n={sheet:1};return ate.forEach(function(e){null!=t[e]&&t[e]&&(n[e]="1")}),ste.forEach(function(e){null!=t[e]&&!t[e]&&(n[e]="0")}),t.password&&(n.password=LS(t.password).toString(16).toUpperCase()),Bn("sheetProtection",null,n)}(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=function mte(t,n,e,r){var i="string"==typeof t.ref?t.ref:bi(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,a=rc(i);a.s.r==a.e.r&&(a.e.r=rc(n["!ref"]).e.r,i=bi(a));for(var s=0;s<o.length;++s){var l=o[s];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+e.SheetNames[r]+"'!"+i;break}}return s==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+e.SheetNames[r]+"'!"+i}),Bn("autoFilter",null,{ref:i})}(l["!autofilter"],l,e,t)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=function rte(t){if(0===t.length)return"";for(var n='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)n+='<mergeCell ref="'+bi(t[e])+'"/>';return n+"</mergeCells>"}(l["!merges"]));var D,E=-1,k=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(T){T[1].Target&&(D={ref:T[0]},"#"!=T[1].Target.charAt(0)&&(k=yo(r,-1,Ao(T[1].Target).replace(/#.*$/,""),yi.HLINK),D["r:id"]="rId"+k),(E=T[1].Target.indexOf("#"))>-1&&(D.location=Ao(T[1].Target.slice(E+1))),T[1].Tooltip&&(D.tooltip=Ao(T[1].Tooltip)),i[i.length]=Bn("hyperlink",null,D))}),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=function dte(t){return Yg(t),Bn("pageMargins",null,t)}(l["!margins"])),(!n||n.ignoreEC||null==n.ignoreEC)&&(i[i.length]=fl("ignoredErrors",Bn("ignoredError",null,{numberStoredAsText:1,sqref:c}))),v.length>0&&(k=yo(r,-1,"../drawings/drawing"+(t+1)+".xml",yi.DRAW),i[i.length]=Bn("drawing",null,{"r:id":"rId"+k}),l["!drawing"]=v),l["!comments"].length>0&&(k=yo(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",yi.VML),i[i.length]=Bn("legacyDrawing",null,{"r:id":"rId"+k}),l["!legacy"]=k),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Ete(t,n,e,r){var i=function Cte(t,n,e){var r=Ut(145),i=(e["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var o=320;i.hpx?o=20*Cb(i.hpx):i.hpt&&(o=20*i.hpt),r.write_shift(2,o),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var s=0,l=r.l;r.l+=4;for(var c={r:t,c:0},f=0;f<16;++f)if(!(n.s.c>f+1<<10||n.e.c<f<<10)){for(var v=-1,E=-1,D=f<<10;D<f+1<<10;++D)c.c=D,(Array.isArray(e)?(e[c.r]||[])[c.c]:e[Jr(c)])&&(v<0&&(v=D),E=D);v<0||(++s,r.write_shift(4,v),r.write_shift(4,E))}var T=r.l;return r.l=l,r.write_shift(4,s),r.l=T,r.length>r.l?r.slice(0,r.l):r}(r,e,n);(i.length>17||(n["!rows"]||[])[r])&&_n(t,0,i)}var Ste=Vg,Dte=n_;function SN(t){return[Bg(t),Rl(t),"n"]}var lne=Vg,cne=n_,DN=["left","right","top","bottom","header","footer"];function Dne(t,n,e,r,i,o,a){if(void 0===n.v)return!1;var s="";switch(n.t){case"b":s=n.v?"1":"0";break;case"d":(n=$o(n)).z=n.z||qr[14],n.v=As(ia(n.v)),n.t="n";break;case"n":case"e":s=""+n.v;break;default:s=n.v}var l={r:e,c:r};switch(l.s=lm(i.cellXfs,n,i),n.l&&o["!links"].push([Jr(l),n.l]),n.c&&o["!comments"].push([Jr(l),n.c]),n.t){case"s":case"str":return i.bookSST?(s=GS(i.Strings,n.v,i.revStrings),l.t="s",l.v=s,a?_n(t,18,function Wte(t,n,e){return null==e&&(e=Ut(8)),jg(n,e),e.write_shift(4,n.v),e}(0,l)):_n(t,7,function zte(t,n,e){return null==e&&(e=Ut(12)),Lg(n,e),e.write_shift(4,n.v),e}(0,l))):(l.t="str",a?_n(t,17,function rne(t,n,e){return null==e&&(e=Ut(8+4*t.v.length)),jg(n,e),Ws(t.v,e),e.length>e.l?e.slice(0,e.l):e}(n,l)):_n(t,6,function tne(t,n,e){return null==e&&(e=Ut(12+4*t.v.length)),Lg(n,e),Ws(t.v,e),e.length>e.l?e.slice(0,e.l):e}(n,l))),!0;case"n":return n.v==(0|n.v)&&n.v>-1e3&&n.v<1e3?a?_n(t,13,function Qte(t,n,e){return null==e&&(e=Ut(8)),jg(n,e),KP(t.v,e),e}(n,l)):_n(t,2,function Kte(t,n,e){return null==e&&(e=Ut(12)),Lg(n,e),KP(t.v,e),e}(n,l)):a?_n(t,16,function Yte(t,n,e){return null==e&&(e=Ut(12)),jg(n,e),Ug(t.v,e),e}(n,l)):_n(t,5,function Gte(t,n,e){return null==e&&(e=Ut(16)),Lg(n,e),Ug(t.v,e),e}(n,l)),!0;case"b":return l.t="b",a?_n(t,15,function Lte(t,n,e){return null==e&&(e=Ut(5)),jg(n,e),e.write_shift(1,t.v?1:0),e}(n,l)):_n(t,4,function Nte(t,n,e){return null==e&&(e=Ut(9)),Lg(n,e),e.write_shift(1,t.v?1:0),e}(n,l)),!0;case"e":return l.t="e",a?_n(t,14,function Ute(t,n,e){return null==e&&(e=Ut(8)),jg(n,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}(n,l)):_n(t,3,function jte(t,n,e){return null==e&&(e=Ut(9)),Lg(n,e),e.write_shift(1,t.v),e}(n,l)),!0}return a?_n(t,12,function Pte(t,n,e){return null==e&&(e=Ut(4)),jg(n,e)}(0,l)):_n(t,1,function Fte(t,n,e){return null==e&&(e=Ut(8)),Lg(n,e)}(0,l)),!0}function Rne(t,n,e,r){var i=nc(),o=e.SheetNames[t],a=e.Sheets[o]||{},s=o;try{e&&e.Workbook&&(s=e.Workbook.Sheets[t].CodeName||s)}catch{}var l=zi(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(n.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],_n(i,129),(e.vbaraw||a["!outline"])&&_n(i,147,function Mte(t,n,e){null==e&&(e=Ut(84+4*t.length));var r=192;n&&(n.above&&(r&=-65),n.left&&(r&=-129)),e.write_shift(1,r);for(var i=1;i<3;++i)e.write_shift(1,0);return Pw({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),XP(t,e),e.slice(0,e.l)}(s,a["!outline"])),_n(i,148,Dte(l)),function One(t,n,e){_n(t,133),_n(t,137,function yne(t,n,e){null==e&&(e=Ut(30));var r=924;return(((n||{}).Views||[])[0]||{}).RTL&&(r|=32),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}(0,e)),_n(t,138),_n(t,134)}(i,0,e.Workbook),function Mne(t,n){!n||!n["!cols"]||(_n(t,390),n["!cols"].forEach(function(e,r){e&&_n(t,60,function gne(t,n,e){null==e&&(e=Ut(18));var r=Yw(t,n);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,256*(r.width||10)),e.write_shift(4,0);var i=0;return n.hidden&&(i|=1),"number"==typeof r.width&&(i|=2),n.level&&(i|=n.level<<8),e.write_shift(2,i),e}(r,e))}),_n(t,391))}(i,a),function Ane(t,n,e,r){var i=zi(n["!ref"]||"A1"),a="",s=[];_n(t,145);var l=Array.isArray(n),c=i.e.r;n["!rows"]&&(c=Math.max(i.e.r,n["!rows"].length-1));for(var f=i.s.r;f<=c;++f){a=La(f),Ete(t,n,i,f);var v=!1;if(f<=i.e.r)for(var E=i.s.c;E<=i.e.c;++E){f===i.s.r&&(s[E]=aa(E));var D=l?(n[f]||[])[E]:n[s[E]+a];v=!!D&&Dne(t,D,f,E,r,n,v)}}_n(t,146)}(i,a,0,n),function Nne(t,n){n["!protect"]&&_n(t,535,function xne(t,n){return null==n&&(n=Ut(66)),n.write_shift(2,t.password?LS(t.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){n.write_shift(4,e[1]?null==t[e[0]]||t[e[0]]?0:1:null!=t[e[0]]&&t[e[0]]?0:1)}),n}(n["!protect"]))}(i,a),function Pne(t,n,e,r){if(n["!autofilter"]){var i=n["!autofilter"],o="string"==typeof i.ref?i.ref:bi(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,s=rc(o);s.s.r==s.e.r&&(s.e.r=rc(n["!ref"]).e.r,o=bi(s));for(var l=0;l<a.length;++l){var c=a[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+e.SheetNames[r]+"'!"+o;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+e.SheetNames[r]+"'!"+o}),_n(t,161,n_(zi(o))),_n(t,162)}}(i,a,e,t),function Tne(t,n){!n||!n["!merges"]||(_n(t,177,function une(t,n){return null==n&&(n=Ut(4)),n.write_shift(4,t),n}(n["!merges"].length)),n["!merges"].forEach(function(e){_n(t,176,cne(e))}),_n(t,178))}(i,a),function Fne(t,n,e){n["!links"].forEach(function(r){if(r[1].Target){var i=yo(e,-1,r[1].Target.replace(/#.*$/,""),yi.HLINK);_n(t,494,function fne(t,n){var e=Ut(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));n_({s:ya(t[0]),e:ya(t[0])},e),xS("rId"+n,e);var r=t[1].Target.indexOf("#");return Ws((-1==r?"":t[1].Target.slice(r+1))||"",e),Ws(t[1].Tooltip||"",e),Ws("",e),e.slice(0,e.l)}(r,i))}}),delete n["!links"]}(i,a,r),a["!margins"]&&_n(i,476,function vne(t,n){return null==n&&(n=Ut(48)),Yg(t),DN.forEach(function(e){Ug(t[e],n)}),n}(a["!margins"])),(!n||n.ignoreEC||null==n.ignoreEC)&&function kne(t,n){!n||!n["!ref"]||(_n(t,648),_n(t,649,function wne(t){var n=Ut(24);return n.write_shift(4,4),n.write_shift(4,1),n_(t,n),n}(zi(n["!ref"]))),_n(t,650))}(i,a),function Ine(t,n,e,r){if(n["!comments"].length>0){var i=yo(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",yi.VML);_n(t,551,xS("rId"+i)),n["!legacy"]=i}}(i,a,t,r),_n(i,130),i.end()}var XS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],$ne=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Wne=[],qne=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function AN(t,n){for(var e=0;e!=t.length;++e)for(var r=t[e],i=0;i!=n.length;++i){var o=n[i];if(null==r[o[0]])r[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof r[o[0]]&&(r[o[0]]=oa(r[o[0]]));break;case"int":"string"==typeof r[o[0]]&&(r[o[0]]=parseInt(r[o[0]],10))}}}function TN(t,n){for(var e=0;e!=n.length;++e){var r=n[e];if(null==t[r[0]])t[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof t[r[0]]&&(t[r[0]]=oa(t[r[0]]));break;case"int":"string"==typeof t[r[0]]&&(t[r[0]]=parseInt(t[r[0]],10))}}}function MN(t){TN(t.WBProps,XS),TN(t.CalcPr,qne),AN(t.WBView,$ne),AN(t.Sheets,Wne),l_.date1904=oa(t.WBProps.date1904)}var Yne="][*?/\\".split("");function kN(t,n){if(t.length>31){if(n)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return Yne.forEach(function(r){if(-1!=t.indexOf(r)){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}var Kne=/<\w+:workbook/;function IN(t){var n=[Ra];n[n.length]=Bn("workbook",null,{xmlns:rm[0],"xmlns:r":fs.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(XS.forEach(function(s){null!=t.Workbook.WBProps[s[0]]&&t.Workbook.WBProps[s[0]]!=s[1]&&(r[s[0]]=t.Workbook.WBProps[s[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),n[n.length]=Bn("workbookPr",null,r);var i=t.Workbook&&t.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(n[n.length]="<bookViews>",o=0;o!=t.SheetNames.length&&i[o]&&i[o].Hidden;++o);o==t.SheetNames.length&&(o=0),n[n.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var a={name:Ao(t.SheetNames[o].slice(0,31))};if(a.sheetId=""+(o+1),a["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden"}n[n.length]=Bn("sheet",null,a)}return n[n.length]="</sheets>",e&&(n[n.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(s){var l={name:s.Name};s.Comment&&(l.comment=s.Comment),null!=s.Sheet&&(l.localSheetId=""+s.Sheet),s.Hidden&&(l.hidden="1"),s.Ref&&(n[n.length]=Bn("definedName",Ao(s.Ref),l))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function Jne(t,n){return n||(n=Ut(127)),n.write_shift(4,t.Hidden),n.write_shift(4,t.iTabID),xS(t.strRelID,n),Ws(t.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function nre(t,n){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=n-8,e}function cre(t,n){var e=nc();return _n(e,131),_n(e,128,function are(t,n){n||(n=Ut(127));for(var e=0;4!=e;++e)n.write_shift(4,0);return Ws("SheetJS",n),Ws(eb.version,n),Ws(eb.version,n),Ws("7262",n),n.length>n.l?n.slice(0,n.l):n}()),_n(e,153,function tre(t,n){n||(n=Ut(72));var e=0;return t&&t.filterPrivacy&&(e|=8),n.write_shift(4,e),n.write_shift(4,0),XP(t&&t.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}(t.Workbook&&t.Workbook.WBProps||null)),function lre(t,n){if(n.Workbook&&n.Workbook.Sheets){for(var e=n.Workbook.Sheets,r=0,i=-1,o=-1;r<e.length;++r)!e[r]||!e[r].Hidden&&-1==i?i=r:1==e[r].Hidden&&-1==o&&(o=r);o>i||(_n(t,135),_n(t,158,function sre(t,n){return n||(n=Ut(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,t),n.write_shift(4,t),n.write_shift(1,120),n.length>n.l?n.slice(0,n.l):n}(i)),_n(t,136))}}(e,t),function ore(t,n){_n(t,143);for(var e=0;e!=n.SheetNames.length;++e)_n(t,156,Jne({Hidden:n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e]&&n.Workbook.Sheets[e].Hidden||0,iTabID:e+1,strRelID:"rId"+(e+1),name:n.SheetNames[e]}));_n(t,144)}(e,t),_n(e,132),e.end()}function dre(t,n,e,r,i,o,a,s){return".bin"===n.slice(-4)?function Sne(t,n,e,r,i,o,a){if(!t)return t;var s=n||{};r||(r={"!id":{}}),null!=Pa&&null==s.dense&&(s.dense=Pa);var c,k,T,R,q,Z,W,Ee,Le,Pe,l=s.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=[],E=!1,D=!1,ge=[];s.biff=12,s["!row"]=0;var Ye=0,Ge=!1,wt=[],Mt={},Qe=s.supbooks||i.supbooks||[[]];if(Qe.sharedf=Mt,Qe.arrayf=wt,Qe.SheetNames=i.SheetNames||i.Sheets.map(function(Wn){return Wn.name}),!s.supbooks&&(s.supbooks=Qe,i.Names))for(var An=0;An<i.Names.length;++An)Qe[0][An+1]=i.Names[An];var an,Ln,rr=[],Nn=[],rn=!1;if(Ib[16]={n:"BrtShortReal",f:SN},Mh(t,function(qt,Ae,dt){if(!D)switch(dt){case 148:c=qt;break;case 0:k=qt,s.sheetRows&&s.sheetRows<=k.r&&(D=!0),Le=La(q=k.r),s["!row"]=k.r,(qt.hidden||qt.hpt||null!=qt.level)&&(qt.hpt&&(qt.hpx=o_(qt.hpt)),Nn[qt.r]=qt);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(T={t:qt[2]},qt[2]){case"n":T.v=qt[1];break;case"s":T.v=(Ee=Tb[qt[1]]).t,T.r=Ee.r;break;case"b":T.v=!!qt[1];break;case"e":T.v=qt[1],!1!==s.cellText&&(T.w=kh[T.v]);break;case"str":T.t="s",T.v=qt[1];break;case"is":T.t="s",T.v=qt[1].t}if((R=a.CellXf[qt[0].iStyleRef])&&xN(T,R.numFmtId,null,s,o,a),Z=-1==qt[0].c?Z+1:qt[0].c,s.dense?(l[q]||(l[q]=[]),l[q][Z]=T):l[aa(Z)+Le]=T,s.cellFormula){for(Ge=!1,Ye=0;Ye<wt.length;++Ye){var Fe=wt[Ye];k.r>=Fe[0].s.r&&k.r<=Fe[0].e.r&&Z>=Fe[0].s.c&&Z<=Fe[0].e.c&&(T.F=bi(Fe[0]),Ge=!0)}!Ge&&qt.length>3&&(T.f=qt[3])}if(f.s.r>k.r&&(f.s.r=k.r),f.s.c>Z&&(f.s.c=Z),f.e.r<k.r&&(f.e.r=k.r),f.e.c<Z&&(f.e.c=Z),s.cellDates&&R&&"n"==T.t&&Og(qr[R.numFmtId])){var Re=em(T.v);Re&&(T.t="d",T.v=new Date(Re.y,Re.m-1,Re.d,Re.H,Re.M,Re.S,Re.u))}an&&("XLDAPR"==an.type&&(T.D=!0),an=void 0),Ln&&(Ln=void 0);break;case 1:case 12:if(!s.sheetStubs||E)break;T={t:"z",v:void 0},Z=-1==qt[0].c?Z+1:qt[0].c,s.dense?(l[q]||(l[q]=[]),l[q][Z]=T):l[aa(Z)+Le]=T,f.s.r>k.r&&(f.s.r=k.r),f.s.c>Z&&(f.s.c=Z),f.e.r<k.r&&(f.e.r=k.r),f.e.c<Z&&(f.e.c=Z),an&&("XLDAPR"==an.type&&(T.D=!0),an=void 0),Ln&&(Ln=void 0);break;case 176:ge.push(qt);break;case 49:an=((s.xlmeta||{}).Cell||[])[qt-1];break;case 494:var Xt=r["!id"][qt.relId];for(Xt?(qt.Target=Xt.Target,qt.loc&&(qt.Target+="#"+qt.loc),qt.Rel=Xt):""==qt.relId&&(qt.Target="#"+qt.loc),q=qt.rfx.s.r;q<=qt.rfx.e.r;++q)for(Z=qt.rfx.s.c;Z<=qt.rfx.e.c;++Z)s.dense?(l[q]||(l[q]=[]),l[q][Z]||(l[q][Z]={t:"z",v:void 0}),l[q][Z].l=qt):(W=Jr({c:Z,r:q}),l[W]||(l[W]={t:"z",v:void 0}),l[W].l=qt);break;case 426:if(!s.cellFormula)break;wt.push(qt),(Pe=s.dense?l[q][Z]:l[aa(Z)+Le]).f=jl(qt[1],0,{r:k.r,c:Z},Qe,s),Pe.F=bi(qt[0]);break;case 427:if(!s.cellFormula)break;Mt[Jr(qt[0].s)]=qt[1],(Pe=s.dense?l[q][Z]:l[aa(Z)+Le]).f=jl(qt[1],0,{r:k.r,c:Z},Qe,s);break;case 60:if(!s.cellStyles)break;for(;qt.e>=qt.s;)rr[qt.e--]={width:qt.w/256,hidden:!!(1&qt.flags),level:qt.level},rn||(rn=!0,jS(qt.w/256)),am(rr[qt.e+1]);break;case 161:l["!autofilter"]={ref:bi(qt)};break;case 476:l["!margins"]=qt;break;case 147:i.Sheets[e]||(i.Sheets[e]={}),qt.name&&(i.Sheets[e].CodeName=qt.name),(qt.above||qt.left)&&(l["!outline"]={above:qt.above,left:qt.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),qt.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:E=!0;break;case 36:E=!1;break;case 37:v.push(dt),E=!0;break;case 38:v.pop(),E=!1;break;default:if(!Ae.T&&(!E||s.WTF))throw new Error("Unexpected record 0x"+dt.toString(16))}},s),delete s.supbooks,delete s["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=bi(c||f)),s.sheetRows&&l["!ref"]){var mn=zi(l["!ref"]);s.sheetRows<=+mn.e.r&&(mn.e.r=s.sheetRows-1,mn.e.r>f.e.r&&(mn.e.r=f.e.r),mn.e.r<mn.s.r&&(mn.s.r=mn.e.r),mn.e.c>f.e.c&&(mn.e.c=f.e.c),mn.e.c<mn.s.c&&(mn.s.c=mn.e.c),l["!fullref"]=l["!ref"],l["!ref"]=bi(mn))}return ge.length>0&&(l["!merges"]=ge),rr.length>0&&(l["!cols"]=rr),Nn.length>0&&(l["!rows"]=Nn),l}(t,r,e,i,o,a,s):function nte(t,n,e,r,i,o,a){if(!t)return t;r||(r={"!id":{}}),null!=Pa&&null==n.dense&&(n.dense=Pa);var s=n.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",v=t.match(Yee);v?(c=t.slice(0,v.index),f=t.slice(v.index+v[0].length)):c=f=t;var E=c.match(CN);E?YS(E[0],0,i,e):(E=c.match(ete))&&function ite(t,n,e,r,i){YS(t.slice(0,t.indexOf(">")),0,r,i)}(E[0],0,0,i,e);var D=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(D>0){var k=c.slice(D,D+50).match(Kee);k&&function qee(t,n){var e=zi(n);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=bi(e))}(s,k[1])}var T=c.match(tte);T&&T[1]&&function _te(t,n){n.Views||(n.Views=[{}]),(t.match(gte)||[]).forEach(function(e,r){var i=ri(e);n.Views[r]||(n.Views[r]={}),+i.zoomScale&&(n.Views[r].zoom=+i.zoomScale),oa(i.rightToLeft)&&(n.Views[r].RTL=!0)})}(T[1],i);var R=[];if(n.cellStyles){var q=c.match(Zee);q&&function fte(t,n){for(var e=!1,r=0;r!=n.length;++r){var i=ri(n[r],!0);i.hidden&&(i.hidden=oa(i.hidden));var o=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!e&&i.width&&(e=!0,jS(i.width)),am(i);o<=a;)t[o++]=$o(i)}}(R,q)}v&&yte(v[1],s,n,l,o,a);var Z=f.match(Qee);Z&&(s["!autofilter"]=function pte(t){return{ref:(t.match(/ref="([^"]*)"/)||[])[1]}}(Z[0]));var W=[],Ee=f.match(Gee);if(Ee)for(D=0;D!=Ee.length;++D)W[D]=zi(Ee[D].slice(Ee[D].indexOf('"')+1));var Le=f.match(Xee);Le&&function cte(t,n,e){for(var r=Array.isArray(t),i=0;i!=n.length;++i){var o=ri(Lo(n[i]),!0);if(!o.ref)return;var a=((e||{})["!id"]||[])[o.id];a?(o.Target=a.Target,o.location&&(o.Target+="#"+ro(o.location))):(o.Target="#"+ro(o.location),a={Target:o.Target,TargetMode:"Internal"}),o.Rel=a,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var s=zi(o.ref),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c){var f=Jr({c,r:l});r?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=o):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=o)}}}(s,Le,r);var Pe=f.match(Jee);if(Pe&&(s["!margins"]=function ute(t){var n={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(n[e]=parseFloat(t[e]))}),n}(ri(Pe[0]))),!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(s["!ref"]=bi(l)),n.sheetRows>0&&s["!ref"]){var ge=zi(s["!ref"]);n.sheetRows<=+ge.e.r&&(ge.e.r=n.sheetRows-1,ge.e.r>l.e.r&&(ge.e.r=l.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>l.e.c&&(ge.e.c=l.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),s["!fullref"]=s["!ref"],s["!ref"]=bi(ge))}return R.length>0&&(s["!cols"]=R),W.length>0&&(s["!merges"]=W),s}(t,r,e,i,o,a,s)}function Cre(t,n,e,r,i){return(".bin"===n.slice(-4)?Rne:EN)(t,e,r,i)}function Dre(t,n,e){return(".bin"===n.slice(-4)?lJ:sN)(t,e)}var kb,PN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ON=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Sd(t,n){var e=t.split(/\s+/),r=[];if(n||(r[0]=e[0]),1===e.length)return r;var o,a,l,i=t.match(PN);if(i)for(l=0;l!=i.length;++l)-1===(a=(o=i[l].match(ON))[1].indexOf(":"))?r[o[1]]=o[2].slice(1,o[2].length-1):r["xmlns:"===o[1].slice(0,6)?"xmlns"+o[1].slice(6):o[1].slice(a+1)]=o[2].slice(1,o[2].length-1);return r}function Tre(t){var e={};if(1===t.split(/\s+/).length)return e;var i,o,s,r=t.match(PN);if(r)for(s=0;s!=r.length;++s)-1===(o=(i=r[s].match(ON))[1].indexOf(":"))?e[i[1]]=i[2].slice(1,i[2].length-1):e["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(o+1)]=i[2].slice(1,i[2].length-1);return e}function kre(t,n,e,r){var i=r;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=oa(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=ia(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[ro(n)]=i}function Ire(t,n,e){if(e.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=zZ[r.Pattern]||r.Pattern)}t[n.ID]=n}function Pre(t,n,e,r,i,o,a,s,l,c){var f="General",v=r.StyleID,E={};c=c||{};var D=[],k=0;for(void 0===v&&s&&(v=s.StyleID),void 0===v&&a&&(v=a.StyleID);void 0!==o[v]&&(o[v].nf&&(f=o[v].nf),o[v].Interior&&D.push(o[v].Interior),o[v].Parent);)v=o[v].Parent;switch(e.Type){case"Boolean":r.t="b",r.v=oa(t);break;case"String":r.t="s",r.r=DP(ro(t)),r.v=t.indexOf("<")>-1?ro(n||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=t.slice(-1)&&(t+="Z"),r.v=(ia(t)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!=r.v?r.v=ro(t):r.v<60&&(r.v=r.v-1),(!f||"General"==f)&&(f="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=nO[t],!1!==c.cellText&&(r.w=t);break;default:""==t&&""==n?r.t="z":(r.t="s",r.v=DP(n||t))}if(function Fre(t,n,e){if("z"!==t.t){if(!e||!1!==e.cellText)try{t.w="e"===t.t?t.w||kh[t.v]:"General"===n?"n"===t.t?(0|t.v)===t.v?t.v.toString(10):ab(t.v):Pg(t.v):function Mre(t,n){var e=kb[t]||ro(t);return"General"===e?Pg(n):tu(e,n)}(n||"General",t.v)}catch(o){if(e.WTF)throw o}try{var r=kb[n]||n||"General";if(e.cellNF&&(t.z=r),e.cellDates&&"n"==t.t&&Og(r)){var i=em(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(e.WTF)throw o}}}(r,f,c),!1!==c.cellFormula)if(r.Formula){var T=ro(r.Formula);61==T.charCodeAt(0)&&(T=T.slice(1)),r.f=s_(T,i),delete r.Formula,"RC"==r.ArrayRange?r.F=s_("RC:RC",i):r.ArrayRange&&(r.F=s_(r.ArrayRange,i),l.push([zi(r.F),r.F]))}else for(k=0;k<l.length;++k)i.r>=l[k][0].s.r&&i.r<=l[k][0].e.r&&i.c>=l[k][0].s.c&&i.c<=l[k][0].e.c&&(r.F=l[k][1]);c.cellStyles&&(D.forEach(function(R){!E.patternType&&R.patternType&&(E.patternType=R.patternType)}),r.s=E),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function Ore(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.v=t.w=t.ixfe=void 0}function KS(t,n){var e=n||{};Z1();var r=Y1(cS(t));("binary"==e.type||"array"==e.type||"base64"==e.type)&&(r=typeof eo<"u"?eo.utils.decode(65001,ww(r)):Lo(r));var i=r.slice(0,1024).toLowerCase(),o=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var a=$o(e);return a.type="string",i_.to_workbook(r,a)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(Za){i.indexOf("<"+Za)>=0&&(o=!0)}),o)return function gie(t,n){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||0==e.length)throw new Error("Invalid HTML: could not find <table>");if(1==e.length)return im(BN(e[0],n),n);var r={SheetNames:[],Sheets:{}};return e.forEach(function(i,o){fD(r,BN(i,n),"Sheet"+(o+1))}),r}(r,e);kb={"General Number":"General","General Date":qr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":qr[15],"Short Date":qr[14],"Long Time":qr[19],"Medium Time":qr[18],"Short Time":qr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:qr[2],Standard:qr[4],Percent:qr[10],Scientific:qr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var s,c,l=[];null!=Pa&&null==e.dense&&(e.dense=Pa);var an,f={},v=[],E=e.dense?[]:{},D="",k={},T={},R=Sd('<Data ss:Type="String">'),q=0,Z=0,W=0,Ee={s:{r:2e6,c:2e6},e:{r:0,c:0}},Le={},Pe={},ge="",Ye=0,Ge=[],wt={},Mt={},Qe=0,An=[],rr=[],Nn={},rn=[],Ln=!1,mn=[],Wn=[],qt={},Ae=0,dt=0,Fe={Sheets:[],WBProps:{date1904:!1}},Re={};fb.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var Xt="";s=fb.exec(r);)switch(s[3]=(Xt=s[3]).toLowerCase()){case"data":if("data"==Xt){if("/"===s[1]){if((c=l.pop())[0]!==s[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&l.push([s[3],!0]);break}if(l[l.length-1][1])break;"/"===s[1]?Pre(r.slice(q,s.index),ge,R,"comment"==l[l.length-1][0]?Nn:k,{c:Z,r:W},Le,rn[Z],T,mn,e):(ge="",R=Sd(s[0]),q=s.index+s[0].length);break;case"cell":if("/"===s[1])if(rr.length>0&&(k.c=rr),(!e.sheetRows||e.sheetRows>W)&&void 0!==k.v&&(e.dense?(E[W]||(E[W]=[]),E[W][Z]=k):E[aa(Z)+La(W)]=k),k.HRef&&(k.l={Target:ro(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(Ae=Z+(0|parseInt(k.MergeAcross,10)),dt=W+(0|parseInt(k.MergeDown,10)),Ge.push({s:{c:Z,r:W},e:{c:Ae,r:dt}})),e.sheetStubs)if(k.MergeAcross||k.MergeDown){for(var En=Z;En<=Ae;++En)for(var Sn=W;Sn<=dt;++Sn)(En>Z||Sn>W)&&(e.dense?(E[Sn]||(E[Sn]=[]),E[Sn][En]={t:"z"}):E[aa(En)+La(Sn)]={t:"z"});Z=Ae+1}else++Z;else k.MergeAcross?Z=Ae+1:++Z;else(k=Tre(s[0])).Index&&(Z=+k.Index-1),Z<Ee.s.c&&(Ee.s.c=Z),Z>Ee.e.c&&(Ee.e.c=Z),"/>"===s[0].slice(-2)&&++Z,rr=[];break;case"row":"/"===s[1]||"/>"===s[0].slice(-2)?(W<Ee.s.r&&(Ee.s.r=W),W>Ee.e.r&&(Ee.e.r=W),"/>"===s[0].slice(-2)&&(T=Sd(s[0])).Index&&(W=+T.Index-1),Z=0,++W):((T=Sd(s[0])).Index&&(W=+T.Index-1),qt={},("0"==T.AutoFitHeight||T.Height)&&(qt.hpx=parseInt(T.Height,10),qt.hpt=Cb(qt.hpx),Wn[W]=qt),"1"==T.Hidden&&(qt.hidden=!0,Wn[W]=qt));break;case"worksheet":if("/"===s[1]){if((c=l.pop())[0]!==s[3])throw new Error("Bad state: "+c.join("|"));v.push(D),Ee.s.r<=Ee.e.r&&Ee.s.c<=Ee.e.c&&(E["!ref"]=bi(Ee),e.sheetRows&&e.sheetRows<=Ee.e.r&&(E["!fullref"]=E["!ref"],Ee.e.r=e.sheetRows-1,E["!ref"]=bi(Ee))),Ge.length&&(E["!merges"]=Ge),rn.length>0&&(E["!cols"]=rn),Wn.length>0&&(E["!rows"]=Wn),f[D]=E}else Ee={s:{r:2e6,c:2e6},e:{r:0,c:0}},W=Z=0,l.push([s[3],!1]),c=Sd(s[0]),D=ro(c.Name),E=e.dense?[]:{},Ge=[],mn=[],Wn=[],Fe.Sheets.push(Re={name:D,Hidden:0});break;case"table":if("/"===s[1]){if((c=l.pop())[0]!==s[3])throw new Error("Bad state: "+c.join("|"))}else{if("/>"==s[0].slice(-2))break;l.push([s[3],!1]),rn=[],Ln=!1}break;case"style":"/"===s[1]?Ire(Le,Pe,e):Pe=Sd(s[0]);break;case"numberformat":Pe.nf=ro(Sd(s[0]).Format||"General"),kb[Pe.nf]&&(Pe.nf=kb[Pe.nf]);for(var bn=0;392!=bn&&qr[bn]!=Pe.nf;++bn);if(392==bn)for(bn=57;392!=bn;++bn)if(null==qr[bn]){Df(Pe.nf,bn);break}break;case"column":if("table"!==l[l.length-1][0])break;if((an=Sd(s[0])).Hidden&&(an.hidden=!0,delete an.Hidden),an.Width&&(an.wpx=parseInt(an.Width,10)),!Ln&&an.wpx>10){Ln=!0,Bl=QO;for(var dn=0;dn<rn.length;++dn)rn[dn]&&am(rn[dn])}Ln&&am(an),rn[an.Index-1||rn.length]=an;for(var li=0;li<+an.Span;++li)rn[rn.length]=$o(an);break;case"namedrange":if("/"===s[1])break;Fe.Names||(Fe.Names=[]);var ke=ri(s[0]),To={Name:ke.Name,Ref:s_(ke.RefersTo.slice(1),{r:0,c:0})};Fe.Sheets.length>0&&(To.Sheet=Fe.Sheets.length-1),Fe.Names.push(To);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===s[0].slice(-2))break;"/"===s[1]?ge+=r.slice(Ye,s.index):Ye=s.index+s[0].length;break;case"interior":if(!e.cellStyles)break;Pe.Interior=Sd(s[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===s[0].slice(-2))break;"/"===s[1]?rX(wt,Xt,r.slice(Qe,s.index)):Qe=s.index+s[0].length;break;case"styles":case"workbook":if("/"===s[1]){if((c=l.pop())[0]!==s[3])throw new Error("Bad state: "+c.join("|"))}else l.push([s[3],!1]);break;case"comment":if("/"===s[1]){if((c=l.pop())[0]!==s[3])throw new Error("Bad state: "+c.join("|"));Ore(Nn),rr.push(Nn)}else l.push([s[3],!1]),Nn={a:(c=Sd(s[0])).Author};break;case"autofilter":if("/"===s[1]){if((c=l.pop())[0]!==s[3])throw new Error("Bad state: "+c.join("|"))}else if("/"!==s[0].charAt(s[0].length-2)){var Bi=Sd(s[0]);E["!autofilter"]={ref:s_(Bi.Range).replace(/\$/g,"")},l.push([s[3],!0])}break;case"datavalidation":if("/"===s[1]){if((c=l.pop())[0]!==s[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&l.push([s[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===s[1]){if((c=l.pop())[0]!==s[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&l.push([s[3],!0]);break;default:if(0==l.length&&"document"==s[3]||0==l.length&&"uof"==s[3])return KN(r,e);var Mo=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Mo=!1}break;case"componentoptions":switch(s[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Mo=!1}break;case"excelworkbook":switch(s[3]){case"date1904":Fe.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Mo=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":case"height":case"width":break;default:Mo=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if("/>"!==s[0].slice(-2))if("/"===s[1])switch(r.slice(Qe,s.index)){case"SheetHidden":Re.Hidden=1;break;case"SheetVeryHidden":Re.Hidden=2}else Qe=s.index+s[0].length;break;case"header":E["!margins"]||Yg(E["!margins"]={},"xlml"),isNaN(+ri(s[0]).Margin)||(E["!margins"].header=+ri(s[0]).Margin);break;case"footer":E["!margins"]||Yg(E["!margins"]={},"xlml"),isNaN(+ri(s[0]).Margin)||(E["!margins"].footer=+ri(s[0]).Margin);break;case"pagemargins":var ji=ri(s[0]);E["!margins"]||Yg(E["!margins"]={},"xlml"),isNaN(+ji.Top)||(E["!margins"].top=+ji.Top),isNaN(+ji.Left)||(E["!margins"].left=+ji.Left),isNaN(+ji.Right)||(E["!margins"].right=+ji.Right),isNaN(+ji.Bottom)||(E["!margins"].bottom=+ji.Bottom);break;case"displayrighttoleft":Fe.Views||(Fe.Views=[]),Fe.Views[0]||(Fe.Views[0]={}),Fe.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":E["!outline"]||(E["!outline"]={}),E["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":E["!outline"]||(E["!outline"]={}),E["!outline"].left=!0;break;default:Mo=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Mo=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Mo=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Mo=!1}break;case"querytable":switch(s[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Mo=!1}break;case"datavalidation":switch(s[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Mo=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Mo=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Mo=!1}break;case"smarttags":break;default:Mo=!1}if(Mo||s[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+l.join("|");if("customdocumentproperties"===l[l.length-1][0]){if("/>"===s[0].slice(-2))break;"/"===s[1]?kre(Mt,Xt,An,r.slice(Qe,s.index)):(An=s,Qe=s.index+s[0].length);break}if(e.WTF)throw"Unrecognized tag: "+s[3]+"|"+l.join("|")}var er={};return!e.bookSheets&&!e.bookProps&&(er.Sheets=f),er.SheetNames=v,er.Workbook=Fe,er.SSF=$o(qr),er.Props=wt,er.Custprops=Mt,er}function ZS(t,n){switch(iD(n=n||{}),n.type||"base64"){case"base64":return KS(Jc(t),n);case"binary":case"buffer":case"file":return KS(t,n);case"array":return KS(Jp(t),n)}}function NN(t){return Bn("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+zS(t.Ref,{r:0,c:0})})}function Hre(t,n,e,r,i,o,a){if(!t||null==t.v&&null==t.f)return"";var s={};if(t.f&&(s["ss:Formula"]="="+Ao(zS(t.f,a))),t.F&&t.F.slice(0,n.length)==n){var l=ya(t.F.slice(n.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(s["ss:HRef"]=Ao(t.l.Target),t.l.Tooltip&&(s["x:HRefScreenTip"]=Ao(t.l.Tooltip))),e["!merges"])for(var c=e["!merges"],f=0;f!=c.length;++f)c[f].s.c!=a.c||c[f].s.r!=a.r||(c[f].e.c>c[f].s.c&&(s["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(s["ss:MergeDown"]=c[f].e.r-c[f].s.r));var v="",E="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":v="Number",E=String(t.v);break;case"b":v="Boolean",E=t.v?"1":"0";break;case"e":v="Error",E=kh[t.v];break;case"d":v="DateTime",E=new Date(t.v).toISOString(),null==t.z&&(t.z=t.z||qr[14]);break;case"s":v="String",E=function aY(t){return(t+"").replace(oS,function(e){return iS[e]}).replace(SP,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}(t.v||"")}var D=lm(r.cellXfs,t,r);s["ss:StyleID"]="s"+(21+D),s["ss:Index"]=a.c+1;var T="z"==t.t?"":'<Data ss:Type="'+v+'">'+(null!=t.v?E:"")+"</Data>";return(t.c||[]).length>0&&(T+=function Ure(t){return t.map(function(n){var e=function sY(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}(n.t||""),r=Bn("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return Bn("Comment",r,{"ss:Author":n.a})}).join("")}(t.c)),Bn("Cell",T,s)}function zre(t,n){var e='<Row ss:Index="'+(t+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=o_(n.hpt)),n.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(e+=' ss:Hidden="1"')),e+">"}function Wre(t,n,e){var r=[],o=e.Sheets[e.SheetNames[t]],a=o?function jre(t,n,e,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,o=[],a=0;a<i.length;++a){var s=i[a];s.Sheet==e&&(s.Name.match(/^_xlfn\./)||o.push(NN(s)))}return o.join("")}(o,0,t,e):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=o?function $re(t,n,e,r){if(!t["!ref"])return"";var i=zi(t["!ref"]),o=t["!merges"]||[],a=0,s=[];t["!cols"]&&t["!cols"].forEach(function(R,q){am(R);var Z=!!R.width,W=Yw(q,R),Ee={"ss:Index":q+1};Z&&(Ee["ss:Width"]=wb(W.width)),R.hidden&&(Ee["ss:Hidden"]="1"),s.push(Bn("Column",null,Ee))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var f=[zre(c,(t["!rows"]||[])[c])],v=i.s.c;v<=i.e.c;++v){var E=!1;for(a=0;a!=o.length;++a)if(!(o[a].s.c>v||o[a].s.r>c||o[a].e.c<v||o[a].e.r<c)){(o[a].s.c!=v||o[a].s.r!=c)&&(E=!0);break}if(!E){var D={r:c,c:v},k=Jr(D);f.push(Hre(l?(t[c]||[])[v]:t[k],k,t,n,0,0,D))}}f.push("</Row>"),f.length>2&&s.push(f.join(""))}return s.join("")}(o,n):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(function Vre(t,n,e,r){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Bn("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Bn("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Bn("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e])if(r.Workbook.Sheets[e].Hidden)i.push(Bn("Visible",1==r.Workbook.Sheets[e].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<e&&(!r.Workbook.Sheets[o]||r.Workbook.Sheets[o].Hidden);++o);o==e&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(fl("ProtectContents","True")),t["!protect"].objects&&i.push(fl("ProtectObjects","True")),t["!protect"].scenarios&&i.push(fl("ProtectScenarios","True")),null==t["!protect"].selectLockedCells||t["!protect"].selectLockedCells?null!=t["!protect"].selectUnlockedCells&&!t["!protect"].selectUnlockedCells&&i.push(fl("EnableSelection","UnlockedCells")):i.push(fl("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),0==i.length?"":Bn("WorksheetOptions",i.join(""),{xmlns:ru.x})}(o,0,t,e)),r.join("")}function qre(t,n){n||(n={}),t.SSF||(t.SSF=$o(qr)),t.SSF&&(Z1(),sb(t.SSF),n.revssf=Dw(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF,n.cellXfs=[],lm(n.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(function Nre(t,n){var e=[];return t.Props&&e.push(function iX(t,n){var e=[];return Oa(kS).map(function(r){for(var i=0;i<Hu.length;++i)if(Hu[i][1]==r)return Hu[i];for(i=0;i<zg.length;++i)if(zg[i][1]==r)return zg[i];throw r}).forEach(function(r){if(null!=t[r[1]]){var i=n&&n.Props&&null!=n.Props[r[1]]?n.Props[r[1]]:t[r[1]];"date"===r[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),e.push(fl(kS[r[1]]||r[1],i))}}),Bn("DocumentProperties",e.join(""),{xmlns:ru.o})}(t.Props,n)),t.Custprops&&e.push(function oX(t,n){var e=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return t&&Oa(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var a=0;a<Hu.length;++a)if(o==Hu[a][1])return;for(a=0;a<zg.length;++a)if(o==zg[a][1])return;for(a=0;a<e.length;++a)if(o==e[a])return;var s=t[o],l="string";"number"==typeof s?(l="float",s=String(s)):!0===s||!1===s?(l="boolean",s=s?"1":"0"):s=String(s),i.push(Bn(EP(o),s,{"dt:dt":l}))}}),n&&Oa(n).forEach(function(o){if(Object.prototype.hasOwnProperty.call(n,o)&&(!t||!Object.prototype.hasOwnProperty.call(t,o))){var a=n[o],s="string";"number"==typeof a?(s="float",a=String(a)):!0===a||!1===a?(s="boolean",a=a?"1":"0"):a instanceof Date?(s="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Bn(EP(o),a,{"dt:dt":s}))}}),"<"+r+' xmlns="'+ru.o+'">'+i.join("")+"</"+r+">"}(t.Props,t.Custprops)),e.join("")}(t,n)),e.push(""),e.push(""),e.push("");for(var r=0;r<t.SheetNames.length;++r)e.push(Bn("Worksheet",Wre(r,n,t),{"ss:Name":Ao(t.SheetNames[r])}));return e[2]=function Lre(t,n){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(r,i){var o=[];o.push(Bn("NumberFormat",null,{"ss:Format":Ao(qr[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};e.push(Bn("Style",o.join(""),a))}),Bn("Styles",e.join(""))}(0,n),e[3]=function Bre(t){if(!((t||{}).Workbook||{}).Names)return"";for(var n=t.Workbook.Names,e=[],r=0;r<n.length;++r){var i=n[r];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||e.push(NN(i)))}return Bn("Names",e.join(""))}(t),Ra+Bn("Workbook",e.join(""),{xmlns:ru.ss,"xmlns:o":ru.o,"xmlns:x":ru.x,"xmlns:ss":ru.ss,"xmlns:dt":ru.dt,"xmlns:html":ru.html})}var Yre=[60,1084,2066,2165,2175];function Xre(t,n,e,r,i){var o=r,a=[],s=e.slice(e.l,e.l+o);if(i&&i.enc&&i.enc.insitu&&s.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(s)}a.push(s),e.l+=o;for(var l=Th(e,e.l),c=QS[l],f=0;null!=c&&Yre.indexOf(l)>-1;)o=Th(e,e.l+2),f=e.l+4,2066==l?f+=4:(2165==l||2175==l)&&(f+=12),s=e.slice(f,e.l+4+o),a.push(s),e.l+=4+o,c=QS[l=Th(e,e.l)];var v=zs(a);hl(v,0);var E=0;v.lens=[];for(var D=0;D<a.length;++D)v.lens.push(E),E+=a[D].length;if(v.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+r;return n.f(v,v.length,i)}function Ff(t,n,e){if("z"!==t.t&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,n.cellNF&&(t.z=qr[r])}catch(o){if(n.WTF)throw o}if(!n||!1!==n.cellText)try{t.w="e"===t.t?t.w||kh[t.v]:0===r||"General"==r?"n"===t.t?(0|t.v)===t.v?t.v.toString(10):ab(t.v):Pg(t.v):tu(r,t.v,{date1904:!!e,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&"n"==t.t&&Og(qr[r]||String(r))){var i=em(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Xw(t,n,e){return{v:t,ixfe:n,t:e}}var Fb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function RN(t,n){var e,r,i,o;if(n||(n={}),iD(n),yw(),n.codepage&&bw(n.codepage),t.FullPaths){if(Fr.find(t,"/encryption"))throw new Error("File is password-protected");e=Fr.find(t,"!CompObj"),r=Fr.find(t,"/Workbook")||Fr.find(t,"/Book")}else{switch(n.type){case"base64":t=eu(Jc(t));break;case"binary":t=eu(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t))}hl(t,0),r={content:t}}if(e&&function Gre(t){var n={},e=t.content;if(e.l=28,n.AnsiUserType=e.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=function LY(t){return QP(t,1)}(e),e.length-e.l<=4)return n;var r=e.read_shift(4);if(0==r||r>40||(e.l-=4,n.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||1907505652!==(r=e.read_shift(4))||(n.UnicodeClipboardFormat=function BY(t){return QP(t,2)}(e),0==(r=e.read_shift(4))||r>40))return n;e.l-=4,n.Reserved2=e.read_shift(0,"lpwstr")}(e),n.bookProps&&!n.bookSheets)i={};else{var a=Mi?"buffer":"array";if(r&&r.content)i=function Kre(t,n){var e={opts:{}},r={};null!=Pa&&null==n.dense&&(n.dense=Pa);var v,D,T,R,W,Ee,i=n.dense?[]:{},o={},a={},s=null,l=[],c="",f={},E="",q={},Z=[],Le=[],Pe=[],ge={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Ye={},Ge=function(Ii){return Ii<8?Hg[Ii]:Ii<64&&Pe[Ii-8]||Hg[Ii]},Mt=function(Ii,Qa,Zu){if(!(qt>1||Zu.sheetRows&&Ii.r>=Zu.sheetRows)){if(Zu.cellStyles&&Qa.XF&&Qa.XF.data&&function(Ii,Qa,Zu){var p0,Ms=Qa.XF.data;Ms&&Ms.patternType&&Zu&&Zu.cellStyles&&(Qa.s={},Qa.s.patternType=Ms.patternType,(p0=yb(Ge(Ms.icvFore)))&&(Qa.s.fgColor={rgb:p0}),(p0=yb(Ge(Ms.icvBack)))&&(Qa.s.bgColor={rgb:p0}))}(0,Qa,Zu),delete Qa.ixfe,delete Qa.XF,v=Ii,E=Jr(Ii),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ii.r<a.s.r&&(a.s.r=Ii.r),Ii.c<a.s.c&&(a.s.c=Ii.c),Ii.r+1>a.e.r&&(a.e.r=Ii.r+1),Ii.c+1>a.e.c&&(a.e.c=Ii.c+1),Zu.cellFormula&&Qa.f)for(var Ms=0;Ms<Z.length;++Ms)if(!(Z[Ms][0].s.c>Ii.c||Z[Ms][0].s.r>Ii.r||Z[Ms][0].e.c<Ii.c||Z[Ms][0].e.r<Ii.r)){Qa.F=bi(Z[Ms][0]),(Z[Ms][0].s.c!=Ii.c||Z[Ms][0].s.r!=Ii.r)&&delete Qa.f,Qa.f&&(Qa.f=""+jl(Z[Ms][1],0,Ii,mn,Qe));break}Zu.dense?(i[Ii.r]||(i[Ii.r]=[]),i[Ii.r][Ii.c]=Qa):i[E]=Qa}},Qe={enc:!1,sbcch:0,snames:[],sharedf:q,arrayf:Z,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(Qe.password=n.password);var An,rr=[],Nn=[],rn=[],an=[],Ln=!1,mn=[];mn.SheetNames=Qe.snames,mn.sharedf=Qe.sharedf,mn.arrayf=Qe.arrayf,mn.names=[],mn.XTI=[];var Re,Wn=0,qt=0,Ae=0,dt=[],Fe=[];Qe.codepage=1200,Bu(1200);for(var Xt=!1;t.l<t.length-1;){var En=t.l,Sn=t.read_shift(2);if(0===Sn&&10===Wn)break;var bn=t.l===t.length?0:t.read_shift(2),dn=QS[Sn];if(dn&&dn.f){if(n.bookSheets&&133===Wn&&133!==Sn)break;if(Wn=Sn,2===dn.r||12==dn.r){var li=t.read_shift(2);if(bn-=2,!Qe.enc&&li!==Sn&&((255&li)<<8|li>>8)!==Sn)throw new Error("rt mismatch: "+li+"!="+Sn);12==dn.r&&(t.l+=10,bn-=10)}var ke={};if(ke=10===Sn?dn.f(t,bn,Qe):Xre(Sn,dn,t,bn,Qe),0==qt&&-1===[9,521,1033,2057].indexOf(Wn))continue;switch(Sn){case 34:e.opts.Date1904=ge.WBProps.date1904=ke;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(Qe.enc||(t.l=0),Qe.enc=ke,!n.password)throw new Error("File is password-protected");if(null==ke.valid)throw new Error("Encryption scheme unsupported");if(!ke.valid)throw new Error("Password is incorrect");break;case 92:Qe.lastuser=ke;break;case 66:var To=Number(ke);switch(To){case 21010:To=1200;break;case 32768:To=1e4;break;case 32769:To=1252}Bu(Qe.codepage=To),Xt=!0;break;case 317:Qe.rrtabid=ke;break;case 25:Qe.winlocked=ke;break;case 439:e.opts.RefreshAll=ke;break;case 12:e.opts.CalcCount=ke;break;case 16:e.opts.CalcDelta=ke;break;case 17:e.opts.CalcIter=ke;break;case 13:e.opts.CalcMode=ke;break;case 14:e.opts.CalcPrecision=ke;break;case 95:e.opts.CalcSaveRecalc=ke;break;case 15:Qe.CalcRefMode=ke;break;case 2211:e.opts.FullCalc=ke;break;case 129:ke.fDialog&&(i["!type"]="dialog"),ke.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),ke.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:Le.push(ke);break;case 430:mn.push([ke]),mn[mn.length-1].XTI=[];break;case 35:case 547:mn[mn.length-1].push(ke);break;case 24:case 536:Re={Name:ke.Name,Ref:jl(ke.rgce,0,null,mn,Qe)},ke.itab>0&&(Re.Sheet=ke.itab-1),mn.names.push(Re),mn[0]||(mn[0]=[],mn[0].XTI=[]),mn[mn.length-1].push(ke),"_xlnm._FilterDatabase"==ke.Name&&ke.itab>0&&ke.rgce&&ke.rgce[0]&&ke.rgce[0][0]&&"PtgArea3d"==ke.rgce[0][0][0]&&(Fe[ke.itab-1]={ref:bi(ke.rgce[0][0][1][2])});break;case 22:Qe.ExternCount=ke;break;case 23:0==mn.length&&(mn[0]=[],mn[0].XTI=[]),mn[mn.length-1].XTI=mn[mn.length-1].XTI.concat(ke),mn.XTI=mn.XTI.concat(ke);break;case 2196:if(Qe.biff<8)break;null!=Re&&(Re.Comment=ke[1]);break;case 18:i["!protect"]=ke;break;case 19:0!==ke&&Qe.WTF&&console.error("Password verifier: "+ke);break;case 133:o[ke.pos]=ke,Qe.snames.push(ke.name);break;case 10:if(--qt)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=bi(a),n.sheetRows&&n.sheetRows<=a.e.r){var Bi=a.e.r;a.e.r=n.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=bi(a),a.e.r=Bi}a.e.r++,a.e.c++}rr.length>0&&(i["!merges"]=rr),Nn.length>0&&(i["!objects"]=Nn),rn.length>0&&(i["!cols"]=rn),an.length>0&&(i["!rows"]=an),ge.Sheets.push(Ye)}""===c?f=i:r[c]=i,i=n.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===Qe.biff&&(Qe.biff={9:2,521:3,1033:4}[Sn]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ke.BIFFVer]||8),Qe.biffguess=0==ke.BIFFVer,0==ke.BIFFVer&&4096==ke.dt&&(Qe.biff=5,Xt=!0,Bu(Qe.codepage=28591)),8==Qe.biff&&0==ke.BIFFVer&&16==ke.dt&&(Qe.biff=2),qt++)break;if(i=n.dense?[]:{},Qe.biff<8&&!Xt&&(Xt=!0,Bu(Qe.codepage=n.codepage||1252)),Qe.biff<5||0==ke.BIFFVer&&4096==ke.dt){""===c&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Mo={pos:t.l-bn,name:c};o[Mo.pos]=Mo,Qe.snames.push(c)}else c=(o[En]||{name:""}).name;32==ke.dt&&(i["!type"]="chart"),64==ke.dt&&(i["!type"]="macro"),rr=[],Nn=[],Qe.arrayf=Z=[],rn=[],an=[],Ln=!1,Ye={Hidden:(o[En]||{hs:0}).hs,name:c};break;case 515:case 3:case 2:"chart"==i["!type"]&&(n.dense?(i[ke.r]||[])[ke.c]:i[Jr({c:ke.c,r:ke.r})])&&++ke.c,W={ixfe:ke.ixfe,XF:Le[ke.ixfe]||{},v:ke.val,t:"n"},Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt({c:ke.c,r:ke.r},W,n);break;case 5:case 517:W={ixfe:ke.ixfe,XF:Le[ke.ixfe],v:ke.val,t:ke.t},Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt({c:ke.c,r:ke.r},W,n);break;case 638:W={ixfe:ke.ixfe,XF:Le[ke.ixfe],v:ke.rknum,t:"n"},Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt({c:ke.c,r:ke.r},W,n);break;case 189:for(var ji=ke.c;ji<=ke.C;++ji){var er=ke.rkrec[ji-ke.c][0];W={ixfe:er,XF:Le[er],v:ke.rkrec[ji-ke.c][1],t:"n"},Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt({c:ji,r:ke.r},W,n)}break;case 6:case 518:case 1030:if("String"==ke.val){s=ke;break}if((W=Xw(ke.val,ke.cell.ixfe,ke.tt)).XF=Le[W.ixfe],n.cellFormula){var Za=ke.formula;if(Za&&Za[0]&&Za[0][0]&&"PtgExp"==Za[0][0][0]){var Ku=Za[0][0][1][0],Rf=Za[0][0][1][1],Bh=Jr({r:Ku,c:Rf});q[Bh]?W.f=""+jl(ke.formula,0,ke.cell,mn,Qe):W.F=((n.dense?(i[Ku]||[])[Rf]:i[Bh])||{}).F}else W.f=""+jl(ke.formula,0,ke.cell,mn,Qe)}Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt(ke.cell,W,n),s=ke;break;case 7:case 519:if(!s)throw new Error("String record expects Formula");s.val=ke,(W=Xw(ke,s.cell.ixfe,"s")).XF=Le[W.ixfe],n.cellFormula&&(W.f=""+jl(s.formula,0,s.cell,mn,Qe)),Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt(s.cell,W,n),s=null;break;case 33:case 545:Z.push(ke);var a2=Jr(ke[0].s);if(D=n.dense?(i[ke[0].s.r]||[])[ke[0].s.c]:i[a2],n.cellFormula&&D){if(!s||!a2||!D)break;D.f=""+jl(ke[1],0,ke[0],mn,Qe),D.F=bi(ke[0])}break;case 1212:if(!n.cellFormula)break;if(E){if(!s)break;q[Jr(s.cell)]=ke[0],((D=n.dense?(i[s.cell.r]||[])[s.cell.c]:i[Jr(s.cell)])||{}).f=""+jl(ke[0],0,v,mn,Qe)}break;case 253:W=Xw(l[ke.isst].t,ke.ixfe,"s"),l[ke.isst].h&&(W.h=l[ke.isst].h),W.XF=Le[W.ixfe],Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt({c:ke.c,r:ke.r},W,n);break;case 513:n.sheetStubs&&(W={ixfe:ke.ixfe,XF:Le[ke.ixfe],t:"z"},Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt({c:ke.c,r:ke.r},W,n));break;case 190:if(n.sheetStubs)for(var ym=ke.c;ym<=ke.C;++ym){var du=ke.ixfe[ym-ke.c];W={ixfe:du,XF:Le[du],t:"z"},Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt({c:ym,r:ke.r},W,n)}break;case 214:case 516:case 4:(W=Xw(ke.val,ke.ixfe,"s")).XF=Le[W.ixfe],Ae>0&&(W.z=dt[W.ixfe>>8&63]),Ff(W,n,e.opts.Date1904),Mt({c:ke.c,r:ke.r},W,n);break;case 0:case 512:1===qt&&(a=ke);break;case 252:l=ke;break;case 1054:if(4==Qe.biff){dt[Ae++]=ke[1];for(var jh=0;jh<Ae+163&&qr[jh]!=ke[1];++jh);jh>=163&&Df(ke[1],Ae+163)}else Df(ke[1],ke[0]);break;case 30:dt[Ae++]=ke;for(var wm=0;wm<Ae+163&&qr[wm]!=ke;++wm);wm>=163&&Df(ke,Ae+163);break;case 229:rr=rr.concat(ke);break;case 93:Nn[ke.cmo[0]]=Qe.lastobj=ke;break;case 438:Qe.lastobj.TxO=ke;break;case 127:Qe.lastobj.ImData=ke;break;case 440:for(R=ke[0].s.r;R<=ke[0].e.r;++R)for(T=ke[0].s.c;T<=ke[0].e.c;++T)(D=n.dense?(i[R]||[])[T]:i[Jr({c:T,r:R})])&&(D.l=ke[1]);break;case 2048:for(R=ke[0].s.r;R<=ke[0].e.r;++R)for(T=ke[0].s.c;T<=ke[0].e.c;++T)(D=n.dense?(i[R]||[])[T]:i[Jr({c:T,r:R})])&&D.l&&(D.l.Tooltip=ke[1]);break;case 28:if(Qe.biff<=5&&Qe.biff>=2)break;D=n.dense?(i[ke[0].r]||[])[ke[0].c]:i[Jr(ke[0])];var s2=Nn[ke[2]];D||(n.dense?(i[ke[0].r]||(i[ke[0].r]=[]),D=i[ke[0].r][ke[0].c]={t:"z"}):D=i[Jr(ke[0])]={t:"z"},a.e.r=Math.max(a.e.r,ke[0].r),a.s.r=Math.min(a.s.r,ke[0].r),a.e.c=Math.max(a.e.c,ke[0].c),a.s.c=Math.min(a.s.c,ke[0].c)),D.c||(D.c=[]),D.c.push({a:ke[1],t:s2.TxO.t});break;case 2173:RQ(0,ke.ext);break;case 125:if(!Qe.cellStyles)break;for(;ke.e>=ke.s;)rn[ke.e--]={width:ke.w/256,level:ke.level||0,hidden:!!(1&ke.flags)},Ln||(Ln=!0,jS(ke.w/256)),am(rn[ke.e+1]);break;case 520:var oc={};null!=ke.level&&(an[ke.r]=oc,oc.level=ke.level),ke.hidden&&(an[ke.r]=oc,oc.hidden=!0),ke.hpt&&(an[ke.r]=oc,oc.hpt=ke.hpt,oc.hpx=o_(ke.hpt));break;case 38:case 39:case 40:case 41:i["!margins"]||Yg(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Sn]]=ke;break;case 161:i["!margins"]||Yg(i["!margins"]={}),i["!margins"].header=ke.header,i["!margins"].footer=ke.footer;break;case 574:ke.RTL&&(ge.Views[0].RTL=!0);break;case 146:Pe=ke;break;case 2198:An=ke;break;case 140:Ee=ke;break;case 442:c?Ye.CodeName=ke||Ye.name:ge.WBProps.CodeName=ke||"ThisWorkbook"}}else dn||console.error("Missing Info for XLS Record 0x"+Sn.toString(16)),t.l+=bn}return e.SheetNames=Oa(o).sort(function(Lf,Ii){return Number(Lf)-Number(Ii)}).map(function(Lf){return o[Lf].name}),n.bookSheets||(e.Sheets=r),!e.SheetNames.length&&f["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=f)):e.Preamble=f,e.Sheets&&Fe.forEach(function(Lf,Ii){e.Sheets[e.SheetNames[Ii]]["!autofilter"]=Lf}),e.Strings=l,e.SSF=$o(qr),Qe.enc&&(e.Encryption=Qe.enc),An&&(e.Themes=An),e.Metadata={},void 0!==Ee&&(e.Metadata.Country=Ee),mn.names.length>0&&(ge.Names=mn.names),e.Workbook=ge,e}(r.content,n);else if((o=Fr.find(t,"PerfectOffice_MAIN"))&&o.content)i=Gg.to_workbook(o.content,(n.type=a,n));else{if(!(o=Fr.find(t,"NativeContent_MAIN"))||!o.content)throw(o=Fr.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i=Gg.to_workbook(o.content,(n.type=a,n))}n.bookVBA&&t.FullPaths&&Fr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function uJ(t){var n=Fr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,r){if("/"!==e.slice(-1)&&e.match(/_VBA_PROJECT_CUR/)){var i=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Fr.utils.cfb_add(n,i,t.FileIndex[r].content)}}),Fr.write(n)}(t))}var s={};return t.FullPaths&&function Zre(t,n,e){var r=Fr.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=wO(r,SS,Fb.DSI);for(var o in i)n[o]=i[o]}catch(c){if(e.WTF)throw c}var a=Fr.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var s=wO(a,DS,Fb.SI);for(var l in s)null==n[l]&&(n[l]=s[l])}catch(c){if(e.WTF)throw c}n.HeadingPairs&&n.TitlesOfParts&&(cO(n.HeadingPairs,n.TitlesOfParts,n,e),delete n.HeadingPairs,delete n.TitlesOfParts)}(t,s,n),i.Props=i.Custprops=s,n.bookFiles&&(i.cfb=t),i}var Ib={0:{f:function xte(t,n){var e={},r=t.l+n;e.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=r,7&o&&(e.level=7&o),16&o&&(e.hidden=!0),32&o&&(e.hpt=i/20),e}},1:{f:function kte(t){return[Uu(t)]}},2:{f:function Xte(t){return[Uu(t),CS(t),"n"]}},3:{f:function Bte(t){return[Uu(t),t.read_shift(1),"e"]}},4:{f:function Ote(t){return[Uu(t),t.read_shift(1),"b"]}},5:{f:function qte(t){return[Uu(t),Rl(t),"n"]}},6:{f:function ene(t){return[Uu(t),Nl(t),"str"]}},7:{f:function Hte(t){return[Uu(t),t.read_shift(4),"s"]}},8:{f:function sne(t,n,e){var r=t.l+n,i=Uu(t);i.r=e["!row"];var a=[i,Nl(t),"str"];if(e.cellFormula){t.l+=2;var s=Gw(t,r-t.l,e);a[3]=jl(s,0,i,e.supbooks,e)}else t.l=r;return a}},9:{f:function ane(t,n,e){var r=t.l+n,i=Uu(t);i.r=e["!row"];var a=[i,Rl(t),"n"];if(e.cellFormula){t.l+=2;var s=Gw(t,r-t.l,e);a[3]=jl(s,0,i,e.supbooks,e)}else t.l=r;return a}},10:{f:function ine(t,n,e){var r=t.l+n,i=Uu(t);i.r=e["!row"];var a=[i,t.read_shift(1),"b"];if(e.cellFormula){t.l+=2;var s=Gw(t,r-t.l,e);a[3]=jl(s,0,i,e.supbooks,e)}else t.l=r;return a}},11:{f:function one(t,n,e){var r=t.l+n,i=Uu(t);i.r=e["!row"];var a=[i,t.read_shift(1),"e"];if(e.cellFormula){t.l+=2;var s=Gw(t,r-t.l,e);a[3]=jl(s,0,i,e.supbooks,e)}else t.l=r;return a}},12:{f:function Ite(t){return[Bg(t)]}},13:{f:function Zte(t){return[Bg(t),CS(t),"n"]}},14:{f:function Vte(t){return[Bg(t),t.read_shift(1),"e"]}},15:{f:function Rte(t){return[Bg(t),t.read_shift(1),"b"]}},16:{f:SN},17:{f:function nne(t){return[Bg(t),Nl(t),"str"]}},18:{f:function $te(t){return[Bg(t),t.read_shift(4),"s"]}},19:{f:bS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function rre(t,n,e){var r=t.l+n;t.l+=4,t.l+=1;var i=t.read_shift(4),o=IY(t),a=jee(t,0,e),s=yS(t);t.l=r;var l={Name:o,Ptg:a};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}},40:{},42:{},43:{f:function eQ(t,n,e){var r={};r.sz=t.read_shift(2)/20;var i=function NY(t){var n=t.read_shift(1);return t.l++,{fBold:1&n,fItalic:2&n,fUnderline:4&n,fStrikeout:8&n,fOutline:16&n,fShadow:32&n,fCondense:64&n,fExtend:128&n}}(t);switch(i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1),700===t.read_shift(2)&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var a=t.read_shift(1);0!=a&&(r.underline=a);var s=t.read_shift(1);s>0&&(r.family=s);var l=t.read_shift(1);switch(l>0&&(r.charset=l),t.l++,r.color=function OY(t){var n={},r=t.read_shift(1)>>>1,i=t.read_shift(1),o=t.read_shift(2,"i"),a=t.read_shift(1),s=t.read_shift(1),l=t.read_shift(1);switch(t.l++,r){case 0:n.auto=1;break;case 1:n.index=i;var c=Hg[i];c&&(n.rgb=yb(c));break;case 2:n.rgb=yb([a,s,l]);break;case 3:n.theme=i}return 0!=o&&(n.tint=o>0?o/32767:o/32768),n}(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Nl(t),r}},44:{f:function QZ(t,n){return[t.read_shift(2),Nl(t)]}},45:{f:rQ},46:{f:oQ},47:{f:function iQ(t,n){var e=t.l+n,r=t.read_shift(2),i=t.read_shift(2);return t.l=e,{ixfe:r,numFmtId:i}}},48:{},49:{f:function SY(t){return t.read_shift(4,"i")}},50:{},51:{f:function jQ(t){for(var n=[],e=t.read_shift(4);e-- >0;)n.push([t.read_shift(4),t.read_shift(4)]);return n}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:HO},62:{f:function Jte(t){return[Uu(t),bS(t),"is"]}},63:{f:function YQ(t){var n={};n.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),n.r=Jr(e);var r=t.read_shift(1);return 2&r&&(n.l="1"),8&r&&(n.a="1"),n}},64:{f:function Cne(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ol,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function bne(t){var n=t.read_shift(2);return t.l+=28,{RTL:32&n}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function Tte(t,n){var e={},r=t[t.l];return++t.l,e.above=!(64&r),e.left=!(128&r),t.l+=18,e.name=FY(t,n-19),e}},148:{f:Ste,p:16},151:{f:function hne(){}},152:{},153:{f:function ere(t,n){var e={},r=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var i=n>8?Nl(t):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(65536&r),e.backupFile=!!(64&r),e.checkCompatibility=!!(4096&r),e.date1904=!!(1&r),e.filterPrivacy=!!(8&r),e.hidePivotFieldList=!!(1024&r),e.promptedSolutions=!!(16&r),e.publishItems=!!(2048&r),e.refreshAllConnections=!!(262144&r),e.saveExternalLinkValues=!!(128&r),e.showBorderUnselectedTables=!!(4&r),e.showInkAnnotation=!!(32&r),e.showObjects=["all","placeholders","none"][r>>13&3],e.showPivotChartFilter=!!(32768&r),e.updateLinks=["userSet","never","always"][r>>8&3],e}},154:{},155:{},156:{f:function Qne(t,n){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=wS(t,n-8),e.name=Nl(t),e}},157:{},158:{},159:{T:1,f:function mZ(t){return[t.read_shift(4),t.read_shift(4)]}},160:{T:-1},161:{T:1,f:Vg},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:lne},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function LQ(t,n){return{flags:t.read_shift(4),version:t.read_shift(4),name:Nl(t)}}},336:{T:-1},337:{f:function HQ(t){return t.l+=4,0!=t.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wS},357:{},358:{},359:{},360:{T:1},361:{},362:{f:VO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function pne(t,n,e){var r=t.l+n,i=ZP(t),o=t.read_shift(1),a=[i];if(a[2]=o,e.cellFormula){var s=Bee(t,r-t.l,e);a[1]=s}else t.l=r;return a}},427:{f:function mne(t,n,e){var r=t.l+n,o=[Vg(t,16)];if(e.cellFormula){var a=Vee(t,r-t.l,e);o[1]=a,t.l=r}else t.l=r;return o}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function _ne(t){var n={};return DN.forEach(function(e){n[e]=Rl(t)}),n}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function Ate(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function dne(t,n){var e=t.l+n,r=Vg(t,16),i=yS(t),o=Nl(t),a=Nl(t),s=Nl(t);t.l=e;var l={rfx:r,relId:i,loc:o,display:s};return a&&(l.Tooltip=a),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wS},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:oJ},633:{T:1},634:{T:-1},635:{T:1,f:function rJ(t){var n={};n.iauthor=t.read_shift(4);var e=Vg(t,16);return n.rfx=e.s,n.ref=Jr(e.s),t.l+=16,n}},636:{T:-1},637:{f:MY},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function Une(t,n){return t.l+=10,{name:Nl(t)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function Ene(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},QS={6:{f:WS},10:{f:om},12:{f:hs},13:{f:hs},14:{f:Xa},15:{f:Xa},16:{f:Rl},17:{f:Xa},18:{f:Xa},19:{f:hs},20:{f:LO},21:{f:LO},23:{f:VO},24:{f:jO},25:{f:Xa},26:{},27:{},28:{f:function EK(t,n,e){return function CK(t,n,e){if(!(e.biff<8)){var r=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),a=t.read_shift(2),s=Wg(t,0,e);return e.biff<8&&t.read_shift(1),[{r,c:i},s,a,o]}}(t,0,e)}},29:{},34:{f:Xa},35:{f:BO},38:{f:Rl},39:{f:Rl},40:{f:Rl},41:{f:Rl},42:{f:Xa},43:{f:Xa},47:{f:function RZ(t,n,e){var r={Type:e.biff>=8?t.read_shift(2):0};return r.Type?function NZ(t,n,e){var r=e||{};return r.Info=t.read_shift(2),t.l-=2,r.Data=1===r.Info?function FZ(t){var n={},e=n.EncryptionVersionInfo=Fh(t,4);if(1!=e.Major||1!=e.Minor)throw"unrecognized version code "+e.Major+" : "+e.Minor;return n.Salt=t.read_shift(16),n.EncryptedVerifier=t.read_shift(16),n.EncryptedVerifierHash=t.read_shift(16),n}(t):function kZ(t,n){var e={},r=e.EncryptionVersionInfo=Fh(t,4);if(n-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);e.Flags=t.read_shift(4),n-=4;var i=t.read_shift(4);return n-=4,e.EncryptionHeader=YO(t,i),e.EncryptionVerifier=XO(t,n-=i),e}(t,n),r}(t,n-2,r):function OZ(t,n,e,r){var i={key:hs(t),verificationBytes:hs(t)};e.password&&(i.verifier=LS(e.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=function(t){var n=0,e=KO(t);return function(r){var i=function(t,n,e,r,i){var o,a;for(i||(i=n),r||(r=KO("")),o=0;o!=n.length;++o)a=n[o],i[o]=a=255&((a^=r[e])>>5|a<<3),++e;return[i,e,r]}(0,r,n,e);return n=i[1],i[0]}}(e.password))}(t,0,e,r),r}},49:{f:function ZX(t,n,e){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10}return r.name=vb(t,0,e),r}},51:{f:hs},60:{},61:{f:function qX(t){return{Pos:[t.read_shift(2),t.read_shift(2)],Dim:[t.read_shift(2),t.read_shift(2)],Flags:t.read_shift(2),CurTab:t.read_shift(2),FirstTab:t.read_shift(2),Selected:t.read_shift(2),TabRatio:t.read_shift(2)}}},64:{f:Xa},65:{f:function KX(){}},66:{f:hs},77:{},80:{},81:{},82:{},85:{f:hs},89:{},90:{},91:{},92:{f:function NX(t,n,e){if(e.enc)return t.l+=n,"";var r=t.l,i=Wg(t,0,e);return t.read_shift(n+r-t.l),i}},93:{f:function AK(t,n,e){if(e&&e.biff<8)return function MK(t,n,e){t.l+=4;var r=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6;var a=[];return a.push((TK[r]||Ol)(t,n-=36,e)),{cmo:[i,r,o],ft:a}}(t,n,e);var r=IO(t),i=function PX(t,n){for(var e=t.l+n,r=[];t.l<e;){var i=t.read_shift(2);t.l-=2;try{r.push(IX[i](t,e-t.l))}catch{return t.l=e,r}}return t.l!=e&&(t.l=e),r}(t,n-22);return{cmo:r,ft:i}}},94:{},95:{f:Xa},96:{},97:{},99:{f:Xa},125:{f:HO},128:{f:function fK(t){t.l+=4;var n=[t.read_shift(2),t.read_shift(2)];if(0!==n[0]&&n[0]--,0!==n[1]&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}},129:{f:function LX(t,n,e){var r=e&&8==e.biff||2==n?t.read_shift(2):(t.l+=n,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:hs},131:{f:Xa},132:{f:Xa},133:{f:function BX(t,n,e){var r=t.read_shift(4),i=3&t.read_shift(1),o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule"}var a=vb(t,0,e);return 0===a.length&&(a="Sheet1"),{pos:r,hs:i,dt:o,name:a}}},134:{},140:{f:function NK(t){var e,n=[0,0];return e=t.read_shift(2),n[0]=tO[e]||e,e=t.read_shift(2),n[1]=tO[e]||e,n}},141:{f:hs},144:{},146:{f:function BK(t){for(var n=t.read_shift(2),e=[];n-- >0;)e.push(TO(t));return e}},151:{},152:{},153:{},154:{},155:{},156:{f:hs},157:{},158:{},160:{f:WK},161:{f:function UK(t,n){var e={};return n<32||(t.l+=16,e.header=Rl(t),e.footer=Rl(t),t.l+=2),e}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function lK(t,n){for(var e=t.l+n-2,r=t.read_shift(2),i=t.read_shift(2),o=[];t.l<e;)o.push(MO(t));if(t.l!==e)throw new Error("MulRK read error");var a=t.read_shift(2);if(o.length!=a-i+1)throw new Error("MulRK length mismatch");return{r,c:i,C:a,rkrec:o}}},190:{f:function cK(t,n){for(var e=t.l+n-2,r=t.read_shift(2),i=t.read_shift(2),o=[];t.l<e;)o.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var a=t.read_shift(2);if(o.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r,c:i,C:a,ixfe:o}}},193:{f:om},197:{},198:{},199:{},200:{},201:{},202:{f:Xa},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:hs},220:{},221:{f:Xa},222:{},224:{f:function dK(t,n,e){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function uK(t,n,e,r){var i={},o=t.read_shift(4),a=t.read_shift(4),s=t.read_shift(4),l=t.read_shift(2);return i.patternType=$Y[s>>26],r.cellStyles&&(i.alc=7&o,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=15&a,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=127&s,i.icvBottom=s>>7&127,i.icvDiag=s>>14&127,i.dgDiag=s>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}(t,0,0,e),r}},225:{f:function OX(t,n){return 0===n||t.read_shift(2),1200}},226:{f:om},227:{},229:{f:function SK(t,n){for(var e=[],r=t.read_shift(2);r--;)e.push(Vw(t));return e}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function VX(t,n){for(var e=t.l+n,r=t.read_shift(4),i=t.read_shift(4),o=[],a=0;a!=i&&t.l<e;++a)o.push(_X(t));return o.Count=r,o.Unique=i,o}},253:{f:function JX(t){var n=kf(t);return n.isst=t.read_shift(4),n}},255:{f:function HX(t,n){var e={};return e.dsst=t.read_shift(2),t.l+=n-2,e}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:CO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Xa},353:{f:om},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function _K(t,n,e){var r=t.l+n,i=t.read_shift(2),o=t.read_shift(2);if(e.sbcch=o,1025==o||14849==o)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var a=$g(t,o),s=[];r>t.l;)s.push(bb(t));return[o,i,a,s]}},431:{f:Xa},432:{},433:{},434:{},437:{},438:{f:function kK(t,n,e){var r=t.l,i="";try{t.l+=4,-1==[0,5,7,11,12,14].indexOf((e.lastobj||{cmo:[0,0]}).cmo[1])?t.l+=6:function bX(t){var n=t.read_shift(1);t.l++;var e=t.read_shift(2);t.l+=2}(t);var s=t.read_shift(2);t.read_shift(2),hs(t);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-r!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l];if((i+=$g(t,t.lens[c+1]-t.lens[c]-1)).length>=(f?s:2*s))break}if(i.length!==s&&i.length!==2*s)throw new Error("cchText: "+s+" != "+i.length);return t.l=r+n,{t:i}}catch{return t.l=r+n,{t:i}}}},439:{f:Xa},440:{f:function FK(t,n){var e=Vw(t);t.l+=16;var r=function CX(t,n){var e=t.l+n,r=t.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var i=t.read_shift(2);t.l+=2;var o,a,s,l,f,v,c="";16&i&&(o=jw(t)),128&i&&(a=jw(t)),257==(257&i)&&(s=jw(t)),1==(257&i)&&(l=function xX(t,n){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return function yX(t){var n=t.read_shift(4),e=t.l,r=!1;n>24&&(t.l+=n-24,"795881f43b1d7f48af2c825dc4852763"===t.read_shift(16)&&(r=!0),t.l=e);var i=t.read_shift((r?n-24:n)>>1,"utf16le").replace(Il,"");return r&&(t.l+=24),i}(t);case"0303000000000000c000000000000046":return function wX(t){for(var n=t.read_shift(2),e="";n-- >0;)e+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,57005!=t.read_shift(2))throw new Error("Bad FileMoniker");if(0===t.read_shift(4))return e+r.replace(/\\/g,"/");var o=t.read_shift(4);if(3!=t.read_shift(2))throw new Error("Bad FileMoniker");return e+t.read_shift(o>>1,"utf16le").replace(Il,"")}(t);default:throw new Error("Unsupported Moniker "+e)}}(t)),8&i&&(c=jw(t)),32&i&&(f=t.read_shift(16)),64&i&&(v=IS(t)),t.l=e;var E=a||s||l||"";E&&c&&(E+="#"+c),E||(E="#"+c),2&i&&"/"==E.charAt(0)&&"/"!=E.charAt(1)&&(E="file://"+E);var D={Target:E};return f&&(D.guid=f),v&&(D.time=v),o&&(D.Tooltip=o),D}(t,n-24);return[e,r]}},441:{},442:{f:bb},443:{},444:{f:hs},445:{},446:{},448:{f:om},449:{f:function WX(t){return t.read_shift(2),t.read_shift(4)},r:2},450:{f:om},512:{f:OO},513:{f:$K},515:{f:function mK(t,n,e){e.biffguess&&2==e.biff&&(e.biff=5);var r=kf(t),i=Rl(t);return r.val=i,r}},516:{f:function tK(t,n,e){e.biffguess&&2==e.biff&&(e.biff=5);var i=kf(t);2==e.biff&&t.l++;var o=bb(t,0,e);return i.val=o,i}},517:{f:RO},519:{f:qK},520:{f:function zX(t){var n={};n.r=t.read_shift(2),n.c=t.read_shift(2),n.cnt=t.read_shift(2)-n.c;var e=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,7&r&&(n.level=7&r),32&r&&(n.hidden=!0),64&r&&(n.hpt=e/20),n}},523:{},545:{f:UO},549:{f:PO},566:{},574:{f:function YX(t,n,e){return e&&e.biff>=2&&e.biff<5?{}:{RTL:64&t.read_shift(2)}}},638:{f:function sK(t){var n=t.read_shift(2),e=t.read_shift(2),r=MO(t);return{r:n,c:e,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function rK(t,n,e){return[t.read_shift(2),Wg(t,0,e)]}},1084:{},1212:{f:function wK(t,n,e){var r=FO(t);t.l++;var i=t.read_shift(1);return[Oee(t,n-=8,e),i,r]}},2048:{f:function PK(t,n){t.read_shift(2);var e=Vw(t),r=t.read_shift((n-10)/2,"dbcs-cont");return[e,r=r.replace(Il,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Uw},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:om},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function jK(t){t.l+=2;var n={cxfs:0,crc:0};return n.cxfs=t.read_shift(2),n.crc=t.read_shift(4),n},r:12},2173:{f:function NQ(t,n){t.l+=2;var r=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),o=[];i-- >0;)o.push(OQ(t));return{ixfe:r,ext:o}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Xa,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function yK(t,n,e){if(!(e.biff<8)){var r=t.read_shift(2),i=t.read_shift(2);return[$g(t,r,e),$g(t,i,e)]}t.l+=n},r:12},2197:{},2198:{f:function MQ(t,n,e){var r=t.l+n;if(124226!==t.read_shift(4)){if(!e.cellStyles)return void(t.l=r);var a,o=t.slice(t.l);t.l=r;try{a=wP(o,{type:"array"})}catch{return}var s=nu(a,"theme/theme/theme1.xml",!0);if(s)return rN(s,e)}},r:12},2199:{},2200:{},2201:{},2202:{f:function xK(t){return[0!==t.read_shift(4),0!==t.read_shift(4),t.read_shift(4)]},r:12},2203:{f:om},2204:{},2205:{},2206:{},2207:{},2211:{f:function $X(t){var n=function SX(t){var n=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:n,flags:e}}(t);if(2211!=n.type)throw new Error("Invalid Future Record "+n.type);return 0!==t.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:hs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function HK(t,n,e){var r={area:!1};if(5!=e.biff)return t.l+=n,r;var i=t.read_shift(1);return t.l+=3,16&i&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function LK(t){for(var n=t.read_shift(2),e=[];n-- >0;)e.push(TO(t));return e}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:OO},1:{},2:{f:function ZK(t){var n=kf(t);++t.l;var e=t.read_shift(2);return n.t="n",n.val=e,n}},3:{f:function XK(t){var n=kf(t);++t.l;var e=Rl(t);return n.t="n",n.val=e,n}},4:{f:function YK(t,n,e){e.biffguess&&5==e.biff&&(e.biff=2);var r=kf(t);++t.l;var i=Wg(t,0,e);return r.t="str",r.val=i,r}},5:{f:RO},7:{f:function JK(t){var n=t.read_shift(1);return 0===n?(t.l++,""):t.read_shift(n,"sbcs-cont")}},8:{},9:{f:Uw},11:{},22:{f:hs},30:{f:oK},31:{},32:{},33:{f:UO},36:{},37:{f:PO},50:{f:function eZ(t,n){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=n-13}},62:{},52:{},67:{},68:{f:hs},69:{},86:{},126:{},127:{f:function GK(t){var n=t.read_shift(2),e=t.read_shift(2),r=t.read_shift(4),i={fmt:n,env:e,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,i}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function tZ(t,n,e){var r=t.l+n,i=kf(t),o=t.read_shift(2),a=$g(t,o,e);return t.l=r,i.t="str",i.val=a,i}},223:{},234:{},354:{},421:{},518:{f:WS},521:{f:Uw},536:{f:jO},547:{f:BO},561:{},579:{},1030:{f:WS},1033:{f:Uw},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Vn(t,n,e,r){var i=n;if(!isNaN(i)){var o=r||(e||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,o),o>0&&mS(e)&&t.push(e)}}function Pb(t,n,e){return t||(t=Ut(7)),t.write_shift(2,n),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function rie(t,n,e,r){if(null!=n.v)switch(n.t){case"d":case"n":var i="d"==n.t?As(ia(n.v)):n.v;return void(i==(0|i)&&i>=0&&i<65536?Vn(t,2,function QK(t,n,e){var r=Ut(9);return Pb(r,t,n),r.write_shift(2,e),r}(e,r,i)):Vn(t,3,function KK(t,n,e){var r=Ut(15);return Pb(r,t,n),r.write_shift(8,e,"f"),r}(e,r,i)));case"b":case"e":return void Vn(t,5,function tie(t,n,e,r){var i=Ut(9);return Pb(i,t,n),EO(e,r||"b",i),i}(e,r,n.v,n.t));case"s":case"str":return void Vn(t,4,function nie(t,n,e){var r=Ut(8+2*e.length);return Pb(r,t,n),r.write_shift(1,e.length),r.write_shift(e.length,e,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(e,r,(n.v||"").slice(0,255)))}Vn(t,1,Pb(null,e,r))}function fie(t,n,e,r,i){var o=16+lm(i.cellXfs,n,i);if(null!=n.v||n.bf)if(n.bf)Vn(t,6,function Lee(t,n,e,r,i){var o=qg(n,e,i),a=function Ree(t){if(null==t){var n=Ut(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}return Ug("number"==typeof t?t:0)}(t.v),s=Ut(6);s.write_shift(2,33),s.write_shift(4,0);for(var c=Ut(t.bf.length),f=0;f<t.bf.length;++f)c[f]=t.bf[f];return zs([o,a,s,c])}(n,e,r,0,o));else switch(n.t){case"d":case"n":Vn(t,515,function gK(t,n,e,r){var i=Ut(14);return qg(t,n,r,i),Ug(e,i),i}(e,r,"d"==n.t?As(ia(n.v)):n.v,o));break;case"b":case"e":Vn(t,517,function pK(t,n,e,r,i,o){var a=Ut(8);return qg(t,n,r,a),EO(e,o,a),a}(e,r,n.v,o,0,n.t));break;case"s":case"str":i.bookSST?Vn(t,253,function eK(t,n,e,r){var i=Ut(10);return qg(t,n,r,i),i.write_shift(4,e),i}(e,r,GS(i.Strings,n.v,i.revStrings),o)):Vn(t,516,function nK(t,n,e,r,i){var o=!i||8==i.biff,a=Ut(+o+8+(1+o)*e.length);return qg(t,n,r,a),a.write_shift(2,e.length),o&&a.write_shift(1,1),a.write_shift((1+o)*e.length,e,o?"utf16le":"sbcs"),a}(e,r,(n.v||"").slice(0,255),o,i));break;default:Vn(t,513,qg(e,r,o))}else Vn(t,513,qg(e,r,o))}function hie(t,n,e){var f,r=nc(),i=e.SheetNames[t],o=e.Sheets[i]||{},a=(e||{}).Workbook||{},s=(a.Sheets||[])[t]||{},l=Array.isArray(o),c=8==n.biff,v="",E=[],D=zi(o["!ref"]||"A1"),k=c?65536:16384;if(D.e.c>255||D.e.r>=k){if(n.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");D.e.c=Math.min(D.e.c,255),D.e.r=Math.min(D.e.c,k-1)}Vn(r,2057,OS(0,16,n)),Vn(r,13,zu(1)),Vn(r,12,zu(100)),Vn(r,15,ic(!0)),Vn(r,17,ic(!1)),Vn(r,16,Ug(.001)),Vn(r,95,ic(!0)),Vn(r,42,ic(!1)),Vn(r,43,ic(!1)),Vn(r,130,zu(1)),Vn(r,128,function hK(t){var n=Ut(8);return n.write_shift(4,0),n.write_shift(2,t[0]?t[0]+1:0),n.write_shift(2,t[1]?t[1]+1:0),n}([0,0])),Vn(r,131,ic(!1)),Vn(r,132,ic(!1)),c&&function die(t,n){if(n){var e=0;n.forEach(function(r,i){++e<=256&&r&&Vn(t,125,function VK(t,n){var e=Ut(12);e.write_shift(2,n),e.write_shift(2,n),e.write_shift(2,256*t.width),e.write_shift(2,0);var r=0;return t.hidden&&(r|=1),e.write_shift(1,r),e.write_shift(1,r=t.level||0),e.write_shift(2,0),e}(Yw(i,r),i))})}}(r,o["!cols"]),Vn(r,512,function aK(t,n){var e=8!=n.biff&&n.biff?2:4,r=Ut(2*e+6);return r.write_shift(e,t.s.r),r.write_shift(e,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}(D,n)),c&&(o["!links"]=[]);for(var T=D.s.r;T<=D.e.r;++T){v=La(T);for(var R=D.s.c;R<=D.e.c;++R){T===D.s.r&&(E[R]=aa(R)),f=E[R]+v;var q=l?(o[T]||[])[R]:o[f];q&&(fie(r,q,T,R,n),c&&q.l&&o["!links"].push([f,q.l]))}}var Z=s.CodeName||s.name||i;return c&&Vn(r,574,function XX(t){var n=Ut(18),e=1718;return t&&t.RTL&&(e|=64),n.write_shift(2,e),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}((a.Views||[])[0])),c&&(o["!merges"]||[]).length&&Vn(r,229,function DK(t){var n=Ut(2+8*t.length);n.write_shift(2,t.length);for(var e=0;e<t.length;++e)kO(t[e],n);return n}(o["!merges"])),c&&function uie(t,n){for(var e=0;e<n["!links"].length;++e){var r=n["!links"][e];Vn(t,440,IK(r)),r[1].Tooltip&&Vn(t,2048,OK(r))}delete n["!links"]}(r,o),Vn(r,442,SO(Z)),c&&function lie(t,n){var e=Ut(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Vn(t,2151,e),(e=Ut(39)).write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),kO(zi(n["!ref"]||"A1"),e),e.write_shift(4,4),Vn(t,2152,e)}(r,o),Vn(r,10),r.end()}function pie(t,n,e){var r=nc(),i=(t||{}).Workbook||{},o=i.Sheets||[],a=i.WBProps||{},s=8==e.biff,l=5==e.biff;Vn(r,2057,OS(0,5,e)),"xla"==e.bookType&&Vn(r,135),Vn(r,225,s?zu(1200):null),Vn(r,193,function pX(t,n){n||(n=Ut(t));for(var e=0;e<t;++e)n.write_shift(1,0);return n}(2)),l&&Vn(r,191),l&&Vn(r,192),Vn(r,226),Vn(r,92,function RX(t,n){var e=!n||8==n.biff,r=Ut(e?112:54);for(r.write_shift(8==n.biff?2:1,7),e&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(e?0:536870912));r.l<r.length;)r.write_shift(1,e?0:32);return r}(0,e)),Vn(r,66,zu(s?1200:1252)),s&&Vn(r,353,zu(0)),s&&Vn(r,448),Vn(r,317,function zK(t){for(var n=Ut(2*t),e=0;e<t;++e)n.write_shift(2,e+1);return n}(t.SheetNames.length)),s&&t.vbaraw&&Vn(r,211),s&&t.vbaraw&&Vn(r,442,SO(a.CodeName||"ThisWorkbook")),Vn(r,156,zu(17)),Vn(r,25,ic(!1)),Vn(r,18,ic(!1)),Vn(r,19,zu(0)),s&&Vn(r,431,ic(!1)),s&&Vn(r,444,zu(0)),Vn(r,61,function GX(){var t=Ut(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}()),Vn(r,64,ic(!1)),Vn(r,141,zu(0)),Vn(r,34,ic("true"==function Gne(t){return t.Workbook&&t.Workbook.WBProps&&oa(t.Workbook.WBProps.date1904)?"true":"false"}(t))),Vn(r,14,ic(!0)),s&&Vn(r,439,ic(!1)),Vn(r,218,zu(0)),function aie(t,n,e){Vn(t,49,function QX(t,n){var e=t.name||"Arial",r=n&&5==n.biff,o=Ut(r?15+e.length:16+2*e.length);return o.write_shift(2,20*(t.sz||12)),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,e.length),r||o.write_shift(1,1),o.write_shift((r?1:2)*e.length,e,r?"sbcs":"utf16le"),o}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}(r,0,e),function sie(t,n,e){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=n[i]&&Vn(t,1054,iK(i,n[i],e))})}(r,t.SSF,e),function cie(t,n){for(var e=0;e<16;++e)Vn(t,224,NO({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(r){Vn(t,224,NO(r,0,n))})}(r,e),s&&Vn(r,352,ic(!1));var f=r.end(),v=nc();s&&Vn(v,140,function RK(t){return t||(t=Ut(4)),t.write_shift(2,1),t.write_shift(2,1),t}()),s&&e.Strings&&function eie(t,n,e,r){var i=r||(e||[]).length||0;if(i<=8224)return Vn(t,n,e,i);var o=n;if(!isNaN(o)){for(var a=e.parts||[],s=0,l=0,c=0;c+(a[s]||8224)<=8224;)c+=a[s]||8224,s++;var f=t.next(4);for(f.write_shift(2,o),f.write_shift(2,c),t.push(e.slice(l,l+c)),l+=c;l<i;){for((f=t.next(4)).write_shift(2,60),c=0;c+(a[s]||8224)<=8224;)c+=a[s]||8224,s++;f.write_shift(2,c),t.push(e.slice(l,l+c)),l+=c}}}(v,252,function UX(t,n){var e=Ut(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var r=[],i=0;i<t.length;++i)r[i]=vX(t[i]);var o=zs([e].concat(r));return o.parts=[e.length].concat(r.map(function(a){return a.length})),o}(e.Strings)),Vn(v,10);var E=v.end(),D=nc(),k=0,T=0;for(T=0;T<t.SheetNames.length;++T)k+=(s?12:11)+(s?2:1)*t.SheetNames[T].length;var R=f.length+k+E.length;for(T=0;T<t.SheetNames.length;++T)Vn(D,133,jX({pos:R,hs:(o[T]||{}).Hidden||0,dt:0,name:t.SheetNames[T]},e)),R+=n[T].length;var Z=D.end();if(k!=Z.length)throw new Error("BS8 "+k+" != "+Z.length);var W=[];return f.length&&W.push(f),Z.length&&W.push(Z),E.length&&W.push(E),zs(W)}function LN(t,n){for(var e=0;e<=t.SheetNames.length;++e){var r=t.Sheets[t.SheetNames[e]];r&&r["!ref"]&&rc(r["!ref"]).e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}var o=n||{};switch(o.biff||2){case 8:case 5:return function mie(t,n){var e=n||{},r=[];t&&!t.SSF&&(t.SSF=$o(qr)),t&&t.SSF&&(Z1(),sb(t.SSF),e.revssf=Dw(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,oD(e),e.cellXfs=[],lm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)r[r.length]=hie(i,e,t);return r.unshift(pie(t,r,e)),zs(r)}(t,n);case 4:case 3:case 2:return function oie(t,n){var e=n||{};null!=Pa&&null==e.dense&&(e.dense=Pa);for(var r=nc(),i=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==e.sheet&&(i=o);if(0==i&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return Vn(r,4==e.biff?1033:3==e.biff?521:9,OS(0,16,e)),function iie(t,n,e,r){var a,i=Array.isArray(n),o=zi(n["!ref"]||"A1"),s="",l=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),a=bi(o)}for(var c=o.s.r;c<=o.e.r;++c){s=La(c);for(var f=o.s.c;f<=o.e.c;++f){c===o.s.r&&(l[f]=aa(f)),a=l[f]+s;var v=i?(n[c]||[])[f]:n[a];v&&rie(t,v,c,f)}}}(r,t.Sheets[t.SheetNames[i]],0,e),Vn(r,10),r.end()}(t,n)}throw new Error("invalid type "+o.bookType+" for BIFF")}function BN(t,n){var e=n||{};null!=Pa&&null==e.dense&&(e.dense=Pa);var r=e.dense?[]:{},i=(t=t.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),a=i.index,s=o&&o.index||t.length,l=JG(t.slice(a,s),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,v=0,E=0,D={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(a=0;a<l.length;++a){var T=l[a].trim(),R=T.slice(0,3).toLowerCase();if("<tr"!=R){if("<td"==R||"<th"==R){var q=T.split(/<\/t[dh]>/i);for(s=0;s<q.length;++s){var Z=q[s].trim();if(Z.match(/<t[dh]/i)){for(var W=Z,Ee=0;"<"==W.charAt(0)&&(Ee=W.indexOf(">"))>-1;)W=W.slice(Ee+1);for(var Le=0;Le<k.length;++Le){var Pe=k[Le];Pe.s.c==f&&Pe.s.r<c&&c<=Pe.e.r&&(f=Pe.e.c+1,Le=-1)}var ge=ri(Z.slice(0,Z.indexOf(">")));E=ge.colspan?+ge.colspan:1,((v=+ge.rowspan)>1||E>1)&&k.push({s:{r:c,c:f},e:{r:c+(v||1)-1,c:f+E-1}});var Ye=ge.t||ge["data-t"]||"";if(!W.length){f+=E;continue}if(W=MP(W),D.s.r>c&&(D.s.r=c),D.e.r<c&&(D.e.r=c),D.s.c>f&&(D.s.c=f),D.e.c<f&&(D.e.c=f),!W.length){f+=E;continue}var Ge={t:"s",v:W};e.raw||!W.trim().length||"s"==Ye||("TRUE"===W?Ge={t:"b",v:!0}:"FALSE"===W?Ge={t:"b",v:!1}:isNaN(Cd(W))?isNaN(Q1(W).getDate())||(Ge={t:"d",v:ia(W)},e.cellDates||(Ge={t:"n",v:As(Ge.v)}),Ge.z=e.dateNF||qr[14]):Ge={t:"n",v:Cd(W)}),e.dense?(r[c]||(r[c]=[]),r[c][f]=Ge):r[Jr({r:c,c:f})]=Ge,f+=E}}}}else{if(++c,e.sheetRows&&e.sheetRows<=c){--c;break}f=0}}return r["!ref"]=bi(D),k.length&&(r["!merges"]=k),r}function jN(t,n,e,r){for(var i=t["!merges"]||[],o=[],a=n.s.c;a<=n.e.c;++a){for(var s=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>e||i[c].s.c>a||i[c].e.r<e||i[c].e.c<a)){if(i[c].s.r<e||i[c].s.c<a){s=-1;break}s=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(s<0)){var f=Jr({r:e,c:a}),v=r.dense?(t[e]||[])[a]:t[f],E=v&&null!=v.v&&(v.h||aS(v.w||(Mf(v),v.w)||""))||"",D={};s>1&&(D.rowspan=s),l>1&&(D.colspan=l),r.editable?E='<span contenteditable="true">'+E+"</span>":v&&(D["data-t"]=v&&v.t||"z",null!=v.v&&(D["data-v"]=v.v),null!=v.z&&(D["data-z"]=v.z),v.l&&"#"!=(v.l.Target||"#").charAt(0)&&(E='<a href="'+v.l.Target+'">'+E+"</a>")),D.id=(r.id||"sjs")+"-"+f,o.push(Bn("td",E,D))}}return"<tr>"+o.join("")+"</tr>"}var VN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',UN="</body></html>";function zN(t,n){var e=n||{},i=null!=e.footer?e.footer:UN,o=[null!=e.header?e.header:VN],a=rc(t["!ref"]);e.dense=Array.isArray(t),o.push(function HN(t,n,e){return[].join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}(0,0,e));for(var s=a.s.r;s<=a.e.r;++s)o.push(jN(t,a,s,e));return o.push("</table>"+i),o.join("")}function $N(t,n,e){var r=e||{};null!=Pa&&(r.dense=Pa);var i=0,o=0;if(null!=r.origin)if("number"==typeof r.origin)i=r.origin;else{var a="string"==typeof r.origin?ya(r.origin):r.origin;i=a.r,o=a.c}var s=n.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,s.length),c={s:{r:0,c:0},e:{r:i,c:o}};if(t["!ref"]){var f=rc(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),-1==i&&(c.e.r=i=f.e.r+1)}var v=[],E=0,D=t["!rows"]||(t["!rows"]=[]),k=0,T=0,R=0,q=0,Z=0,W=0;for(t["!cols"]||(t["!cols"]=[]);k<s.length&&T<l;++k){var Ee=s[k];if(qN(Ee)){if(r.display)continue;D[T]={hidden:!0}}var Le=Ee.children;for(R=q=0;R<Le.length;++R){var Pe=Le[R];if(!r.display||!qN(Pe)){var ge=Pe.hasAttribute("data-v")?Pe.getAttribute("data-v"):Pe.hasAttribute("v")?Pe.getAttribute("v"):MP(Pe.innerHTML),Ye=Pe.getAttribute("data-z")||Pe.getAttribute("z");for(E=0;E<v.length;++E){var Ge=v[E];Ge.s.c==q+o&&Ge.s.r<T+i&&T+i<=Ge.e.r&&(q=Ge.e.c+1-o,E=-1)}W=+Pe.getAttribute("colspan")||1,((Z=+Pe.getAttribute("rowspan")||1)>1||W>1)&&v.push({s:{r:T+i,c:q+o},e:{r:T+i+(Z||1)-1,c:q+o+(W||1)-1}});var wt={t:"s",v:ge},Mt=Pe.getAttribute("data-t")||Pe.getAttribute("t")||"";null!=ge&&(0==ge.length?wt.t=Mt||"z":r.raw||0==ge.trim().length||"s"==Mt||("TRUE"===ge?wt={t:"b",v:!0}:"FALSE"===ge?wt={t:"b",v:!1}:isNaN(Cd(ge))?isNaN(Q1(ge).getDate())||(wt={t:"d",v:ia(ge)},r.cellDates||(wt={t:"n",v:As(wt.v)}),wt.z=r.dateNF||qr[14]):wt={t:"n",v:Cd(ge)})),void 0===wt.z&&null!=Ye&&(wt.z=Ye);var Qe="",An=Pe.getElementsByTagName("A");if(An&&An.length)for(var rr=0;rr<An.length&&(!An[rr].hasAttribute("href")||"#"==(Qe=An[rr].getAttribute("href")).charAt(0));++rr);Qe&&"#"!=Qe.charAt(0)&&(wt.l={Target:Qe}),r.dense?(t[T+i]||(t[T+i]=[]),t[T+i][q+o]=wt):t[Jr({c:q+o,r:T+i})]=wt,c.e.c<q+o&&(c.e.c=q+o),q+=W}}++T}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),c.e.r=Math.max(c.e.r,T-1+i),t["!ref"]=bi(c),T>=l&&(t["!fullref"]=bi((c.e.r=s.length-k+T-1+i,c))),t}function WN(t,n){return $N((n||{}).dense?[]:{},t,n)}function qN(t){var n="",e=function vie(t){return t.ownerDocument.defaultView&&"function"==typeof t.ownerDocument.defaultView.getComputedStyle?t.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(t);return e&&(n=e(t).getPropertyValue("display")),n||(n=t.style&&t.style.display),"none"===n}function bie(t){var n=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[ro(n.replace(/<[^>]*>/g,""))]}var GN={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function YN(t,n){var e=n||{};null!=Pa&&null==e.dense&&(e.dense=Pa);var o,a,f,v,T,R,r=cS(t),i=[],s={name:""},l="",c=0,E={},D=[],k=e.dense?[]:{},q={value:""},Z="",W=0,Le=[],Pe=-1,ge=-1,Ye={s:{r:1e6,c:1e7},e:{r:0,c:0}},Ge=0,wt={},Mt=[],Qe={},An=0,rr=0,Nn=[],rn=1,an=1,Ln=[],mn={Names:[]},Wn={},qt=["",""],Ae=[],dt={},Fe="",Re=0,Xt=!1,En=!1,Sn=0;for(fb.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");T=fb.exec(r);)switch(T[3]=T[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===T[1]?(k["!ref"]=Ye.e.c>=Ye.s.c&&Ye.e.r>=Ye.s.r?bi(Ye):"A1:A1",e.sheetRows>0&&e.sheetRows<=Ye.e.r&&(k["!fullref"]=k["!ref"],Ye.e.r=e.sheetRows-1,k["!ref"]=bi(Ye)),Mt.length&&(k["!merges"]=Mt),Nn.length&&(k["!rows"]=Nn),f.name=f.\u540d\u79f0||f.name,typeof JSON<"u"&&JSON.stringify(f),D.push(f.name),E[f.name]=k,En=!1):"/"!==T[0].charAt(T[0].length-2)&&(f=ri(T[0],!1),Pe=ge=-1,Ye.s.r=Ye.s.c=1e7,Ye.e.r=Ye.e.c=0,k=e.dense?[]:{},Mt=[],Nn=[],En=!0);break;case"table-row-group":"/"===T[1]?--Ge:++Ge;break;case"table-row":case"\u884c":if("/"===T[1]){Pe+=rn,rn=1;break}if((v=ri(T[0],!1)).\u884c\u53f7?Pe=v.\u884c\u53f7-1:-1==Pe&&(Pe=0),(rn=+v["number-rows-repeated"]||1)<10)for(Sn=0;Sn<rn;++Sn)Ge>0&&(Nn[Pe+Sn]={level:Ge});ge=-1;break;case"covered-table-cell":"/"!==T[1]&&++ge,e.sheetStubs&&(e.dense?(k[Pe]||(k[Pe]=[]),k[Pe][ge]={t:"z"}):k[Jr({r:Pe,c:ge})]={t:"z"}),Z="",Le=[];break;case"table-cell":case"\u6570\u636e":if("/"===T[0].charAt(T[0].length-2))++ge,q=ri(T[0],!1),an=parseInt(q["number-columns-repeated"]||"1",10),R={t:"z",v:null},q.formula&&0!=e.cellFormula&&(R.f=wN(ro(q.formula))),"string"==(q.\u6570\u636e\u7c7b\u578b||q["value-type"])&&(R.t="s",R.v=ro(q["string-value"]||""),e.dense?(k[Pe]||(k[Pe]=[]),k[Pe][ge]=R):k[Jr({r:Pe,c:ge})]=R),ge+=an-1;else if("/"!==T[1]){Z="",W=0,Le=[],an=1;var bn=rn?Pe+rn-1:Pe;if(++ge>Ye.e.c&&(Ye.e.c=ge),ge<Ye.s.c&&(Ye.s.c=ge),Pe<Ye.s.r&&(Ye.s.r=Pe),bn>Ye.e.r&&(Ye.e.r=bn),Ae=[],dt={},R={t:(q=ri(T[0],!1)).\u6570\u636e\u7c7b\u578b||q["value-type"],v:null},e.cellFormula)if(q.formula&&(q.formula=ro(q.formula)),q["number-matrix-columns-spanned"]&&q["number-matrix-rows-spanned"]&&(An=parseInt(q["number-matrix-rows-spanned"],10)||0,rr=parseInt(q["number-matrix-columns-spanned"],10)||0,R.F=bi(Qe={s:{r:Pe,c:ge},e:{r:Pe+An-1,c:ge+rr-1}}),Ln.push([Qe,R.F])),q.formula)R.f=wN(q.formula);else for(Sn=0;Sn<Ln.length;++Sn)Pe>=Ln[Sn][0].s.r&&Pe<=Ln[Sn][0].e.r&&ge>=Ln[Sn][0].s.c&&ge<=Ln[Sn][0].e.c&&(R.F=Ln[Sn][1]);switch((q["number-columns-spanned"]||q["number-rows-spanned"])&&(An=parseInt(q["number-rows-spanned"],10)||0,rr=parseInt(q["number-columns-spanned"],10)||0,Mt.push(Qe={s:{r:Pe,c:ge},e:{r:Pe+An-1,c:ge+rr-1}})),q["number-columns-repeated"]&&(an=parseInt(q["number-columns-repeated"],10)),R.t){case"boolean":R.t="b",R.v=oa(q["boolean-value"]);break;case"float":case"percentage":case"currency":R.t="n",R.v=parseFloat(q.value);break;case"date":R.t="d",R.v=ia(q["date-value"]),e.cellDates||(R.t="n",R.v=As(R.v)),R.z="m/d/yy";break;case"time":R.t="n",R.v=KG(q["time-value"])/86400,e.cellDates&&(R.t="d",R.v=Tw(R.v)),R.z="HH:MM:SS";break;case"number":R.t="n",R.v=parseFloat(q.\u6570\u636e\u6570\u503c);break;default:if("string"!==R.t&&"text"!==R.t&&R.t)throw new Error("Unsupported value type "+R.t);R.t="s",null!=q["string-value"]&&(Z=ro(q["string-value"]),Le=[])}}else{if(Xt=!1,"s"===R.t&&(R.v=Z||"",Le.length&&(R.R=Le),Xt=0==W),Wn.Target&&(R.l=Wn),Ae.length>0&&(R.c=Ae,Ae=[]),Z&&!1!==e.cellText&&(R.w=Z),Xt&&(R.t="z",delete R.v),(!Xt||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=Pe))for(var dn=0;dn<rn;++dn){if(an=parseInt(q["number-columns-repeated"]||"1",10),e.dense)for(k[Pe+dn]||(k[Pe+dn]=[]),k[Pe+dn][ge]=0==dn?R:$o(R);--an>0;)k[Pe+dn][ge+an]=$o(R);else for(k[Jr({r:Pe+dn,c:ge})]=R;--an>0;)k[Jr({r:Pe+dn,c:ge+an})]=$o(R);Ye.e.c<=ge&&(Ye.e.c=ge)}ge+=(an=parseInt(q["number-columns-repeated"]||"1",10))-1,an=0,R={},Z="",Le=[]}Wn={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===T[1]){if((o=i.pop())[0]!==T[3])throw"Bad state: "+o}else"/"!==T[0].charAt(T[0].length-2)&&i.push([T[3],!0]);break;case"annotation":if("/"===T[1]){if((o=i.pop())[0]!==T[3])throw"Bad state: "+o;dt.t=Z,Le.length&&(dt.R=Le),dt.a=Fe,Ae.push(dt)}else"/"!==T[0].charAt(T[0].length-2)&&i.push([T[3],!1]);Fe="",Re=0,Z="",W=0,Le=[];break;case"creator":"/"===T[1]?Fe=r.slice(Re,T.index):Re=T.index+T[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===T[1]){if((o=i.pop())[0]!==T[3])throw"Bad state: "+o}else"/"!==T[0].charAt(T[0].length-2)&&i.push([T[3],!1]);Z="",W=0,Le=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===T[1]){if(wt[s.name]=l,(o=i.pop())[0]!==T[3])throw"Bad state: "+o}else"/"!==T[0].charAt(T[0].length-2)&&(l="",s=ri(T[0],!1),i.push([T[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ri(T[0],!1),l+=GN[T[3]]["long"===a.style?1:0]}break;case"text":if("/>"===T[0].slice(-2))break;if("/"===T[1])switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=r.slice(c,T.index)}else c=T.index+T[0].length;break;case"named-range":qt=qS((a=ri(T[0],!1))["cell-range-address"]);var li={Name:a.name,Ref:qt[0]+"!"+qt[1]};En&&(li.Sheet=D.length),mn.Names.push(li);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if("/"!==T[1]||q&&q["string-value"])ri(T[0],!1),W=T.index+T[0].length;else{var ke=bie(r.slice(W,T.index));Z=(Z.length>0?Z+"\n":"")+ke[0]}break;case"database-range":if("/"===T[1])break;try{E[(qt=qS(ri(T[0])["target-range-address"]))[0]]["!autofilter"]={ref:qt[1]}}catch{}break;case"a":if("/"!==T[1]){if(!(Wn=ri(T[0],!1)).href)break;Wn.Target=ro(Wn.href),delete Wn.href,"#"==Wn.Target.charAt(0)&&Wn.Target.indexOf(".")>-1?(qt=qS(Wn.Target.slice(1)),Wn.Target="#"+qt[0]+"!"+qt[1]):Wn.Target.match(/^\.\.[\\\/]/)&&(Wn.Target=Wn.Target.slice(3))}break;default:switch(T[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(e.WTF)throw new Error(T)}}var To={Sheets:E,SheetNames:D,Workbook:mn};return e.bookSheets&&delete To.Sheets,To}function KN(t,n){return YN(t,n)}var yie=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+db({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ra+n}}(),ZN=function(){var t=function(o){return Ao(o).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n="          <table:table-cell />\n",r=function(o,a,s){var l=[];l.push('      <table:table table:name="'+Ao(a.SheetNames[s])+'" table:style-name="ta1">\n');var c=0,f=0,v=rc(o["!ref"]||"A1"),E=o["!merges"]||[],D=0,k=Array.isArray(o);if(o["!cols"])for(f=0;f<=v.e.c;++f)l.push("        <table:table-column"+(o["!cols"][f]?' table:style-name="co'+o["!cols"][f].ods+'"':"")+"></table:table-column>\n");var R=o["!rows"]||[];for(c=0;c<v.s.r;++c)l.push("        <table:table-row"+(R[c]?' table:style-name="ro'+R[c].ods+'"':"")+"></table:table-row>\n");for(;c<=v.e.r;++c){for(l.push("        <table:table-row"+(R[c]?' table:style-name="ro'+R[c].ods+'"':"")+">\n"),f=0;f<v.s.c;++f)l.push(n);for(;f<=v.e.c;++f){var q=!1,Z={},W="";for(D=0;D!=E.length;++D)if(!(E[D].s.c>f||E[D].s.r>c||E[D].e.c<f||E[D].e.r<c)){(E[D].s.c!=f||E[D].s.r!=c)&&(q=!0),Z["table:number-columns-spanned"]=E[D].e.c-E[D].s.c+1,Z["table:number-rows-spanned"]=E[D].e.r-E[D].s.r+1;break}if(q)l.push("          <table:covered-table-cell/>\n");else{var Ee=Jr({r:c,c:f}),Le=k?(o[c]||[])[f]:o[Ee];if(Le&&Le.f&&(Z["table:formula"]=Ao(zee(Le.f)),Le.F&&Le.F.slice(0,Ee.length)==Ee)){var Pe=rc(Le.F);Z["table:number-matrix-columns-spanned"]=Pe.e.c-Pe.s.c+1,Z["table:number-matrix-rows-spanned"]=Pe.e.r-Pe.s.r+1}if(Le){switch(Le.t){case"b":W=Le.v?"TRUE":"FALSE",Z["office:value-type"]="boolean",Z["office:boolean-value"]=Le.v?"true":"false";break;case"n":W=Le.w||String(Le.v||0),Z["office:value-type"]="float",Z["office:value"]=Le.v||0;break;case"s":case"str":W=null==Le.v?"":Le.v,Z["office:value-type"]="string";break;case"d":W=Le.w||ia(Le.v).toISOString(),Z["office:value-type"]="date",Z["office:date-value"]=ia(Le.v).toISOString(),Z["table:style-name"]="ce1";break;default:l.push(n);continue}var ge=t(W);if(Le.l&&Le.l.Target){var Ye=Le.l.Target;"#"!=(Ye="#"==Ye.charAt(0)?"#"+$ee(Ye.slice(1)):Ye).charAt(0)&&!Ye.match(/^\w+:/)&&(Ye="../"+Ye),ge=Bn("text:a",ge,{"xlink:href":Ye.replace(/&/g,"&amp;")})}l.push("          "+Bn("table:table-cell",Bn("text:p",ge,{}),Z)+"\n")}else l.push(n)}}l.push("        </table:table-row>\n")}return l.push("      </table:table>\n"),l.join("")};return function(a,s){var l=[Ra],c=db({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=db({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==s.bookType?(l.push("<office:document"+c+f+">\n"),l.push(oO().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+">\n"),function(o,a){o.push(" <office:automatic-styles>\n"),o.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),o.push('   <number:month number:style="long"/>\n'),o.push("   <number:text>/</number:text>\n"),o.push('   <number:day number:style="long"/>\n'),o.push("   <number:text>/</number:text>\n"),o.push("   <number:year/>\n"),o.push("  </number:date-style>\n");var s=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"])for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var v=c["!cols"][f];if(null==v.width&&null==v.wpx&&null==v.wch)continue;am(v),v.ods=s;var E=c["!cols"][f].wpx+"px";o.push('  <style:style style:name="co'+s+'" style:family="table-column">\n'),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+E+'"/>\n'),o.push("  </style:style>\n"),++s}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"])for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var v=c["!rows"][f].hpx+"px";o.push('  <style:style style:name="ro'+l+'" style:family="table-row">\n'),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+'"/>\n'),o.push("  </style:style>\n"),++l}}),o.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),o.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),o.push("  </style:style>\n"),o.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),o.push(" </office:automatic-styles>\n")}(l,a),l.push("  <office:body>\n"),l.push("    <office:spreadsheet>\n");for(var v=0;v!=a.SheetNames.length;++v)l.push(r(a.Sheets[a.SheetNames[v]],a,v));return l.push("    </office:spreadsheet>\n"),l.push("  </office:body>\n"),l.push("fods"==s.bookType?"</office:document>":"</office:document-content>"),l.join("")}}();function QN(t,n){if("fods"==n.bookType)return ZN(t,n);var e=rS(),r="",i=[],o=[];return Ei(e,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ei(e,r="content.xml",ZN(t,n)),i.push([r,"text/xml"]),o.push([r,"ContentFile"]),Ei(e,r="styles.xml",yie(t,n)),i.push([r,"text/xml"]),o.push([r,"StylesFile"]),Ei(e,r="meta.xml",Ra+oO()),i.push([r,"text/xml"]),o.push([r,"MetadataFile"]),Ei(e,r="manifest.rdf",function QY(t){var n=[Ra];n.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var e=0;e!=t.length;++e)n.push(iO(t[e][0],t[e][1])),n.push(ZY("",t[e][0]));return n.push(iO("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}(o)),i.push([r,"application/rdf+xml"]),Ei(e,r="META-INF/manifest.xml",function KY(t){var n=[Ra];n.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),n.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var e=0;e<t.length;++e)n.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+'"/>\n');return n.push("</manifest:manifest>"),n.join("")}(i)),e}function Xg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function JS(t){return typeof TextDecoder<"u"?(new TextDecoder).decode(t):Lo(Jp(t))}function wie(t){return typeof TextEncoder<"u"?(new TextEncoder).encode(t):eu(Tf(t))}function cm(t){var n=t.reduce(function(i,o){return i+o.length},0),e=new Uint8Array(n),r=0;return t.forEach(function(i){e.set(i,r),r+=i.length}),e}function JN(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>>24}function Ob(t,n){var e=n?n[0]:0,r=127&t[e];e:if(t[e++]>=128&&(r|=(127&t[e])<<7,t[e++]<128||(r|=(127&t[e])<<14,t[e++]<128)||(r|=(127&t[e])<<21,t[e++]<128)||(r+=(127&t[e])*Math.pow(2,28),++e,t[e++]<128)||(r+=(127&t[e])*Math.pow(2,35),++e,t[e++]<128)||(r+=(127&t[e])*Math.pow(2,42),++e,t[e++]<128)))break e;return n&&(n[0]=e),r}function wo(t){var n=new Uint8Array(7);n[0]=127&t;var e=1;e:if(t>127){if(n[e-1]|=128,n[e]=t>>7&127,++e,t<=16383||(n[e-1]|=128,n[e]=t>>14&127,++e,t<=2097151)||(n[e-1]|=128,n[e]=t>>21&127,++e,t<=268435455)||(n[e-1]|=128,n[e]=t/256>>>21&127,++e,t<=34359738367)||(n[e-1]|=128,n[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;n[e-1]|=128,n[e]=t/16777216>>>21&127,++e}return n.slice(0,e)}function Ba(t){var n=0,e=127&t[n];e:if(t[n++]>=128){if(e|=(127&t[n])<<7,t[n++]<128||(e|=(127&t[n])<<14,t[n++]<128)||(e|=(127&t[n])<<21,t[n++]<128))break e;e|=(127&t[n])<<28}return e}function lo(t){for(var n=[],e=[0];e[0]<t.length;){var s,r=e[0],i=Ob(t,e),o=7&i,a=0;if(0==(i=Math.floor(i/8)))break;switch(o){case 0:for(var l=e[0];t[e[0]++]>=128;);s=t.slice(l,e[0]);break;case 5:s=t.slice(e[0],e[0]+(a=4)),e[0]+=a;break;case 1:s=t.slice(e[0],e[0]+(a=8)),e[0]+=a;break;case 2:a=Ob(t,e),s=t.slice(e[0],e[0]+a),e[0]+=a;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(r))}var c={data:s,type:o};null==n[i]?n[i]=[c]:n[i].push(c)}return n}function Gs(t){var n=[];return t.forEach(function(e,r){e.forEach(function(i){i.data&&(n.push(wo(8*r+i.type)),2==i.type&&n.push(wo(i.data.length)),n.push(i.data))})}),cm(n)}function eD(t,n){return t?.map(function(e){return n(e.data)})||[]}function $u(t){for(var n,e=[],r=[0];r[0]<t.length;){var i=Ob(t,r),o=lo(t.slice(r[0],r[0]+i));r[0]+=i;var a={id:Ba(o[1][0].data),messages:[]};o[2].forEach(function(s){var l=lo(s.data),c=Ba(l[3][0].data);a.messages.push({meta:l,data:t.slice(r[0],r[0]+c)}),r[0]+=c}),null!=(n=o[3])&&n[0]&&(a.merge=Ba(o[3][0].data)>>>0>0),e.push(a)}return e}function c_(t){var n=[];return t.forEach(function(e){var r=[];r[1]=[{data:wo(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:wo(+!!e.merge),type:0}]);var i=[];e.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:wo(a.data.length)}],r[2].push({data:Gs(a.meta),type:2})});var o=Gs(r);n.push(wo(o.length)),n.push(o),i.forEach(function(a){return n.push(a)})}),cm(n)}function Sie(t,n){if(0!=t)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],r=Ob(n,e),i=[];e[0]<n.length;){var o=3&n[e[0]];if(0!=o){var l=0,c=0;if(1==o?(c=4+(n[e[0]]>>2&7),l=(224&n[e[0]++])<<3,l|=n[e[0]++]):(c=1+(n[e[0]++]>>2),2==o?(l=n[e[0]]|n[e[0]+1]<<8,e[0]+=2):(l=(n[e[0]]|n[e[0]+1]<<8|n[e[0]+2]<<16|n[e[0]+3]<<24)>>>0,e[0]+=4)),i=[cm(i)],0==l)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}else{var a=n[e[0]++]>>2;if(a<60)++a;else{var s=a-59;a=n[e[0]],s>1&&(a|=n[e[0]+1]<<8),s>2&&(a|=n[e[0]+2]<<16),s>3&&(a|=n[e[0]+3]<<24),a>>>=0,a++,e[0]+=s}i.push(n.slice(e[0],e[0]+a)),e[0]+=a}}var f=cm(i);if(f.length!=r)throw new Error("Unexpected length: ".concat(f.length," != ").concat(r));return f}function Wu(t){for(var n=[],e=0;e<t.length;){var r=t[e++],i=t[e]|t[e+1]<<8|t[e+2]<<16;n.push(Sie(r,t.slice(e+=3,e+i))),e+=i}if(e!==t.length)throw new Error("data is not a valid framed stream!");return cm(n)}function u_(t){for(var n=[],e=0;e<t.length;){var r=Math.min(t.length-e,268435455),i=new Uint8Array(4);n.push(i);var o=wo(r),a=o.length;n.push(o),r<=60?(a++,n.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,n.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,n.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,n.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,n.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),n.push(t.slice(e,e+r)),a+=r,i[0]=0,i[1]=255&a,i[2]=a>>8&255,i[3]=a>>16&255,e+=r}return cm(n)}function tD(t,n){var e=new Uint8Array(32),r=Xg(e),i=12,o=0;switch(e[0]=5,t.t){case"n":e[1]=2,function Eie(t,n,e){var r=Math.floor(0==e?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,i=e/Math.pow(10,r-6176);t[n+15]|=r>>7,t[n+14]|=(127&r)<<1;for(var o=0;i>=1;++o,i/=256)t[n+o]=255&i;t[n+15]|=e>=0?0:128}(e,i,t.v),o|=1,i+=16;break;case"b":e[1]=6,r.setFloat64(i,t.v?1:0,!0),o|=2,i+=8;break;case"s":if(-1==n.indexOf(t.v))throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,r.setUint32(i,n.indexOf(t.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,o,!0),e.slice(0,i)}function nD(t,n){var e=new Uint8Array(32),r=Xg(e),i=12,o=0;switch(e[0]=3,t.t){case"n":e[2]=2,r.setFloat64(i,t.v,!0),o|=32,i+=8;break;case"b":e[2]=6,r.setFloat64(i,t.v?1:0,!0),o|=32,i+=8;break;case"s":if(-1==n.indexOf(t.v))throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,r.setUint32(i,n.indexOf(t.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,o,!0),e.slice(0,i)}function Tie(t,n,e){switch(t[0]){case 0:case 1:case 2:case 3:return function Die(t,n,e,r){var v,i=Xg(t),o=i.getUint32(4,!0),a=(r>1?12:8)+4*JN(o&(r>1?3470:398)),s=-1,l=-1,c=NaN,f=new Date(2001,0,1);switch(512&o&&(s=i.getUint32(a,!0),a+=4),a+=4*JN(o&(r>1?12288:4096)),16&o&&(l=i.getUint32(a,!0),a+=4),32&o&&(c=i.getFloat64(a,!0),a+=8),64&o&&(f.setTime(f.getTime()+1e3*i.getFloat64(a,!0)),a+=8),t[2]){case 0:break;case 2:v={t:"n",v:c};break;case 3:v={t:"s",v:n[l]};break;case 5:v={t:"d",v:f};break;case 6:v={t:"b",v:c>0};break;case 7:v={t:"n",v:c/86400};break;case 8:v={t:"e",v:0};break;case 9:if(s>-1)v={t:"s",v:e[s]};else if(l>-1)v={t:"s",v:n[l]};else{if(isNaN(c))throw new Error("Unsupported cell type ".concat(t.slice(0,4)));v={t:"n",v:c}}break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}(t,n,e,t[0]);case 5:return function Aie(t,n,e){var v,r=Xg(t),i=r.getUint32(8,!0),o=12,a=-1,s=-1,l=NaN,c=NaN,f=new Date(2001,0,1);switch(1&i&&(l=function Cie(t,n){for(var e=(127&t[n+15])<<7|t[n+14]>>1,r=1&t[n+14],i=n+13;i>=n;--i)r=256*r+t[i];return(128&t[n+15]?-r:r)*Math.pow(10,e-6176)}(t,o),o+=16),2&i&&(c=r.getFloat64(o,!0),o+=8),4&i&&(f.setTime(f.getTime()+1e3*r.getFloat64(o,!0)),o+=8),8&i&&(s=r.getUint32(o,!0),o+=4),16&i&&(a=r.getUint32(o,!0),o+=4),t[1]){case 0:break;case 2:case 10:v={t:"n",v:l};break;case 3:v={t:"s",v:n[s]};break;case 5:v={t:"d",v:f};break;case 6:v={t:"b",v:c>0};break;case 7:v={t:"n",v:c/86400};break;case 8:v={t:"e",v:0};break;case 9:if(!(a>-1))throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(31&i," : ").concat(t.slice(0,4)));v={t:"s",v:e[a]};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(31&i," : ").concat(t.slice(0,4)))}return v}(t,n,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Vl(t){return Ob(lo(t)[1][0].data)}function eR(t,n){var e=lo(n.data),r=Ba(e[1][0].data),o=[];return(e[3]||[]).forEach(function(a){var s=lo(a.data),l=Ba(s[1][0].data)>>>0;switch(r){case 1:o[l]=JS(s[3][0].data);break;case 8:var f=lo(t[Vl(s[9][0].data)][0].data),v=t[Vl(f[1][0].data)][0],E=Ba(v.meta[1][0].data);if(2001!=E)throw new Error("2000 unexpected reference to ".concat(E));var D=lo(v.data);o[l]=D[3].map(function(k){return JS(k.data)}).join("")}}),o}function Iie(t,n){var r={"!ref":"A1"},i=t[Vl(lo(n.data)[2][0].data)],o=Ba(i[0].meta[1][0].data);if(6001!=o)throw new Error("6000 unexpected reference to ".concat(o));return function Fie(t,n,e){var r,i=lo(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Ba(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(Ba(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));e["!ref"]=bi(o);var a=lo(i[4][0].data),s=eR(t,t[Vl(a[4][0].data)][0]),l=null!=(r=a[17])&&r[0]?eR(t,t[Vl(a[17][0].data)][0]):[],c=lo(a[3][0].data),f=0;c[1].forEach(function(v){var E=lo(v.data),D=t[Vl(E[2][0].data)][0],k=Ba(D.meta[1][0].data);if(6002!=k)throw new Error("6001 unexpected reference to ".concat(k));var T=function kie(t,n){var e,r=lo(n.data),i=null!=(e=r?.[7])&&e[0]?Ba(r[7][0].data)>>>0>0?1:0:-1,o=eD(r[5],function(a){return function Mie(t,n){var e,r,i,o,a,s,l,c,f,v,E,D,k,T,Ee,Le,R=lo(t),q=Ba(R[1][0].data)>>>0,Z=Ba(R[2][0].data)>>>0,W=(null==(r=null==(e=R[8])?void 0:e[0])?void 0:r.data)&&Ba(R[8][0].data)>0||!1;if(null!=(o=null==(i=R[7])?void 0:i[0])&&o.data&&0!=n)Ee=null==(s=null==(a=R[7])?void 0:a[0])?void 0:s.data,Le=null==(c=null==(l=R[6])?void 0:l[0])?void 0:c.data;else{if(null==(v=null==(f=R[4])?void 0:f[0])||!v.data||1==n)throw"NUMBERS Tile missing ".concat(n," cell storage");Ee=null==(D=null==(E=R[4])?void 0:E[0])?void 0:D.data,Le=null==(T=null==(k=R[3])?void 0:k[0])?void 0:T.data}for(var Pe=W?4:1,ge=Xg(Ee),Ye=[],Ge=0;Ge<Ee.length/2;++Ge){var wt=ge.getUint16(2*Ge,!0);wt<65535&&Ye.push([Ge,wt])}if(Ye.length!=Z)throw"Expected ".concat(Z," cells, found ").concat(Ye.length);var Mt=[];for(Ge=0;Ge<Ye.length-1;++Ge)Mt[Ye[Ge][0]]=Le.subarray(Ye[Ge][1]*Pe,Ye[Ge+1][1]*Pe);return Ye.length>=1&&(Mt[Ye[Ye.length-1][0]]=Le.subarray(Ye[Ye.length-1][1]*Pe)),{R:q,cells:Mt}}(a,i)});return{nrows:Ba(r[4][0].data)>>>0,data:o.reduce(function(a,s){return a[s.R]||(a[s.R]=[]),s.cells.forEach(function(l,c){if(a[s.R][c])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(c));a[s.R][c]=l}),a},[])}}(0,D);T.data.forEach(function(R,q){R.forEach(function(Z,W){var Ee=Jr({r:f+q,c:W}),Le=Tie(Z,s,l);Le&&(e[Ee]=Le)})}),f+=T.nrows})}(t,i[0],r),r}function rD(t){var n,e,r,i,o={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c,f;try{c=Wu(l.content)}catch(v){return console.log("?? "+l.content.length+" "+(v.message||v))}try{f=$u(c)}catch(v){return console.log("## "+(v.message||v))}f.forEach(function(v){o[v.id]=v.messages,a.push(v.id)})}}),!a.length)throw new Error("File has no messages");var s=(null==(i=null==(r=null==(e=null==(n=o?.[1])?void 0:n[0])?void 0:e.meta)?void 0:r[1])?void 0:i[0].data)&&1==Ba(o[1][0].meta[1][0].data)&&o[1][0];if(s||a.forEach(function(l){o[l].forEach(function(c){if(1==Ba(c.meta[1][0].data)>>>0){if(s)throw new Error("Document has multiple roots");s=c}})}),!s)throw new Error("Cannot find Document root");return function Oie(t,n){var e={SheetNames:[],Sheets:{}};if(eD(lo(n.data)[1],Vl).forEach(function(o){t[o].forEach(function(a){if(2==Ba(a.meta[1][0].data)){var l=function Pie(t,n){var e,r=lo(n.data),i={name:null!=(e=r[1])&&e[0]?JS(r[1][0].data):"",sheets:[]};return eD(r[2],Vl).forEach(function(a){t[a].forEach(function(s){6e3==Ba(s.meta[1][0].data)&&i.sheets.push(Iie(t,s))})}),i}(t,a);l.sheets.forEach(function(c,f){fD(e,c,0==f?l.name:l.name+"_"+f,!0)})}})}),0==e.SheetNames.length)throw new Error("Empty NUMBERS file");return e}(o,s)}function Nie(t,n,e){var r,i,o,a;if(null==(r=t[6])||!r[0]||null==(i=t[7])||!i[0])throw"Mutation only works on post-BNC storages!";if((null==(a=null==(o=t[8])?void 0:o[0])?void 0:a.data)&&Ba(t[8][0].data)>0)throw"Math only works with normal offsets";for(var l=0,c=Xg(t[7][0].data),f=0,v=[],E=Xg(t[4][0].data),D=0,k=[],T=0;T<n.length;++T)if(null!=n[T]){var R,q;switch(c.setUint16(2*T,f,!0),E.setUint16(2*T,D,!0),typeof n[T]){case"string":R=tD({t:"s",v:n[T]},e),q=nD({t:"s",v:n[T]},e);break;case"number":R=tD({t:"n",v:n[T]},e),q=nD({t:"n",v:n[T]},e);break;case"boolean":R=tD({t:"b",v:n[T]},e),q=nD({t:"b",v:n[T]},e);break;default:throw new Error("Unsupported value "+n[T])}v.push(R),f+=R.length,k.push(q),D+=q.length,++l}else c.setUint16(2*T,65535,!0),E.setUint16(2*T,65535);for(t[2][0].data=wo(l);T<t[7][0].data.length/2;++T)c.setUint16(2*T,65535,!0),E.setUint16(2*T,65535,!0);return t[6][0].data=cm(v),t[3][0].data=cm(k),l}function tR(t){return function(e){for(var r=0;r!=t.length;++r){var i=t[r];void 0===e[i[0]]&&(e[i[0]]=i[1]),"n"===i[2]&&(e[i[0]]=Number(e[i[0]]))}}}function iD(t){tR([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function oD(t){tR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Lie(t){return yi.WS.indexOf(t)>-1?"sheet":yi.CS&&t==yi.CS?"chart":yi.DS&&t==yi.DS?"dialog":yi.MS&&t==yi.MS?"macro":t&&t.length?t:"sheet"}function jie(t,n,e,r,i,o,a,s,l,c,f,v){try{o[r]=_b(nu(t,e,!0),n);var D,E=ds(t,n);switch(s){case"sheet":D=dre(E,n,i,l,o[r],c,f,v);break;case"chart":if(!(D=function fre(t,n,e,r,i,o,a,s){return".bin"===n.slice(-4)?function Hne(t,n,e,r,i){if(!t)return t;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},a=[],s=!1;return Mh(t,function(c,f,v){switch(v){case 550:o["!rel"]=c;break;case 651:i.Sheets[e]||(i.Sheets[e]={}),c.name&&(i.Sheets[e].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(v);break;case 38:a.pop();break;default:if(f.T>0)a.push(v);else if(f.T<0)a.pop();else if(!s||n.WTF)throw new Error("Unexpected record 0x"+v.toString(16))}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}(t,r,e,i,o):function jne(t,n,e,r,i){if(!t)return t;r||(r={"!id":{}});var a,o={"!type":"chart","!drawel":null,"!rel":""},s=t.match(CN);return s&&YS(s[0],0,i,e),(a=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=a[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}(t,0,e,i,o)}(E,n,i,l,o[r],c))||!D["!drawel"])break;var k=cb(D["!drawel"].Target,n),T=gb(k),R=function ZQ(t,n){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][e].Target}(nu(t,k,!0),_b(nu(t,T,!0),k)),q=cb(R,k),Z=gb(q);D=function Bne(t,n,e,r,i,o){var a=o||{"!type":"chart"};if(!t)return o;var s=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var E=function Lne(t){var r,n=[],e=t.match(/^<c:numCache>/);(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(o){var a=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(n[+a[1]]=e?+a[2]:a[2])});var i=ro((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,i,r]}(v);f.s.r=f.s.c=0,f.e.c=s,c=aa(s),E[0].forEach(function(D,k){a[c+La(k)]={t:"n",v:D,z:E[1]},l=k}),f.e.r<l&&(f.e.r=l),++s}),s>0&&(a["!ref"]=bi(f)),a}(nu(t,q,!0),0,0,_b(nu(t,Z,!0),q),0,D);break;case"macro":D=function hre(t,n,e,r,i,o,a,s){return n.slice(-4),{"!type":"macro"}}(0,n);break;case"dialog":D=function pre(t,n,e,r,i,o,a,s){return n.slice(-4),{"!type":"dialog"}}(0,n);break;default:throw new Error("Unrecognized sheet type "+s)}a[r]=D;var W=[];o&&o[r]&&Oa(o[r]).forEach(function(Ee){var Le="";if(o[r][Ee].Type==yi.CMNT){Le=cb(o[r][Ee].Target,n);var Pe=function vre(t,n,e){return".bin"===n.slice(-4)?function sJ(t,n){var e=[],r=[],i={},o=!1;return Mh(t,function(s,l,c){switch(c){case 632:r.push(s);break;case 635:i=s;break;case 637:i.t=s.t,i.h=s.h,i.r=s.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,n.sheetRows&&i.rfx&&n.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,e.push(i);break;case 3072:case 37:case 38:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!l.T&&(!o||n.WTF))throw new Error("Unexpected record 0x"+c.toString(16))}}),e}(t,e):function QQ(t,n){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],r=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(""!==a&&""!==a.trim()){var s=a.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&e.push(s[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(a){if(""!==a&&""!==a.trim()){var s=a.match(/<(?:\w+:)?comment[^>]*>/);if(s){var l=ri(s[0]),c={author:l.authorId&&e[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=ya(l.ref);if(!(n.sheetRows&&n.sheetRows<=f.r)){var v=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),E=!!v&&!!v[1]&&RS(v[1])||{r:"",t:"",h:""};c.r=E.r,"<t></t>"==E.r&&(E.t=E.h=""),c.t=(E.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),n.cellHTML&&(c.h=E.h),r.push(c)}}}}),r}(t,e)}(ds(t,Le,!0),Le,l);if(!Pe||!Pe.length)return;aN(D,Pe,!1)}o[r][Ee].Type==yi.TCMNT&&(Le=cb(o[r][Ee].Target,n),W=W.concat(function JQ(t,n){var e=[],r=!1,i={},o=0;return t.replace(Pl,function(s,l){var c=ri(s);switch(Af(c[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=i.t&&e.push(i);break;case"<text>":case"<text":o=l+s.length;break;case"</text>":i.t=t.slice(o,l).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return s}),e}(ds(t,Le,!0),l)))}),W&&W.length&&aN(D,W,!0,l.people||[])}catch(Ee){if(l.WTF)throw Ee}}function qu(t){return"/"==t.charAt(0)?t.slice(1):t}function Vie(t,n){if(Z1(),iD(n=n||{}),Vu(t,"META-INF/manifest.xml")||Vu(t,"objectdata.xml"))return function XN(t,n){n=n||{},Vu(t,"META-INF/manifest.xml")&&function XY(t,n){for(var r,i,e=cS(t);r=fb.exec(e);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(i=ri(r[0],!1)).path&&i.type!==YY)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}(ds(t,"META-INF/manifest.xml"),n);var e=nu(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var r=YN(Lo(e),n);return Vu(t,"meta.xml")&&(r.Props=aO(ds(t,"meta.xml"))),r}(t,n);if(Vu(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(t.FileIndex)return rD(t);var e=Fr.utils.cfb_new();return yP(t).forEach(function(rr){Ei(e,rr,bP(t,rr))}),rD(e)}if(!Vu(t,"[Content_Types].xml"))throw Vu(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vu(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a,s,r=yP(t),i=function GY(t){var n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!t||!t.match)return n;var e={};if((t.match(Pl)||[]).forEach(function(r){var i=ri(r);switch(i[0].replace(rY,"<")){case"<?xml":break;case"<Types":n.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[i.Extension]=i.ContentType;break;case"<Override":void 0!==n[AS[i.ContentType]]&&n[AS[i.ContentType]].push(i.PartName)}}),n.xmlns!==fs.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=e,delete n.calcchains,n}(nu(t,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&ds(t,s="xl/workbook.xml",!0)&&i.workbooks.push(s),0===i.workbooks.length){if(!ds(t,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(s),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!n.bookSheets&&!n.bookProps){if(Tb=[],i.sst)try{Tb=function _re(t,n,e){return".bin"===n.slice(-4)?function gZ(t,n){var e=[],r=!1;return Mh(t,function(o,a,s){switch(s){case 159:e.Count=o[0],e.Unique=o[1];break;case 19:e.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(!r||n.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),e}(t,e):function hZ(t,n){var e=[],r="";if(!t)return e;var i=t.match(uZ);if(i){r=i[2].replace(dZ,"").split(fZ);for(var o=0;o!=r.length;++o){var a=RS(r[o].trim(),n);null!=a&&(e[e.length]=a)}i=ri(i[1]),e.Count=i.count,e.Unique=i.uniqueCount}return e}(t,e)}(ds(t,qu(i.sst)),i.sst,n)}catch(rr){if(n.WTF)throw rr}n.cellStyles&&i.themes.length&&(l=function gre(t,n,e){return rN(t,e)}(nu(t,i.themes[0].replace(/^\//,""),!0)||"",0,n)),i.style&&(c=function mre(t,n,e,r){return".bin"===n.slice(-4)?function cQ(t,n,e){var r={NumberFmt:[]};for(var i in qr)r.NumberFmt[i]=qr[i];r.CellXf=[],r.Fonts=[];var o=[],a=!1;return Mh(t,function(l,c,f){switch(f){case 44:r.NumberFmt[l[0]]=l[1],Df(l[1],l[0]);break;case 43:r.Fonts.push(l),null!=l.color.theme&&n&&n.themeElements&&n.themeElements.clrScheme&&(l.color.rgb=Hw(n.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==o[o.length-1]&&r.CellXf.push(l);break;case 35:a=!0;break;case 36:a=!1;break;case 37:o.push(f),a=!0;break;case 38:o.pop(),a=!1;break;default:if(c.T>0)o.push(f);else if(c.T<0)o.pop();else if(!a||e.WTF&&37!=o[o.length-1])throw new Error("Unexpected record 0x"+f.toString(16))}}),r}(t,e,r):ZZ(t,e,r)}(ds(t,qu(i.style)),i.style,l,n))}i.links.map(function(rr){try{return _b(nu(t,gb(qu(rr))),rr),function yre(t,n,e,r){return".bin"===e.slice(-4)?function KQ(t,n,e,r){if(!t)return t;var i=r||{},o=!1;Mh(t,function(l,c,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!c.T&&(!o||i.WTF))throw new Error("Unexpected record 0x"+f.toString(16))}},i)}(t,0,0,r):void 0}(ds(t,qu(rr)),0,rr,n)}catch{}});var f=function ure(t,n,e){return".bin"===n.slice(-4)?function ire(t,n){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;n||(n={}),n.biff=12;var o=[],a=[[]];return a.SheetNames=[],a.XTI=[],Ib[16]={n:"BrtFRTArchID$",f:nre},Mh(t,function(l,c,f){switch(f){case 156:a.SheetNames.push(l.name),e.Sheets.push(l);break;case 153:e.WBProps=l;break;case 39:null!=l.Sheet&&(n.SID=l.Sheet),l.Ref=jl(l.Ptg,0,null,a,n),delete n.SID,delete l.Ptg,o.push(l);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,l]):a[0]=[f,l],a[a.length-1].XTI=[];break;case 362:0===a.length&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 35:case 37:r.push(f),i=!0;break;case 36:case 38:r.pop(),i=!1;break;default:if(!c.T&&(!i||n.WTF&&37!=r[r.length-1]&&35!=r[r.length-1]))throw new Error("Unexpected record 0x"+f.toString(16))}},n),MN(e),e.Names=o,e.supbooks=a,e}(t,e):function Zne(t,n){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",o={},a=0;if(t.replace(Pl,function(l,c){var f=ri(l);switch(Af(f[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":l.match(Kne)&&(i="xmlns"+l.match(/<(\w+):/)[1]),e.xmlns=f[i];break;case"<fileVersion":delete f[0],e.AppVersion=f;break;case"<workbookPr":case"<workbookPr/>":XS.forEach(function(v){if(null!=f[v[0]])switch(v[2]){case"bool":e.WBProps[v[0]]=oa(f[v[0]]);break;case"int":e.WBProps[v[0]]=parseInt(f[v[0]],10);break;default:e.WBProps[v[0]]=f[v[0]]}}),f.codeName&&(e.WBProps.CodeName=Lo(f.codeName));break;case"<workbookView":case"<workbookView/>":delete f[0],e.WBView.push(f);break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=ro(Lo(f.name)),delete f[0],e.Sheets.push(f);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(o={}).Name=Lo(f.name),f.comment&&(o.Comment=f.comment),f.localSheetId&&(o.Sheet=+f.localSheetId),oa(f.hidden||"0")&&(o.Hidden=!0),a=c+l.length;break;case"</definedName>":o.Ref=ro(Lo(t.slice(a,c))),e.Names.push(o);break;case"<calcPr":case"<calcPr/>":delete f[0],e.CalcPr=f;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),-1===rm.indexOf(e.xmlns))throw new Error("Unknown Namespace: "+e.xmlns);return MN(e),e}(t,e)}(ds(t,qu(i.workbooks[0])),i.workbooks[0],n),v={},E="";i.coreprops.length&&((E=ds(t,qu(i.coreprops[0]),!0))&&(v=aO(E)),0!==i.extprops.length&&(E=ds(t,qu(i.extprops[0]),!0))&&function eX(t,n,e){var r={};n||(n={}),t=Lo(t),zg.forEach(function(i){var o=(t.match(ub(i[0]))||[])[1];switch(i[2]){case"string":o&&(n[i[1]]=ro(o));break;case"bool":n[i[1]]="true"===o;break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(r[i[1]]=a[1])}}),r.HeadingPairs&&r.TitlesOfParts&&cO(r.HeadingPairs,r.TitlesOfParts,n,e)}(E,v,n));var D={};(!n.bookSheets||n.bookProps)&&0!==i.custprops.length&&(E=nu(t,qu(i.custprops[0]),!0))&&(D=function nX(t,n){var e={},r="",i=t.match(tX);if(i)for(var o=0;o!=i.length;++o){var a=i[o],s=ri(a);switch(s[0]){case"<?xml":case"<Properties":break;case"<property":r=ro(s.name);break;case"</property>":r=null;break;default:if(0===a.indexOf("<vt:")){var l=a.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":e[r]=ro(f);break;case"bool":e[r]=oa(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[r]=parseInt(f,10);break;case"r4":case"r8":case"decimal":e[r]=parseFloat(f);break;case"filetime":case"date":e[r]=ia(f);break;default:if("/"==c.slice(-1))break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if("</"!==a.slice(0,2)&&n.WTF)throw new Error(a)}}return e}(E,n));var k={};if((n.bookSheets||n.bookProps)&&(f.Sheets?a=f.Sheets.map(function(Nn){return Nn.name}):v.Worksheets&&v.SheetNames.length>0&&(a=v.SheetNames),n.bookProps&&(k.Props=v,k.Custprops=D),n.bookSheets&&typeof a<"u"&&(k.SheetNames=a),n.bookSheets?k.SheetNames:n.bookProps))return k;a={};var T={};n.bookDeps&&i.calcchain&&(T=function bre(t,n,e){return".bin"===n.slice(-4)?function XQ(t,n,e){var r=[];return Mh(t,function(a,s,l){if(63===l)r.push(a);else if(!s.T)throw new Error("Unexpected record 0x"+l.toString(16))}),r}(t):function GQ(t){var n=[];if(!t)return n;var e=1;return(t.match(Pl)||[]).forEach(function(r){var i=ri(r);switch(i[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?e=i.i:i.i=e,n.push(i)}}),n}(t)}(ds(t,qu(i.calcchain)),i.calcchain));var Z,W,R=0,q={},Ee=f.Sheets;v.Worksheets=Ee.length,v.SheetNames=[];for(var Le=0;Le!=Ee.length;++Le)v.SheetNames[Le]=Ee[Le].name;var Pe=o?"bin":"xml",ge=i.workbooks[0].lastIndexOf("/"),Ye=(i.workbooks[0].slice(0,ge+1)+"_rels/"+i.workbooks[0].slice(ge+1)+".rels").replace(/^\//,"");Vu(t,Ye)||(Ye="xl/_rels/workbook."+Pe+".rels");var Ge=_b(nu(t,Ye,!0),Ye.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(n.xlmeta=function wre(t,n,e){return".bin"===n.slice(-4)?function $Q(t,n,e){var r={Types:[],Cell:[],Value:[]},i=e||{},o=[],a=!1,s=2;return Mh(t,function(l,c,f){switch(f){case 335:r.Types.push({name:l.name});break;case 51:l.forEach(function(v){1==s?r.Cell.push({type:r.Types[v[0]-1].name,index:v[1]}):0==s&&r.Value.push({type:r.Types[v[0]-1].name,index:v[1]})});break;case 337:s=l?1:0;break;case 338:s=2;break;case 35:o.push(f),a=!0;break;case 36:o.pop(),a=!1;break;default:if(!c.T&&(!a||i.WTF&&35!=o[o.length-1]))throw new Error("Unexpected record 0x"+f.toString(16))}}),r}(t,0,e):function qQ(t,n,e){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var a,i=!1,o=2;return t.replace(Pl,function(s){var l=ri(s);switch(Af(l[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:l.name});break;case"<futureMetadata":for(var c=0;c<r.Types.length;++c)r.Types[c].name==l.name&&(a=r.Types[c]);break;case"<rc":1==o?r.Cell.push({type:r.Types[l.t-1].name,index:+l.v}):0==o&&r.Value.push({type:r.Types[l.t-1].name,index:+l.v});break;case"<cellMetadata":o=1;break;case"</cellMetadata>":case"</valueMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&e.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return s}),r}(t,0,e)}(ds(t,qu(i.metadata[0])),i.metadata[0],n)),(i.people||[]).length>=1&&(n.people=function tJ(t,n){var e=[],r=!1;return t.replace(Pl,function(o){var a=ri(o);switch(Af(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":e.push({name:a.displayname,id:a.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return o}),e}(ds(t,qu(i.people[0])),n)),Ge&&(Ge=function Bie(t,n){if(!t)return 0;try{t=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,Lie(t["!id"][r.id].Type)]})}catch{return null}return t&&0!==t.length?t:null}(Ge,f.Sheets));var wt=ds(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(R=0;R!=v.Worksheets;++R){var Mt="sheet";if(Ge&&Ge[R]?(Z="xl/"+Ge[R][1].replace(/[\/]?xl\//,""),Vu(t,Z)||(Z=Ge[R][1]),Vu(t,Z)||(Z=Ye.replace(/_rels\/.*$/,"")+Ge[R][1]),Mt=Ge[R][2]):Z=(Z="xl/worksheets/sheet"+(R+1-wt)+"."+Pe).replace(/sheet0\./,"sheet."),W=Z.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&null!=n.sheets)switch(typeof n.sheets){case"number":if(R!=n.sheets)continue e;break;case"string":if(v.SheetNames[R].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var Qe=!1,An=0;An!=n.sheets.length;++An)"number"==typeof n.sheets[An]&&n.sheets[An]==R&&(Qe=1),"string"==typeof n.sheets[An]&&n.sheets[An].toLowerCase()==v.SheetNames[R].toLowerCase()&&(Qe=1);if(!Qe)continue e}}jie(t,Z,W,v.SheetNames[R],R,q,a,Mt,n,f,l,c)}return k={Directory:i,Workbook:f,Props:v,Custprops:D,Deps:T,Sheets:a,SheetNames:v.SheetNames,Strings:Tb,Styles:c,Themes:l,SSF:$o(qr)},n&&n.bookFiles&&(t.files?(k.keys=r,k.files=t.files):(k.keys=[],k.files={},t.FullPaths.forEach(function(rr,Nn){rr=rr.replace(/^Root Entry[\/]/,""),k.keys.push(rr),k.files[rr]=t.FileIndex[Nn]}))),n&&n.bookVBA&&(i.vba.length>0?k.vbaraw=ds(t,qu(i.vba[0]),!0):i.defaults&&i.defaults.bin===cJ&&(k.vbaraw=ds(t,"xl/vbaProject.bin",!0))),k}function Uie(t,n){var e=n||{},r="Workbook",i=Fr.find(t,r);try{if(!(i=Fr.find(t,r="/!DataSpaces/Version"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function yZ(t){var n={};n.id=t.read_shift(0,"lpp4"),n.R=Fh(t,4),n.U=Fh(t,4),n.W=Fh(t,4)}(i.content),!(i=Fr.find(t,r="/!DataSpaces/DataSpaceMap"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function xZ(t){var n=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)n.push(wZ(t));return n}(i.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(!(i=Fr.find(t,r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=function CZ(t){var n=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)n.push(t.read_shift(0,"lpp4"));return n}(i.content);if(1!=a.length||"StrongEncryptionTransform"!=a[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(!(i=Fr.find(t,r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);!function SZ(t){var n=function EZ(t){var n={};return t.read_shift(4),t.l+=4,n.id=t.read_shift(0,"lpp4"),n.name=t.read_shift(0,"lpp4"),n.R=Fh(t,4),n.U=Fh(t,4),n.W=Fh(t,4),n}(t);if(n.ename=t.read_shift(0,"8lpp4"),n.blksz=t.read_shift(4),n.cmode=t.read_shift(4),4!=t.read_shift(4))throw new Error("Bad !Primary record");return n}(i.content)}catch{}if(!(i=Fr.find(t,r="/EncryptionInfo"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function DZ(t){var n=Fh(t);switch(n.Minor){case 2:return[n.Minor,AZ(t)];case 3:return[n.Minor,TZ()];case 4:return[n.Minor,MZ(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}(i.content);if(!(i=Fr.find(t,r="/EncryptedPackage"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==s[0]&&typeof decrypt_agile<"u")return decrypt_agile(s[1],i.content,e.password||"",e);if(2==s[0]&&typeof decrypt_std76<"u")return decrypt_std76(s[1],i.content,e.password||"",e);throw new Error("File is password-protected")}function Hie(t,n){return"ods"==n.bookType?QN(t,n):"numbers"==n.bookType?function Rie(t,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=rc(e["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(bi(r)));var o=Zw(e,{range:r,header:1}),a=["~Sh33tJ5~"];o.forEach(function(Fe){return Fe.forEach(function(Re){"string"==typeof Re&&a.push(Re)})});var s={},l=[],c=Fr.read(n.numbers,{type:"base64"});c.FileIndex.map(function(Fe,Re){return[Fe,c.FullPaths[Re]]}).forEach(function(Fe){var Re=Fe[0],Xt=Fe[1];2==Re.type&&Re.name.match(/\.iwa/)&&$u(Wu(Re.content)).forEach(function(dn){l.push(dn.id),s[dn.id]={deps:[],location:Xt,type:Ba(dn.messages[0].meta[1][0].data)}})}),l.sort(function(Fe,Re){return Fe-Re});var f=l.filter(function(Fe){return Fe>1}).map(function(Fe){return[Fe,wo(Fe)]});c.FileIndex.map(function(Fe,Re){return[Fe,c.FullPaths[Re]]}).forEach(function(Fe){var Re=Fe[0];Re.name.match(/\.iwa/)&&$u(Wu(Re.content)).forEach(function(Sn){Sn.messages.forEach(function(bn){f.forEach(function(dn){Sn.messages.some(function(li){return 11006!=Ba(li.meta[1][0].data)&&function xie(t,n){e:for(var e=0;e<=t.length-n.length;++e){for(var r=0;r<n.length;++r)if(t[e+r]!=n[r])continue e;return!0}return!1}(li.data,dn[1])})&&s[dn[0]].deps.push(Sn.id)})})})});for(var k,E=Fr.find(c,s[1].location),D=$u(Wu(E.content)),T=0;T<D.length;++T){var R=D[T];1==R.id&&(k=R)}var q=Vl(lo(k.messages[0].data)[1][0].data);for(D=$u(Wu((E=Fr.find(c,s[q].location)).content)),T=0;T<D.length;++T)(R=D[T]).id==q&&(k=R);for(q=Vl(lo(k.messages[0].data)[2][0].data),D=$u(Wu((E=Fr.find(c,s[q].location)).content)),T=0;T<D.length;++T)(R=D[T]).id==q&&(k=R);for(q=Vl(lo(k.messages[0].data)[2][0].data),D=$u(Wu((E=Fr.find(c,s[q].location)).content)),T=0;T<D.length;++T)(R=D[T]).id==q&&(k=R);var Z=lo(k.messages[0].data);Z[6][0].data=wo(r.e.r+1),Z[7][0].data=wo(r.e.c+1);for(var W=Vl(Z[46][0].data),Ee=Fr.find(c,s[W].location),Le=$u(Wu(Ee.content)),Pe=0;Pe<Le.length&&Le[Pe].id!=W;++Pe);if(Le[Pe].id!=W)throw"Bad ColumnRowUIDMapArchive";var ge=lo(Le[Pe].messages[0].data);ge[1]=[],ge[2]=[],ge[3]=[];for(var Ye=0;Ye<=r.e.c;++Ye){var Ge=[];Ge[1]=Ge[2]=[{type:0,data:wo(Ye+420690)}],ge[1].push({type:2,data:Gs(Ge)}),ge[2].push({type:0,data:wo(Ye)}),ge[3].push({type:0,data:wo(Ye)})}ge[4]=[],ge[5]=[],ge[6]=[];for(var wt=0;wt<=r.e.r;++wt)(Ge=[])[1]=Ge[2]=[{type:0,data:wo(wt+726270)}],ge[4].push({type:2,data:Gs(Ge)}),ge[5].push({type:0,data:wo(wt)}),ge[6].push({type:0,data:wo(wt)});Le[Pe].messages[0].data=Gs(ge),Ee.content=u_(c_(Le)),Ee.size=Ee.content.length,delete Z[46];var Mt=lo(Z[4][0].data);Mt[7][0].data=wo(r.e.r+1);var An=Vl(lo(Mt[1][0].data)[2][0].data);if((Le=$u(Wu((Ee=Fr.find(c,s[An].location)).content)))[0].id!=An)throw"Bad HeaderStorageBucket";var rr=lo(Le[0].messages[0].data);for(wt=0;wt<o.length;++wt){var Nn=lo(rr[2][0].data);Nn[1][0].data=wo(wt),Nn[4][0].data=wo(o[wt].length),rr[2][wt]={type:rr[2][0].type,data:Gs(Nn)}}Le[0].messages[0].data=Gs(rr),Ee.content=u_(c_(Le)),Ee.size=Ee.content.length;var rn=Vl(Mt[2][0].data);if((Le=$u(Wu((Ee=Fr.find(c,s[rn].location)).content)))[0].id!=rn)throw"Bad HeaderStorageBucket";for(rr=lo(Le[0].messages[0].data),Ye=0;Ye<=r.e.c;++Ye)(Nn=lo(rr[2][0].data))[1][0].data=wo(Ye),Nn[4][0].data=wo(r.e.r+1),rr[2][Ye]={type:rr[2][0].type,data:Gs(Nn)};Le[0].messages[0].data=Gs(rr),Ee.content=u_(c_(Le)),Ee.size=Ee.content.length;var an=Vl(Mt[4][0].data);!function(){for(var Xt,Fe=Fr.find(c,s[an].location),Re=$u(Wu(Fe.content)),En=0;En<Re.length;++En){var Sn=Re[En];Sn.id==an&&(Xt=Sn)}var bn=lo(Xt.messages[0].data);bn[3]=[];var dn=[];a.forEach(function(To,Bi){dn[1]=[{type:0,data:wo(Bi)}],dn[2]=[{type:0,data:wo(1)}],dn[3]=[{type:2,data:wie(To)}],bn[3].push({type:2,data:Gs(dn)})}),Xt.messages[0].data=Gs(bn);var ke=u_(c_(Re));Fe.content=ke,Fe.size=Fe.content.length}();var Ln=lo(Mt[3][0].data),mn=Ln[1][0];delete Ln[2];var Wn=lo(mn.data),qt=Vl(Wn[2][0].data);!function(){for(var Xt,Fe=Fr.find(c,s[qt].location),Re=$u(Wu(Fe.content)),En=0;En<Re.length;++En){var Sn=Re[En];Sn.id==qt&&(Xt=Sn)}var bn=lo(Xt.messages[0].data);delete bn[6],delete Ln[7];var dn=new Uint8Array(bn[5][0].data);bn[5]=[];for(var li=0,ke=0;ke<=r.e.r;++ke){var To=lo(dn);li+=Nie(To,o[ke],a),To[1][0].data=wo(ke),bn[5].push({data:Gs(To),type:2})}bn[1]=[{type:0,data:wo(r.e.c+1)}],bn[2]=[{type:0,data:wo(r.e.r+1)}],bn[3]=[{type:0,data:wo(li)}],bn[4]=[{type:0,data:wo(r.e.r+1)}],Xt.messages[0].data=Gs(bn);var Mo=u_(c_(Re));Fe.content=Mo,Fe.size=Fe.content.length}(),mn.data=Gs(Wn),Mt[3][0].data=Gs(Ln),Z[4][0].data=Gs(Mt),k.messages[0].data=Gs(Z);var dt=u_(c_(D));return E.content=dt,E.size=E.content.length,c}(t,n):"xlsb"==n.bookType?function zie(t,n){a_=1024,t&&!t.SSF&&(t.SSF=$o(qr)),t&&t.SSF&&(Z1(),sb(t.SSF),n.revssf=Dw(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Mb?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var e="xlsb"==n.bookType?"bin":"xml",r=lN.indexOf(n.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};oD(n=n||{});var o=rS(),a="",s=0;if(n.cellXfs=[],lm(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),Ei(o,a="docProps/core.xml",sO(t.Props,n)),i.coreprops.push(a),yo(n.rels,2,a,yi.CORE_PROPS),a="docProps/app.xml",!t.Props||!t.Props.SheetNames)if(t.Workbook&&t.Workbook.Sheets){for(var l=[],c=0;c<t.SheetNames.length;++c)2!=(t.Workbook.Sheets[c]||{}).Hidden&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}else t.Props.SheetNames=t.SheetNames;for(t.Props.Worksheets=t.Props.SheetNames.length,Ei(o,a,uO(t.Props)),i.extprops.push(a),yo(n.rels,3,a,yi.EXT_PROPS),t.Custprops!==t.Props&&Oa(t.Custprops||{}).length>0&&(Ei(o,a="docProps/custom.xml",dO(t.Custprops)),i.custprops.push(a),yo(n.rels,4,a,yi.CUST_PROPS)),s=1;s<=t.SheetNames.length;++s){var f={"!id":{}},v=t.Sheets[t.SheetNames[s-1]];if(Ei(o,a="xl/worksheets/sheet"+s+"."+e,Cre(s-1,a,n,t,f)),i.sheets.push(a),yo(n.wbrels,-1,"worksheets/sheet"+s+"."+e,yi.WS[0]),v){var D=v["!comments"],k=!1,T="";D&&D.length>0&&(Ei(o,T="xl/comments"+s+"."+e,Dre(D,T,n)),i.comments.push(T),yo(f,-1,"../comments"+s+"."+e,yi.CMNT),k=!0),v["!legacy"]&&k&&Ei(o,"xl/drawings/vmlDrawing"+s+".vml",oN(s,v["!comments"])),delete v["!comments"],delete v["!legacy"]}f["!id"].rId1&&Ei(o,gb(a),r_(f))}return null!=n.Strings&&n.Strings.length>0&&(Ei(o,a="xl/sharedStrings."+e,function Sre(t,n,e){return(".bin"===n.slice(-4)?bZ:qO)(t,e)}(n.Strings,a,n)),i.strs.push(a),yo(n.wbrels,-1,"sharedStrings."+e,yi.SST)),Ei(o,a="xl/workbook."+e,function xre(t,n,e){return(".bin"===n.slice(-4)?cre:IN)(t,e)}(t,a,n)),i.workbooks.push(a),yo(n.rels,1,a,yi.WB),Ei(o,a="xl/theme/theme1.xml",US(t.Themes,n)),i.themes.push(a),yo(n.wbrels,-1,"theme/theme1.xml",yi.THEME),Ei(o,a="xl/styles."+e,function Ere(t,n,e){return(".bin"===n.slice(-4)?bQ:eN)(t,e)}(t,a,n)),i.styles.push(a),yo(n.wbrels,-1,"styles."+e,yi.STY),t.vbaraw&&r&&(Ei(o,a="xl/vbaProject.bin",t.vbaraw),i.vba.push(a),yo(n.wbrels,-1,"vbaProject.bin",yi.VBA)),Ei(o,a="xl/metadata."+e,function Are(t){return(".bin"===t.slice(-4)?WQ:iN)()}(a)),i.metadata.push(a),yo(n.wbrels,-1,"metadata."+e,yi.XLMETA),Ei(o,"[Content_Types].xml",rO(i,n)),Ei(o,"_rels/.rels",r_(n.rels)),Ei(o,"xl/_rels/workbook."+e+".rels",r_(n.wbrels)),delete n.revssf,delete n.ssf,o}(t,n):function nR(t,n){a_=1024,t&&!t.SSF&&(t.SSF=$o(qr)),t&&t.SSF&&(Z1(),sb(t.SSF),n.revssf=Dw(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Mb?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var e="xml",r=lN.indexOf(n.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};oD(n=n||{});var o=rS(),a="",s=0;if(n.cellXfs=[],lm(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),Ei(o,a="docProps/core.xml",sO(t.Props,n)),i.coreprops.push(a),yo(n.rels,2,a,yi.CORE_PROPS),a="docProps/app.xml",!t.Props||!t.Props.SheetNames)if(t.Workbook&&t.Workbook.Sheets){for(var l=[],c=0;c<t.SheetNames.length;++c)2!=(t.Workbook.Sheets[c]||{}).Hidden&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}else t.Props.SheetNames=t.SheetNames;t.Props.Worksheets=t.Props.SheetNames.length,Ei(o,a,uO(t.Props)),i.extprops.push(a),yo(n.rels,3,a,yi.EXT_PROPS),t.Custprops!==t.Props&&Oa(t.Custprops||{}).length>0&&(Ei(o,a="docProps/custom.xml",dO(t.Custprops)),i.custprops.push(a),yo(n.rels,4,a,yi.CUST_PROPS));var f=["SheetJ5"];for(n.tcid=0,s=1;s<=t.SheetNames.length;++s){var v={"!id":{}},E=t.Sheets[t.SheetNames[s-1]];if(Ei(o,a="xl/worksheets/sheet"+s+"."+e,EN(s-1,n,t,v)),i.sheets.push(a),yo(n.wbrels,-1,"worksheets/sheet"+s+"."+e,yi.WS[0]),E){var k=E["!comments"],T=!1,R="";if(k&&k.length>0){var q=!1;k.forEach(function(Z){Z[1].forEach(function(W){1==W.T&&(q=!0)})}),q&&(Ei(o,R="xl/threadedComments/threadedComment"+s+"."+e,eJ(k,f,n)),i.threadedcomments.push(R),yo(v,-1,"../threadedComments/threadedComment"+s+"."+e,yi.TCMNT)),Ei(o,R="xl/comments"+s+"."+e,sN(k)),i.comments.push(R),yo(v,-1,"../comments"+s+"."+e,yi.CMNT),T=!0}E["!legacy"]&&T&&Ei(o,"xl/drawings/vmlDrawing"+s+".vml",oN(s,E["!comments"])),delete E["!comments"],delete E["!legacy"]}v["!id"].rId1&&Ei(o,gb(a),r_(v))}return null!=n.Strings&&n.Strings.length>0&&(Ei(o,a="xl/sharedStrings."+e,qO(n.Strings,n)),i.strs.push(a),yo(n.wbrels,-1,"sharedStrings."+e,yi.SST)),Ei(o,a="xl/workbook."+e,IN(t)),i.workbooks.push(a),yo(n.rels,1,a,yi.WB),Ei(o,a="xl/theme/theme1.xml",US(t.Themes,n)),i.themes.push(a),yo(n.wbrels,-1,"theme/theme1.xml",yi.THEME),Ei(o,a="xl/styles."+e,eN(t,n)),i.styles.push(a),yo(n.wbrels,-1,"styles."+e,yi.STY),t.vbaraw&&r&&(Ei(o,a="xl/vbaProject.bin",t.vbaraw),i.vba.push(a),yo(n.wbrels,-1,"vbaProject.bin",yi.VBA)),Ei(o,a="xl/metadata."+e,iN()),i.metadata.push(a),yo(n.wbrels,-1,"metadata."+e,yi.XLMETA),f.length>1&&(Ei(o,a="xl/persons/person.xml",function nJ(t){var n=[Ra,Bn("personList",null,{xmlns:fs.TCMNT,"xmlns:x":rm[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,r){n.push(Bn("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),n.push("</personList>"),n.join("")}(f)),i.people.push(a),yo(n.wbrels,-1,"persons/person.xml",yi.PEOPLE)),Ei(o,"[Content_Types].xml",rO(i,n)),Ei(o,"_rels/.rels",r_(n.rels)),Ei(o,"xl/_rels/workbook.xml.rels",r_(n.wbrels)),delete n.revssf,delete n.ssf,o}(t,n)}function aD(t,n){var e="";switch((n||{}).type||"base64"){case"buffer":case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Jc(t.slice(0,12));break;case"binary":e=t;break;default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function rR(t,n){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return ZS(t.slice(e),n);default:break e}return i_.to_workbook(t,n)}function sD(t,n,e,r){return r?(e.type="string",i_.to_workbook(t,e)):i_.to_workbook(n,e)}function Nb(t,n){yw();var e=n||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Nb(new Uint8Array(t),((e=$o(e)).type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var i,r=t,o=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),l_={},e.dateNF&&(l_.dateNF=e.dateNF),e.type||(e.type=Mi&&Buffer.isBuffer(t)?"buffer":"base64"),"file"==e.type&&(e.type=Mi?"buffer":"binary",r=function GG(t){if(typeof nm<"u")return nm.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(t);n.open("r"),n.encoding="binary";var e=n.read();return n.close(),e}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}(t),typeof Uint8Array<"u"&&!Mi&&(e.type="array")),"string"==e.type&&(o=!0,e.type="binary",e.codepage=65001,r=function Yie(t){return t.match(/[^\x00-\x7F]/)?Tf(t):t}(t)),"array"==e.type&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),s=new Uint8Array(a);if(s.foo="bar",!s.foo)return(e=$o(e)).type="array",Nb(Q5(r),e)}switch((i=aD(r,e))[0]){case 208:if(207===i[1]&&17===i[2]&&224===i[3]&&161===i[4]&&177===i[5]&&26===i[6]&&225===i[7])return function $ie(t,n){return Fr.find(t,"EncryptedPackage")?Uie(t,n):RN(t,n)}(Fr.read(r,e),e);break;case 9:if(i[1]<=8)return RN(r,e);break;case 60:return ZS(r,e);case 73:if(73===i[1]&&42===i[2]&&0===i[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===i[1])return function rZ(t,n){var e=n||{},r=!!e.WTF;e.WTF=!0;try{var i=zO.to_workbook(t,e);return e.WTF=r,i}catch(o){if(e.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return i_.to_workbook(t,n)}}(r,e);break;case 84:if(65===i[1]&&66===i[2]&&76===i[3])return $O.to_workbook(r,e);break;case 80:return 75===i[1]&&i[2]<9&&i[3]<9?function Wie(t,n){var r=t,i=n||{};return i.type||(i.type=Mi&&Buffer.isBuffer(t)?"buffer":"base64"),Vie(wP(r,i),i)}(r,e):sD(t,r,e,o);case 239:return 60===i[3]?ZS(r,e):sD(t,r,e,o);case 255:if(254===i[1])return function Gie(t,n){var e=t;return"base64"==n.type&&(e=Jc(e)),e=eo.utils.decode(1200,e.slice(2),"str"),n.type="binary",rR(e,n)}(r,e);if(0===i[1]&&2===i[2]&&0===i[3])return Gg.to_workbook(r,e);break;case 0:if(0===i[1]&&(i[2]>=2&&0===i[3]||0===i[2]&&(8===i[3]||9===i[3])))return Gg.to_workbook(r,e);break;case 3:case 131:case 139:case 140:return NS.to_workbook(r,e);case 123:if(92===i[1]&&114===i[2]&&116===i[3])return ZO.to_workbook(r,e);break;case 10:case 13:case 32:return function qie(t,n){var e="",r=aD(t,n);switch(n.type){case"base64":e=Jc(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=Ng(t);break;default:throw new Error("Unrecognized type "+n.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(e=Lo(e)),n.type="binary",rR(e,n)}(r,e);case 137:if(80===i[1]&&78===i[2]&&71===i[3])throw new Error("PNG Image File is not a spreadsheet")}return nZ.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?NS.to_workbook(r,e):sD(t,r,e,o)}function iR(t,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return lb(n.file,Fr.write(t,{type:Mi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return Fr.write(t,n)}function If(t,n,e){e||(e="");var r=e+t;switch(n.type){case"base64":return rb(Tf(r));case"binary":return Tf(r);case"string":return t;case"file":return lb(n.file,r,"utf8");case"buffer":return Mi?Dh(r,"utf8"):typeof TextEncoder<"u"?(new TextEncoder).encode(r):If(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function Kw(t,n){switch(n.type){case"string":case"base64":case"binary":for(var e="",r=0;r<t.length;++r)e+=String.fromCharCode(t[r]);return"base64"==n.type?rb(e):"string"==n.type?Lo(e):e;case"file":return lb(n.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+n.type)}}function lD(t,n){yw(),function FN(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");!function Xne(t,n,e){t.forEach(function(r,i){kN(r);for(var o=0;o<i;++o)if(r==t[o])throw new Error("Duplicate Sheet Name: "+r);if(e){var a=n&&n[i]&&n[i].CodeName||r;if(95==a.charCodeAt(0)&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}(t.SheetNames,t.Workbook&&t.Workbook.Sheets||[],!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)Wee(t.Sheets[t.SheetNames[e]],0,e)}(t);var e=$o(n||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),"array"==e.type){e.type="binary";var r=lD(t,e);return e.type="array",ib(r)}var i=0;if(e.sheet&&(i="number"==typeof e.sheet?e.sheet:t.SheetNames.indexOf(e.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return If(qre(t,e),e);case"slk":case"sylk":return If(zO.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"htm":case"html":return If(zN(t.Sheets[t.SheetNames[i]],e),e);case"txt":return function Qie(t,n){switch(n.type){case"base64":return rb(t);case"binary":case"string":return t;case"file":return lb(n.file,t,"binary");case"buffer":return Mi?Dh(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}(uR(t.Sheets[t.SheetNames[i]],e),e);case"csv":return If(uD(t.Sheets[t.SheetNames[i]],e),e,"\ufeff");case"dif":return If($O.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"dbf":return Kw(NS.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"prn":return If(i_.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"rtf":return If(ZO.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"eth":return If(WO.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"fods":return If(QN(t,e),e);case"wk1":return Kw(Gg.sheet_to_wk1(t.Sheets[t.SheetNames[i]],e),e);case"wk3":return Kw(Gg.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),Kw(LN(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),function Zie(t,n){var e=n||{};return iR(function Jre(t,n){var e=n||{},r=Fr.utils.cfb_new({root:"R"}),i="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":i="/Workbook",e.biff=8;break;case"biff5":i="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Fr.utils.cfb_add(r,i,LN(t,e)),8==e.biff&&(t.Props||t.Custprops)&&function Qre(t,n){var a,e=[],r=[],i=[],o=0,s=fP(SS,"n"),l=fP(DS,"n");if(t.Props)for(a=Oa(t.Props),o=0;o<a.length;++o)(Object.prototype.hasOwnProperty.call(s,a[o])?e:Object.prototype.hasOwnProperty.call(l,a[o])?r:i).push([a[o],t.Props[a[o]]]);if(t.Custprops)for(a=Oa(t.Custprops),o=0;o<a.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},a[o])||(Object.prototype.hasOwnProperty.call(s,a[o])?e:Object.prototype.hasOwnProperty.call(l,a[o])?r:i).push([a[o],t.Custprops[a[o]]]);var c=[];for(o=0;o<i.length;++o)bO.indexOf(i[o][0])>-1||lO.indexOf(i[o][0])>-1||null!=i[o][1]&&c.push(i[o]);r.length&&Fr.utils.cfb_add(n,"/\x05SummaryInformation",xO(r,Fb.SI,l,DS)),(e.length||c.length)&&Fr.utils.cfb_add(n,"/\x05DocumentSummaryInformation",xO(e,Fb.DSI,s,SS,c.length?c:null,Fb.UDI))}(t,r),8==e.biff&&t.vbaraw&&function dJ(t,n){n.FullPaths.forEach(function(e,r){if(0!=r){var i=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&Fr.utils.cfb_add(t,i,n.FileIndex[r].content)}})}(r,Fr.read(t.vbaraw,{type:"string"==typeof t.vbaraw?"binary":"buffer"})),r}(t,e),e)}(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function Xie(t,n){var e=$o(n||{});return function oR(t,n){var e={},r=Mi?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(e.compression="DEFLATE"),n.password)e.type=r;else switch(n.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":e.type=r;break;default:throw new Error("Unrecognized type "+n.type)}var i=t.FullPaths?Fr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!n.compression}):t.generate(e);if(typeof Deno<"u"&&"string"==typeof i){if("binary"==n.type||"base64"==n.type)return i;i=new Uint8Array(ib(i))}return n.password&&typeof encrypt_agile<"u"?iR(encrypt_agile(i,n.password),n):"file"===n.type?lb(n.file,i):"string"==n.type?Lo(i):i}(Hie(t,e),e)}(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function Pf(t,n,e){var r=e||{};return r.type="file",r.file=n,function cD(t){if(!t.bookType){var e=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(t.bookType=e.slice(1)),t.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[t.bookType]||t.bookType}}(r),lD(t,r)}function sR(t,n,e,r,i,o,a,s){var l=La(e),c=s.defval,f=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),v=!0,E=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(E,"__rowNum__",{value:e,enumerable:!1})}catch{E.__rowNum__=e}else E.__rowNum__=e;if(!a||t[e])for(var D=n.s.c;D<=n.e.c;++D){var k=a?t[e][D]:t[r[D]+l];if(void 0!==k&&void 0!==k.t){var T=k.v;switch(k.t){case"z":if(null==T)break;continue;case"e":T=0==T?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(null!=o[D]){if(null==T)if("e"==k.t&&null===T)E[o[D]]=null;else if(void 0!==c)E[o[D]]=c;else{if(!f||null!==T)continue;E[o[D]]=null}else E[o[D]]=f&&("n"!==k.t||"n"===k.t&&!1!==s.rawNumbers)?T:Mf(k,T,s);null!=T&&(v=!1)}}else{if(void 0===c)continue;null!=o[D]&&(E[o[D]]=c)}}return{row:E,isempty:v}}function Zw(t,n){if(null==t||null==t["!ref"])return[];var e={t:"n",v:0},r=0,i=1,o=[],a=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},c=n||{},f=null!=c.range?c.range:t["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof f){case"string":l=zi(f);break;case"number":(l=zi(t["!ref"])).s.r=f;break;default:l=f}r>0&&(i=0);var v=La(l.s.r),E=[],D=[],k=0,T=0,R=Array.isArray(t),q=l.s.r,Z=0,W={};R&&!t[q]&&(t[q]=[]);var Ee=c.skipHidden&&t["!cols"]||[],Le=c.skipHidden&&t["!rows"]||[];for(Z=l.s.c;Z<=l.e.c;++Z)if(!(Ee[Z]||{}).hidden)switch(E[Z]=aa(Z),e=R?t[q][Z]:t[E[Z]+v],r){case 1:o[Z]=Z-l.s.c;break;case 2:o[Z]=E[Z];break;case 3:o[Z]=c.header[Z-l.s.c];break;default:if(null==e&&(e={w:"__EMPTY",t:"s"}),s=a=Mf(e,null,c),T=W[a]||0){do{s=a+"_"+T++}while(W[s]);W[a]=T,W[s]=1}else W[a]=1;o[Z]=s}for(q=l.s.r+i;q<=l.e.r;++q)if(!(Le[q]||{}).hidden){var Pe=sR(t,l,q,E,r,o,R,c);(!1===Pe.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(D[k++]=Pe.row)}return D.length=k,D}var lR=/"/g;function cR(t,n,e,r,i,o,a,s){for(var l=!0,c=[],f="",v=La(e),E=n.s.c;E<=n.e.c;++E)if(r[E]){var D=s.dense?(t[e]||[])[E]:t[r[E]+v];if(null==D)f="";else if(null!=D.v){l=!1,f=""+(s.rawNumbers&&"n"==D.t?D.v:Mf(D,null,s));for(var k=0,T=0;k!==f.length;++k)if((T=f.charCodeAt(k))===i||T===o||34===T||s.forceQuotes){f='"'+f.replace(lR,'""')+'"';break}"ID"==f&&(f='"ID"')}else null==D.f||D.F?f="":(l=!1,(f="="+D.f).indexOf(",")>=0&&(f='"'+f.replace(lR,'""')+'"'));c.push(f)}return!1===s.blankrows&&l?null:c.join(a)}function uD(t,n){var e=[],r=n??{};if(null==t||null==t["!ref"])return"";var i=zi(t["!ref"]),o=void 0!==r.FS?r.FS:",",a=o.charCodeAt(0),s=void 0!==r.RS?r.RS:"\n",l=s.charCodeAt(0),c=new RegExp(("|"==o?"\\|":o)+"+$"),f="",v=[];r.dense=Array.isArray(t);for(var E=r.skipHidden&&t["!cols"]||[],D=r.skipHidden&&t["!rows"]||[],k=i.s.c;k<=i.e.c;++k)(E[k]||{}).hidden||(v[k]=aa(k));for(var T=0,R=i.s.r;R<=i.e.r;++R)(D[R]||{}).hidden||null!=(f=cR(t,i,R,v,a,l,o,r))&&(r.strip&&(f=f.replace(c,"")),(f||!1!==r.blankrows)&&e.push((T++?s:"")+f));return delete r.dense,e.join("")}function uR(t,n){n||(n={}),n.FS="\t",n.RS="\n";var e=uD(t,n);if(typeof eo>"u"||"string"==n.type)return e;var r=eo.utils.encode(1200,e,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function dR(t,n,e){var r=e||{},i=+!r.skipHeader,o=t||{},a=0,s=0;if(o&&null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var l="string"==typeof r.origin?ya(r.origin):r.origin;a=l.r,s=l.c}var c,f={s:{c:0,r:0},e:{c:s,r:a+n.length-1+i}};if(o["!ref"]){var v=zi(o["!ref"]);f.e.c=Math.max(f.e.c,v.e.c),f.e.r=Math.max(f.e.r,v.e.r),-1==a&&(f.e.r=(a=v.e.r+1)+n.length-1+i)}else-1==a&&(a=0,f.e.r=n.length-1+i);var E=r.header||[],D=0;n.forEach(function(T,R){Oa(T).forEach(function(q){-1==(D=E.indexOf(q))&&(E[D=E.length]=q);var Z=T[q],W="z",Ee="",Le=Jr({c:s+D,r:a+R+i});c=Rb(o,Le),!Z||"object"!=typeof Z||Z instanceof Date?("number"==typeof Z?W="n":"boolean"==typeof Z?W="b":"string"==typeof Z?W="s":Z instanceof Date?(W="d",r.cellDates||(W="n",Z=As(Z)),Ee=r.dateNF||qr[14]):null===Z&&r.nullError&&(W="e",Z=0),c?(c.t=W,c.v=Z,delete c.w,delete c.R,Ee&&(c.z=Ee)):o[Le]=c={t:W,v:Z},Ee&&(c.z=Ee)):o[Le]=Z})}),f.e.c=Math.max(f.e.c,s+E.length-1);var k=La(a);if(i)for(D=0;D<E.length;++D)o[aa(D+s)+k]={t:"s",v:E[D]};return o["!ref"]=bi(f),o}function Rb(t,n,e){if("string"==typeof n){if(Array.isArray(t)){var r=ya(n);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[n]||(t[n]={t:"z"})}return Rb(t,Jr("number"!=typeof n?n:{r:n,c:e||0}))}function fD(t,n,e,r){var i=1;if(!e)for(;i<=65535&&-1!=t.SheetNames.indexOf(e="Sheet"+i);++i,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(e)>=0){var o=e.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var a=o&&o[1]||e;for(++i;i<=65535&&-1!=t.SheetNames.indexOf(e=a+i);++i);}if(kN(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=n,e}function fR(t,n,e){return n?(t.l={Target:n},e&&(t.l.Tooltip=e)):delete t.l,t}var Gr={encode_col:aa,encode_row:La,encode_cell:Jr,encode_range:bi,decode_col:vS,decode_row:_S,split_cell:function EY(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ya,decode_range:rc,format_cell:Mf,sheet_add_aoa:YP,sheet_add_json:dR,sheet_add_dom:$N,aoa_to_sheet:t_,json_to_sheet:function eoe(t,n){return dR(null,t,n)},table_to_sheet:WN,table_to_book:function _ie(t,n){return im(WN(t,n),n)},sheet_to_csv:uD,sheet_to_txt:uR,sheet_to_json:Zw,sheet_to_html:zN,sheet_to_formulae:function Jie(t){var e,n="",r="";if(null==t||null==t["!ref"])return[];var s,i=zi(t["!ref"]),o="",a=[],l=[],c=Array.isArray(t);for(s=i.s.c;s<=i.e.c;++s)a[s]=aa(s);for(var f=i.s.r;f<=i.e.r;++f)for(o=La(f),s=i.s.c;s<=i.e.c;++s)if(n=a[s]+o,r="",void 0!==(e=c?(t[f]||[])[s]:t[n])){if(null!=e.F){if(n=e.F,!e.f)continue;r=e.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=e.f)r=e.f;else{if("z"==e.t)continue;if("n"==e.t&&null!=e.v)r=""+e.v;else if("b"==e.t)r=e.v?"TRUE":"FALSE";else if(void 0!==e.w)r="'"+e.w;else{if(void 0===e.v)continue;r="s"==e.t?"'"+e.v:""+e.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:Zw,sheet_get_cell:Rb,book_new:function dD(){return{SheetNames:[],Sheets:{}}},book_append_sheet:fD,book_set_sheet_visibility:function noe(t,n,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=function toe(t,n){if("number"==typeof n){if(n>=0&&t.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}if("string"==typeof n){var e=t.SheetNames.indexOf(n);if(e>-1)return e;throw new Error("Cannot find sheet name |"+n+"|")}throw new Error("Cannot find sheet |"+n+"|")}(t,n);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[r].Hidden=e},cell_set_number_format:function roe(t,n){return t.z=n,t},cell_set_hyperlink:fR,cell_set_internal_link:function ioe(t,n,e){return fR(t,"#"+n,e)},cell_add_comment:function ooe(t,n,e){t.c||(t.c=[]),t.c.push({t:n,a:e||"SheetJS"})},sheet_set_array_formula:function aoe(t,n,e,r){for(var i="string"!=typeof n?n:zi(n),o="string"==typeof n?n:bi(n),a=i.s.r;a<=i.e.r;++a)for(var s=i.s.c;s<=i.e.c;++s){var l=Rb(t,a,s);l.t="n",l.F=o,delete l.v,a==i.s.r&&s==i.s.c&&(l.f=e,r&&(l.D=!0))}return t},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iu_apiUrl="http://107.23.161.120:8080/api";let Ts=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/bodega"}getRegistros(){return this.http.get(this.urlEndPoint).pipe(Pt(e=>It(e)))}getRegistrosActivos(){return this.http.get(`${this.urlEndPoint}/activos`).pipe(Pt(e=>It(e)))}getRegistrosInactivos(){return this.http.get(`${this.urlEndPoint}/inactivos`).pipe(Pt(e=>It(e)))}getRegistroId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unico`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getMunicipiosDepartamento(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/municipio`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getDepartamentos(){return this.http.get(`${this.urlEndPoint}/departamento`).pipe(Pt(e=>(401!=e.status&&e.error.mensaje&&console.error(e.error.mensaje),It(e))))}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getRegistrosMedicamentoBodega(e){const r=(new Pn).set("idBodega",e);return this.http.get(`${this.urlEndPoint}/medicamento`,{params:r}).pipe(Pt(i=>It(i)))}getRegistroMedicamentoBodegaId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/medicamento/unico`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}createMedicamentoBodega(e){return this.http.post(`${this.urlEndPoint}/medicamento`,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}updateMedicamentoBodega(e){return this.http.put(`${this.urlEndPoint}/medicamento`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}deleteMedicamentoBodegaId(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}/medicamento`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getMedicamentosBodegaPendiente(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/medicamento/pendiente`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getMedicamentosBodegaOrdenDespacho(e,r){const i=(new Pn).set("bodegaOrigen",e).set("bodegaDestino",r);return this.http.get(`${this.urlEndPoint}/despacho`,{params:i}).pipe(Pt(o=>(401!=o.status&&o.error.mensaje&&console.error(o.error.mensaje),It(o))))}getMedicamentosBodegaEntregados(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/entrega`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getMedicamentosBodegaEntregaDetallada(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/entrega/detallada`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getMedicamentosPendienteDetallada(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/entrega/pendiente`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getMedicamentosBodegaEntregadosMeses(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/entregameses`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getPacientePendiente(e,r,i,o){const a=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i).set("idMedicamento",o);return this.http.get(`${this.urlEndPoint}/paciente/pendiente`,{params:a}).pipe(Pt(s=>(401!=s.status&&s.error.mensaje&&console.error(s.error.mensaje),It(s))))}getExistenciasMedicamentos(e){const r=(new Pn).set("term",e);return this.http.get(`${this.urlEndPoint}/existencias`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getExistenciasMedicamentoPuntual(e){const r=(new Pn).set("idMedicamento",e);return this.http.get(`${this.urlEndPoint}/existenciaspuntual`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getMedicamentosVencidos(e,r){const i=(new Pn).set("idBodega",e).set("fInicial",r);return this.http.get(`${this.urlEndPoint}/vencidos`,{params:i}).pipe(Pt(o=>(401!=o.status&&o.error.mensaje&&console.error(o.error.mensaje),It(o))))}getMedicamentosNorotan(e,r){const i=(new Pn).set("idBodega",e).set("fInicial",r);return this.http.get(`${this.urlEndPoint}/norotan`,{params:i}).pipe(Pt(o=>(401!=o.status&&o.error.mensaje&&console.error(o.error.mensaje),It(o))))}obtenerMedicamentoPrescritosEntrega(e){return this.http.post(`${this.urlEndPoint}/prescripciones-entregas`,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}obtenerMedicamentoPrescritosEntregaPorBodega(e){return this.http.post(`${this.urlEndPoint}/prescripciones-entregas-bodegas`,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Dd=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/formula"}getFormulaId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unica`,{params:r})}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r})}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return console.log(e),this.http.put(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}filtrarMedicamentos(e){const r=(new Pn).set("term",e);return this.http.get(`${this.urlEndPoint}/filtrar-medicamento`,{params:r}).pipe(Pt(this.handleError("filtrarMedicamentos",[])))}filtrarMedicamentosEps(e,r){const i=(new Pn).set("term",e).set("codEps",r);return this.http.get(`${this.urlEndPoint}/filtrar-medicamento-eps`,{params:i}).pipe(Pt(this.handleError("filtrarMedicamentos",[])))}handleError(e="operation",r){return i=>(console.error(`${e} failed: ${i.message}`),On(r))}saveEntregaFormula(e,r,i,o,a,s){const c=(new Date).toISOString(),f=(new Pn).set("idFormula",e).set("idBodega",r).set("funcionario",i).set("medioEntrega",o).set("fechaEntrega",c).set("tipoRecibe",a).set("documentoRecibe",s);return this.http.get(`${this.urlEndPoint}/entrega`,{params:f}).pipe(Pt(v=>It(v)))}saveItemEntregaFormula(e,r,i,o,a,s,l,c,f){const v=new Date;c=c+" "+String(v.getHours()).padStart(2,"0")+":"+String(v.getMinutes()).padStart(2,"0");const k=(new Pn).set("idItem",e).set("idBodega",r).set("funcionario",i).set("medioEntrega",o).set("cantidadAentregar",a).set("fechaEntrega",c).set("tipoRecibe",s).set("documentoRecibe",l).set("idBodegaFormula",f);return this.http.get(`${this.urlEndPoint}/entrega/pendiente`,{params:k}).pipe(Pt(T=>It(T)))}subsanacionItemEntregaFormula(e,r,i,o,a){const s=(new Pn).set("idItem",e).set("idBodega",r).set("funcionario",i).set("medioEntrega",o).set("cantidadAentregar",a);return this.http.get(`${this.urlEndPoint}/entrega/subsanacion`,{params:s}).pipe(Pt(l=>It(l)))}getDxFormula(e){const r=(new Pn).set("codigo",e);return this.http.get(`${this.urlEndPoint}/cie`,{params:r})}getMedicamentoEntregadoPacienteMenosDe30Dias(e,r){const i=new Date,o=i.toISOString(),a=new Date(i);a.setDate(i.getDate()-28);const s=a.toISOString(),l=(new Pn).set("idMedicamento",e).set("idPaciente",r).set("fInicialstr",s).set("fFinalstr",o);return this.http.get(`${this.urlEndPoint}/medicamento/itemformula`,{params:l})}anularFormula(e,r,i){const o=(new Pn).set("idFormula",e).set("observacion",i).set("funcionario",r);return this.http.get(`${this.urlEndPoint}/anular`,{params:o}).pipe(Pt(a=>It(a)))}getCuotasModeradorasPDF(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/cuotamoderadora`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getFormulasPrescritas(e,r){const i=(new Pn).set("fInicial",e).set("fFinal",r);return this.http.get(`${this.urlEndPoint}/prescritas`,{params:i}).pipe(Pt(o=>(401!=o.status&&o.error.mensaje&&console.error(o.error.mensaje),It(o))))}getFormulasNoProcesadas(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/noprocesadas`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getFormulasDetalladas(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/reportes`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getFormulasDetalladasAnuladas(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/anuladas`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getMedicamentoentregadoPaciente(e,r,i,o){const a=(new Pn).set("idMedicamento",e).set("idBodega",r).set("fInicial",i).set("fFinal",o);return this.http.get(`${this.urlEndPoint}/entrega/paciente`,{params:a}).pipe(Pt(s=>(401!=s.status&&s.error.mensaje&&console.error(s.error.mensaje),It(s))))}deleteItemFormula(e,r,i){const o=(new Pn).set("idBodegaFormula",e).set("idItem",r).set("estadoFormula",i);return this.http.delete(`${this.urlEndPoint}/item`,{params:o})}deleteItemFormulaEntrega(e,r){const i=(new Pn).set("idItemEntrega",e).set("idMedicamento",r);return this.http.delete(`${this.urlEndPoint}/itementrega`,{params:i})}getFormulaIdPaciente(e,r,i){const o=(new Pn).set("idPaciente",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/idpaciente`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ad(t,...n){return n.length?n.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}class woe extends br{constructor(n,e){super()}schedule(n,e=0){return this}}const tx={setInterval(t,n,...e){const{delegate:r}=tx;return r?.setInterval?r.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=tx;return(n?.clearInterval||clearInterval)(t)},delegate:void 0};class mD extends woe{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var r;if(this.closed)return this;this.state=n;const i=this.id,o=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(o,i,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(o,this.id,e),this}requestAsyncId(n,e,r=0){return tx.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&tx.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(n,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let i,r=!1;try{this.work(n)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Ur(r,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}const mR={now:()=>(mR.delegate||Date).now(),delegate:void 0};class Vb{constructor(n,e=Vb.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,r){return new this.schedulerActionCtor(this,n).schedule(r,e)}}Vb.now=mR.now;class gD extends Vb{constructor(n,e=Vb.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,r){for(;n=e.shift();)n.unsubscribe();throw r}}}const nx=new gD(mD),xoe=nx;function xo(t,n=nx){return wn((e,r)=>{let i=null,o=null,a=null;const s=()=>{if(i){i.unsubscribe(),i=null;const c=o;o=null,r.next(c)}};function l(){const c=a+t,f=n.now();if(f<c)return i=this.schedule(void 0,c-f),void r.add(i);s()}e.subscribe(Rr(r,c=>{o=c,a=n.now(),i||(i=n.schedule(l,t),r.add(i))},()=>{s(),r.complete()},void 0,()=>{o=i=null}))})}function gR(t){return _o((n,e)=>t<=e)}function _D(t,n=xr){return t=t??Coe,wn((e,r)=>{let i,o=!0;e.subscribe(Rr(r,a=>{const s=n(a);(o||!t(i,s))&&(o=!1,i=s,r.next(a))}))})}function Coe(t,n){return t===n}function Co(t){return wn((n,e)=>{ja(t).subscribe(Rr(e,()=>e.complete(),Dn)),!e.closed&&n.subscribe(e)})}function Bo(t){return null!=t&&"false"!=`${t}`}function um(t,n=0){return function Eoe(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):n}function rx(t){return Array.isArray(t)?t:[t]}function ms(t){return null==t?"":"string"==typeof t?t:`${t}px`}function Ih(t){return t instanceof $r?t.nativeElement:t}let vD;try{vD=typeof Intl<"u"&&Intl.v8BreakIterator}catch{vD=!1}let d_,Ka=(()=>{class t{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function uH(t){return t===q4}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!vD)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(it(ly))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ub=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({}),t})();const _R=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function vR(){if(d_)return d_;if("object"!=typeof document||!document)return d_=new Set(_R),d_;let t=document.createElement("input");return d_=new Set(_R.filter(n=>(t.setAttribute("type",n),t.type===n))),d_}let Hb,ix,Kg,bD,Td;function f_(t){return function Doe(){if(null==Hb&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Hb=!0}))}finally{Hb=Hb||!1}return Hb}()?t:!!t.capture}function bR(){if(null==Kg){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Kg=!1,Kg;if("scrollBehavior"in document.documentElement.style)Kg=!0;else{const t=Element.prototype.scrollTo;Kg=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}}return Kg}function zb(){if("object"!=typeof document||!document)return 0;if(null==ix){const t=document.createElement("div"),n=t.style;t.dir="rtl",n.width="1px",n.overflow="auto",n.visibility="hidden",n.pointerEvents="none",n.position="absolute";const e=document.createElement("div"),r=e.style;r.width="2px",r.height="1px",t.appendChild(e),document.body.appendChild(t),ix=0,0===t.scrollLeft&&(t.scrollLeft=1,ix=0===t.scrollLeft?1:2),t.remove()}return ix}function yD(){let t=typeof document<"u"&&document?document.activeElement:null;for(;t&&t.shadowRoot;){const n=t.shadowRoot.activeElement;if(n===t)break;t=n}return t}function dm(t){return t.composedPath?t.composedPath()[0]:t.target}function wD(){return typeof Td.__karma__<"u"&&!!Td.__karma__||typeof Td.jasmine<"u"&&!!Td.jasmine||typeof Td.jest<"u"&&!!Td.jest||typeof Td.Mocha<"u"&&!!Td.Mocha}Td=typeof global<"u"?global:typeof window<"u"?window:{};let yR=(()=>{class t{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Moe=(()=>{class t{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,r)=>this._cleanupObserver(r))}observe(e){const r=Ih(e);return new Ht(i=>{const a=this._observeElement(r).subscribe(i);return()=>{a.unsubscribe(),this._unobserveElement(r)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const r=new Bt,i=this._mutationObserverFactory.create(o=>r.next(o));i&&i.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:i,stream:r,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:r,stream:i}=this._observedElements.get(e);r&&r.disconnect(),i.complete(),this._observedElements.delete(e)}}}return t.\u0275fac=function(e){return new(e||t)(it(yR))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),xD=(()=>{class t{constructor(e,r,i){this._contentObserver=e,this._elementRef=r,this._ngZone=i,this.event=new Vr,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(e){this._disabled=Bo(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=um(e),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(xo(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(X(Moe),X($r),X(Wr))},t.\u0275dir=jn({type:t,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),t})(),ox=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:[yR]}),t})();class CR{constructor(n){this._items=n,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new Bt,this._typeaheadSubscription=br.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=e=>e.disabled,this._pressedLetters=[],this.tabOut=new Bt,this.change=new Bt,n instanceof Hp&&n.changes.subscribe(e=>{if(this._activeItem){const i=e.toArray().indexOf(this._activeItem);i>-1&&i!==this._activeItemIndex&&(this._activeItemIndex=i)}})}skipPredicate(n){return this._skipPredicateFn=n,this}withWrap(n=!0){return this._wrap=n,this}withVerticalOrientation(n=!0){return this._vertical=n,this}withHorizontalOrientation(n){return this._horizontal=n,this}withAllowedModifierKeys(n){return this._allowedModifierKeys=n,this}withTypeAhead(n=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Ya(e=>this._pressedLetters.push(e)),xo(n),_o(()=>this._pressedLetters.length>0),gr(()=>this._pressedLetters.join(""))).subscribe(e=>{const r=this._getItemsArray();for(let i=1;i<r.length+1;i++){const o=(this._activeItemIndex+i)%r.length,a=r[o];if(!this._skipPredicateFn(a)&&0===a.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(o);break}}this._pressedLetters=[]}),this}withHomeAndEnd(n=!0){return this._homeAndEnd=n,this}setActiveItem(n){const e=this._activeItem;this.updateActiveItem(n),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(n){const e=n.keyCode,i=["altKey","ctrlKey","metaKey","shiftKey"].every(o=>!n[o]||this._allowedModifierKeys.indexOf(o)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&i){this.setNextItemActive();break}return;case 38:if(this._vertical&&i){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&i){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&i){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&i){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&i){this.setLastItemActive();break}return;default:return void((i||Ad(n,"shiftKey"))&&(n.key&&1===n.key.length?this._letterKeyStream.next(n.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],n.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(n){const e=this._getItemsArray(),r="number"==typeof n?n:e.indexOf(n);this._activeItem=e[r]??null,this._activeItemIndex=r}_setActiveItemByDelta(n){this._wrap?this._setActiveInWrapMode(n):this._setActiveInDefaultMode(n)}_setActiveInWrapMode(n){const e=this._getItemsArray();for(let r=1;r<=e.length;r++){const i=(this._activeItemIndex+n*r+e.length)%e.length;if(!this._skipPredicateFn(e[i]))return void this.setActiveItem(i)}}_setActiveInDefaultMode(n){this._setActiveItemByIndex(this._activeItemIndex+n,n)}_setActiveItemByIndex(n,e){const r=this._getItemsArray();if(r[n]){for(;this._skipPredicateFn(r[n]);)if(!r[n+=e])return;this.setActiveItem(n)}}_getItemsArray(){return this._items instanceof Hp?this._items.toArray():this._items}}class Ioe extends CR{setActiveItem(n){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(n),this.activeItem&&this.activeItem.setActiveStyles()}}class CD extends CR{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(n){return this._origin=n,this}setActiveItem(n){super.setActiveItem(n),this.activeItem&&this.activeItem.focus(this._origin)}}let ED=(()=>{class t{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function Ooe(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const r=function Poe(t){try{return t.frameElement}catch{return null}}(function Hoe(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}(e));if(r&&(-1===SR(r)||!this.isVisible(r)))return!1;let i=e.nodeName.toLowerCase(),o=SR(e);return e.hasAttribute("contenteditable")?-1!==o:!("iframe"===i||"object"===i||this._platform.WEBKIT&&this._platform.IOS&&!function Voe(t){let n=t.nodeName.toLowerCase(),e="input"===n&&t.type;return"text"===e||"password"===e||"select"===n||"textarea"===n}(e))&&("audio"===i?!!e.hasAttribute("controls")&&-1!==o:"video"===i?-1!==o&&(null!==o||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,r){return function Uoe(t){return!function Roe(t){return function Boe(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function Noe(t){let n=t.nodeName.toLowerCase();return"input"===n||"select"===n||"button"===n||"textarea"===n}(t)||function Loe(t){return function joe(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||ER(t))}(e)&&!this.isDisabled(e)&&(r?.ignoreVisibility||this.isVisible(e))}}return t.\u0275fac=function(e){return new(e||t)(it(Ka))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ER(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let n=t.getAttribute("tabindex");return!(!n||isNaN(parseInt(n,10)))}function SR(t){if(!ER(t))return null;const n=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(n)?-1:n}class zoe{constructor(n,e,r,i,o=!1){this._element=n,this._checker=e,this._ngZone=r,this._document=i,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,o||this.attachAnchors()}get enabled(){return this._enabled}set enabled(n){this._enabled=n,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}destroy(){const n=this._startAnchor,e=this._endAnchor;n&&(n.removeEventListener("focus",this.startAnchorListener),n.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(n)))})}focusFirstTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(n)))})}focusLastTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(n)))})}_getRegionBoundary(n){let e=this._element.querySelectorAll(`[cdk-focus-region-${n}], [cdkFocusRegion${n}], [cdk-focus-${n}]`);for(let r=0;r<e.length;r++)e[r].hasAttribute(`cdk-focus-${n}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${n}', use 'cdkFocusRegion${n}' instead. The deprecated attribute will be removed in 8.0.0.`,e[r]):e[r].hasAttribute(`cdk-focus-region-${n}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${n}', use 'cdkFocusRegion${n}' instead. The deprecated attribute will be removed in 8.0.0.`,e[r]);return"start"==n?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(n){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(e.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",e),!this._checker.isFocusable(e)){const r=this._getFirstTabbableElement(e);return r?.focus(n),!!r}return e.focus(n),!0}return this.focusFirstTabbableElement(n)}focusFirstTabbableElement(n){const e=this._getRegionBoundary("start");return e&&e.focus(n),!!e}focusLastTabbableElement(n){const e=this._getRegionBoundary("end");return e&&e.focus(n),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let r=0;r<e.length;r++){const i=e[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[r]):null;if(i)return i}return null}_getLastTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let r=e.length-1;r>=0;r--){const i=e[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[r]):null;if(i)return i}return null}_createAnchor(){const n=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,n),n.classList.add("cdk-visually-hidden"),n.classList.add("cdk-focus-trap-anchor"),n.setAttribute("aria-hidden","true"),n}_toggleAnchorTabIndex(n,e){n?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(n){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_executeOnStable(n){this._ngZone.isStable?n():this._ngZone.onStable.pipe(ra(1)).subscribe(n)}}let DR=(()=>{class t{constructor(e,r,i){this._checker=e,this._ngZone=r,this._document=i}create(e,r=!1){return new zoe(e,this._checker,this._ngZone,this._document,r)}}return t.\u0275fac=function(e){return new(e||t)(it(ED),it(Wr),it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function SD(t){return 0===t.offsetX&&0===t.offsetY}function DD(t){const n=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}const $oe=new U("cdk-input-modality-detector-options"),Woe={ignoreKeys:[18,17,224,91,16]},h_=f_({passive:!0,capture:!0});let qoe=(()=>{class t{constructor(e,r,i,o){this._platform=e,this._mostRecentTarget=null,this._modality=new Yc(null),this._lastTouchMs=0,this._onKeydown=a=>{this._options?.ignoreKeys?.some(s=>s===a.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=dm(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<650||(this._modality.next(SD(a)?"keyboard":"mouse"),this._mostRecentTarget=dm(a))},this._onTouchstart=a=>{DD(a)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=dm(a))},this._options={...Woe,...o},this.modalityDetected=this._modality.pipe(gR(1)),this.modalityChanged=this.modalityDetected.pipe(_D()),e.isBrowser&&r.runOutsideAngular(()=>{i.addEventListener("keydown",this._onKeydown,h_),i.addEventListener("mousedown",this._onMousedown,h_),i.addEventListener("touchstart",this._onTouchstart,h_)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,h_),document.removeEventListener("mousedown",this._onMousedown,h_),document.removeEventListener("touchstart",this._onTouchstart,h_))}}return t.\u0275fac=function(e){return new(e||t)(it(Ka),it(Wr),it(si),it($oe,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Goe=new U("liveAnnouncerElement",{providedIn:"root",factory:function Yoe(){return null}}),Xoe=new U("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Koe=(()=>{class t{constructor(e,r,i,o){this._ngZone=r,this._defaultOptions=o,this._document=i,this._liveElement=e||this._createLiveElement()}announce(e,...r){const i=this._defaultOptions;let o,a;return 1===r.length&&"number"==typeof r[0]?a=r[0]:[o,a]=r,this.clear(),clearTimeout(this._previousTimeout),o||(o=i&&i.politeness?i.politeness:"polite"),null==a&&i&&(a=i.duration),this._liveElement.setAttribute("aria-live",o),this._ngZone.runOutsideAngular(()=>new Promise(s=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,s(),"number"==typeof a&&(this._previousTimeout=setTimeout(()=>this.clear(),a))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null}_createLiveElement(){const e="cdk-live-announcer-element",r=this._document.getElementsByClassName(e),i=this._document.createElement("div");for(let o=0;o<r.length;o++)r[o].remove();return i.classList.add(e),i.classList.add("cdk-visually-hidden"),i.setAttribute("aria-atomic","true"),i.setAttribute("aria-live","polite"),this._document.body.appendChild(i),i}}return t.\u0275fac=function(e){return new(e||t)(it(Goe,8),it(Wr),it(si),it(Xoe,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Zoe=new U("cdk-focus-monitor-default-options"),ax=f_({passive:!0,capture:!0});let fm=(()=>{class t{constructor(e,r,i,o,a){this._ngZone=e,this._platform=r,this._inputModalityDetector=i,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Bt,this._rootNodeFocusAndBlurListener=s=>{const l=dm(s),c="focus"===s.type?this._onFocus:this._onBlur;for(let f=l;f;f=f.parentElement)c.call(this,s,f)},this._document=o,this._detectionMode=a?.detectionMode||0}monitor(e,r=!1){const i=Ih(e);if(!this._platform.isBrowser||1!==i.nodeType)return On(null);const o=function Toe(t){if(function Aoe(){if(null==bD){const t=typeof document<"u"?document.head:null;bD=!(!t||!t.createShadowRoot&&!t.attachShadow)}return bD}()){const n=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}(i)||this._getDocument(),a=this._elementInfo.get(i);if(a)return r&&(a.checkChildren=!0),a.subject;const s={checkChildren:r,subject:new Bt,rootNode:o};return this._elementInfo.set(i,s),this._registerGlobalListeners(s),s.subject}stopMonitoring(e){const r=Ih(e),i=this._elementInfo.get(r);i&&(i.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(i))}focusVia(e,r,i){const o=Ih(e);o===this._getDocument().activeElement?this._getClosestElementsInfo(o).forEach(([s,l])=>this._originChanged(s,r,l)):(this._setOrigin(r),"function"==typeof o.focus&&o.focus(i))}ngOnDestroy(){this._elementInfo.forEach((e,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,r){e.classList.toggle("cdk-focused",!!r),e.classList.toggle("cdk-touch-focused","touch"===r),e.classList.toggle("cdk-keyboard-focused","keyboard"===r),e.classList.toggle("cdk-mouse-focused","mouse"===r),e.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(e,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&r,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,r){const i=this._elementInfo.get(r),o=dm(e);!i||!i.checkChildren&&r!==o||this._originChanged(r,this._getFocusOrigin(o),i)}_onBlur(e,r){const i=this._elementInfo.get(r);!i||i.checkChildren&&e.relatedTarget instanceof Node&&r.contains(e.relatedTarget)||(this._setClasses(r),this._emitOrigin(i.subject,null))}_emitOrigin(e,r){this._ngZone.run(()=>e.next(r))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const r=e.rootNode,i=this._rootNodeFocusListenerCount.get(r)||0;i||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,ax),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,ax)}),this._rootNodeFocusListenerCount.set(r,i+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Co(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(e){const r=e.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const i=this._rootNodeFocusListenerCount.get(r);i>1?this._rootNodeFocusListenerCount.set(r,i-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,ax),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,ax),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,r,i){this._setClasses(e,r),this._emitOrigin(i.subject,r),this._lastFocusOrigin=r}_getClosestElementsInfo(e){const r=[];return this._elementInfo.forEach((i,o)=>{(o===e||i.checkChildren&&o.contains(e))&&r.push([o,i])}),r}}return t.\u0275fac=function(e){return new(e||t)(it(Wr),it(Ka),it(qoe),it(si,8),it(Zoe,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Qoe=(()=>{class t{constructor(e,r){this._elementRef=e,this._focusMonitor=r,this.cdkFocusChange=new Vr}ngAfterViewInit(){const e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,1===e.nodeType&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(r=>this.cdkFocusChange.emit(r))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(fm))},t.\u0275dir=jn({type:t,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"}}),t})();const TR="cdk-high-contrast-black-on-white",MR="cdk-high-contrast-white-on-black",AD="cdk-high-contrast-active";let TD,kR=(()=>{class t{constructor(e,r){this._platform=e,this._document=r}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(e):null,o=(i&&i.backgroundColor||"").replace(/ /g,"");switch(e.remove(),o){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(AD),e.remove(TR),e.remove(MR),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?(e.add(AD),e.add(TR)):2===r&&(e.add(AD),e.add(MR))}}}return t.\u0275fac=function(e){return new(e||t)(it(Ka),it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Joe=(()=>{class t{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return t.\u0275fac=function(e){return new(e||t)(it(kR))},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[Ub,ox]]}),t})(),eae=1;const sx={};function FR(t){return t in sx&&(delete sx[t],!0)}const tae={setImmediate(t){const n=eae++;return sx[n]=!0,TD||(TD=Promise.resolve()),TD.then(()=>FR(n)&&t()),n},clearImmediate(t){FR(t)}},{setImmediate:nae,clearImmediate:rae}=tae,lx={setImmediate(...t){const{delegate:n}=lx;return(n?.setImmediate||nae)(...t)},clearImmediate(t){const{delegate:n}=lx;return(n?.clearImmediate||rae)(t)},delegate:void 0},MD=new class oae extends gD{flush(n){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let i;n=n||r.shift();do{if(i=n.execute(n.state,n.delay))break}while((n=r[0])&&n.id===e&&r.shift());if(this._active=!1,i){for(;(n=r[0])&&n.id===e&&r.shift();)n.unsubscribe();throw i}}}(class iae extends mD{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,r=0){return null!==r&&r>0?super.requestAsyncId(n,e,r):(n.actions.push(this),n._scheduled||(n._scheduled=lx.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,e,r=0){var i;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(n,e,r);const{actions:o}=n;null!=e&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==e&&(lx.clearImmediate(e),n._scheduled=void 0)}});function IR(t,n){return n?e=>Lv(n.pipe(ra(1),function aae(){return wn((t,n)=>{t.subscribe(Rr(n,Dn))})}()),e.pipe(IR(t))):ko((e,r)=>t(e,r).pipe(ra(1),Zy(e)))}function kD(t=0,n,e=xoe){let r=-1;return null!=n&&(Am(n)?e=n:r=n),new Ht(i=>{let o=function sae(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;o<0&&(o=0);let a=0;return e.schedule(function(){i.closed||(i.next(a++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function FD(t,n=nx){const e=kD(t,n);return IR(()=>e)}class PR{}class lae{}const Ph="*";function Zg(t,n){return{type:7,name:t,definitions:n,options:{}}}function ou(t,n=null){return{type:4,styles:n,timings:t}}function OR(t,n=null){return{type:2,steps:t,options:n}}function wa(t){return{type:6,styles:t,offset:null}}function Gu(t,n,e){return{type:0,name:t,styles:n,options:e}}function au(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function NR(t){Promise.resolve().then(t)}class $b{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){NR(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class RR{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,r=0,i=0;const o=this.players.length;0==o?NR(()=>this._onFinish()):this.players.forEach(a=>{a.onDone(()=>{++e==o&&this._onFinish()}),a.onDestroy(()=>{++r==o&&this._onDestroy()}),a.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((a,s)=>Math.max(a,s.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(i)})}getPosition(){const n=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}const ID="!";class PD{attach(n){return this._attachedHost=n,n.attach(this)}detach(){let n=this._attachedHost;null!=n&&(this._attachedHost=null,n.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class Wb extends PD{constructor(n,e,r,i){super(),this.component=n,this.viewContainerRef=e,this.injector=r,this.componentFactoryResolver=i}}class p_ extends PD{constructor(n,e,r){super(),this.templateRef=n,this.viewContainerRef=e,this.context=r}get origin(){return this.templateRef.elementRef}attach(n,e=this.context){return this.context=e,super.attach(n)}detach(){return this.context=void 0,super.detach()}}class cae extends PD{constructor(n){super(),this.element=n instanceof $r?n.nativeElement:n}}class cx{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(n){return n instanceof Wb?(this._attachedPortal=n,this.attachComponentPortal(n)):n instanceof p_?(this._attachedPortal=n,this.attachTemplatePortal(n)):this.attachDomPortal&&n instanceof cae?(this._attachedPortal=n,this.attachDomPortal(n)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(n){this._disposeFn=n}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class uae extends cx{constructor(n,e,r,i,o){super(),this.outletElement=n,this._componentFactoryResolver=e,this._appRef=r,this._defaultInjector=i,this.attachDomPortal=a=>{const s=a.element,l=this._document.createComment("dom-portal");s.parentNode.insertBefore(l,s),this.outletElement.appendChild(s),this._attachedPortal=a,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(s,l)})},this._document=o}attachComponentPortal(n){const r=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component);let i;return n.viewContainerRef?(i=n.viewContainerRef.createComponent(r,n.viewContainerRef.length,n.injector||n.viewContainerRef.injector),this.setDisposeFn(()=>i.destroy())):(i=r.create(n.injector||this._defaultInjector),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.detachView(i.hostView),i.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=n,i}attachTemplatePortal(n){let e=n.viewContainerRef,r=e.createEmbeddedView(n.templateRef,n.context);return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=e.indexOf(r);-1!==i&&e.remove(i)}),this._attachedPortal=n,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let Qg=(()=>{class t extends cx{constructor(e,r,i){super(),this._componentFactoryResolver=e,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new Vr,this.attachDomPortal=o=>{const a=o.element,s=this._document.createComment("dom-portal");o.setAttachedHost(this),a.parentNode.insertBefore(s,a),this._getRootNode().appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{s.parentNode&&s.parentNode.replaceChild(a,s)})},this._document=i}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(e){e.setAttachedHost(this);const r=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,o=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),a=r.createComponent(o,r.length,e.injector||r.injector);return r!==this._viewContainerRef&&this._getRootNode().appendChild(a.hostView.rootNodes[0]),super.setDisposeFn(()=>a.destroy()),this._attachedPortal=e,this._attachedRef=a,this.attached.emit(a),a}attachTemplatePortal(e){e.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return t.\u0275fac=function(e){return new(e||t)(X(Bp),X(Ml),X(si))},t.\u0275dir=jn({type:t,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[_r]}),t})(),ux=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({}),t})();const dae=new U("cdk-dir-doc",{providedIn:"root",factory:function fae(){return Xr(si)}});let su=(()=>{class t{constructor(e){if(this.value="ltr",this.change=new Vr,e){const o=(e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null);this.value="ltr"===o||"rtl"===o?o:"ltr"}}ngOnDestroy(){this.change.complete()}}return t.\u0275fac=function(e){return new(e||t)(it(dae,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),qb=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({}),t})();const LR=new jp("13.0.0");function hae(t,n){if(1&t&&qe(0,"mat-pseudo-checkbox",4),2&t){const e=ae();N("state",e.selected?"checked":"unchecked")("disabled",e.disabled)}}function pae(t,n){if(1&t&&(d(0,"span",5),h(1),u()),2&t){const e=ae();w(1),Qt("(",e.group.label,")")}}const mae=["*"],BR=new jp("13.0.0"),_ae=new U("mat-sanity-checks",{providedIn:"root",factory:function gae(){return!0}});let Wi=(()=>{class t{constructor(e,r,i){this._hasDoneGlobalChecks=!1,this._document=i,e._applyBodyHighContrastModeCssClasses(),this._sanityChecks=r,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!1}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const e=this._document.createElement("div");e.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(e);const r=getComputedStyle(e);r&&"none"!==r.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),e.remove()}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&BR.full!==LR.full&&console.warn("The Angular Material version ("+BR.full+") does not match the Angular CDK version ("+LR.full+").\nPlease ensure the versions of these two packages exactly match.")}}return t.\u0275fac=function(e){return new(e||t)(it(kR),it(_ae,8),it(si))},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[qb],qb]}),t})();function m_(t){return class extends t{constructor(...n){super(...n),this._disabled=!1}get disabled(){return this._disabled}set disabled(n){this._disabled=Bo(n)}}}function Jg(t,n){return class extends t{constructor(...e){super(...e),this.defaultColor=n,this.color=n}get color(){return this._color}set color(e){const r=e||this.defaultColor;r!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),r&&this._elementRef.nativeElement.classList.add(`mat-${r}`),this._color=r)}}}function Oh(t){return class extends t{constructor(...n){super(...n),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=Bo(n)}}}function vae(t,n=0){return class extends t{constructor(...e){super(...e),this._tabIndex=n,this.defaultTabIndex=n}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?um(e):this.defaultTabIndex}}}function bae(t){return class extends t{constructor(...n){super(...n),this.stateChanges=new Bt,this.errorState=!1}updateErrorState(){const n=this.errorState,o=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);o!==n&&(this.errorState=o,this.stateChanges.next())}}}let jR=(()=>{class t{isErrorState(e,r){return!!(e&&e.invalid&&(e.touched||r&&r.submitted))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),VR=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),t})();function Gb(t,n,e){t.nativeElement.classList.toggle(n,e)}let HR=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[Wi],Wi]}),t})();class wae{constructor(n,e,r){this._renderer=n,this.element=e,this.config=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const zR={enterDuration:225,exitDuration:150},OD=f_({passive:!0}),$R=["mousedown","touchstart"],WR=["mouseup","mouseleave","touchend","touchcancel"];class Cae{constructor(n,e,r,i){this._target=n,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=Ih(r))}fadeInRipple(n,e,r={}){const i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o={...zR,...r.animation};r.centered&&(n=i.left+i.width/2,e=i.top+i.height/2);const a=r.radius||function Sae(t,n,e){const r=Math.max(Math.abs(t-e.left),Math.abs(t-e.right)),i=Math.max(Math.abs(n-e.top),Math.abs(n-e.bottom));return Math.sqrt(r*r+i*i)}(n,e,i),s=n-i.left,l=e-i.top,c=o.enterDuration,f=document.createElement("div");f.classList.add("mat-ripple-element"),f.style.left=s-a+"px",f.style.top=l-a+"px",f.style.height=2*a+"px",f.style.width=2*a+"px",null!=r.color&&(f.style.backgroundColor=r.color),f.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(f),function Eae(t){window.getComputedStyle(t).getPropertyValue("opacity")}(f),f.style.transform="scale(1)";const v=new wae(this,f,r);return v.state=0,this._activeRipples.add(v),r.persistent||(this._mostRecentTransientRipple=v),this._runTimeoutOutsideZone(()=>{const E=v===this._mostRecentTransientRipple;v.state=1,!r.persistent&&(!E||!this._isPointerDown)&&v.fadeOut()},c),v}fadeOutRipple(n){const e=this._activeRipples.delete(n);if(n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const r=n.element,i={...zR,...n.config.animation};r.style.transitionDuration=`${i.exitDuration}ms`,r.style.opacity="0",n.state=2,this._runTimeoutOutsideZone(()=>{n.state=3,r.remove()},i.exitDuration)}fadeOutAll(){this._activeRipples.forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const e=Ih(n);!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents($R))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(WR),this._pointerUpEventsRegistered=!0)}_onMousedown(n){const e=SD(n),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!r&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!DD(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=n.changedTouches;for(let r=0;r<e.length;r++)this.fadeInRipple(e[r].clientX,e[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_runTimeoutOutsideZone(n,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(n,e))}_registerEvents(n){this._ngZone.runOutsideAngular(()=>{n.forEach(e=>{this._triggerElement.addEventListener(e,this,OD)})})}_removeTriggerEvents(){this._triggerElement&&($R.forEach(n=>{this._triggerElement.removeEventListener(n,this,OD)}),this._pointerUpEventsRegistered&&WR.forEach(n=>{this._triggerElement.removeEventListener(n,this,OD)}))}}const Dae=new U("mat-ripple-global-options");let Nh=(()=>{class t{constructor(e,r,i,o,a){this._elementRef=e,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=o||{},this._rippleRenderer=new Cae(this,r,e,i)}get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,r=0,i){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,r,{...this.rippleConfig,...i}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Wr),X(Ka),X(Dae,8),X(kl,8))},t.\u0275dir=jn({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,r){2&e&&Ai("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),t})(),g_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[Wi,Ub],Wi]}),t})(),qR=(()=>{class t{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1}}return t.\u0275fac=function(e){return new(e||t)(X(kl,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(e,r){2&e&&Ai("mat-pseudo-checkbox-indeterminate","indeterminate"===r.state)("mat-pseudo-checkbox-checked","checked"===r.state)("mat-pseudo-checkbox-disabled",r.disabled)("_mat-animation-noopable","NoopAnimations"===r._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(e,r){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),t})(),ND=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[Wi]]}),t})();const GR=new U("MAT_OPTION_PARENT_COMPONENT"),YR=new U("MatOptgroup");let Aae=0;class XR{constructor(n,e=!1){this.source=n,this.isUserInput=e}}let Tae=(()=>{class t{constructor(e,r,i,o){this._element=e,this._changeDetectorRef=r,this._parent=i,this.group=o,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+Aae++,this.onSelectionChange=new Vr,this._stateChanges=new Bt}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=Bo(e)}get disableRipple(){return this._parent&&this._parent.disableRipple}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(e,r){const i=this._getHostElement();"function"==typeof i.focus&&i.focus(r)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!Ad(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue=e,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new XR(this,e))}}return t.\u0275fac=function(e){U2()},t.\u0275dir=jn({type:t,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),t})(),hm=(()=>{class t extends Tae{constructor(e,r,i,o){super(e,r,i,o)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Zo),X(GR,8),X(YR,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(e,r){1&e&&De("click",function(){return r._selectViaInteraction()})("keydown",function(o){return r._handleKeydown(o)}),2&e&&(T1("id",r.id),kr("tabindex",r._getTabIndex())("aria-selected",r._getAriaSelected())("aria-disabled",r.disabled.toString()),Ai("mat-selected",r.selected)("mat-option-multiple",r.multiple)("mat-active",r.active)("mat-option-disabled",r.disabled))},exportAs:["matOption"],features:[_r],ngContentSelectors:mae,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(e,r){1&e&&(Fa(),oe(0,hae,1,2,"mat-pseudo-checkbox",0),d(1,"span",1),Ri(2),u(),oe(3,pae,2,1,"span",2),qe(4,"div",3)),2&e&&(N("ngIf",r.multiple),w(3),N("ngIf",r.group&&r.group._inert),w(1),N("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disabled||r.disableRipple))},dependencies:[qR,Fi,Nh],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),t})(),KR=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[g_,xf,Wi,ND]]}),t})();const Fae=["addListener","removeListener"],Iae=["addEventListener","removeEventListener"],Pae=["on","off"];function lu(t,n,e,r){if(zn(e)&&(r=e,e=void 0),r)return lu(t,n,e).pipe(r5(r));const[i,o]=function Rae(t){return zn(t.addEventListener)&&zn(t.removeEventListener)}(t)?Iae.map(a=>s=>t[a](n,s,e)):function Oae(t){return zn(t.addListener)&&zn(t.removeListener)}(t)?Fae.map(ZR(t,n)):function Nae(t){return zn(t.on)&&zn(t.off)}(t)?Pae.map(ZR(t,n)):[];if(!i&&Vf(t))return ko(a=>lu(a,n,e))(ja(t));if(!i)throw new TypeError("Invalid event target");return new Ht(a=>{const s=(...l)=>a.next(1<l.length?l:l[0]);return i(s),()=>o(s)})}function ZR(t,n){return e=>r=>t[e](n,r)}const Yb={schedule(t){let n=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:r}=Yb;r&&(n=r.requestAnimationFrame,e=r.cancelAnimationFrame);const i=n(o=>{e=void 0,t(o)});return new br(()=>e?.(i))},requestAnimationFrame(...t){const{delegate:n}=Yb;return(n?.requestAnimationFrame||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:n}=Yb;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...t)},delegate:void 0};new class Bae extends gD{flush(n){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let i;n=n||r.shift();do{if(i=n.execute(n.state,n.delay))break}while((n=r[0])&&n.id===e&&r.shift());if(this._active=!1,i){for(;(n=r[0])&&n.id===e&&r.shift();)n.unsubscribe();throw i}}}(class Lae extends mD{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,r=0){return null!==r&&r>0?super.requestAsyncId(n,e,r):(n.actions.push(this),n._scheduled||(n._scheduled=Yb.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,e,r=0){var i;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(n,e,r);const{actions:o}=n;null!=e&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==e&&(Yb.cancelAnimationFrame(e),n._scheduled=void 0)}});function QR(t,n=nx){return function Vae(t){return wn((n,e)=>{let r=!1,i=null,o=null,a=!1;const s=()=>{if(o?.unsubscribe(),o=null,r){r=!1;const c=i;i=null,e.next(c)}a&&e.complete()},l=()=>{o=null,a&&e.complete()};n.subscribe(Rr(e,c=>{r=!0,i=c,o||ja(t(c)).subscribe(o=Rr(e,s,l))},()=>{a=!0,(!r||!o||o.closed)&&e.complete()}))})}(()=>kD(t,n))}let dx=(()=>{class t{constructor(e,r,i){this._ngZone=e,this._platform=r,this._scrolled=new Bt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const r=this.scrollContainers.get(e);r&&(r.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Ht(r=>{this._globalSubscription||this._addGlobalListener();const i=e>0?this._scrolled.pipe(QR(e)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):On()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(e,r){const i=this.getAncestorScrollContainers(e);return this.scrolled(r).pipe(_o(o=>!o||i.indexOf(o)>-1))}getAncestorScrollContainers(e){const r=[];return this.scrollContainers.forEach((i,o)=>{this._scrollableContainsElement(o,e)&&r.push(o)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,r){let i=Ih(r),o=e.getElementRef().nativeElement;do{if(i==o)return!0}while(i=i.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>lu(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(it(Wr),it(Ka),it(si,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),fx=(()=>{class t{constructor(e,r,i,o){this.elementRef=e,this.scrollDispatcher=r,this.ngZone=i,this.dir=o,this._destroyed=new Bt,this._elementScrolled=new Ht(a=>this.ngZone.runOutsideAngular(()=>lu(this.elementRef.nativeElement,"scroll").pipe(Co(this._destroyed)).subscribe(a)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const r=this.elementRef.nativeElement,i=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=i?e.end:e.start),null==e.right&&(e.right=i?e.start:e.end),null!=e.bottom&&(e.top=r.scrollHeight-r.clientHeight-e.bottom),i&&0!=zb()?(null!=e.left&&(e.right=r.scrollWidth-r.clientWidth-e.left),2==zb()?e.left=e.right:1==zb()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=r.scrollWidth-r.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const r=this.elementRef.nativeElement;bR()?r.scrollTo(e):(null!=e.top&&(r.scrollTop=e.top),null!=e.left&&(r.scrollLeft=e.left))}measureScrollOffset(e){const r="left",i="right",o=this.elementRef.nativeElement;if("top"==e)return o.scrollTop;if("bottom"==e)return o.scrollHeight-o.clientHeight-o.scrollTop;const a=this.dir&&"rtl"==this.dir.value;return"start"==e?e=a?i:r:"end"==e&&(e=a?r:i),a&&2==zb()?e==r?o.scrollWidth-o.clientWidth-o.scrollLeft:o.scrollLeft:a&&1==zb()?e==r?o.scrollLeft+o.scrollWidth-o.clientWidth:-o.scrollLeft:e==r?o.scrollLeft:o.scrollWidth-o.clientWidth-o.scrollLeft}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(dx),X(Wr),X(su,8))},t.\u0275dir=jn({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),t})(),e0=(()=>{class t{constructor(e,r,i){this._platform=e,this._change=new Bt,this._changeListener=o=>{this._change.next(o)},this._document=i,r.runOutsideAngular(()=>{if(e.isBrowser){const o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,r=this._getWindow(),i=e.documentElement,o=i.getBoundingClientRect();return{top:-o.top||e.body.scrollTop||r.scrollY||i.scrollTop||0,left:-o.left||e.body.scrollLeft||r.scrollX||i.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(QR(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(it(Ka),it(Wr),it(si,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),__=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({}),t})(),JR=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[qb,Ub,__],qb,__]}),t})();const e6=bR();class zae{constructor(n,e){this._viewportRuler=n,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const n=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=n.style.left||"",this._previousHTMLStyles.top=n.style.top||"",n.style.left=ms(-this._previousScrollPosition.left),n.style.top=ms(-this._previousScrollPosition.top),n.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const n=this._document.documentElement,r=n.style,i=this._document.body.style,o=r.scrollBehavior||"",a=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,n.classList.remove("cdk-global-scrollblock"),e6&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e6&&(r.scrollBehavior=o,i.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,r=this._viewportRuler.getViewportSize();return e.scrollHeight>r.height||e.scrollWidth>r.width}}class $ae{constructor(n,e,r,i){this._scrollDispatcher=n,this._ngZone=e,this._viewportRuler=r,this._config=i,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(n){this._overlayRef=n}enable(){if(this._scrollSubscription)return;const n=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=n.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=n.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class t6{enable(){}disable(){}attach(){}}function RD(t,n){return n.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function n6(t,n){return n.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class Wae{constructor(n,e,r,i){this._scrollDispatcher=n,this._viewportRuler=e,this._ngZone=r,this._config=i,this._scrollSubscription=null}attach(n){this._overlayRef=n}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();RD(e,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let qae=(()=>{class t{constructor(e,r,i,o){this._scrollDispatcher=e,this._viewportRuler=r,this._ngZone=i,this.noop=()=>new t6,this.close=a=>new $ae(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new zae(this._viewportRuler,this._document),this.reposition=a=>new Wae(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=o}}return t.\u0275fac=function(e){return new(e||t)(it(dx),it(e0),it(Wr),it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Xb{constructor(n){if(this.scrollStrategy=new t6,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,n){const e=Object.keys(n);for(const r of e)void 0!==n[r]&&(this[r]=n[r])}}}class Gae{constructor(n,e,r,i,o){this.offsetX=r,this.offsetY=i,this.panelClass=o,this.originX=n.originX,this.originY=n.originY,this.overlayX=e.overlayX,this.overlayY=e.overlayY}}class Yae{}let Xae=(()=>{let t=class{constructor(e,r){this.connectionPair=e,this.scrollableViewProperties=r}};return t=function Bf(t,n,e,r){var a,i=arguments.length,o=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,e):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,r);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(i<3?a(o):i>3?a(n,e,o):a(n,e))||o);return i>3&&o&&Object.defineProperty(n,e,o),o}([xa(1,Uc()),g0("design:paramtypes",[Gae,Yae])],t),t})(),r6=(()=>{class t{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const r=this._attachedOverlays.indexOf(e);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}}return t.\u0275fac=function(e){return new(e||t)(it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Kae=(()=>{class t extends r6{constructor(e){super(e),this._keydownListener=r=>{const i=this._attachedOverlays;for(let o=i.length-1;o>-1;o--)if(i[o]._keydownEvents.observers.length>0){i[o]._keydownEvents.next(r);break}}}add(e){super.add(e),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return t.\u0275fac=function(e){return new(e||t)(it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Zae=(()=>{class t extends r6{constructor(e,r){super(e),this._platform=r,this._cursorStyleIsSet=!1,this._pointerDownListener=i=>{this._pointerDownEventTarget=dm(i)},this._clickListener=i=>{const o=dm(i),a="click"===i.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const s=this._attachedOverlays.slice();for(let l=s.length-1;l>-1;l--){const c=s[l];if(!(c._outsidePointerEvents.observers.length<1)&&c.hasAttached()){if(c.overlayElement.contains(o)||c.overlayElement.contains(a))break;c._outsidePointerEvents.next(i)}}}}add(e){if(super.add(e),!this._isAttached){const r=this._document.body;r.addEventListener("pointerdown",this._pointerDownListener,!0),r.addEventListener("click",this._clickListener,!0),r.addEventListener("auxclick",this._clickListener,!0),r.addEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}}return t.\u0275fac=function(e){return new(e||t)(it(si),it(Ka))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),LD=(()=>{class t{constructor(e,r){this._platform=r,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||wD()){const i=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let o=0;o<i.length;o++)i[o].remove()}const r=this._document.createElement("div");r.classList.add(e),wD()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}}return t.\u0275fac=function(e){return new(e||t)(it(si),it(Ka))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Qae{constructor(n,e,r,i,o,a,s,l,c){this._portalOutlet=n,this._host=e,this._pane=r,this._config=i,this._ngZone=o,this._keyboardDispatcher=a,this._document=s,this._location=l,this._outsideClickDispatcher=c,this._backdropElement=null,this._backdropClick=new Bt,this._attachments=new Bt,this._detachments=new Bt,this._locationChanges=br.EMPTY,this._backdropClickHandler=f=>this._backdropClick.next(f),this._keydownEvents=new Bt,this._outsidePointerEvents=new Bt,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(n){let e=this._portalOutlet.attach(n);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(ra(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const n=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),n}dispose(){const n=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,n&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(n){n!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=n,this.hasAttached()&&(n.attach(this),this.updatePosition()))}updateSize(n){this._config={...this._config,...n},this._updateElementSize()}setDirection(n){this._config={...this._config,direction:n},this._updateElementDirection()}addPanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!0)}removePanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!1)}getDirection(){const n=this._config.direction;return n?"string"==typeof n?n:n.value:"ltr"}updateScrollStrategy(n){n!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=n,this.hasAttached()&&(n.attach(this),n.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const n=this._pane.style;n.width=ms(this._config.width),n.height=ms(this._config.height),n.minWidth=ms(this._config.minWidth),n.minHeight=ms(this._config.minHeight),n.maxWidth=ms(this._config.maxWidth),n.maxHeight=ms(this._config.maxHeight)}_togglePointerEvents(n){this._pane.style.pointerEvents=n?"":"none"}_attachBackdrop(){const n="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(n)})}):this._backdropElement.classList.add(n)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const n=this._backdropElement;if(!n)return;let e;const r=()=>{n&&(n.removeEventListener("click",this._backdropClickHandler),n.removeEventListener("transitionend",r),this._disposeBackdrop(n)),this._config.backdropClass&&this._toggleClasses(n,this._config.backdropClass,!1),clearTimeout(e)};n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{n.addEventListener("transitionend",r)}),n.style.pointerEvents="none",e=this._ngZone.runOutsideAngular(()=>setTimeout(r,500))}_toggleClasses(n,e,r){const i=rx(e||[]).filter(o=>!!o);i.length&&(r?n.classList.add(...i):n.classList.remove(...i))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const n=this._ngZone.onStable.pipe(Co(Ea(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),n.unsubscribe())})})}_disposeScrollStrategy(){const n=this._scrollStrategy;n&&(n.disable(),n.detach&&n.detach())}_disposeBackdrop(n){n&&(n.remove(),this._backdropElement===n&&(this._backdropElement=null))}}const i6="cdk-overlay-connected-position-bounding-box",Jae=/([A-Za-z%]+)$/;class ese{constructor(n,e,r,i,o){this._viewportRuler=e,this._document=r,this._platform=i,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Bt,this._resizeSubscription=br.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(n)}get positions(){return this._preferredPositions}attach(n){this._validatePositions(),n.hostElement.classList.add(i6),this._overlayRef=n,this._boundingBox=n.hostElement,this._pane=n.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const n=this._originRect,e=this._overlayRect,r=this._viewportRect,i=[];let o;for(let a of this._preferredPositions){let s=this._getOriginPoint(n,a),l=this._getOverlayPoint(s,e,a),c=this._getOverlayFit(l,e,r,a);if(c.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,s);this._canFitWithFlexibleDimensions(c,l,r)?i.push({position:a,origin:s,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(s,a)}):(!o||o.overlayFit.visibleArea<c.visibleArea)&&(o={overlayFit:c,overlayPoint:l,originPoint:s,position:a,overlayRect:e})}if(i.length){let a=null,s=-1;for(const l of i){const c=l.boundingBoxRect.width*l.boundingBoxRect.height*(l.position.weight||1);c>s&&(s=c,a=l)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&t0(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(i6),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const n=this._lastPosition||this._preferredPositions[0],e=this._getOriginPoint(this._originRect,n);this._applyPosition(n,e)}}withScrollableContainers(n){return this._scrollables=n,this}withPositions(n){return this._preferredPositions=n,-1===n.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(n){return this._viewportMargin=n,this}withFlexibleDimensions(n=!0){return this._hasFlexibleDimensions=n,this}withGrowAfterOpen(n=!0){return this._growAfterOpen=n,this}withPush(n=!0){return this._canPush=n,this}withLockedPosition(n=!0){return this._positionLocked=n,this}setOrigin(n){return this._origin=n,this}withDefaultOffsetX(n){return this._offsetX=n,this}withDefaultOffsetY(n){return this._offsetY=n,this}withTransformOriginOn(n){return this._transformOriginSelector=n,this}_getOriginPoint(n,e){let r,i;if("center"==e.originX)r=n.left+n.width/2;else{const o=this._isRtl()?n.right:n.left,a=this._isRtl()?n.left:n.right;r="start"==e.originX?o:a}return i="center"==e.originY?n.top+n.height/2:"top"==e.originY?n.top:n.bottom,{x:r,y:i}}_getOverlayPoint(n,e,r){let i,o;return i="center"==r.overlayX?-e.width/2:"start"===r.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,o="center"==r.overlayY?-e.height/2:"top"==r.overlayY?0:-e.height,{x:n.x+i,y:n.y+o}}_getOverlayFit(n,e,r,i){const o=a6(e);let{x:a,y:s}=n,l=this._getOffset(i,"x"),c=this._getOffset(i,"y");l&&(a+=l),c&&(s+=c);let E=0-s,D=s+o.height-r.height,k=this._subtractOverflows(o.width,0-a,a+o.width-r.width),T=this._subtractOverflows(o.height,E,D),R=k*T;return{visibleArea:R,isCompletelyWithinViewport:o.width*o.height===R,fitsInViewportVertically:T===o.height,fitsInViewportHorizontally:k==o.width}}_canFitWithFlexibleDimensions(n,e,r){if(this._hasFlexibleDimensions){const i=r.bottom-e.y,o=r.right-e.x,a=o6(this._overlayRef.getConfig().minHeight),s=o6(this._overlayRef.getConfig().minWidth);return(n.fitsInViewportVertically||null!=a&&a<=i)&&(n.fitsInViewportHorizontally||null!=s&&s<=o)}return!1}_pushOverlayOnScreen(n,e,r){if(this._previousPushAmount&&this._positionLocked)return{x:n.x+this._previousPushAmount.x,y:n.y+this._previousPushAmount.y};const i=a6(e),o=this._viewportRect,a=Math.max(n.x+i.width-o.width,0),s=Math.max(n.y+i.height-o.height,0),l=Math.max(o.top-r.top-n.y,0),c=Math.max(o.left-r.left-n.x,0);let f=0,v=0;return f=i.width<=o.width?c||-a:n.x<this._viewportMargin?o.left-r.left-n.x:0,v=i.height<=o.height?l||-s:n.y<this._viewportMargin?o.top-r.top-n.y:0,this._previousPushAmount={x:f,y:v},{x:n.x+f,y:n.y+v}}_applyPosition(n,e){if(this._setTransformOrigin(n),this._setOverlayElementStyles(e,n),this._setBoundingBoxStyles(e,n),n.panelClass&&this._addPanelClasses(n.panelClass),this._lastPosition=n,this._positionChanges.observers.length){const r=this._getScrollVisibility(),i=new Xae(n,r);this._positionChanges.next(i)}this._isInitialRender=!1}_setTransformOrigin(n){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,i=n.overlayY;r="center"===n.overlayX?"center":this._isRtl()?"start"===n.overlayX?"right":"left":"start"===n.overlayX?"left":"right";for(let o=0;o<e.length;o++)e[o].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(n,e){const r=this._viewportRect,i=this._isRtl();let o,a,s,f,v,E;if("top"===e.overlayY)a=n.y,o=r.height-a+this._viewportMargin;else if("bottom"===e.overlayY)s=r.height-n.y+2*this._viewportMargin,o=r.height-s+this._viewportMargin;else{const D=Math.min(r.bottom-n.y+r.top,n.y),k=this._lastBoundingBoxSize.height;o=2*D,a=n.y-D,o>k&&!this._isInitialRender&&!this._growAfterOpen&&(a=n.y-k/2)}if("end"===e.overlayX&&!i||"start"===e.overlayX&&i)E=r.width-n.x+this._viewportMargin,f=n.x-this._viewportMargin;else if("start"===e.overlayX&&!i||"end"===e.overlayX&&i)v=n.x,f=r.right-n.x;else{const D=Math.min(r.right-n.x+r.left,n.x),k=this._lastBoundingBoxSize.width;f=2*D,v=n.x-D,f>k&&!this._isInitialRender&&!this._growAfterOpen&&(v=n.x-k/2)}return{top:a,left:v,bottom:s,right:E,width:f,height:o}}_setBoundingBoxStyles(n,e){const r=this._calculateBoundingBoxRect(n,e);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right=i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{const o=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;i.height=ms(r.height),i.top=ms(r.top),i.bottom=ms(r.bottom),i.width=ms(r.width),i.left=ms(r.left),i.right=ms(r.right),i.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",i.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",o&&(i.maxHeight=ms(o)),a&&(i.maxWidth=ms(a))}this._lastBoundingBoxSize=r,t0(this._boundingBox.style,i)}_resetBoundingBoxStyles(){t0(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){t0(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(n,e){const r={},i=this._hasExactPosition(),o=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(i){const f=this._viewportRuler.getViewportScrollPosition();t0(r,this._getExactOverlayY(e,n,f)),t0(r,this._getExactOverlayX(e,n,f))}else r.position="static";let s="",l=this._getOffset(e,"x"),c=this._getOffset(e,"y");l&&(s+=`translateX(${l}px) `),c&&(s+=`translateY(${c}px)`),r.transform=s.trim(),a.maxHeight&&(i?r.maxHeight=ms(a.maxHeight):o&&(r.maxHeight="")),a.maxWidth&&(i?r.maxWidth=ms(a.maxWidth):o&&(r.maxWidth="")),t0(this._pane.style,r)}_getExactOverlayY(n,e,r){let i={top:"",bottom:""},o=this._getOverlayPoint(e,this._overlayRect,n);this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r));let a=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return o.y-=a,"bottom"===n.overlayY?i.bottom=this._document.documentElement.clientHeight-(o.y+this._overlayRect.height)+"px":i.top=ms(o.y),i}_getExactOverlayX(n,e,r){let a,i={left:"",right:""},o=this._getOverlayPoint(e,this._overlayRect,n);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),a=this._isRtl()?"end"===n.overlayX?"left":"right":"end"===n.overlayX?"right":"left","right"===a?i.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":i.left=ms(o.x),i}_getScrollVisibility(){const n=this._getOriginRect(),e=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:n6(n,r),isOriginOutsideView:RD(n,r),isOverlayClipped:n6(e,r),isOverlayOutsideView:RD(e,r)}}_subtractOverflows(n,...e){return e.reduce((r,i)=>r-Math.max(i,0),n)}_getNarrowedViewportRect(){const n=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+n-this._viewportMargin,bottom:r.top+e-this._viewportMargin,width:n-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(n,e){return"x"===e?null==n.offsetX?this._offsetX:n.offsetX:null==n.offsetY?this._offsetY:n.offsetY}_validatePositions(){}_addPanelClasses(n){this._pane&&rx(n).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(n=>{this._pane.classList.remove(n)}),this._appliedPanelClasses=[])}_getOriginRect(){const n=this._origin;if(n instanceof $r)return n.nativeElement.getBoundingClientRect();if(n instanceof Element)return n.getBoundingClientRect();const e=n.width||0,r=n.height||0;return{top:n.y,bottom:n.y+r,left:n.x,right:n.x+e,height:r,width:e}}}function t0(t,n){for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}function o6(t){if("number"!=typeof t&&null!=t){const[n,e]=t.split(Jae);return e&&"px"!==e?null:parseFloat(n)}return t||null}function a6(t){return{top:Math.floor(t.top),right:Math.floor(t.right),bottom:Math.floor(t.bottom),left:Math.floor(t.left),width:Math.floor(t.width),height:Math.floor(t.height)}}const s6="cdk-global-overlay-wrapper";class tse{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(n){const e=n.getConfig();this._overlayRef=n,this._width&&!e.width&&n.updateSize({width:this._width}),this._height&&!e.height&&n.updateSize({height:this._height}),n.hostElement.classList.add(s6),this._isDisposed=!1}top(n=""){return this._bottomOffset="",this._topOffset=n,this._alignItems="flex-start",this}left(n=""){return this._rightOffset="",this._leftOffset=n,this._justifyContent="flex-start",this}bottom(n=""){return this._topOffset="",this._bottomOffset=n,this._alignItems="flex-end",this}right(n=""){return this._leftOffset="",this._rightOffset=n,this._justifyContent="flex-end",this}width(n=""){return this._overlayRef?this._overlayRef.updateSize({width:n}):this._width=n,this}height(n=""){return this._overlayRef?this._overlayRef.updateSize({height:n}):this._height=n,this}centerHorizontally(n=""){return this.left(n),this._justifyContent="center",this}centerVertically(n=""){return this.top(n),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const n=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:o,maxWidth:a,maxHeight:s}=r,l=!("100%"!==i&&"100vw"!==i||a&&"100%"!==a&&"100vw"!==a),c=!("100%"!==o&&"100vh"!==o||s&&"100%"!==s&&"100vh"!==s);n.position=this._cssPosition,n.marginLeft=l?"0":this._leftOffset,n.marginTop=c?"0":this._topOffset,n.marginBottom=this._bottomOffset,n.marginRight=this._rightOffset,l?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const n=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,r=e.style;e.classList.remove(s6),r.justifyContent=r.alignItems=n.marginTop=n.marginBottom=n.marginLeft=n.marginRight=n.position="",this._overlayRef=null,this._isDisposed=!0}}let nse=(()=>{class t{constructor(e,r,i,o){this._viewportRuler=e,this._document=r,this._platform=i,this._overlayContainer=o}global(){return new tse}flexibleConnectedTo(e){return new ese(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return t.\u0275fac=function(e){return new(e||t)(it(e0),it(si),it(Ka),it(LD))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),rse=0,Rh=(()=>{class t{constructor(e,r,i,o,a,s,l,c,f,v,E){this.scrollStrategies=e,this._overlayContainer=r,this._componentFactoryResolver=i,this._positionBuilder=o,this._keyboardDispatcher=a,this._injector=s,this._ngZone=l,this._document=c,this._directionality=f,this._location=v,this._outsideClickDispatcher=E}create(e){const r=this._createHostElement(),i=this._createPaneElement(r),o=this._createPortalOutlet(i),a=new Xb(e);return a.direction=a.direction||this._directionality.value,new Qae(o,r,i,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(e){const r=this._document.createElement("div");return r.id="cdk-overlay-"+rse++,r.classList.add("cdk-overlay-pane"),e.appendChild(r),r}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(N1)),new uae(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return t.\u0275fac=function(e){return new(e||t)(it(qae),it(LD),it(Bp),it(nse),it(Kae),it(js),it(Wr),it(si),it(su),it(xv),it(Zae))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();const ase={provide:new U("cdk-connected-overlay-scroll-strategy"),deps:[Rh],useFactory:function ose(t){return()=>t.scrollStrategies.reposition()}};let hx=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:[Rh,ase],imports:[[qb,ux,JR],JR]}),t})();const sse=["mat-menu-item",""];function lse(t,n){1&t&&(Ns(),d(0,"svg",2),qe(1,"polygon",3),u())}const l6=["*"];function cse(t,n){if(1&t){const e=Fn();d(0,"div",0),De("keydown",function(i){return ht(e),pt(ae()._handleKeydown(i))})("click",function(){return ht(e),pt(ae().closed.emit("click"))})("@transformMenu.start",function(i){return ht(e),pt(ae()._onAnimationStart(i))})("@transformMenu.done",function(i){return ht(e),pt(ae()._onAnimationDone(i))}),d(1,"div",1),Ri(2),u()()}if(2&t){const e=ae();N("id",e.panelId)("ngClass",e._classList)("@transformMenu",e._panelAnimationState),kr("aria-label",e.ariaLabel||null)("aria-labelledby",e.ariaLabelledby||null)("aria-describedby",e.ariaDescribedby||null)}}const px={transformMenu:Zg("transformMenu",[Gu("void",wa({opacity:0,transform:"scale(0.8)"})),au("void => enter",ou("120ms cubic-bezier(0, 0, 0.2, 1)",wa({opacity:1,transform:"scale(1)"}))),au("* => void",ou("100ms 25ms linear",wa({opacity:0})))]),fadeInItems:Zg("fadeInItems",[Gu("showing",wa({opacity:1})),au("void => *",[wa({opacity:0}),ou("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},use=new U("MatMenuContent"),BD=new U("MAT_MENU_PANEL"),dse=Oh(m_(class{}));let Of=(()=>{class t extends dse{constructor(e,r,i,o,a){super(),this._elementRef=e,this._focusMonitor=i,this._parentMenu=o,this._changeDetectorRef=a,this.role="menuitem",this._hovered=new Bt,this._focused=new Bt,this._highlighted=!1,this._triggersSubmenu=!1,o&&o.addItem&&o.addItem(this)}focus(e,r){this._focusMonitor&&e?this._focusMonitor.focusVia(this._getHostElement(),e,r):this._getHostElement().focus(r),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const e=this._elementRef.nativeElement.cloneNode(!0),r=e.querySelectorAll("mat-icon, .material-icons");for(let i=0;i<r.length;i++)r[i].remove();return e.textContent?.trim()||""}_setHighlighted(e){this._highlighted=e,this._changeDetectorRef?.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(si),X(fm),X(BD,8),X(Zo))},t.\u0275cmp=pr({type:t,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:10,hostBindings:function(e,r){1&e&&De("click",function(o){return r._checkDisabled(o)})("mouseenter",function(){return r._handleMouseEnter()}),2&e&&(kr("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled.toString())("disabled",r.disabled||null),Ai("mat-menu-item",!0)("mat-menu-item-highlighted",r._highlighted)("mat-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[_r],attrs:sse,ngContentSelectors:l6,decls:3,vars:3,consts:[["matRipple","",1,"mat-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-menu-submenu-icon","viewBox","0 0 5 10","focusable","false",4,"ngIf"],["viewBox","0 0 5 10","focusable","false",1,"mat-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(e,r){1&e&&(Fa(),Ri(0),qe(1,"div",0),oe(2,lse,2,0,"svg",1)),2&e&&(w(1),N("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),w(1),N("ngIf",r._triggersSubmenu))},dependencies:[Nh,Fi],encapsulation:2,changeDetection:0}),t})();const c6=new U("mat-menu-default-options",{providedIn:"root",factory:function fse(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let hse=0,Kb=(()=>{class t{constructor(e,r,i){this._elementRef=e,this._ngZone=r,this._defaultOptions=i,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._directDescendantItems=new Hp,this._tabSubscription=br.EMPTY,this._classList={},this._panelAnimationState="void",this._animationDone=new Bt,this.overlayPanelClass=this._defaultOptions.overlayPanelClass||"",this.backdropClass=this._defaultOptions.backdropClass,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop,this.closed=new Vr,this.close=this.closed,this.panelId="mat-menu-panel-"+hse++}get xPosition(){return this._xPosition}set xPosition(e){this._xPosition=e,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(e){this._yPosition=e,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(e){this._overlapTrigger=Bo(e)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=Bo(e)}set panelClass(e){const r=this._previousPanelClass;r&&r.length&&r.split(" ").forEach(i=>{this._classList[i]=!1}),this._previousPanelClass=e,e&&e.length&&(e.split(" ").forEach(i=>{this._classList[i]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(e){this.panelClass=e}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new CD(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._tabSubscription=this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(ec(this._directDescendantItems),Di(e=>Ea(...e.map(r=>r._focused)))).subscribe(e=>this._keyManager.updateActiveItem(e))}ngOnDestroy(){this._directDescendantItems.destroy(),this._tabSubscription.unsubscribe(),this.closed.complete()}_hovered(){return this._directDescendantItems.changes.pipe(ec(this._directDescendantItems),Di(r=>Ea(...r.map(i=>i._hovered))))}addItem(e){}removeItem(e){}_handleKeydown(e){const r=e.keyCode,i=this._keyManager;switch(r){case 27:Ad(e)||(e.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:(38===r||40===r)&&i.setFocusOrigin("keyboard"),i.onKeydown(e)}}focusFirstItem(e="program"){this.lazyContent?this._ngZone.onStable.pipe(ra(1)).subscribe(()=>this._focusFirstItem(e)):this._focusFirstItem(e)}_focusFirstItem(e){const r=this._keyManager;if(r.setFocusOrigin(e).setFirstItemActive(),!r.activeItem&&this._directDescendantItems.length){let i=this._directDescendantItems.first._getHostElement().parentElement;for(;i;){if("menu"===i.getAttribute("role")){i.focus();break}i=i.parentElement}}}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(e){const r=Math.min(this._baseElevation+e,24),i=`${this._elevationPrefix}${r}`,o=Object.keys(this._classList).find(a=>a.startsWith(this._elevationPrefix));(!o||o===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[i]=!0,this._previousElevation=i)}setPositionClasses(e=this.xPosition,r=this.yPosition){const i=this._classList;i["mat-menu-before"]="before"===e,i["mat-menu-after"]="after"===e,i["mat-menu-above"]="above"===r,i["mat-menu-below"]="below"===r}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(e){this._animationDone.next(e),this._isAnimating=!1}_onAnimationStart(e){this._isAnimating=!0,"enter"===e.toState&&0===this._keyManager.activeItemIndex&&(e.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(ec(this._allItems)).subscribe(e=>{this._directDescendantItems.reset(e.filter(r=>r._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Wr),X(c6))},t.\u0275dir=jn({type:t,contentQueries:function(e,r,i){if(1&e&&(so(i,use,5),so(i,Of,5),so(i,Of,4)),2&e){let o;Er(o=Sr())&&(r.lazyContent=o.first),Er(o=Sr())&&(r._allItems=o),Er(o=Sr())&&(r.items=o)}},viewQuery:function(e,r){if(1&e&&Ko(Zl,5),2&e){let i;Er(i=Sr())&&(r.templateRef=i.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),t})(),n0=(()=>{class t extends Kb{constructor(e,r,i){super(e,r,i),this._elevationPrefix="mat-elevation-z",this._baseElevation=4}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Wr),X(c6))},t.\u0275cmp=pr({type:t,selectors:[["mat-menu"]],hostVars:3,hostBindings:function(e,r){2&e&&kr("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[ki([{provide:BD,useExisting:t}]),_r],ngContentSelectors:l6,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-menu-panel",3,"id","ngClass","keydown","click"],[1,"mat-menu-content"]],template:function(e,r){1&e&&(Fa(),oe(0,cse,3,6,"ng-template"))},dependencies:[wf],styles:["mat-menu{display:none}.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:4px;outline:0;min-height:64px}.mat-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-menu-panel{outline:solid 1px}.mat-menu-content:not(:empty){padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative}.mat-menu-item::-moz-focus-inner{border:0}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item[disabled]{pointer-events:none}.cdk-high-contrast-active .mat-menu-item{margin-top:1px}.cdk-high-contrast-active .mat-menu-item.cdk-program-focused,.cdk-high-contrast-active .mat-menu-item.cdk-keyboard-focused,.cdk-high-contrast-active .mat-menu-item-highlighted{outline:dotted 1px}.mat-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-menu-submenu-icon{fill:CanvasText}button.mat-menu-item{width:100%}.mat-menu-item .mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}\n"],encapsulation:2,data:{animation:[px.transformMenu,px.fadeInItems]},changeDetection:0}),t})();const u6=new U("mat-menu-scroll-strategy"),mse={provide:u6,deps:[Rh],useFactory:function pse(t){return()=>t.scrollStrategies.reposition()}},f6=f_({passive:!0});let gse=(()=>{class t{constructor(e,r,i,o,a,s,l,c){this._overlay=e,this._element=r,this._viewContainerRef=i,this._menuItemInstance=s,this._dir=l,this._focusMonitor=c,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=br.EMPTY,this._hoverSubscription=br.EMPTY,this._menuCloseSubscription=br.EMPTY,this._handleTouchStart=f=>{DD(f)||(this._openedBy="touch")},this._openedBy=void 0,this._ariaHaspopup=!0,this.restoreFocus=!0,this.menuOpened=new Vr,this.onMenuOpen=this.menuOpened,this.menuClosed=new Vr,this.onMenuClose=this.menuClosed,this._scrollStrategy=o,this._parentMaterialMenu=a instanceof Kb?a:void 0,r.nativeElement.addEventListener("touchstart",this._handleTouchStart,f6),s&&(s._triggersSubmenu=this.triggersSubmenu())}get _ariaExpanded(){return this.menuOpen||null}get _ariaControl(){return this.menuOpen?this.menu.panelId:null}get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(e){this.menu=e}get menu(){return this._menu}set menu(e){e!==this._menu&&(this._menu=e,this._menuCloseSubscription.unsubscribe(),e&&(this._menuCloseSubscription=e.close.subscribe(r=>{this._destroyMenu(r),("click"===r||"tab"===r)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(r)})))}ngAfterContentInit(){this._checkMenu(),this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,f6),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!(!this._menuItemInstance||!this._parentMaterialMenu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){if(this._menuOpen)return;this._checkMenu();const e=this._createOverlay(),r=e.getConfig();this._setPosition(r.positionStrategy),r.hasBackdrop=null==this.menu.hasBackdrop?!this.triggersSubmenu():this.menu.hasBackdrop,e.attach(this._getPortal()),this.menu.lazyContent&&this.menu.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(),this.menu instanceof Kb&&this.menu._startAnimation()}closeMenu(){this.menu.close.emit()}focus(e,r){this._focusMonitor&&e?this._focusMonitor.focusVia(this._element,e,r):this._element.nativeElement.focus(r)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(e){if(!this._overlayRef||!this.menuOpen)return;const r=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===e||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,r instanceof Kb?(r._resetAnimation(),r.lazyContent?r._animationDone.pipe(_o(i=>"void"===i.toState),ra(1),Co(r.lazyContent._attached)).subscribe({next:()=>r.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),r.lazyContent&&r.lazyContent.detach())}_initMenu(){this.menu.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,this.menu.direction=this.dir,this._setMenuElevation(),this.menu.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(){if(this.menu.setElevation){let e=0,r=this.menu.parentMenu;for(;r;)e++,r=r.parentMenu;this.menu.setElevation(e)}}_setIsMenuOpen(e){this._menuOpen=e,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(e)}_checkMenu(){}_createOverlay(){if(!this._overlayRef){const e=this._getOverlayConfig();this._subscribeToPositions(e.positionStrategy),this._overlayRef=this._overlay.create(e),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(){return new Xb({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:this.menu.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:this.menu.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(e){this.menu.setPositionClasses&&e.positionChanges.subscribe(r=>{this.menu.setPositionClasses("start"===r.connectionPair.overlayX?"after":"before","top"===r.connectionPair.overlayY?"below":"above")})}_setPosition(e){let[r,i]="before"===this.menu.xPosition?["end","start"]:["start","end"],[o,a]="above"===this.menu.yPosition?["bottom","top"]:["top","bottom"],[s,l]=[o,a],[c,f]=[r,i],v=0;this.triggersSubmenu()?(f=r="before"===this.menu.xPosition?"start":"end",i=c="end"===r?"start":"end",v="bottom"===o?8:-8):this.menu.overlapTrigger||(s="top"===o?"bottom":"top",l="top"===a?"bottom":"top"),e.withPositions([{originX:r,originY:s,overlayX:c,overlayY:o,offsetY:v},{originX:i,originY:s,overlayX:f,overlayY:o,offsetY:v},{originX:r,originY:l,overlayX:c,overlayY:a,offsetY:-v},{originX:i,originY:l,overlayX:f,overlayY:a,offsetY:-v}])}_menuClosingActions(){const e=this._overlayRef.backdropClick(),r=this._overlayRef.detachments();return Ea(e,this._parentMaterialMenu?this._parentMaterialMenu.closed:On(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(_o(a=>a!==this._menuItemInstance),_o(()=>this._menuOpen)):On(),r)}_handleMousedown(e){SD(e)||(this._openedBy=0===e.button?"mouse":void 0,this.triggersSubmenu()&&e.preventDefault())}_handleKeydown(e){const r=e.keyCode;(13===r||32===r)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===r&&"ltr"===this.dir||37===r&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(e){this.triggersSubmenu()?(e.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(_o(e=>e===this._menuItemInstance&&!e.disabled),FD(0,MD)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof Kb&&this.menu._isAnimating?this.menu._animationDone.pipe(ra(1),FD(0,MD),Co(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(){return(!this._portal||this._portal.templateRef!==this.menu.templateRef)&&(this._portal=new p_(this.menu.templateRef,this._viewContainerRef)),this._portal}}return t.\u0275fac=function(e){return new(e||t)(X(Rh),X($r),X(Ml),X(u6),X(BD,8),X(Of,10),X(su,8),X(fm))},t.\u0275dir=jn({type:t,hostVars:3,hostBindings:function(e,r){1&e&&De("mousedown",function(o){return r._handleMousedown(o)})("keydown",function(o){return r._handleKeydown(o)})("click",function(o){return r._handleClick(o)}),2&e&&kr("aria-expanded",r._ariaExpanded)("aria-controls",r._ariaControl)("aria-haspopup",r._ariaHaspopup)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),t})(),r0=(()=>{class t extends gse{}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-menu-trigger"],exportAs:["matMenuTrigger"],features:[_r]}),t})(),_se=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:[mse],imports:[[xf,Wi,g_,hx],__,Wi]}),t})();const vse=["*"];let mx;function Zb(t){return function bse(){if(void 0===mx&&(mx=null,typeof window<"u")){const t=window;void 0!==t.trustedTypes&&(mx=t.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return mx}()?.createHTML(t)||t}function h6(t){return Error(`Unable to find icon with the name "${t}"`)}function p6(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function m6(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}class o0{constructor(n,e,r){this.url=n,this.svgText=e,this.options=r}}let gx=(()=>{class t{constructor(e,r,i,o){this._httpClient=e,this._sanitizer=r,this._errorHandler=o,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=i}addSvgIcon(e,r,i){return this.addSvgIconInNamespace("",e,r,i)}addSvgIconLiteral(e,r,i){return this.addSvgIconLiteralInNamespace("",e,r,i)}addSvgIconInNamespace(e,r,i,o){return this._addSvgIconConfig(e,r,new o0(i,null,o))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,r,i,o){const a=this._sanitizer.sanitize(Ji.HTML,i);if(!a)throw m6(i);const s=Zb(a);return this._addSvgIconConfig(e,r,new o0("",s,o))}addSvgIconSet(e,r){return this.addSvgIconSetInNamespace("",e,r)}addSvgIconSetLiteral(e,r){return this.addSvgIconSetLiteralInNamespace("",e,r)}addSvgIconSetInNamespace(e,r,i){return this._addSvgIconSetConfig(e,new o0(r,null,i))}addSvgIconSetLiteralInNamespace(e,r,i){const o=this._sanitizer.sanitize(Ji.HTML,r);if(!o)throw m6(r);const a=Zb(o);return this._addSvgIconSetConfig(e,new o0("",a,i))}registerFontClassAlias(e,r=e){return this._fontCssClassesByAlias.set(e,r),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const r=this._sanitizer.sanitize(Ji.RESOURCE_URL,e);if(!r)throw p6(e);const i=this._cachedIconsByUrl.get(r);return i?On(_x(i)):this._loadSvgIconFromConfig(new o0(e,null)).pipe(Ya(o=>this._cachedIconsByUrl.set(r,o)),gr(o=>_x(o)))}getNamedSvgIcon(e,r=""){const i=g6(r,e);let o=this._svgIconConfigs.get(i);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(r,e),o)return this._svgIconConfigs.set(i,o),this._getSvgFromConfig(o);const a=this._iconSetConfigs.get(r);return a?this._getSvgFromIconSetConfigs(e,a):It(h6(i))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?On(_x(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(gr(r=>_x(r)))}_getSvgFromIconSetConfigs(e,r){const i=this._extractIconWithNameFromAnySet(e,r);return i?On(i):Rk(r.filter(a=>!a.svgText).map(a=>this._loadSvgIconSetFromConfig(a).pipe(Pt(s=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(Ji.RESOURCE_URL,a.url)} failed: ${s.message}`;return this._errorHandler.handleError(new Error(c)),On(null)})))).pipe(gr(()=>{const a=this._extractIconWithNameFromAnySet(e,r);if(!a)throw h6(e);return a}))}_extractIconWithNameFromAnySet(e,r){for(let i=r.length-1;i>=0;i--){const o=r[i];if(o.svgText&&o.svgText.toString().indexOf(e)>-1){const a=this._svgElementFromConfig(o),s=this._extractSvgIconFromSet(a,e,o.options);if(s)return s}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Ya(r=>e.svgText=r),gr(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?On(null):this._fetchIcon(e).pipe(Ya(r=>e.svgText=r))}_extractSvgIconFromSet(e,r,i){const o=e.querySelector(`[id="${r}"]`);if(!o)return null;const a=o.cloneNode(!0);if(a.removeAttribute("id"),"svg"===a.nodeName.toLowerCase())return this._setSvgAttributes(a,i);if("symbol"===a.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(a),i);const s=this._svgElementFromString(Zb("<svg></svg>"));return s.appendChild(a),this._setSvgAttributes(s,i)}_svgElementFromString(e){const r=this._document.createElement("DIV");r.innerHTML=e;const i=r.querySelector("svg");if(!i)throw Error("<svg> tag not found");return i}_toSvgElement(e){const r=this._svgElementFromString(Zb("<svg></svg>")),i=e.attributes;for(let o=0;o<i.length;o++){const{name:a,value:s}=i[o];"id"!==a&&r.setAttribute(a,s)}for(let o=0;o<e.childNodes.length;o++)e.childNodes[o].nodeType===this._document.ELEMENT_NODE&&r.appendChild(e.childNodes[o].cloneNode(!0));return r}_setSvgAttributes(e,r){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),r&&r.viewBox&&e.setAttribute("viewBox",r.viewBox),e}_fetchIcon(e){const{url:r,options:i}=e,o=i?.withCredentials??!1;if(!this._httpClient)throw function yse(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const a=this._sanitizer.sanitize(Ji.RESOURCE_URL,r);if(!a)throw p6(r);const s=this._inProgressUrlFetches.get(a);if(s)return s;const l=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(gr(c=>Zb(c)),Bv(()=>this._inProgressUrlFetches.delete(a)),Yh());return this._inProgressUrlFetches.set(a,l),l}_addSvgIconConfig(e,r,i){return this._svgIconConfigs.set(g6(e,r),i),this}_addSvgIconSetConfig(e,r){const i=this._iconSetConfigs.get(e);return i?i.push(r):this._iconSetConfigs.set(e,[r]),this}_svgElementFromConfig(e){if(!e.svgElement){const r=this._svgElementFromString(e.svgText);this._setSvgAttributes(r,e.options),e.svgElement=r}return e.svgElement}_getIconConfigFromResolvers(e,r){for(let i=0;i<this._resolvers.length;i++){const o=this._resolvers[i](r,e);if(o)return xse(o)?new o0(o.url,null,o.options):new o0(o,null)}}}return t.\u0275fac=function(e){return new(e||t)(it(Fl,8),it(ZE),it(si,8),it(ph))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function _x(t){return t.cloneNode(!0)}function g6(t,n){return t+":"+n}function xse(t){return!(!t.url||!t.options)}const Cse=Jg(class{constructor(t){this._elementRef=t}}),Ese=new U("mat-icon-location",{providedIn:"root",factory:function Sse(){const t=Xr(si),n=t?t.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),_6=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Dse=_6.map(t=>`[${t}]`).join(", "),Ase=/^url\(['"]?#(.*?)['"]?\)$/;let Wo=(()=>{class t extends Cse{constructor(e,r,i,o,a){super(e),this._iconRegistry=r,this._location=o,this._errorHandler=a,this._inline=!1,this._currentIconFetch=br.EMPTY,i||e.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(e){this._inline=Bo(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const r=this._cleanupFontValue(e);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const r=this._cleanupFontValue(e);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}_splitIconName(e){if(!e)return["",""];const r=e.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const r=e.querySelectorAll("style");for(let o=0;o<r.length;o++)r[o].textContent+=" ";const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let r=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){const i=e.childNodes[r];(1!==i.nodeType||"svg"===i.nodeName.toLowerCase())&&i.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,r=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();r!=this._previousFontSetClass&&(this._previousFontSetClass&&e.classList.remove(this._previousFontSetClass),r&&e.classList.add(r),this._previousFontSetClass=r),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const r=this._elementsWithExternalReferences;r&&r.forEach((i,o)=>{i.forEach(a=>{o.setAttribute(a.name,`url('${e}#${a.value}')`)})})}_cacheChildrenWithExternalReferences(e){const r=e.querySelectorAll(Dse),i=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<r.length;o++)_6.forEach(a=>{const s=r[o],l=s.getAttribute(a),c=l?l.match(Ase):null;if(c){let f=i.get(s);f||(f=[],i.set(s,f)),f.push({name:a,value:c[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[r,i]=this._splitIconName(e);r&&(this._svgNamespace=r),i&&(this._svgName=i),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(i,r).pipe(ra(1)).subscribe(o=>this._setSvgElement(o),o=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${r}:${i}! ${o.message}`))})}}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(gx),jc("aria-hidden"),X(Ese),X(ph))},t.\u0275cmp=pr({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(e,r){2&e&&(kr("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet),Ai("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[_r],ngContentSelectors:vse,decls:1,vars:0,template:function(e,r){1&e&&(Fa(),Ri(0))},styles:[".mat-icon{-webkit-user-select:none;-moz-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),t})(),Tse=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[Wi],Wi]}),t})();function Mse(t,n){if(1&t&&(d(0,"option",37),h(1),u()),2&t){const e=n.$implicit,r=ae();N("ngValue",e.codigo)("selected",r.parametro==e.codigo),w(1),_e(e.nombre)}}function kse(t,n){if(1&t&&(d(0,"option",37),h(1),u()),2&t){const e=n.$implicit,r=ae();N("ngValue",e.codigo)("selected",r.parametro==e.codigo),w(1),_e(e.nombre)}}function Fse(t,n){if(1&t){const e=Fn();d(0,"button",38),De("click",function(){return ht(e),pt(ae().mostrarInactivos())}),h(1," Bodegas Inactivas "),u()}}function Ise(t,n){if(1&t){const e=Fn();d(0,"button",38),De("click",function(){return ht(e),pt(ae().mostrarActivos())}),h(1," Bodegas activas "),u()}}const a0=function(){return{color:"green"}};function Pse(t,n){if(1&t){const e=Fn();d(0,"button",33),De("click",function(){return ht(e),pt(ae().reporteBodegaEntregasDetalldasTodas())}),d(1,"mat-icon",34),h(2,"art_track"),u(),d(3,"span"),h(4,"Entregas detalladas"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,a0)))}const vx=function(){return{color:"#2BB6D7"}};function Ose(t,n){if(1&t){const e=Fn();d(0,"button",33),De("click",function(){return ht(e),pt(ae().reporteExistenciasActualestotal())}),d(1,"mat-icon",34),h(2,"playlist_add_check"),u(),d(3,"span"),h(4,"Existencias actuales"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,vx)))}const Qb=function(){return{color:"orange"}};function Nse(t,n){if(1&t){const e=Fn();d(0,"button",33),De("click",function(){return ht(e),pt(ae().reportePendientesTodos())}),d(1,"mat-icon",34),h(2,"remove_circle_outline"),u(),d(3,"span"),h(4,"Consolidado de pendientes"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,Qb)))}function Rse(t,n){if(1&t){const e=Fn();d(0,"button",33),De("click",function(){return ht(e),pt(ae().reportePendientesDetalldos(0))}),d(1,"mat-icon",34),h(2,"blur_linear"),u(),d(3,"span"),h(4,"Detallado de pendientes"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,vx)))}function Lse(t,n){if(1&t){const e=Fn();d(0,"button",33),De("click",function(){return ht(e),pt(ae().reporteFormulasDetalldas(0,0))}),d(1,"mat-icon",34),h(2,"low_priority"),u(),d(3,"span"),h(4,"Detalle de formulas"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,a0)))}function Bse(t,n){if(1&t){const e=Fn();d(0,"button",33),De("click",function(){return ht(e),pt(ae().exportarMedicamentosNorotanxlsx(0))}),d(1,"mat-icon",34),h(2,"gps_off"),u(),d(3,"span"),h(4,"Medicamentos que no rotan"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,Qb)))}const s0=function(){return{color:"red"}};function jse(t,n){if(1&t){const e=Fn();d(0,"button",33),De("click",function(){return ht(e),pt(ae().exportarVencidosxlsx(0))}),d(1,"mat-icon",34),h(2,"report"),u(),d(3,"span"),h(4,"Medicamentos vencidos"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,s0)))}function Vse(t,n){1&t&&(d(0,"div",39),h(1," No hay registros para mostrar! "),u())}const jD=function(){return{color:"#009A94"}};function Use(t,n){if(1&t){const e=Fn();d(0,"mat-icon",49),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).mostrarRegistro(i))}),h(1,"edit"),u()}2&t&&N("ngStyle",Nt(1,jD))}function Hse(t,n){if(1&t){const e=Fn();d(0,"mat-icon",50),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).eliminarRegistro(i))}),h(1,"delete_sweep"),u()}2&t&&N("ngStyle",Nt(1,s0))}const zse=function(t){return{color:t}},$se=function(t){return["/menu/medicamentobodega",t]},Wse=function(t){return["/menu/pendiente",t]},v6=function(){return{color:"black"}},VD=function(){return{color:"blue"}};function qse(t,n){if(1&t){const e=Fn();d(0,"tr",34)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),u(),d(13,"td")(14,"mat-icon",43),h(15,"playlist_add_check"),u(),d(16,"mat-icon",44),h(17,"remove_circle_outline"),u()(),d(18,"td")(19,"mat-icon",45),h(20,"print"),u(),oe(21,Use,2,2,"mat-icon",46),oe(22,Hse,2,2,"mat-icon",47),d(23,"mat-menu",null,48)(25,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteBodegaEntregasDetalldas(o))}),d(26,"mat-icon",34),h(27,"art_track"),u(),d(28,"span"),h(29,"Entregas detalladas"),u()(),d(30,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteExistenciasActuales(o))}),d(31,"mat-icon",34),h(32,"playlist_add_check"),u(),d(33,"span"),h(34,"Existencias actuales PDF"),u()(),d(35,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).exportarExistenciasxlsx(o.idBodega))}),d(36,"mat-icon",34),h(37,"playlist_add_check"),u(),d(38,"span"),h(39,"Existencias actuales XLSX"),u()(),d(40,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reportePendientes(o))}),d(41,"mat-icon",34),h(42,"remove_circle_outline"),u(),d(43,"span"),h(44,"Consolidado de pendientes"),u()(),d(45,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reportePendientesDetalldos(o.idBodega))}),d(46,"mat-icon",34),h(47,"blur_linear"),u(),d(48,"span"),h(49,"Detallado de pendientes"),u()(),d(50,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteStopMinimo(o))}),d(51,"mat-icon",34),h(52,"vertical_align_bottom"),u(),d(53,"span"),h(54,"Por debajo de stock m\xednimo"),u()(),d(55,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteBodegaEntregas(o))}),d(56,"mat-icon",34),h(57,"low_priority"),u(),d(58,"span"),h(59,"Entregas consolidadas"),u()(),d(60,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteBodegaEntregasMeses(o))}),d(61,"mat-icon",34),h(62,"event_note"),u(),d(63,"span"),h(64,"Ent. consolidadas por meses"),u()(),d(65,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteFormulasDetalldas(o.idBodega,0))}),d(66,"mat-icon",34),h(67,"low_priority"),u(),d(68,"span"),h(69,"Detalle de formulas"),u()(),d(70,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteFormulasDetalldas(o.idBodega,1))}),d(71,"mat-icon",34),h(72,"block"),u(),d(73,"span"),h(74,"Formulas Anuladas"),u()(),d(75,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteFormulasNoProcesadas(o.idBodega))}),d(76,"mat-icon",34),h(77," live_help"),u(),d(78,"span"),h(79,"Formulas no procesadas"),u()(),d(80,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).exportarMedicamentosNorotanxlsx(o.idBodega))}),d(81,"mat-icon",34),h(82,"gps_off"),u(),d(83,"span"),h(84,"Medicamentos que no rotan"),u()(),d(85,"button",33),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).exportarVencidosxlsx(o.idBodega))}),d(86,"mat-icon",34),h(87,"report"),u(),d(88,"span"),h(89,"Medicamentos vencidos"),u()()()()()}if(2&t){const e=n.$implicit,r=n.index,i=go(24),o=ae(2);N("ngStyle",Si(28,zse,e.estado?"black":"red")),w(2),_e(r+1),w(2),_e(e.idBodega),w(2),_e(o.primerasmayusculas(e.nombre)),w(2),_e(o.primerasmayusculas(e.puntoEntrega)),w(2),_e(o.primerasmayusculas(e.direccion)),w(2),_e(o.primerasmayusculas(e.telefono)),w(2),N("ngStyle",Nt(30,jD))("routerLink",Si(31,$se,e.idBodega)),w(2),N("ngStyle",Nt(33,Qb))("routerLink",Si(34,Wse,e.idBodega)),w(3),N("ngStyle",Nt(36,jD))("matMenuTriggerFor",i),w(2),N("ngIf",o.tieneAcceso(3)),w(1),N("ngIf",o.tieneAcceso(3)),w(4),N("ngStyle",Nt(37,a0)),w(5),N("ngStyle",Nt(38,vx)),w(5),N("ngStyle",Nt(39,a0)),w(5),N("ngStyle",Nt(40,Qb)),w(5),N("ngStyle",Nt(41,vx)),w(5),N("ngStyle",Nt(42,v6)),w(5),N("ngStyle",Nt(43,a0)),w(5),N("ngStyle",Nt(44,VD)),w(5),N("ngStyle",Nt(45,a0)),w(5),N("ngStyle",Nt(46,s0)),w(5),N("ngStyle",Nt(47,s0)),w(5),N("ngStyle",Nt(48,Qb)),w(5),N("ngStyle",Nt(49,s0))}}function Gse(t,n){if(1&t&&(d(0,"div")(1,"table",40)(2,"thead",41)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"ID"),u(),d(8,"th"),h(9,"Nombre"),u(),d(10,"th"),h(11,"Punto de entrega"),u(),d(12,"th"),h(13,"Direcci\xf3n"),u(),d(14,"th"),h(15,"Tel\xe9fono"),u(),d(16,"th"),h(17,"Ver"),u(),d(18,"th"),h(19,"Gesti\xf3n"),u()()(),d(20,"tbody"),oe(21,qse,90,50,"tr",42),u()()()),2&t){const e=ae();w(21),N("ngForOf",e.listaregistros)}}let Yse=(()=>{class t{constructor(e,r,i){this.fb=e,this.servicio=r,this.servicioFormula=i,this.keyword="nomCompleto",this.lista=[],this.contador=NaN,this.mostrarActivos(),this.nombrebtn="Crear",this.banderaRegistro=!1,this.cargarDepartamentos()}ngOnInit(){this.crearFormulario();const e=new Date;new Date(e),this.hoy=e.toISOString().split("T")[0]}onDptoSeleccionado(){const e=this.generalForm.get("departamento")?.value;this.servicio.getMunicipiosDepartamento(e).subscribe(r=>{this.listaMpio=r},r=>{console.error(r)})}cargarDepartamentos(){this.servicio.getDepartamentos().subscribe(e=>{this.listaDpto=e},e=>{console.error(e)})}crearFormulario(){this.generalForm=this.fb.group({idBodega:[""],nombre:["",[Zn.required]],departamento:["",[Zn.required]],municipio:["",[Zn.required]],direccion:["",[Zn.required]],telefono:["",[Zn.required]],email:[""],puntoEntrega:["",[Zn.required]],estado:["true",[Zn.required]],dispensa:["false",[Zn.required]],inventario:["false",[Zn.required]],entrada:["false",[Zn.required]],salida:["false",[Zn.required]],fInicial:[""],fFinal:[""]})}mostrarRegistro(e){this.nombrebtn="Actualizar",this.servicio.getMunicipiosDepartamento(e.departamento).subscribe(r=>{this.listaMpio=r,this.generalForm.patchValue({idBodega:e.idBodega,nombre:e.nombre,puntoEntrega:e.puntoEntrega,departamento:e.departamento,municipio:e.municipio,direccion:e.direccion,telefono:e.telefono,email:e.email,estado:e.estado,dispensa:e.dispensa,inventario:e.inventario,entrada:e.entrada,salida:e.salida})},r=>{console.error(r)})}mostrarActivos(){this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e,this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);if(0===o){const a=r.puntoEntrega.localeCompare(i.puntoEntrega);return 0===a?r.puntoEntrega.localeCompare(i.puntoEntrega):a}return o})},e=>{console.error(e)}),this.banderaRegistro=!1}mostrarInactivos(){this.servicio.getRegistrosInactivos().subscribe(e=>{this.listaregistros=e,this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);if(0===o){const a=r.puntoEntrega.localeCompare(i.puntoEntrega);return 0===a?r.puntoEntrega.localeCompare(i.puntoEntrega):a}return o})},e=>{console.error(e)}),this.banderaRegistro=!0}create(){this.generalForm.value.usuario=localStorage.getItem("lidersistema"),"VALID"==this.generalForm.status?"Crear"==this.nombrebtn?this.servicio.create(this.generalForm.value).subscribe(e=>{this.mostrarActivos(),z().fire({icon:"success",title:"Ok",text:"La bodega ha sido creado correctamente"}),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar la bodega en la base de datos!",footer:e.mensaje})}):this.servicio.update(this.generalForm.value).subscribe(e=>{this.mostrarActivos(),this.nombrebtn="Crear",z().fire({icon:"success",title:"Ok",text:"La bodega ha sido actualizado correctameente"}),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo actualizar la bodega en la base de datos!",footer:e.mensaje})}):z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para crear la bodega en la base de datos!"})}eliminarRegistro(e){z().fire({title:"Desea eliminar?",text:"La bodega "+e.nombre+" - "+e.puntoEntrega+" de la base de datos.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.servicio.delete(e.idBodega).subscribe(i=>{this.listaregistros=this.listaregistros.filter(o=>o!==e),z().fire({icon:"success",title:"Ok",text:"La bodega ha sido eliminado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}reportePendientesTodos(){const e=this.generalForm.get("fInicial")?.value,r=this.generalForm.get("fFinal")?.value;e&&r?new Date(e)>new Date(r)?z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"}):this.datosPendientesTodos(0,e,r).then(a=>{const s=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let l="{total_pages_count_string}",c=1,f="Periodo del reporte del "+e+" al "+r;Zc()(s,{head:[["Nro","CUM","Nombre del medicamento","Presentaci\xf3n","Existencias","Pendientes"]],body:a,startY:25,theme:"striped",willDrawPage:function(D){s.setFontSize(11),s.setDrawColor(0);let k=s.internal.pageSize.getWidth()/2-s.getTextWidth("RELACION DE MEDICAMENTOS PENDIENTES")/2,T=s.getTextWidth("RELACION DE MEDICAMENTOS PENDIENTES");s.setDrawColor("#D3E3FD"),s.setFillColor("#D3E3FD"),s.roundedRect(k-10,9,T+20,7,3,3,"FD"),s.addImage("/assets/logo.png","JPEG",238,3,25,20),s.text("RELACION DE MEDICAMENTOS PENDIENTES",k,14),s.setTextColor("#000000"),k=s.internal.pageSize.getWidth()/2-s.getTextWidth(f)/2,s.text(f,k,21)},didDrawPage:function(D){s.setFontSize(10),s.text("P\xe1gina "+c+" de "+l,170,s.internal.pageSize.height-10),s.text("CALLE 24 #18A-101 Barrio Santa Catalina ",12,s.internal.pageSize.height-12),s.text("Cel: 3004407974, Email: npizarro@sism.com.co",12,s.internal.pageSize.height-7),s.setLineWidth(1.3),s.setDrawColor(236,255,83),s.line(10,s.internal.pageSize.height-20,10,s.internal.pageSize.height-5),c++}}),"function"==typeof s.putTotalPages&&s.putTotalPages(l);var v=s.output("datauri"),E=window.open();E?E.document.write('<iframe src="'+v+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")}):z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})}datosPendientesTodos(e,r,i){var o=this;return(0,hi.Z)(function*(){const a=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const s=yield o.servicio.getMedicamentosBodegaPendiente(e,r,i).toPromise();o.lista=s,o.lista.sort((l,c)=>l.nombre.localeCompare(c.nombre)),console.log(o.lista);for(let l=0;l<o.lista.length;l++){const c=[(l+1).toString(),o.lista[l].cum,o.lista[l].nombre,o.primerasmayusculas(o.lista[l].forma),o.lista[l].cantidad,o.lista[l].pendiente];a.push(c)}return z().close(),a.length>0?a:void 0}catch(s){return console.error(s),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}reportePendientes(e){const r=this.generalForm.get("fInicial")?.value,i=this.generalForm.get("fFinal")?.value;r&&i?new Date(r)>new Date(i)?z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"}):this.datosPendientes(e.idBodega,r,i).then(s=>{const l=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let c="{total_pages_count_string}",f=1,v="Periodo del reporte: "+r+" al "+i;Zc()(l,{head:[["Nro","CUM","Nombre del medicamento","Presentaci\xf3n","Existencia","Dotaci\xf3n","Pendiente"]],body:s,startY:37,theme:"striped",willDrawPage:function(k){l.setFontSize(11),l.setDrawColor(0);let T=l.internal.pageSize.getWidth()/2-l.getTextWidth("RELACION DE MEDICAMENTOS PENDIENTES")/2,R=l.getTextWidth("RELACION DE MEDICAMENTOS PENDIENTES");l.setDrawColor("#D3E3FD"),l.setFillColor("#D3E3FD"),l.roundedRect(T-10,9,R+20,7,3,3,"FD"),l.addImage("/assets/logo.png","JPEG",238,3,25,20),l.text("RELACION DE MEDICAMENTOS PENDIENTES",T,14),l.setTextColor("#000000"),l.text("Nombre de la bodega:",17,20),l.text(e.nombre.toString()+" - "+e.puntoEntrega,60,20),l.text("Municipio:",17,25),l.text(e.municipio,60,25),l.text("Direcci\xf3n:",17,30),l.text(e.direccion,60,30),l.text("Tel\xe9fono:",17,35),l.text(e.telefono,60,35),T=l.internal.pageSize.getWidth()/2-l.getTextWidth(v)/2,l.text(v,T+30,35)},didDrawPage:function(k){l.setFontSize(10),l.text("P\xe1gina "+f+" de "+c,170,l.internal.pageSize.height-10),l.text(e.direccion.toString(),12,l.internal.pageSize.height-12),l.text("Cel: "+e.telefono.toString()+", Email: "+e.email.toString(),12,l.internal.pageSize.height-7),l.setLineWidth(1.3),l.setDrawColor(236,255,83),l.line(10,l.internal.pageSize.height-20,10,l.internal.pageSize.height-5),f++}}),"function"==typeof l.putTotalPages&&l.putTotalPages(c);var E=l.output("datauri"),D=window.open();D?D.document.write('<iframe src="'+E+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")}):z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})}datosPendientes(e,r,i){var o=this;return(0,hi.Z)(function*(){const a=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const s=yield o.servicio.getMedicamentosBodegaPendiente(e,r,i).toPromise();o.lista=s,o.lista.sort((l,c)=>l.nombre.localeCompare(c.nombre));for(let l=0;l<o.lista.length;l++){const c=[(l+1).toString(),o.lista[l].cum,o.lista[l].nombre,o.primerasmayusculas(o.lista[l].forma),o.lista[l].cantidad,o.lista[l].ultFecIngreso.split("T")[0],o.lista[l].pendiente];a.push(c)}return z().close(),a.length>0?a:void 0}catch(s){return console.error(s),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}reporteStopMinimo(e){this.datosStopMinimo(e).then(r=>{const i=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let o="{total_pages_count_string}",a=1;Zc()(i,{head:[["Nro","CUM","Nombre del medicamento","Presentaci\xf3n","Cantidad existente","Stop Minimo"]],body:r,startY:37,theme:"striped",willDrawPage:function(c){i.setFontSize(11),i.setDrawColor(0);let f=i.internal.pageSize.getWidth()/2-i.getTextWidth("MEDICAMENTOS EN LA BODEGA POR DEBAJO DEL STOP MINIMO")/2,v=i.getTextWidth("MEDICAMENTOS EN LA BODEGA POR DEBAJO DEL STOP MINIMO");i.setDrawColor("#D3E3FD"),i.setFillColor("#D3E3FD"),i.roundedRect(f-10,9,v+20,7,3,3,"FD"),i.addImage("/assets/logo.png","JPEG",180,8,25,20),i.text("MEDICAMENTOS EN LA BODEGA POR DEBAJO DEL STOP MINIMO",f,14),i.setTextColor("#000000"),i.text("Nombre de la bodega:",17,20),i.text(e.nombre.toString()+" - "+e.puntoEntrega,60,20),i.text("Municipio:",17,25),i.text(e.municipio,60,25),i.text("Direcci\xf3n:",17,30),i.text(e.direccion,60,30),i.text("Tel\xe9fono:",17,35),i.text(e.telefono,60,35)},didDrawPage:function(c){i.setFontSize(10),i.text("P\xe1gina "+a+" de "+o,170,i.internal.pageSize.height-10),i.text(e.direccion.toString(),12,i.internal.pageSize.height-12),i.text("Cel: "+e.telefono.toString()+", Email: "+e.email.toString(),12,i.internal.pageSize.height-7),i.setLineWidth(1.3),i.setDrawColor(236,255,83),i.line(10,i.internal.pageSize.height-20,10,i.internal.pageSize.height-5),a++}}),"function"==typeof i.putTotalPages&&i.putTotalPages(o);var s=i.output("datauri"),l=window.open();l?l.document.write('<iframe src="'+s+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")})}datosStopMinimo(e){var r=this;return(0,hi.Z)(function*(){const i=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const o=yield r.servicio.getRegistrosMedicamentoBodega(e.idBodega).toPromise();r.lista=o,r.lista.sort((a,s)=>s.nombre-a.nombre);for(let a=0;a<r.lista.length;a++)if(r.lista[a].cantidad<r.lista[a].stopMinimo){r.contador++;const s=[r.contador.toString(),r.lista[a].cum,r.lista[a].nombre,r.primerasmayusculas(r.lista[a].forma),r.lista[a].cantidad,r.lista[a].stopMinimo];i.push(s)}return z().close(),i.length>0?i:void 0}catch(o){return console.error(o),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}reporteExistenciasActuales(e){this.datosExistencia(e.idBodega).then(r=>{const i=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let o="{total_pages_count_string}",a=1;Zc()(i,{head:[["Nro","CUM","ID","Nombre del medicamento","Presentaci\xf3n","Cantidad existente"]],body:r,startY:32,theme:"striped",willDrawPage:function(c){i.setFontSize(11),i.setDrawColor(0);let f=i.internal.pageSize.getWidth()/2-i.getTextWidth("EXISTENCIA DE MEDICAMENTOS EN LA BODEGA")/2,v=i.getTextWidth("EXISTENCIA DE MEDICAMENTOS EN LA BODEGA");i.setDrawColor("#D3E3FD"),i.setFillColor("#D3E3FD"),i.roundedRect(f-10,9,v+20,7,3,3,"FD"),i.addImage("/assets/logo.png","JPEG",180,8,25,20),i.text("EXISTENCIA DE MEDICAMENTOS EN LA BODEGA",f,14),i.setTextColor("#000000"),i.text("Nombre de la bodega:",17,20),i.text(e.nombre.toString()+" - "+e.puntoEntrega,60,20),i.text("Direcci\xf3n:",17,25),i.text(e.direccion,60,25),i.text("Tel\xe9fono:",17,30),i.text(e.telefono,60,30)},didDrawPage:function(c){i.setFontSize(10),i.text("P\xe1gina "+a+" de "+o,170,i.internal.pageSize.height-10),i.text(e.direccion.toString(),12,i.internal.pageSize.height-12),i.text("Cel: "+e.telefono.toString()+", Email: "+e.email.toString(),12,i.internal.pageSize.height-7),i.setLineWidth(1.3),i.setDrawColor(236,255,83),i.line(10,i.internal.pageSize.height-20,10,i.internal.pageSize.height-5),a++}}),"function"==typeof i.putTotalPages&&i.putTotalPages(o);var s=i.output("datauri"),l=window.open();l?l.document.write('<iframe src="'+s+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")})}reporteExistenciasActualestotal(){this.datosExistencia(0).then(e=>{const r=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let i="{total_pages_count_string}",o=1,a="Fecha y hora del reporte ";Zc()(r,{head:[["Nro","CUM","ID","Nombre del medicamento","Presentaci\xf3n","Cantidad existente"]],body:e,startY:25,theme:"striped",willDrawPage:function(c){r.setFontSize(11),r.setDrawColor(0);let f=r.internal.pageSize.getWidth()/2-r.getTextWidth("EXISTENCIA DE MEDICAMENTOS EN TODAS LAS BODEGAS")/2,v=r.getTextWidth("EXISTENCIA DE MEDICAMENTOS EN TODAS LAS BODEGAS");r.setDrawColor("#D3E3FD"),r.setFillColor("#D3E3FD"),r.roundedRect(f-10,9,v+20,7,3,3,"FD"),r.addImage("/assets/logo.png","JPEG",180,8,25,20),r.text("EXISTENCIA DE MEDICAMENTOS EN TODAS LAS BODEGAS",f,14),r.setTextColor("#000000"),f=r.internal.pageSize.getWidth()/2-r.getTextWidth(a)/2,r.text(a,f,21)},didDrawPage:function(c){r.setFontSize(10),r.text("P\xe1gina "+o+" de "+i,170,r.internal.pageSize.height-10),r.text("CALLE 24 #18A-101 Barrio Santa Catalina ",12,r.internal.pageSize.height-12),r.text("Cel: 3004407974, Email: npizarro@sism.com.co",12,r.internal.pageSize.height-7),r.setLineWidth(1.3),r.setDrawColor(236,255,83),r.line(10,r.internal.pageSize.height-20,10,r.internal.pageSize.height-5),o++}}),"function"==typeof r.putTotalPages&&r.putTotalPages(i);var s=r.output("datauri"),l=window.open();l?l.document.write('<iframe src="'+s+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")})}datosExistencia(e){var r=this;return(0,hi.Z)(function*(){const i=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const o=yield r.servicio.getRegistrosMedicamentoBodega(e).toPromise();r.lista=o,r.lista.sort((a,s)=>a.nombre.localeCompare(s.nombre)),r.contador=0;for(let a=0;a<r.lista.length;a++)if(r.lista[a].cantidad>0){r.contador++;const s=[r.contador.toString(),r.lista[a].cum,r.lista[a].idMedicamento,r.lista[a].nombre,r.primerasmayusculas(r.lista[a].forma),r.lista[a].cantidad];i.push(s)}return z().close(),i.length>0?i:void 0}catch(o){return console.error(o),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}reporteCuotasModeradoras(e){const r=this.generalForm.get("fInicial")?.value,i=this.generalForm.get("fFinal")?.value;r&&i?new Date(r)>new Date(i)?z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"}):this.datosCuotasModeradoras(e,r,i).then(s=>{const l=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let c="{total_pages_count_string}",f=1,v="Periodo del reporte del "+r+" al "+i;Zc()(l,{head:[["Nro","Nombre del dispensario","Nro. de Formulas","Valor recaudo"]],body:s,startY:25,theme:"striped",willDrawPage:function(k){l.setFontSize(11),l.setDrawColor(0);let T=l.internal.pageSize.getWidth()/2-l.getTextWidth("RELACION DE RECAUDO DE CUOTAS MODERADORAS")/2,R=l.getTextWidth("RELACION DE RECAUDO DE CUOTAS MODERADORAS");l.setDrawColor("#D3E3FD"),l.setFillColor("#D3E3FD"),l.roundedRect(T-10,9,R+20,7,3,3,"FD"),l.addImage("/assets/logo.png","JPEG",180,8,25,20),l.text("RELACION DE RECAUDO DE CUOTAS MODERADORAS",T,14),l.setTextColor("#000000"),T=l.internal.pageSize.getWidth()/2-l.getTextWidth(v)/2,l.text(v,T,21)},didDrawPage:function(k){l.setFontSize(10),l.text("P\xe1gina "+f+" de "+c,170,l.internal.pageSize.height-10),l.text("CALLE 24 #18A-101 Barrio Santa Catalina ",12,l.internal.pageSize.height-12),l.text("Cel: 3004407974, Email: npizarro@sism.com.co",12,l.internal.pageSize.height-7),l.setLineWidth(1.3),l.setDrawColor(236,255,83),l.line(10,l.internal.pageSize.height-20,10,l.internal.pageSize.height-5),f++}}),"function"==typeof l.putTotalPages&&l.putTotalPages(c);var E=l.output("datauri"),D=window.open();D?D.document.write('<iframe src="'+E+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")}):z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})}datosCuotasModeradoras(e,r,i){var o=this;return(0,hi.Z)(function*(){const a=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const s=yield o.servicioFormula.getCuotasModeradorasPDF(e,r,i).toPromise();o.lista=s,o.lista.sort((l,c)=>l.dato_1.localeCompare(c.dato_1)),o.contador=0;for(let l=0;l<o.lista.length;l++){const c=[(l+1).toString(),o.lista[l].dato_1??"",o.lista[l].d_1?.toString()??"",o.lista[l].d_2?.toString()??""];a.push(c)}return a.push(["","Subtotales:",o.calcularTotal("d_1"),o.calcularTotal("d_2")]),z().close(),a.length>0?a:void 0}catch(s){return console.error(s),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}reporteFormulasPrescritas(){const e=this.generalForm.get("fInicial")?.value,r=this.generalForm.get("fFinal")?.value;e&&r?new Date(e)>new Date(r)?z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"}):this.datosFormulasPrescritas(e,r).then(a=>{const s=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let l="{total_pages_count_string}",c=1,f="Periodo del reporte del "+e+" al "+r;Zc()(s,{head:[["Nro","Nombre del dispensario","Procesadas","Anuladas","Total formulas"]],body:a,startY:25,theme:"striped",willDrawPage:function(D){s.setFontSize(11),s.setDrawColor(0);let k=s.internal.pageSize.getWidth()/2-s.getTextWidth("RELACION DE CONSOLIDADOS DE FORMULA PRESCRITAS")/2,T=s.getTextWidth("RELACION DE CONSOLIDADOS DE FORMULA PRESCRITAS");s.setDrawColor("#D3E3FD"),s.setFillColor("#D3E3FD"),s.roundedRect(k-10,9,T+20,7,3,3,"FD"),s.addImage("/assets/logo.png","JPEG",180,8,25,20),s.text("RELACION DE CONSOLIDADOS DE FORMULA PRESCRITAS",k,14),s.setTextColor("#000000"),k=s.internal.pageSize.getWidth()/2-s.getTextWidth(f)/2,s.text(f,k,21)},didDrawPage:function(D){s.setFontSize(10),s.text("P\xe1gina "+c+" de "+l,170,s.internal.pageSize.height-10),s.text("CALLE 24 #18A-101 Barrio Santa Catalina",12,s.internal.pageSize.height-12),s.text("Cel: 3004407974, Email: npizarro@sism.com.co",12,s.internal.pageSize.height-7),s.setLineWidth(1.3),s.setDrawColor(236,255,83),s.line(10,s.internal.pageSize.height-20,10,s.internal.pageSize.height-5),c++}}),"function"==typeof s.putTotalPages&&s.putTotalPages(l);var v=s.output("datauri"),E=window.open();E?E.document.write('<iframe src="'+v+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")}):z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})}datosFormulasPrescritas(e,r){var i=this;return(0,hi.Z)(function*(){const o=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const a=yield i.servicioFormula.getFormulasPrescritas(e,r).toPromise();i.lista=a,i.lista.sort((s,l)=>s.dato_1.localeCompare(l.dato_1)),i.contador=0;for(let s=0;s<i.lista.length;s++){const l=[(s+1).toString(),i.lista[s].dato_1??"",i.lista[s].d_1?.toString()??"",i.lista[s].d_2?.toString()??"",i.lista[s].d_3?.toString()??""];o.push(l)}return o.push(["","Subtotales:",i.calcularTotal("d_1"),i.calcularTotal("d_2"),i.calcularTotal("d_3")]),z().close(),o.length>0?o:void 0}catch(a){return console.error(a),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}reporteFormulasNoProcesadas(e){const r=this.generalForm.get("fInicial")?.value,i=this.generalForm.get("fFinal")?.value;r&&i?new Date(r)>new Date(i)?z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"}):this.datosFormulasNoProcesadas(e,r,i).then(s=>{const l=new Kc.default({orientation:"l",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let c="{total_pages_count_string}",f=1,v="Periodo del reporte del "+r+" al "+i;Zc()(l,{head:[["Nro","Tipo y Documento","Nombre del paciente","Nro. Formula","Fecha Solicitud","Dispensario","Funcionario"]],body:s,startY:25,theme:"striped",willDrawPage:function(k){l.setFontSize(11),l.setDrawColor(0);let T=l.internal.pageSize.getWidth()/2-l.getTextWidth("RELACION DE FORMULAS PENDIENTE DEL PASO DE GENERAR LA ENTREGA")/2,R=l.getTextWidth("RELACION DE FORMULAS PENDIENTE DEL PASO DE GENERAR LA ENTREGA");l.setDrawColor("#D3E3FD"),l.setFillColor("#D3E3FD"),l.roundedRect(T-10,9,R+20,7,3,3,"FD"),l.addImage("/assets/logo.png","JPEG",240,8,25,20),l.text("RELACION DE FORMULAS PENDIENTE DEL PASO DE GENERAR LA ENTREGA",T,14),l.setTextColor("#000000"),T=l.internal.pageSize.getWidth()/2-l.getTextWidth(v)/2,l.text(v,T,21)},didDrawPage:function(k){l.setFontSize(10),l.text("P\xe1gina "+f+" de "+c,170,l.internal.pageSize.height-10),l.text("CALLE 24 #18A-101 Barrio Santa Catalina",12,l.internal.pageSize.height-12),l.text("Cel: 3004407974, Email: npizarro@sism.com.co",12,l.internal.pageSize.height-7),l.setLineWidth(1.3),l.setDrawColor(236,255,83),l.line(10,l.internal.pageSize.height-20,10,l.internal.pageSize.height-5),f++}}),"function"==typeof l.putTotalPages&&l.putTotalPages(c);var E=l.output("datauri"),D=window.open();D?D.document.write('<iframe src="'+E+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")}):z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})}datosFormulasNoProcesadas(e,r,i){var o=this;return(0,hi.Z)(function*(){const a=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const s=yield o.servicioFormula.getFormulasNoProcesadas(e,r,i).toPromise();o.lista=s,console.log(s),o.contador=0;for(let l=0;l<o.lista.length;l++){const c=[(l+1).toString(),`${o.lista[l].tipoDoc??""} ${o.lista[l].numDocumento??""}`,`${o.lista[l].pNombre??""} ${o.lista[l].sNombre??""} ${o.lista[l].pApellido??""} ${o.lista[l].sApellido??""}`,o.lista[l].idFormula??"",o.lista[l].fecSolicitud??"",o.lista[l].bodega??"",o.lista[l].funcionario??""];a.push(c)}return z().close(),a.length>0?a:void 0}catch(s){return console.error(s),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}reporteBodegaEntregas(e){const r=this.generalForm.get("fInicial")?.value,i=this.generalForm.get("fFinal")?.value;r&&i?new Date(r)>new Date(i)?z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"}):this.datosBodegaEntregas(e,r,i).then(s=>{const l=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let c="{total_pages_count_string}",f=1;Zc()(l,{head:[["Nro","CUM","Nombre del medicamento","Presentaci\xf3n","Cantidad entregadas"]],body:s,startY:37,theme:"striped",willDrawPage:function(D){l.setFontSize(11),l.setDrawColor(0);let k=l.internal.pageSize.getWidth()/2-l.getTextWidth("RELACION DE MEDICAMENTOS ENTREGADOS POR BODEGA")/2,T=l.getTextWidth("RELACION DE MEDICAMENTOS ENTREGADOS POR BODEGA");l.setDrawColor("#D3E3FD"),l.setFillColor("#D3E3FD"),l.roundedRect(k-10,9,T+20,7,3,3,"FD"),l.addImage("/assets/logo.png","JPEG",180,8,25,20),l.text("RELACION DE MEDICAMENTOS ENTREGADOS POR BODEGA",k,14),l.setTextColor("#000000"),l.text("Nombre de la bodega:",17,20),l.text(e.nombre.toString()+" - "+e.puntoEntrega,60,20),l.text("Municipio:",17,25),l.text(e.municipio,60,25),l.text("Direcci\xf3n:",17,30),l.text(e.direccion,60,30),l.text("Tel\xe9fono:",17,35),l.text(e.telefono,60,35)},didDrawPage:function(D){l.setFontSize(10),l.text("P\xe1gina "+f+" de "+c,170,l.internal.pageSize.height-10),l.text(e.direccion.toString(),12,l.internal.pageSize.height-12),l.text("Cel: "+e.telefono.toString()+", Email: "+e.email.toString(),12,l.internal.pageSize.height-7),l.setLineWidth(1.3),l.setDrawColor(236,255,83),l.line(10,l.internal.pageSize.height-20,10,l.internal.pageSize.height-5),f++}}),"function"==typeof l.putTotalPages&&l.putTotalPages(c);var v=l.output("datauri"),E=window.open();E?E.document.write('<iframe src="'+v+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")}):z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})}datosBodegaEntregas(e,r,i){var o=this;return(0,hi.Z)(function*(){const a=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const s=yield o.servicio.getMedicamentosBodegaEntregados(e.idBodega,r,i).toPromise();o.lista=s,o.lista.sort((l,c)=>c.nombre-l.nombre);for(let l=0;l<o.lista.length;l++){o.contador++;const c=[o.contador.toString(),o.lista[l].cum,o.lista[l].nombre,o.primerasmayusculas(o.lista[l].forma),o.lista[l].cantidadEntregada];a.push(c)}return z().close(),a.length>0?a:void 0}catch(s){return console.error(s),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}reporteBodegaEntregasMeses(e){const r=this.generalForm.get("fInicial")?.value,i=this.generalForm.get("fFinal")?.value;r&&i?new Date(r)>new Date(i)?z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"}):this.datosBodegaEntregasMeses(e,r,i).then(s=>{const l=new Kc.default({orientation:"l",unit:"mm",format:[220,340],putOnlyUsedFonts:!0});let c="{total_pages_count_string}",f=1;Zc()(l,{head:[["Nro","CUM","Nombre del medicamento","Presentaci\xf3n","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre","Total"]],body:s,startY:37,theme:"striped",willDrawPage:function(D){l.setFontSize(11),l.setDrawColor(0);let k=l.internal.pageSize.getWidth()/2-l.getTextWidth("MEDICAMENTOS ENTREGADOS POR BODEGA CONSOLIDADO POR MESES")/2,T=l.getTextWidth("MEDICAMENTOS ENTREGADOS POR BODEGA CONSOLIDADO POR MESES");l.setDrawColor("#D3E3FD"),l.setFillColor("#D3E3FD"),l.roundedRect(k-10,9,T+20,7,3,3,"FD"),l.addImage("/assets/logo.png","JPEG",280,8,25,20),l.text("MEDICAMENTOS ENTREGADOS POR BODEGA CONSOLIDADO POR MESES",k,14),l.setTextColor("#000000"),l.text("Nombre de la bodega:",17,20),l.text(e.nombre.toString()+" - "+e.puntoEntrega,60,20),l.text("Municipio:",17,25),l.text(e.municipio,60,25),l.text("Direcci\xf3n:",17,30),l.text(e.direccion,60,30),l.text("Tel\xe9fono:",17,35),l.text(e.telefono,60,35)},didDrawPage:function(D){l.setFontSize(10),l.text("P\xe1gina "+f+" de "+c,170,l.internal.pageSize.height-10),l.text(e.direccion.toString(),12,l.internal.pageSize.height-12),l.text("Cel: "+e.telefono.toString()+", Email: "+e.email.toString(),12,l.internal.pageSize.height-7),l.setLineWidth(1.3),l.setDrawColor(236,255,83),l.line(10,l.internal.pageSize.height-20,10,l.internal.pageSize.height-5),f++}}),"function"==typeof l.putTotalPages&&l.putTotalPages(c);var v=l.output("datauri"),E=window.open();E?E.document.write('<iframe src="'+v+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")}):z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})}datosBodegaEntregasMeses(e,r,i){var o=this;return(0,hi.Z)(function*(){const a=[];try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const s=yield o.servicio.getMedicamentosBodegaEntregadosMeses(e.idBodega,r,i).toPromise();o.lista=s,o.lista.sort((l,c)=>l.dato_2.localeCompare(c.dato_2)),console.log(o.lista);for(let l=0;l<o.lista.length;l++){o.contador++;const c=[o.contador.toString(),o.lista[l].dato_1,o.lista[l].dato_2,o.primerasmayusculas(o.lista[l].dato_3),o.lista[l].d_1,o.lista[l].d_2,o.lista[l].d_3,o.lista[l].d_4,o.lista[l].d_5,o.lista[l].d_6,o.lista[l].d_7,o.lista[l].d_8,o.lista[l].d_9,o.lista[l].d_10,o.lista[l].d_11,o.lista[l].d_12,o.lista[l].d_t];a.push(c)}return z().close(),a.length>0?a:void 0}catch(s){return console.error(s),z().close(),void z().fire("Error","No se pudieron cargar los registros.","error")}})()}calcularTotal(e){return this.lista.reduce((i,o)=>i+(o[e]?o[e]:0),0).toString()}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}reporteBodegaEntregasDetalldasTodas(){var e=this;return(0,hi.Z)(function*(){const r=e.generalForm.get("fInicial")?.value,i=e.generalForm.get("fFinal")?.value;if(r&&i)if(new Date(r)>new Date(i))z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"});else try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const s=yield e.servicio.getMedicamentosBodegaEntregaDetallada(0,r,i).toPromise();z().close(),Array.isArray(s)?(e.lista=s,e.exportarExcel()):console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array.")}catch(s){console.error("Error al obtener los datos de entrega detallada:",s),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")}else z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})})()}reporteBodegaEntregasDetalldas(e){var r=this;return(0,hi.Z)(function*(){const i=r.generalForm.get("fInicial")?.value,o=r.generalForm.get("fFinal")?.value;if(i&&o)if(new Date(i)>new Date(o))z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"});else try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const l=yield r.servicio.getMedicamentosBodegaEntregaDetallada(e.idBodega,i,o).toPromise();z().close(),Array.isArray(l)?(r.lista=l,r.exportarExcel()):console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array.")}catch(l){console.error("Error al obtener los datos de entrega detallada:",l),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")}else z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})})()}exportarExcel(){const e=[];e.push(["TIPO ID","NUMERO DE ID","PRIMER APELLIDO","SEGUNDO APELLIDO","PRIMER NOMBRE","SEGUNDO NOMBRE","FECHA NACIMIENTO","SEXO","ORIGEN DE LA FORMULA","N\xba de Formulas Del Paciente","CONTINUIDADES","NOMBRE DEL MEDICAMENTO","VIA DE ADMINISTRACION","FORMA FARMACEUTICA","CANTIDAD PRESCRITA","NUMERO DE DOSIS","PERIODICIDAD","PROGRAMA DE RIESGO","TTIPO DE ACTIVIDAD REALIZADA","CANTIDAD ENTREGADA","DX","REGIMEN","NOMBRE DE LA IPS QUE PRESCRIBE","NOMBRE DEL MEDICO QUE PRESCRIBE","NUMERO DEL REGISTRO MEDICO","DEPARTAMENTO","MUNICIPIO","NOMBRE DE LA FARMACIA","TIPO DE ID","NUMERO DE IDENTIFICACION","NOMBRE DEL USUARIO","CIE-10","Descripci\xf3n Diagn\xf3stico Principal","DIRECCION","TELEFONO","CUM","Nombre del Medicamento","Fecha de prescripci\xf3n de la formula","Presentaci\xf3n","Cantidad Prescrita","Cantidad Entregada","Cantidad Pendiente","Nombre del Medicamento Pendiente","Fecha en la que el usuario solicita en la farmacia los medicamentos","Fecha de entrega de los medicamentos","Cuota moderadora y/o Copago","Fecha de entrega real  del medicamento pendiente","Fecha de entrega estimada del medicamento","Medio de entrega del pendiente","Tipo recibe","Docuemnto recibe","Eps","\xbfEs PGP?","Id Formula","CIE-R1","CIE-R2","CIE-R3","Observaci\xf3n","Estado","Funcionario que entrega","PACIENTE PAVE","MEDICAMENTO CONTROLADO","PENDIENTE DEL MEDICAMENTO","PENDIENTE DE LA FORMULA"]);let i="",o="";this.lista.forEach(c=>{i="",o="",c.fecEntrega!=c.fecSolicitud&&(i=c.fecEntrega),c.pendiente>0&&(o=c.nombreMedicamento),e.push([c.tipoDoc||"",c.numDocumento||"",c.pApellido||"",c.sApellido||"",c.pNombre||"",c.sNombre||"",c.fecNacimiento||"",c.sexo||"",c.origen||"","",(c.continuidadEntrega||"").toUpperCase(),c.nombreMedicamento||"",c.via||"",c.forma||"",c.cantidadPrescrita||0,(c.frecuencia||"").toUpperCase(),c.duracion?c.duracion+" DIAS":"N/A",c.programaRiesgo||"",(c.medioEntrega||"").toUpperCase(),c.cantidadEntrega||0,"",c.regimen||"",c.ips||"",c.medico||"",c.registroMedico||"",c.departamento||"",c.municipio||"",c.bodega||"",c.tipoDoc||"",c.numDocumento||"",`${c.pNombre||""} ${c.sNombre||""} ${c.pApellido||""} ${c.sApellido||""}`,c.dxP||"",c.dxPDescripcion||"",c.direccion||"",c.telefono||"",c.cum||"",c.nombreMedicamento||"",c.fecPrescribe||"",c.forma||"",c.cantidadPrescrita||0,c.cantidadEntrega||0,c.pendiente||0,o||"",c.fecSolicitud||"",c.fecEntrega||"",c.cuotaModeradora||0,i||"",c.fecEstimada||"",(c.medioEntrega||"").toUpperCase(),c.tipoRecibe||"",c.documentoRecibe||"",c.codEps||"",c.pgp||"",c.idFormula||"",c.cieR1||"",c.cieR2||"",c.cieR3||"",c.observacion||"",c.estado||"",c.funcionario||"",c.pave||"",c.controlado||"",c.controlado||"",c.controlado||""])});const a=Gr.aoa_to_sheet(e),s=Gr.decode_range(a["!ref"]);for(let c=s.s.c;c<=s.e.c;c++){const f=a[Gr.encode_cell({r:0,c})];f&&(f.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const l=Gr.book_new();Gr.book_append_sheet(l,a,"Entregas_Detalladas"),Pf(l,"Entrega_Medicamentos_"+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Su reporte fue exportado en su carpeta de descargas en formato xslx"})}reportePendientesDetalldos(e){var r=this;return(0,hi.Z)(function*(){const i=r.generalForm.get("fInicial")?.value,o=r.generalForm.get("fFinal")?.value;if(i&&o)if(new Date(i)>new Date(o))z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"});else try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const l=Number(e),c=yield r.servicio.getMedicamentosPendienteDetallada(l,i,o).toPromise();z().close(),Array.isArray(c)?(r.lista=c,r.exportarExcelPendientes()):console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array.")}catch(l){console.error("Error al obtener los datos de medicamentos pendientes detallados:",l),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")}else z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})})()}exportarExcelPendientes(){const e=[];e.push(["TIPO DE ID","NUMERO DE ID","PRIMER APELLIDO","SEGUNDO APELLIDO","PRIMER NOMBRE","SEGUNDO NOMBRE","NACIMIENTO","SEXO","T\xc9LEFONO","DIRECCI\xd3N","DEPARTAMENTO","MUNICIPIO","EPS","REGIMEN","NOMBRE DE LA FARMACIA","NRO. FORMULA","FECHA DE LA FORMULA","NOMBRE DE LA IPS QUE PRESCRIBE","CUM","NOMBRE DEL MEDICAMENTO","VIA DE ADMINISTRACION","FORMA FARMACEUTICA","CANTIDAD PRESCRITA","CANTIDAD ENTREGADA","CANTIDAD PENDIENTE","FECHA DE SOLICITUD","FECHA DE ENTREGA","FUNCIONARIO QUE ENTREGA","PACIENTE PAVE"]);let i="",o="";this.lista.forEach(c=>{i="",o="",c.fecEntrega!=c.fecSolicitud&&(i=c.fecEntrega),c.pendiente>0&&(o=c.nombreMedicamento),e.push([c.tipoDoc||"",c.numDocumento||"",c.pApellido||"",c.sApellido||"",c.pNombre||"",c.sNombre||"",c.fecNacimiento||"",c.sexo||"",c.telefono||"",c.direccion||"",c.departamento||"",c.municipio||"",c.codEps||"",c.regimen||"",c.bodega||"",c.idFormula||"",c.fecPrescribe||"",c.ips||"",c.cum||"",c.nombreMedicamento||"",c.via||"",c.forma||"",c.cantidadPrescrita||0,c.cantidadEntrega||0,c.pendiente||0,c.fecSolicitud||"",c.fecEntrega||"",c.funcionario||"",c.pave||""])});const a=Gr.aoa_to_sheet(e),s=Gr.decode_range(a["!ref"]);for(let c=s.s.c;c<=s.e.c;c++){const f=a[Gr.encode_cell({r:0,c})];f&&(f.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const l=Gr.book_new();Gr.book_append_sheet(l,a,"Pendientes"),Pf(l,"Medicamentos_Pendientes_"+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Su reporte fue exportado en su carpeta de descargas en formato xslx"})}reporteFormulasDetalldas(e,r){var i=this;return(0,hi.Z)(function*(){const o=i.generalForm.get("fInicial")?.value,a=i.generalForm.get("fFinal")?.value;if(o&&a)if(new Date(o)>new Date(a))z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"});else try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const c=Number(e);let f,v=0===r?"Activas":"Anuladas";f=0===r?yield i.servicioFormula.getFormulasDetalladas(c,o,a).toPromise():yield i.servicioFormula.getFormulasDetalladasAnuladas(c,o,a).toPromise(),z().close(),Array.isArray(f)?(i.lista=f,i.exportarExcelFormulas(v)):console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array.")}catch(c){console.error("Error al obtener los datos de medicamentos pendientes detallados:",c),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")}else z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de las fechas del periodo que desea generar!"})})()}exportarExcelFormulas(e){const r=[];r.push(["TIPO DE ID","NUMERO DE ID","PRIMER APELLIDO","SEGUNDO APELLIDO","PRIMER NOMBRE","SEGUNDO NOMBRE","NACIMIENTO","SEXO","EPS","REGIMEN","DEPARTAMENTO","MUNICIPIO","ID DE LA FARMACIA","NRO. FORMULA","FECHA DE LA FORMULA","FECHA DE SOLICITUD","NOMBRE DE LA IPS QUE PRESCRIBE","NOMBRE DEL MEDICO QUE PRESCRIBE","TIPO DE CONTRATO","ORIGEN DE LA FORMULA","CONTINUIDAD","CIE-P","CIE-R1","CIE-R2","CIE-R3","CUOTA MODERADORA","VALOR CUOTA","VALOR DE LA F\xd3RMULA","NUMERO DE MEDICAMENTOS","FUNCIONARIO QUE CREO LA F\xd3RMULA","ESTADO DE LA F\xd3RMULA","FUNCIONARIO QUE ANUL\xd3 LA F\xd3RMULA","OBSERVACI\xd3N DE LA F\xd3RMULA","FECHA DE CREACI\xd3N"]);let o="",a="";this.lista.forEach(f=>{o="",a="",f.fecEntrega!=f.fecSolicitud&&(o=f.fecEntrega),f.pendiente>0&&(a=f.nombreMedicamento),r.push([f.tipoDoc||"",f.numDocumento||"",f.pApellido||"",f.sApellido||"",f.pNombre||"",f.sNombre||"",f.fecNacimiento||"",f.sexo||"",f.codEps||"",f.regimen||"",f.departamento||"",f.municipio||"",f.bodega||"",f.idFormula||"",f.fecPrescribe||"",f.fecSolicitud||"",f.ips||"",f.medico||"",f.tipoContrato||"",f.tipoOrigen||"",f.continuidad||"",f.dxP||"",f.cieR1||"",f.cieR2||"",f.cieR3||"",f.cuotaModeradora||"",f.valorCuota||"",f.valorFormula||"0",f.numeroItems||"0",f.funcionariocreaformula||"",f.estadoFormula||"",f.funcionarioanula||"",f.observacion||"",f.fecCreacion||""])});const s=Gr.aoa_to_sheet(r),l=Gr.decode_range(s["!ref"]);for(let f=l.s.c;f<=l.e.c;f++){const v=s[Gr.encode_cell({r:0,c:f})];v&&(v.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const c=Gr.book_new();Gr.book_append_sheet(c,s,e),Pf(c,"Formulas_"+e+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Su reporte fue exportado en su carpeta de descargas en formato xlsx"})}exportarExistenciasxlsx(e){var r=this;return(0,hi.Z)(function*(){try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const i=yield r.servicio.getRegistrosMedicamentoBodega(e).toPromise();r.lista=i,r.lista.sort((o,a)=>o.nombre.localeCompare(a.nombre)),z().close(),Array.isArray(i)?r.exportarExistenciasXlsx("Existencias"):console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array.")}catch(i){console.error("Error al obtener los datos de medicamentos pendientes detallados:",i),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")}})()}exportarExistenciasXlsx(e){const r=[];r.push(["CONSECUTIVO","CUM","ID MEDICAMENTO","NOMBRE DEL MEDICAMENTO","PRESENTACION","CANTIDAD EN PLATAFORMA","CANTIDAD FISICA","DIFERENCIA"]),this.contador=0,this.lista.forEach(l=>{this.contador++,r.push([this.contador.toString(),l.cum||"",l.idMedicamento,l.nombre?.toUpperCase()||"",l.forma?.toUpperCase()||"",l.cantidad])});const o=Gr.aoa_to_sheet(r),a=Gr.decode_range(o["!ref"]);for(let l=a.s.c;l<=a.e.c;l++){const c=o[Gr.encode_cell({r:0,c:l})];c&&(c.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const s=Gr.book_new();Gr.book_append_sheet(s,o,e),Pf(s,"Inventario_"+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Las existencias actuales fueron exportadas en su carpeta de descargas en formato xlsx"})}exportarVencidosxlsx(e){var r=this;return(0,hi.Z)(function*(){const i=r.generalForm.get("fInicial")?.value;if(i)try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const o=yield r.servicio.getMedicamentosVencidos(e,i).toPromise();r.lista=o,Array.isArray(o)?(z().close(),r.exportarVencidosXlsx("VENCIDOS")):(z().close(),console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array."))}catch(o){console.error("Error al obtener los datos de medicamentos vencidos de manera detallada",o),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")}else z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de la  fecha de corte inicial para generar el informe solicitado!"})})()}exportarMedicamentosNorotanxlsx(e){var r=this;return(0,hi.Z)(function*(){const i=r.generalForm.get("fInicial")?.value;if(i)try{z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const o=yield r.servicio.getMedicamentosNorotan(e,i).toPromise();r.lista=o,z().close(),Array.isArray(o)?r.exportarVencidosXlsx("NO_ROTAN"):console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array.")}catch(o){console.error("Error al obtener los datos de medicamentos que no rotan de  manera detallada",o),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")}else z().fire({icon:"error",title:"Pendiente!",text:"Falta la informacion de la  fecha de corte inicial para generar el informe solicitado!"})})()}exportarVencidosXlsx(e){const r=[];r.push(["CONSECUTIVO","NOMBRE DE LA BODEGA","ID MEDICAMENTO","NOMBRE DEL MEDICAMENTO","PRESENTACION","VALOR UNITARIO","CANTIDAD ACTUAL","CANTIDAD DE REFERENCIA","ULTIMA FECHA DE DOTACION","PENDIENTE","INVIMA","LABORATORIO","LOTE","FECHA_VENCIMIENTO"]),this.contador=0,this.lista.forEach(l=>{this.contador++,r.push([this.contador.toString(),l.nombreBodega||"",l.idMedicamento,l.nombre?.toUpperCase()||"",l.forma?.toUpperCase()||"",l.stopMinimo||0,l.cantidad,l.cantidadReferencia,l.ultFecIngreso?new Date(l.ultFecIngreso).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"",l.pendiente,l.invima?l.invima.toUpperCase():"",l.laboratorio?l.laboratorio.toUpperCase():"",l.lote?l.lote.toUpperCase():"",l.fechaVencimiento?new Date(l.fechaVencimiento).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):""])});const o=Gr.aoa_to_sheet(r),a=Gr.decode_range(o["!ref"]);for(let l=a.s.c;l<=a.e.c;l++){const c=o[Gr.encode_cell({r:0,c:l})];c&&(c.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const s=Gr.book_new();Gr.book_append_sheet(s,o,e),Pf(s,e+"_"+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Los medicamentos "+e+" a la fecha seleccionada fueron exportadas en su carpeta de descargas en formato xlsx"})}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}reporteEnConstruccion(){z().fire({icon:"info",title:"En construcci\xf3n!",text:"El reporte esta en proceso de construcci\xf3n, te estaremos informando cuando est\xe9 disponible!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(Ts),X(Dd))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-bodega"]],decls:107,vars:29,consts:[[1,"container","mt-4"],[1,"w-100","d-block",3,"formGroup"],[1,"row"],[1,"col-sm"],[1,"input-group","mb-2"],["formControlName","departamento","required","",1,"form-select",3,"change"],["selected","","value",""],[3,"ngValue","selected",4,"ngFor","ngForOf"],["formControlName","municipio","required","",1,"form-select"],["type","text","formControlName","nombre","placeholder","ingrese nombre de la bodega","required","",1,"form-control","border-end-0"],[1,"input-group-text","bg-transparent"],[1,"fa","fa-user"],["type","text","formControlName","puntoEntrega","placeholder","ingrese nombre del punto de entrega","required","",1,"form-control","border-end-0"],["type","text","formControlName","direccion","placeholder","ingrese la direcci\xf3n de la bodega","required","",1,"form-control","border-end-0"],["type","text","formControlName","telefono","placeholder","ingrese tel\xe9fono","required","",1,"form-control","border-end-0"],["type","text","formControlName","email","placeholder","ingrese email","required","",1,"form-control","border-end-0"],[1,"d-flex","flex-wrap","align-items-center","gap-3","mb-2"],[1,"d-flex","align-items-center"],["type","checkbox","formControlName","estado",1,"form-check-input","me-2"],["type","checkbox","formControlName","dispensa",1,"form-check-input","me-2"],["type","checkbox","formControlName","entrada",1,"form-check-input","me-2"],["type","checkbox","formControlName","salida",1,"form-check-input","me-2"],["type","checkbox","formControlName","inventario",1,"form-check-input","me-2"],[1,"col-6"],[1,"btn","btn-outline-primary","w-100",3,"click"],[1,"far","fa-save"],["type","button","class","btn btn-outline-primary w-100",3,"click",4,"ngIf"],[1,"date-inputs"],["type","date","formControlName","fInicial",1,"form-control","border-end-0","date-input"],["type","date","formControlName","fFinal",1,"form-control","border-end-0","date-input",3,"max"],[1,"btn","btn-outline-primary","w-100",3,"matMenuTriggerFor"],["menuC","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],[3,"ngStyle"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[3,"ngValue","selected"],["type","button",1,"btn","btn-outline-primary","w-100",3,"click"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm","mt-2"],[1,"thead-colored"],[3,"ngStyle",4,"ngFor","ngForOf"],["title","Mdicamentos bodega",1,"pointer-cursor",3,"ngStyle","routerLink"],["title","Mdicamentos pendientes",1,"pointer-cursor",3,"ngStyle","routerLink"],["title","Listar en PDF",1,"pointer-cursor",3,"ngStyle","matMenuTriggerFor"],["title","Actualizar datos de la bodega","class","pointer-cursor",3,"ngStyle","click",4,"ngIf"],["title","Eliminar la bodega","class","pointer-cursor",3,"ngStyle","click",4,"ngIf"],["menu","matMenu"],["title","Actualizar datos de la bodega",1,"pointer-cursor",3,"ngStyle","click"],["title","Eliminar la bodega",1,"pointer-cursor",3,"ngStyle","click"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"select",5),De("change",function(){return i.onDptoSeleccionado()}),d(6,"option",6),h(7,"Seleccione el departamento"),u(),oe(8,Mse,2,3,"option",7),u()(),d(9,"div",4)(10,"select",8)(11,"option",6),h(12,"Seleccione el municipio"),u(),oe(13,kse,2,3,"option",7),u()(),d(14,"div",4),qe(15,"input",9),d(16,"span",10),qe(17,"i",11),u()(),d(18,"div",4),qe(19,"input",12),d(20,"span",10),qe(21,"i",11),u()(),d(22,"div",4),qe(23,"input",13),d(24,"span",10),qe(25,"i",11),u()(),d(26,"div",4),qe(27,"input",14),d(28,"span",10),qe(29,"i",11),u()(),d(30,"div",4),qe(31,"input",15),d(32,"span",10),qe(33,"i",11),u()(),d(34,"div",16)(35,"label",17),qe(36,"input",18),h(37," Activa "),u(),d(38,"label",17),qe(39,"input",19),h(40," Habilitada para dispensar "),u(),d(41,"label",17),qe(42,"input",20),h(43," Habilitada para ingresos "),u(),d(44,"label",17),qe(45,"input",21),h(46," Habilitada para salidas "),u(),d(47,"label",17),qe(48,"input",22),h(49," Habilitada para inventario "),u()(),qe(50,"hr"),d(51,"div",2)(52,"div",23)(53,"button",24),De("click",function(){return i.create()}),qe(54,"i",25),h(55),u()(),d(56,"div",3),oe(57,Fse,2,0,"button",26),oe(58,Ise,2,0,"button",26),u()()(),d(59,"div",3)(60,"div",27),qe(61,"input",28),h(62," al "),qe(63,"input",29),d(64,"button",30),h(65," Generar reportes consolidados "),u(),d(66,"mat-menu",null,31),oe(68,Pse,5,2,"button",32),oe(69,Ose,5,2,"button",32),oe(70,Nse,5,2,"button",32),oe(71,Rse,5,2,"button",32),d(72,"button",33),De("click",function(){return i.reporteCuotasModeradoras(0)}),d(73,"mat-icon",34),h(74,"monetization_on"),u(),d(75,"span"),h(76,"Cuotas moderadoras"),u()(),d(77,"button",33),De("click",function(){return i.reporteFormulasPrescritas()}),d(78,"mat-icon",34),h(79,"filter_9_plus"),u(),d(80,"span"),h(81,"Consolidado de formulas"),u()(),d(82,"button",33),De("click",function(){return i.reporteEnConstruccion()}),d(83,"mat-icon",34),h(84,"event_note"),u(),d(85,"span"),h(86,"Formulas por meses"),u()(),oe(87,Lse,5,2,"button",32),d(88,"button",33),De("click",function(){return i.reporteFormulasDetalldas(0,1)}),d(89,"mat-icon",34),h(90,"block"),u(),d(91,"span"),h(92,"Formulas Anuladas"),u()(),d(93,"button",33),De("click",function(){return i.reporteFormulasNoProcesadas(0)}),d(94,"mat-icon",34),h(95," live_help"),u(),d(96,"span"),h(97,"Formulas no procesadas"),u()(),oe(98,Bse,5,2,"button",32),oe(99,jse,5,2,"button",32),d(100,"button",33),De("click",function(){return i.reporteEnConstruccion()}),d(101,"mat-icon",34),h(102,"event_note"),u(),d(103,"span"),h(104,"Prescritos por meses"),u()()()()()()(),oe(105,Vse,2,0,"div",35),oe(106,Gse,22,1,"div",36),u()),2&r){const o=go(67);w(1),N("formGroup",i.generalForm),w(7),N("ngForOf",i.listaDpto),w(5),N("ngForOf",i.listaMpio),w(42),Qt(" ",i.nombrebtn,""),w(2),N("ngIf",!i.banderaRegistro&&i.tieneAcceso(3)),w(1),N("ngIf",i.banderaRegistro),w(5),N("max",i.hoy),w(1),N("matMenuTriggerFor",o),w(4),N("ngIf",i.tieneAcceso(3)),w(1),N("ngIf",i.tieneAcceso(3)),w(1),N("ngIf",i.tieneAcceso(3)),w(1),N("ngIf",i.tieneAcceso(3)),w(2),N("ngStyle",Nt(23,v6)),w(5),N("ngStyle",Nt(24,a0)),w(5),N("ngStyle",Nt(25,VD)),w(4),N("ngIf",i.tieneAcceso(3)),w(2),N("ngStyle",Nt(26,s0)),w(5),N("ngStyle",Nt(27,s0)),w(4),N("ngIf",i.tieneAcceso(3)),w(1),N("ngIf",i.tieneAcceso(3)),w(2),N("ngStyle",Nt(28,VD)),w(4),N("ngIf",0==(null==i.listaregistros?null:i.listaregistros.length)),w(1),N("ngIf",(null==i.listaregistros?null:i.listaregistros.length)>0)}},dependencies:[ho,Fi,Jo,Hs,n0,Of,r0,Wo,Vs,cl,ul,vo,sl,Ss,No,zo,Dc,bo,Ro]})}return t})();function Xse(t,n){}class UD{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0}}const Kse={dialogContainer:Zg("dialogContainer",[Gu("void, exit",wa({opacity:0,transform:"scale(0.7)"})),Gu("enter",wa({transform:"none"})),au("* => enter",ou("150ms cubic-bezier(0, 0, 0.2, 1)",wa({transform:"none",opacity:1}))),au("* => void, * => exit",ou("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",wa({opacity:0})))])};let Zse=(()=>{class t extends cx{constructor(e,r,i,o,a,s,l,c){super(),this._elementRef=e,this._focusTrapFactory=r,this._changeDetectorRef=i,this._config=a,this._interactivityChecker=s,this._ngZone=l,this._focusMonitor=c,this._animationStateChanged=new Vr,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=f=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(f)),this._ariaLabelledBy=a.ariaLabelledBy||null,this._document=o}_initializeWithAttachedContent(){this._setupFocusTrap(),this._capturePreviouslyFocusedElement()}attachComponentPortal(e){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(e)}attachTemplatePortal(e){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(e)}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,r){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{e.addEventListener("blur",()=>e.removeAttribute("tabindex")),e.addEventListener("mousedown",()=>e.removeAttribute("tabindex"))})),e.focus(r)}_focusByCssSelector(e,r){let i=this._elementRef.nativeElement.querySelector(e);i&&this._forceFocus(i,r)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{r||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const e=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&e&&"function"==typeof e.focus){const r=yD(),i=this._elementRef.nativeElement;(!r||r===this._document.body||r===i||i.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(e,this._closeInteractionType),this._closeInteractionType=null):e.focus())}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)}_capturePreviouslyFocusedElement(){this._document&&(this._elementFocusedBeforeDialogWasOpened=yD())}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const e=this._elementRef.nativeElement,r=yD();return e===r||e.contains(r)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(DR),X(Zo),X(si,8),X(UD),X(ED),X(Wr),X(fm))},t.\u0275dir=jn({type:t,viewQuery:function(e,r){if(1&e&&Ko(Qg,7),2&e){let i;Er(i=Sr())&&(r._portalOutlet=i.first)}},features:[_r]}),t})(),Qse=(()=>{class t extends Zse{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:e,totalTime:r}){"enter"===e?(this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:r})):"exit"===e&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:r}))}_onAnimationStart({toState:e,totalTime:r}){"enter"===e?this._animationStateChanged.next({state:"opening",totalTime:r}):("exit"===e||"void"===e)&&this._animationStateChanged.next({state:"closing",totalTime:r})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275cmp=pr({type:t,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(e,r){1&e&&lv("@dialogContainer.start",function(o){return r._onAnimationStart(o)})("@dialogContainer.done",function(o){return r._onAnimationDone(o)}),2&e&&(T1("id",r._id),kr("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledBy)("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),uv("@dialogContainer",r._state))},features:[_r],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(e,r){1&e&&oe(0,Xse,0,0,"ng-template",0)},dependencies:[Qg],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[Kse.dialogContainer]}}),t})(),Jse=0;class Jb{constructor(n,e,r="mat-dialog-"+Jse++){this._overlayRef=n,this._containerInstance=e,this.id=r,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new Bt,this._afterClosed=new Bt,this._beforeClosed=new Bt,this._state=0,e._id=r,e._animationStateChanged.pipe(_o(i=>"opened"===i.state),ra(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),e._animationStateChanged.pipe(_o(i=>"closed"===i.state),ra(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),n.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),n.keydownEvents().pipe(_o(i=>27===i.keyCode&&!this.disableClose&&!Ad(i))).subscribe(i=>{i.preventDefault(),b6(this,"keyboard")}),n.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():b6(this,"mouse")})}close(n){this._result=n,this._containerInstance._animationStateChanged.pipe(_o(e=>"closing"===e.state),ra(1)).subscribe(e=>{this._beforeClosed.next(n),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(n){let e=this._getPositionStrategy();return n&&(n.left||n.right)?n.left?e.left(n.left):e.right(n.right):e.centerHorizontally(),n&&(n.top||n.bottom)?n.top?e.top(n.top):e.bottom(n.bottom):e.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(n="",e=""){return this._overlayRef.updateSize({width:n,height:e}),this._overlayRef.updatePosition(),this}addPanelClass(n){return this._overlayRef.addPanelClass(n),this}removePanelClass(n){return this._overlayRef.removePanelClass(n),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function b6(t,n,e){return void 0!==t._containerInstance&&(t._containerInstance._closeInteractionType=n),t.close(e)}const e2=new U("MatDialogData"),ele=new U("mat-dialog-default-options"),y6=new U("mat-dialog-scroll-strategy"),nle={provide:y6,deps:[Rh],useFactory:function tle(t){return()=>t.scrollStrategies.block()}};let rle=(()=>{class t{constructor(e,r,i,o,a,s,l,c,f,v){this._overlay=e,this._injector=r,this._defaultOptions=i,this._parentDialog=o,this._overlayContainer=a,this._dialogRefConstructor=l,this._dialogContainerType=c,this._dialogDataToken=f,this._animationMode=v,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Bt,this._afterOpenedAtThisLevel=new Bt,this._ariaHiddenElements=new Map,this._dialogAnimatingOpen=!1,this.afterAllClosed=Xy(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(ec(void 0))),this._scrollStrategy=s}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(e,r){if(r=function ile(t,n){return{...n,...t}}(r,this._defaultOptions||new UD),r.id&&this.getDialogById(r.id),this._dialogAnimatingOpen)return this._lastDialogRef;const i=this._createOverlay(r),o=this._attachDialogContainer(i,r);if("NoopAnimations"!==this._animationMode){const s=o._animationStateChanged.subscribe(l=>{"opening"===l.state&&(this._dialogAnimatingOpen=!0),"opened"===l.state&&(this._dialogAnimatingOpen=!1,s.unsubscribe())});this._animationStateSubscriptions||(this._animationStateSubscriptions=new br),this._animationStateSubscriptions.add(s)}const a=this._attachDialogContent(e,o,i,r);return this._lastDialogRef=a,this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(a),a.afterClosed().subscribe(()=>this._removeOpenDialog(a)),this.afterOpened.next(a),o._initializeWithAttachedContent(),a}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._animationStateSubscriptions&&this._animationStateSubscriptions.unsubscribe()}_createOverlay(e){const r=this._getOverlayConfig(e);return this._overlay.create(r)}_getOverlayConfig(e){const r=new Xb({positionStrategy:this._overlay.position().global(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(r.backdropClass=e.backdropClass),r}_attachDialogContainer(e,r){const o=js.create({parent:r&&r.viewContainerRef&&r.viewContainerRef.injector||this._injector,providers:[{provide:UD,useValue:r}]}),a=new Wb(this._dialogContainerType,r.viewContainerRef,o,r.componentFactoryResolver);return e.attach(a).instance}_attachDialogContent(e,r,i,o){const a=new this._dialogRefConstructor(i,r,o.id);if(e instanceof Zl)r.attachTemplatePortal(new p_(e,null,{$implicit:o.data,dialogRef:a}));else{const s=this._createInjector(o,a,r),l=r.attachComponentPortal(new Wb(e,o.viewContainerRef,s));a.componentInstance=l.instance}return a.updateSize(o.width,o.height).updatePosition(o.position),a}_createInjector(e,r,i){const o=e&&e.viewContainerRef&&e.viewContainerRef.injector,a=[{provide:this._dialogContainerType,useValue:i},{provide:this._dialogDataToken,useValue:e.data},{provide:this._dialogRefConstructor,useValue:r}];return e.direction&&(!o||!o.get(su,null,Cr.Optional))&&a.push({provide:su,useValue:{value:e.direction,change:On()}}),js.create({parent:o||this._injector,providers:a})}_removeOpenDialog(e){const r=this.openDialogs.indexOf(e);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((i,o)=>{i?o.setAttribute("aria-hidden",i):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const r=e.parentElement.children;for(let i=r.length-1;i>-1;i--){let o=r[i];o!==e&&"SCRIPT"!==o.nodeName&&"STYLE"!==o.nodeName&&!o.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(o,o.getAttribute("aria-hidden")),o.setAttribute("aria-hidden","true"))}}}_closeDialogs(e){let r=e.length;for(;r--;)e[r].close()}}return t.\u0275fac=function(e){U2()},t.\u0275dir=jn({type:t}),t})(),bx=(()=>{class t extends rle{constructor(e,r,i,o,a,s,l,c){super(e,r,o,s,l,a,Jb,Qse,e2,c)}}return t.\u0275fac=function(e){return new(e||t)(it(Rh),it(js),it(xv,8),it(ele,8),it(y6),it(t,12),it(LD),it(kl,8))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})(),ole=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:[bx,nle],imports:[[hx,ux,Wi],Wi]}),t})(),w6=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/forma_farmaceutica"}getRegistros(){return this.http.get(this.urlEndPoint).pipe(Pt(e=>It(e)))}getRegistrosActivos(){return this.http.get(`${this.urlEndPoint}/activos`).pipe(Pt(e=>It(e)))}getRegistrosInactivos(){return this.http.get(`${this.urlEndPoint}/inactivos`).pipe(Pt(e=>It(e)))}getRegistroId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unico`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}filtrarForma(e){const r=encodeURIComponent(e),i=(new Pn).set("term",r);return this.http.get(`${this.urlEndPoint}/filtrar`,{params:i}).pipe(Pt(this.handleError("filtrarIpss",[])))}handleError(e="operation",r){return i=>(console.error(`${e} failed: ${i.message}`),On(r))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ale(t,n){1&t&&(d(0,"div",10),h(1," No hay registros para mostrar! "),u())}const sle=function(t){return{color:t}},lle=function(){return{color:"#009A94"}},cle=function(){return{color:"red"}};function ule(t,n){if(1&t){const e=Fn();d(0,"tr",14)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td")(6,"button",15),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarRegistro(o))}),d(7,"mat-icon",14),h(8,"edit"),u()()(),d(9,"td")(10,"button",16),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarRegistro(o))}),d(11,"mat-icon",14),h(12,"delete_sweep"),u()()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);N("ngStyle",Si(5,sle,e.estado?"black":"red")),w(2),_e(r+1),w(2),_e(i.primerasmayusculas(e.nombre)),w(3),N("ngStyle",Nt(7,lle)),w(4),N("ngStyle",Nt(8,cle))}}function dle(t,n){if(1&t&&(d(0,"div")(1,"table",11)(2,"thead",12)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Nombre"),u(),d(8,"th"),h(9,"Editar"),u(),d(10,"th"),h(11,"Eliminar"),u()()(),d(12,"tbody"),oe(13,ule,13,9,"tr",13),u()()()),2&t){const e=ae();w(13),N("ngForOf",e.listaregistrosFiltrados)}}let x6=(()=>{class t{constructor(e,r,i,o){this.fb=e,this.servicio=r,this.dialogRef=i,this.data=o,this.nombrebtn="Crear"}ngOnInit(){this.crearFormulario(),this.generalForm.get("nombre").valueChanges.pipe(xo(300),Di(e=>this.servicio.filtrarForma(e))).subscribe(e=>{this.listaregistrosFiltrados=e})}onNoClick(){this.dialogRef.close()}crearFormulario(){this.generalForm=this.fb.group({idForma:[""],nombre:["",[Zn.required]],estado:["true",[Zn.required]]})}mostrarRegistro(e){this.nombrebtn="Actualizar",this.generalForm.setValue({idForma:e.idForma,nombre:e.nombre,estado:e.estado})}create(){this.generalForm.value.usuario=localStorage.getItem("lidersistema"),this.generalForm.valid?"Crear"==this.nombrebtn?this.servicio.create(this.generalForm.value).subscribe(e=>{z().fire({icon:"success",title:"Ok",text:"La forma farmaceutica ha sido creado correctamente"}),this.generalForm.reset(),this.nombrebtn="Crear"},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar la forma farmaceutica en la base de datos!",footer:e.mensaje})}):(console.log(this.generalForm.value),this.servicio.update(this.generalForm.value).subscribe(e=>{this.nombrebtn="Crear",z().fire({icon:"success",title:"Ok",text:"La forma farmaceutica ha sido actualizado correctameente"}),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo actualizar la forma farmaceutica en la base de datos!",footer:e.mensaje})})):z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para crear la forma farmaceutica en la base de datos!"})}eliminarRegistro(e){z().fire({title:"Desea eliminar?",text:"La forma farmaceutica "+e.nombre+" de la base de datos.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.servicio.delete(e.idForma).subscribe(i=>{this.listaregistrosFiltrados=this.listaregistrosFiltrados.filter(o=>o!==e),z().fire({icon:"success",title:"Ok",text:"La forma farmaceutica ha sido eliminado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(w6),X(Jb),X(e2))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-ffarmaceutica"]],decls:18,vars:4,consts:[[1,"container","mt-4"],[1,"w-100","d-block",3,"formGroup"],[1,"row"],[1,"input-group","mb-2"],["type","text","formControlName","nombre","placeholder","Ingrese el nombre de la forma farmaceutica","required","",1,"form-control","border-end-0"],["type","checkbox","formControlName","estado",1,"form-check-input"],[1,"col-6"],[1,"btn","btn-outline-primary","w-100",3,"click"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],["title","Actualizar la forma","type","button",1,"btn","btn-sm",3,"click"],["title","Eliminar la forma","type","button",1,"btn","btn-sm",3,"click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3),qe(4,"input",4),u(),d(5,"div",3),qe(6,"input",5),h(7," Estado "),u(),qe(8,"hr"),d(9,"div",2)(10,"div",6)(11,"button",7),De("click",function(){return i.create()}),h(12),u()(),d(13,"div",6)(14,"button",7),De("click",function(){return i.onNoClick()}),h(15," Cerrar"),u()()()()(),oe(16,ale,2,0,"div",8),oe(17,dle,14,1,"div",9),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(11),Qt(" ",i.nombrebtn,""),w(4),N("ngIf",0==(null==i.listaregistrosFiltrados?null:i.listaregistrosFiltrados.length)),w(1),N("ngIf",(null==i.listaregistrosFiltrados?null:i.listaregistrosFiltrados.length)>0))},dependencies:[ho,Fi,Jo,Wo,Vs,vo,sl,No,zo,Dc,bo,Ro]})}return t})(),C6=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/via_administracion"}getRegistros(){return this.http.get(this.urlEndPoint).pipe(Pt(e=>It(e)))}getRegistrosActivos(){return this.http.get(`${this.urlEndPoint}/activos`).pipe(Pt(e=>It(e)))}getRegistrosInactivos(){return this.http.get(`${this.urlEndPoint}/inactivos`).pipe(Pt(e=>It(e)))}getRegistroId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unico`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}filtrarVia(e){const r=encodeURIComponent(e),i=(new Pn).set("term",r);return this.http.get(`${this.urlEndPoint}/filtrar`,{params:i}).pipe(Pt(this.handleError("filtrarIpss",[])))}handleError(e="operation",r){return i=>(console.error(`${e} failed: ${i.message}`),On(r))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function fle(t,n){1&t&&(d(0,"div",12),h(1," No hay registros para mostrar!\n"),u())}const hle=function(t){return{color:t}},ple=function(){return{color:"#009A94"}},mle=function(){return{color:"red"}};function gle(t,n){if(1&t){const e=Fn();d(0,"tr",16)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td")(6,"button",17),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarRegistro(o))}),d(7,"mat-icon",16),h(8,"edit"),u()()(),d(9,"td")(10,"button",18),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarRegistro(o))}),d(11,"mat-icon",16),h(12,"delete_sweep"),u()()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);N("ngStyle",Si(5,hle,e.estado?"black":"red")),w(2),_e(r+1),w(2),_e(i.primerasmayusculas(e.nombre)),w(3),N("ngStyle",Nt(7,ple)),w(4),N("ngStyle",Nt(8,mle))}}function _le(t,n){if(1&t&&(d(0,"div")(1,"table",13)(2,"thead",14)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Nombre"),u(),d(8,"th"),h(9,"Editar"),u(),d(10,"th"),h(11,"Eliminar"),u()()(),d(12,"tbody"),oe(13,gle,13,9,"tr",15),u()()()),2&t){const e=ae();w(13),N("ngForOf",e.listaregistrosFiltrados)}}let E6=(()=>{class t{constructor(e,r,i,o){this.fb=e,this.servicio=r,this.dialogRef=i,this.data=o,this.nombrebtn="Crear"}ngOnInit(){this.crearFormulario(),this.generalForm.get("nombre").valueChanges.pipe(xo(300),Di(e=>this.servicio.filtrarVia(e))).subscribe(e=>{this.listaregistrosFiltrados=e})}onNoClick(){this.dialogRef.close()}crearFormulario(){this.generalForm=this.fb.group({idVia:[""],nombre:["",[Zn.required]],estado:["true",[Zn.required]]})}mostrarRegistro(e){this.nombrebtn="Actualizar",this.generalForm.setValue({idVia:e.idVia,nombre:e.nombre,estado:e.estado})}create(){this.generalForm.valid?"Crear"==this.nombrebtn?this.servicio.create(this.generalForm.value).subscribe(e=>{z().fire({icon:"success",title:"Ok",text:"La via de administraci\xf3n ha sido creado correctamente"}),this.generalForm.reset(),this.nombrebtn="Crear"},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar la via de administraci\xf3n en la base de datos!",footer:e.mensaje})}):this.servicio.update(this.generalForm.value).subscribe(e=>{this.nombrebtn="Crear",z().fire({icon:"success",title:"Ok",text:"La via de administraci\xf3n ha sido actualizado correctameente"}),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo actualizar la via de administraci\xf3n en la base de datos!",footer:e.mensaje})}):z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para crear la via de administraci\xf3n en la base de datos!"})}eliminarRegistro(e){z().fire({title:"Desea eliminar?",text:"La via de administraci\xf3n "+e.nombre+" de la base de datos.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.servicio.delete(e.idVia).subscribe(i=>{this.listaregistrosFiltrados=this.listaregistrosFiltrados.filter(o=>o!==e),z().fire({icon:"success",title:"Ok",text:"La via de administraci\xf3n ha sido eliminado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(C6),X(Jb),X(e2))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-vadministracion"]],decls:20,vars:4,consts:[[1,"container","mt-4"],[1,"w-100","d-block",3,"formGroup"],[1,"row"],[1,"input-group","mb-2"],["type","text","formControlName","nombre","placeholder","ingrese el nombtre de la via de administraci\xf3n","required","",1,"form-control","border-end-0"],[1,"input-group-text","bg-transparent"],[1,"fa","fa-user"],["type","checkbox","formControlName","estado",1,"form-check-input"],[1,"col-6"],[1,"btn","btn-outline-primary","w-100",3,"click"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],["title","Actualizar la via","type","button",1,"btn","btn-sm",3,"click"],["title","Eliminar la via","type","button",1,"btn","btn-sm",3,"click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3),qe(4,"input",4),d(5,"span",5),qe(6,"i",6),u()(),d(7,"div",3),qe(8,"input",7),h(9," Estado "),u(),qe(10,"hr"),d(11,"div",2)(12,"div",8)(13,"button",9),De("click",function(){return i.create()}),h(14),u()(),d(15,"div",8)(16,"button",9),De("click",function(){return i.onNoClick()}),h(17," Cerrar"),u()()()()(),oe(18,fle,2,0,"div",10),oe(19,_le,14,1,"div",11),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(13),Qt(" ",i.nombrebtn,""),w(4),N("ngIf",0==(null==i.listaregistrosFiltrados?null:i.listaregistrosFiltrados.length)),w(1),N("ngIf",(null==i.listaregistrosFiltrados?null:i.listaregistrosFiltrados.length)>0))},dependencies:[ho,Fi,Jo,Wo,Vs,vo,sl,No,zo,Dc,bo,Ro]})}return t})();class S6{constructor(){this.id=NaN,this.idMedicamento=NaN,this.codEps="",this.valorVenta=0,this.descuento=0}}let l0=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/medicamento"}getRegistros(){return this.http.get(this.urlEndPoint).pipe(Pt(e=>It(e)))}getRegistrosActivos(){return this.http.get(`${this.urlEndPoint}/activos`).pipe(Pt(e=>It(e)))}getRegistrosInactivos(){return this.http.get(`${this.urlEndPoint}/inactivos`).pipe(Pt(e=>It(e)))}getRegistroId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unico`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getMedicamentoBodega(e,r){const i=(new Pn).set("idMedicamento",e).set("idBodega",r);return this.http.get(`${this.urlEndPoint}/bodega`,{params:i}).pipe(Pt(o=>(401!=o.status&&o.error.mensaje&&console.error(o.error.mensaje),It(o))))}adicionarMedicamento(e){return this.http.post(`${this.urlEndPoint}/eps`,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}quitarMedicamento(e,r){const i=(new Pn).set("idMedicamento",e).set("codEps",r);return this.http.delete(`${this.urlEndPoint}/eps`,{params:i}).pipe(Pt(o=>(o.error.mensaje&&console.error(o.error.mensaje),It(o))))}agregarMedicamentoBodegatodas(e){const r=(new Pn).set("idMedicamento",e);return this.http.get(`${this.urlEndPoint}/agregartbodega`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}agregarMedicamentoUnaBodega(e,r){const i=(new Pn).set("idMedicamento",e).set("idBodega",r);return this.http.get(`${this.urlEndPoint}/agregarubodega`,{params:i}).pipe(Pt(o=>(401!=o.status&&o.error.mensaje&&console.error(o.error.mensaje),It(o))))}getMedicamentoContrato(e){const r=(new Pn).set("idMedicamento",e);return this.http.get(`${this.urlEndPoint}/contrato`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getMedicamentoContratoEps(e){const r=(new Pn).set("codEps",e);return this.http.get(`${this.urlEndPoint}/contratoeps`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getMedicamentoFiltrados(e,r,i){const o=(new Pn).set("agotado",e).set("desabastecido",r).set("controlado",i);return this.http.get(`${this.urlEndPoint}/filtro`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getMedicamentoNovigente(){const e=new Pn;return this.http.get(`${this.urlEndPoint}/novigente`,{params:e}).pipe(Pt(r=>(401!=r.status&&r.error.mensaje&&console.error(r.error.mensaje),It(r))))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),pm=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/paciente"}getRegistros(){return this.http.get(this.urlEndPoint).pipe(Pt(e=>It(e)))}getRegistrosActivos(){return this.http.get(`${this.urlEndPoint}/activos`).pipe(Pt(e=>It(e)))}getRegistrosInactivos(){return this.http.get(`${this.urlEndPoint}/inactivos`).pipe(Pt(e=>It(e)))}getRegistroId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unico`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}getRegistroDocumento(e){const r=(new Pn).set("documento",e);return this.http.get(`${this.urlEndPoint}/documento`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}filtrarPacientes(e,r,i,o){const a=(new Pn).set("pNombre",e).set("sNombre",r).set("pApellido",i).set("sApellido",o);return this.http.get(`${this.urlEndPoint}/filtrar`,{params:a}).pipe(Pt(this.handleError("filtrarPacientes",[])))}handleError(e="operation",r){return i=>(console.error(`${e} failed: ${i.message}`),On(r))}getEps(){return this.http.get(`${this.urlEndPoint}/eps`).pipe(Pt(e=>It(e)))}getCategoria(){return this.http.get(`${this.urlEndPoint}/categoria`).pipe(Pt(e=>It(e)))}getTipoDocumento(){return this.http.get(`${this.urlEndPoint}/tipo-documento`).pipe(Pt(e=>It(e)))}exportarPacientes(e){return this.http.post(`${this.urlEndPoint}/exportar`,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}importarPacientes(e){const r=new FormData;return r.append("file",e),this.http.post(`${this.urlEndPoint}/importar`,r)}insertarNuevosPacientes(){return this.http.post(`${this.urlEndPoint}/insertar-nuevos`,null)}actualizarPacienteTemporal(e){return this.http.post(`${this.urlEndPoint}/actualizar-temporal`,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const vle=["mat-button",""],ble=["*"],wle=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],xle=Jg(m_(Oh(class{constructor(t){this._elementRef=t}})));let mm=(()=>{class t extends xle{constructor(e,r,i){super(e),this._focusMonitor=r,this._animationMode=i,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const o of wle)this._hasHostAttributes(o)&&this._getHostElement().classList.add(o);e.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,r){e?this._focusMonitor.focusVia(this._getHostElement(),e,r):this._getHostElement().focus(r)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...e){return e.some(r=>this._getHostElement().hasAttribute(r))}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(fm),X(kl,8))},t.\u0275cmp=pr({type:t,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(e,r){if(1&e&&Ko(Nh,5),2&e){let i;Er(i=Sr())&&(r.ripple=i.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(e,r){2&e&&(kr("disabled",r.disabled||null),Ai("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-button-disabled",r.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[_r],attrs:vle,ngContentSelectors:ble,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,r){1&e&&(Fa(),d(0,"span",0),Ri(1),u(),qe(2,"span",1)(3,"span",2)),2&e&&(w(2),Ai("mat-button-ripple-round",r.isRoundButton||r.isIconButton),N("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",r.isIconButton)("matRippleTrigger",r._getHostElement()))},dependencies:[Nh],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),t})(),D6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[g_,Wi],Wi]}),t})();function Cle(t,n){if(1&t&&(d(0,"option",32),h(1),u()),2&t){const e=n.$implicit,r=ae();N("ngValue",e.idForma)("selected",r.parametro==e.idForma),w(1),_e(e.nombre)}}function Ele(t,n){if(1&t&&(d(0,"option",32),h(1),u()),2&t){const e=n.$implicit,r=ae();N("ngValue",e.idVia)("selected",r.parametro==e.idVia),w(1),Qt("",e.nombre," ")}}function Sle(t,n){1&t&&(d(0,"div",33),h(1," No hay registros para mostrar! "),u())}const Dle=function(t){return{color:t}},HD=function(){return{"font-size":"20px",color:"#009A94"}},Ale=function(){return{"font-size":"20px",color:"orange"}},Tle=function(){return{"font-size":"20px",color:"red"}},A6=function(){return{color:"green"}},Mle=function(){return{color:"#2BB6D7"}},T6=function(){return{color:"red"}};function kle(t,n){if(1&t){const e=Fn();d(0,"tr",29)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),Hi(15,"number"),u(),d(16,"td")(17,"div",37)(18,"mat-icon",38),h(19,"domain"),u(),d(20,"mat-icon",39),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).modificarContrato(o,0))}),h(21,"offline_pin"),u(),d(22,"mat-icon",40),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).modificarContrato(o,1))}),h(23,"clear"),u(),d(24,"mat-icon",41),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarRegistro(o))}),h(25,"edit"),u(),d(26,"mat-icon",42),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarRegistro(o))}),h(27,"delete_sweep"),u()(),d(28,"mat-menu",null,43)(30,"button",28),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).agregarMedicamentotodasBodega(o))}),d(31,"mat-icon",29),h(32,"art_track"),u(),d(33,"span"),h(34,"Agregar en todas las bodega"),u()(),d(35,"button",28),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).modificarMedicamentoBodega(o,0))}),d(36,"mat-icon",29),h(37,"playlist_add"),u(),d(38,"span"),h(39,"Agregar en una bodega"),u()(),d(40,"button",28),De("click",function(){return ht(e),pt(ae(2).reporteEnConstruccion())}),d(41,"mat-icon",29),h(42,"highlight_off"),u(),d(43,"span"),h(44,"Quitar de una bodega"),u()()()()()}if(2&t){const e=n.$implicit,r=n.index,i=go(29),o=ae(2);N("ngStyle",Si(20,Dle,e.estado?"black":"red")),w(2),_e(r+1),w(2),_e(e.idMedicamento),w(2),_e(e.codigoCum),w(2),_e(o.primerasmayusculas(e.nombre)),w(2),_e(e.forma.nombre),w(2),_e(e.via.nombre),w(2),_e("$ "+Xo(15,17,e.valor,"1.0-0")),w(4),N("matMenuTriggerFor",i)("ngStyle",Nt(22,HD)),w(2),N("ngStyle",Nt(23,HD)),w(2),N("ngStyle",Nt(24,Ale)),w(2),N("ngStyle",Nt(25,HD)),w(2),N("ngStyle",Nt(26,Tle)),w(5),N("ngStyle",Nt(27,A6)),w(5),N("ngStyle",Nt(28,Mle)),w(5),N("ngStyle",Nt(29,T6))}}function Fle(t,n){if(1&t&&(d(0,"div")(1,"table",34)(2,"thead",35)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"ID"),u(),d(8,"th"),h(9,"CUM"),u(),d(10,"th"),h(11,"Nombre"),u(),d(12,"th"),h(13,"Forma Farmaceutica"),u(),d(14,"th"),h(15,"Via"),u(),d(16,"th"),h(17,"Precio Unit."),u(),d(18,"th"),h(19,"Gesti\xf3n"),u()()(),d(20,"tbody"),oe(21,kle,45,30,"tr",36),u()()()),2&t){const e=ae();w(21),N("ngForOf",e.listaregistrosFiltrados)}}const Ile=function(){return{color:"#orange"}},Ple=function(){return{color:"2BB6D7"}};let Ole=(()=>{class t{constructor(e,r,i,o,a,s,l){this.fb=e,this.servicio=r,this.servicioPaciente=i,this.servicioBodega=o,this.formaservicio=a,this.viaservicio=s,this.dialog=l,this.lista=[],this.cargarRegistros(),this.cargarFormas(),this.cargarVias(),this.nombrebtn="Crear",this.banderaRegistro=!0}ngOnInit(){this.crearFormulario(),this.generalForm.get("nombre").valueChanges.pipe(xo(300),Di(e=>this.buscarMedicamentos(e))).subscribe(e=>{this.listaregistrosFiltrados=e})}buscarMedicamentos(e){return e&&e.length>3?(e=e.toLocaleLowerCase(),On(this.listaregistros.filter(i=>i.nombre.toLowerCase().includes(e)))):On(this.listaregistros)}cargarRegistros(){z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.servicio.getRegistros().subscribe(e=>{this.listaregistros=e.sort((r,i)=>r.nombre.localeCompare(i.nombre)),this.listaregistrosFiltrados=this.listaregistros,z().close()},e=>{console.error("\u274c Error cargando registros",e),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})}cargarFormas(){this.listFormas=null,this.formaservicio.getRegistros().subscribe(e=>{this.listFormas=e},e=>{console.error(e)})}cargarVias(){this.listVias=null,this.viaservicio.getRegistros().subscribe(e=>{this.listVias=e},e=>{console.error(e)})}crearFormulario(){this.generalForm=this.fb.group({idMedicamento:[""],nombre:["",[Zn.required]],principioActivo:[""],codigoCum:[""],codigoAtc:[""],concentracion:[""],valor:["",[Zn.required]],descuento:[""],codigoBarra:[""],fecCreacion:[""],via:["",[Zn.required]],forma:["",[Zn.required]],estado:[!0,[Zn.required]],desabastecido:[!1,[Zn.required]],agotado:[!1,[Zn.required]],controlado:[!1,[Zn.required]]})}mostrarRegistro(e){this.nombrebtn="Actualizar",this.generalForm.setValue({idMedicamento:e.idMedicamento,nombre:e.nombre,principioActivo:e.principioActivo,codigoCum:e.codigoCum,codigoAtc:e.codigoAtc,concentracion:e.concentracion,valor:e.valor,descuento:e.descuento,codigoBarra:e.codigoBarra,fecCreacion:e.fecCreacion,via:e.via.idVia,forma:e.forma.idForma,estado:e.estado,desabastecido:e.desabastecido,agotado:e.agotado,controlado:e.controlado})}openDialogVia(){this.dialog.open(E6,{width:"400px",data:{}}).afterClosed().subscribe(r=>{r&&(this.cargarVias(),this.generalForm.get("via").setValue(r.nombre))})}openDialogForma(){this.dialog.open(x6,{width:"400px",data:{}}).afterClosed().subscribe(r=>{r&&(this.cargarFormas(),this.generalForm.get("forma").setValue(r.nombre))})}create(){this.generalForm.valid?"Crear"==this.nombrebtn?this.servicio.create(this.generalForm.value).subscribe(e=>{this.cargarRegistros(),z().fire({icon:"success",title:"Ok",text:"El medicamento ha sido creado correctamente"}),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar el medicamento en la base de datos!",footer:e.mensaje})}):this.servicio.update(this.generalForm.value).subscribe(e=>{this.cargarRegistros(),z().fire({icon:"success",title:"Ok",text:"El medicamento ha sido actualizado correctameente"}),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo actualizar el medicamento en la base de datos!",footer:e.mensaje})}):z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para crear el medicamento en la base de datos!"})}eliminarRegistro(e){z().fire({title:"Desea eliminar?",text:"El medicamento "+e.nombre+" de la base de datos.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.servicio.delete(e.idMedicamento).subscribe(i=>{this.listaregistros=this.listaregistros.filter(o=>o!==e),z().fire({icon:"success",title:"Ok",text:"El medicamento ha sido eliminado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.error.mensaje})})})}modificarContrato(e,r){const i=0===r?"Adicionando el medicamento al contrato":"Quitando el medicamento del contrato",o=0===r?"Adicionar":"Quitar";this.listadeEps().then(a=>{z().fire({title:i,html:`\n          <div class="swal-container">           \n            <div>${e.nombre}</div><br>\n            <div class="form-group">      \n              <select id="selectEps" class="form-select">\n                <option value="-1">Seleccione la EPS</option>\n                ${a}                    \n              </select>   \n            </div>         \n          </div>  \n        `,showCancelButton:!0,confirmButtonText:o,cancelButtonText:"Cancelar"}).then(s=>{if(s.isConfirmed){const c=document.getElementById("selectEps").value;if("-1"!==c){let f="";if(0===r){const v=new S6;v.idMedicamento=e.idMedicamento,v.codEps=c,f=`Se realiz\xf3 el tr\xe1mite de adici\xf3n del medicamento ${e.nombre} al contrato con la EPS ${c} con \xe9xito!`,this.ejecutarAccion(()=>this.servicio.adicionarMedicamento(v),f)}else f=`Se realiz\xf3 el tr\xe1mite de eliminaci\xf3n del medicamento ${e.nombre} al contrato con la EPS ${c} con \xe9xito!`,this.ejecutarAccion(()=>this.servicio.quitarMedicamento(e.idMedicamento,c),f)}else z().fire("Falta!",`No has seleccionado la EPS para proceder con el tramite del medicamento ${e.nombre}`,"warning")}})})}listadeEps(){var e=this;return(0,hi.Z)(function*(){try{return(yield e.servicioPaciente.getEps().toPromise()).map(i=>`<option value="${i.codigo}">${i.codigo} - ${i.nombre}</option>`).join("")}catch(r){return void console.error(r)}})()}ejecutarAccion(e,r){e().subscribe(()=>{z().fire({icon:"success",title:"Ok",text:r})},i=>{z().fire({icon:"error",title:"Error...",text:"No se pudo realizar el tr\xe1mite con el medicamento!",footer:i.error.mensaje})})}modificarMedicamentoBodega(e,r){const i=0===r?"Adicionando el medicamento a la bodega":"Quitando el medicamento de la bodega",o=0===r?"Adicionar":"Quitar";this.listadeBodegas().then(a=>{z().fire({title:i,html:`\n          <div class="swal-container">           \n            <div>${e.nombre}</div><br>\n            <div class="form-group">      \n              <select id="selectBodega" class="form-select">\n                <option value="-1">Seleccione la bodega</option>\n                ${a}                    \n              </select>   \n            </div>         \n          </div>  \n        `,showCancelButton:!0,confirmButtonText:o,cancelButtonText:"Cancelar"}).then(s=>{if(s.isConfirmed){const c=document.getElementById("selectBodega").value;if("-1"!==c){let f="";0===r?(f=`Se realiz\xf3 el tr\xe1mite de adici\xf3n del medicamento ${e.nombre} a la bodega   ${c} con \xe9xito!`,this.ejecutarAccion(()=>this.servicio.agregarMedicamentoUnaBodega(e.idMedicamento,+c),f)):(f=`Se realiz\xf3 el retiro del medicamento ${e.nombre} en la bodega con \xe9xito!`,this.ejecutarAccion(()=>this.servicio.quitarMedicamento(e.idMedicamento,c),f))}else z().fire("Falta!",`No has seleccionado la bodega para proceder con el tramite del medicamento ${e.nombre}`,"warning")}})})}listadeBodegas(){var e=this;return(0,hi.Z)(function*(){try{return(yield e.servicioBodega.getRegistrosActivos().toPromise()).map(i=>`<option value="${i.idBodega}">${i.idBodega} - ${i.nombre}</option>`).join("")}catch(r){return void console.error(r)}})()}agregarMedicamentotodasBodega(e){z().fire({title:"Confirmar",text:`Agregar el medicamento ${e.nombre} en todas las bodegas activas!`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, agregar!"}).then(r=>{r.isConfirmed&&this.servicio.agregarMedicamentoBodegatodas(e.idMedicamento).subscribe(i=>{z().fire({icon:"success",title:"Ok",text:"El medicamento ha sido agregado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.error.mensaje})})})}reporteMedicamentosFiltrados(e,r,i,o,a){this.datosMedicamentosFiltrados(e,r,i,o).then(s=>{const l=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let c="{total_pages_count_string}",f=1,v="Fecha y hora del reporte "+(new Date).toLocaleString();Zc()(l,{head:[["Nro","CUM","ID","Nombre del medicamento","Presentaci\xf3n","Cantidad existente"]],body:s,startY:25,theme:"striped",willDrawPage:function(k){l.setFontSize(11),l.setDrawColor(0);let T=l.internal.pageSize.getWidth()/2-l.getTextWidth("REPORTE DE MEDICAMENTOS "+a)/2,R=l.getTextWidth("REPORTE DE MEDICAMENTOS "+a);l.setDrawColor("#D3E3FD"),l.setFillColor("#D3E3FD"),l.roundedRect(T-10,9,R+20,7,3,3,"FD"),l.addImage("/assets/logo.png","JPEG",8,8,25,20),l.text("REPORTE DE MEDICAMENTOS "+a,T,14),l.setTextColor("#000000"),T=l.internal.pageSize.getWidth()/2-l.getTextWidth(v)/2,l.text(v,T,21)},didDrawPage:function(k){l.setFontSize(10),l.text("P\xe1gina "+f+" de "+c,170,l.internal.pageSize.height-10),l.text("CALLE 24 #18A-101 Barrio Santa Catalina ",12,l.internal.pageSize.height-12),l.text("Cel: 3004407974, Email: npizarro@sism.com.co",12,l.internal.pageSize.height-7),l.setLineWidth(1.3),l.setDrawColor(236,255,83),l.line(10,l.internal.pageSize.height-20,10,l.internal.pageSize.height-5),f++}}),"function"==typeof l.putTotalPages&&l.putTotalPages(c);var E=l.output("datauri"),D=window.open();D?D.document.write('<iframe src="'+E+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")})}datosMedicamentosFiltrados(e,r,i,o){var a=this;return(0,hi.Z)(function*(){const s=[];let l;try{l=o?yield a.servicio.getMedicamentoNovigente().toPromise():yield a.servicio.getMedicamentoFiltrados(e,r,i).toPromise(),a.lista=l,a.lista.sort((c,f)=>c.nombre.localeCompare(f.nombre));for(let c=0;c<a.lista.length;c++){const f=[(c+1).toString(),a.lista[c].cum,a.lista[c].idMedicamento,a.lista[c].nombre,a.primerasmayusculas(a.lista[c].forma),a.lista[c].cantidad];s.push(f)}return s.length>0?s:void 0}catch(c){return void console.error(c)}})()}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}reporteEnConstruccion(){z().fire({icon:"info",title:"En construcci\xf3n!",text:"El proceso esta en proceso de construcci\xf3n, te estaremos informando cuando est\xe9 disponible!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(l0),X(pm),X(Ts),X(w6),X(C6),X(bx))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-medicamento"]],decls:87,vars:15,consts:[[1,"container","mt-4"],[1,"w-100","d-block",3,"formGroup"],[1,"row"],[1,"col-sm"],[1,"input-group","mb-2"],["type","text","formControlName","nombre","placeholder","Ingrese el nombre del medicamento","required","",1,"form-control","border-end-0"],[1,"input-group-text","bg-transparent"],[1,"fa","fa-user"],["type","text","formControlName","principioActivo","placeholder","Ingrese el principio activo",1,"form-control","border-end-0"],["type","text","formControlName","codigoCum","placeholder","Ingrese el codigo CUM","required","",1,"form-control","border-end-0"],["type","text","formControlName","codigoAtc","placeholder","Ingrese el codigo ATC",1,"form-control","border-end-0"],["type","text","formControlName","concentracion","placeholder","Ingrese la concentraci\xf3n",1,"form-control","border-end-0"],[1,"mb-3","d-flex","align-items-center"],[1,"input-group"],["formControlName","forma","required","",1,"form-select"],["selected","","value",""],[3,"ngValue","selected",4,"ngFor","ngForOf"],["mat-icon-button","","type","button",3,"click"],["formControlName","via","required","",1,"form-select"],["type","number","formControlName","valor","placeholder","Ingrese el precio","required","",1,"form-control","border-end-0"],["type","checkbox","formControlName","estado",1,"form-check-input",2,"margin-right","5px"],["type","checkbox","formControlName","desabastecido",1,"form-check-input",2,"margin-right","5px","margin-left","30px"],["type","checkbox","formControlName","agotado",1,"form-check-input",2,"margin-right","5px","margin-left","30px"],["type","checkbox","formControlName","controlado",1,"form-check-input",2,"margin-right","5px","margin-left","30px"],[1,"col-6"],[1,"btn","btn-outline-primary","w-50",3,"click"],[1,"btn","btn-outline-primary","w-50",3,"matMenuTriggerFor"],["menuMed","matMenu"],["mat-menu-item","",3,"click"],[3,"ngStyle"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[3,"ngValue","selected"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm","mt-2"],[1,"thead-colored"],[3,"ngStyle",4,"ngFor","ngForOf"],[2,"display","flex","align-items","center"],["title","Gestionar el medicamento en la bodega",1,"pointer-cursor",3,"matMenuTriggerFor","ngStyle"],["title","Asociar el medicamento al contrato",1,"pointer-cursor",3,"ngStyle","click"],["title","Quitar el medicamento del contrato",1,"pointer-cursor",3,"ngStyle","click"],["title","Actualizar el medicamento",1,"pointer-cursor",3,"ngStyle","click"],["title","Eliminar el medicamento",1,"pointer-cursor",3,"ngStyle","click"],["menu","matMenu"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4),qe(5,"input",5),d(6,"span",6),qe(7,"i",7),u()(),d(8,"div",4),qe(9,"input",8),d(10,"span",6),qe(11,"i",7),u()(),d(12,"div",4),qe(13,"input",9),d(14,"span",6),qe(15,"i",7),u()(),d(16,"div",4),qe(17,"input",10),d(18,"span",6),qe(19,"i",7),u()(),d(20,"div",4),qe(21,"input",11),d(22,"span",6),qe(23,"i",7),u()(),d(24,"div",12)(25,"div",13)(26,"select",14)(27,"option",15),h(28,"Seleccione forma farmaceutica"),u(),oe(29,Cle,2,3,"option",16),u(),d(30,"button",17),De("click",function(){return i.openDialogForma()}),d(31,"mat-icon"),h(32,"add_circle"),u()()()(),d(33,"div",12)(34,"div",13)(35,"select",18)(36,"option",15),h(37,"Seleccione via de administraci\xf3n"),u(),oe(38,Ele,2,3,"option",16),u(),d(39,"button",17),De("click",function(){return i.openDialogVia()}),d(40,"mat-icon"),h(41,"add_circle"),u()()()(),d(42,"div",4),qe(43,"input",19),d(44,"span",6),qe(45,"i",7),u()(),d(46,"div",4),qe(47,"input",20),h(48," Vigente "),qe(49,"input",21),h(50," Desabastecido "),qe(51,"input",22),h(52," Agotado "),qe(53,"input",23),h(54," Controlado "),u(),qe(55,"hr"),d(56,"div",2)(57,"div",24)(58,"button",25),De("click",function(){return i.create()}),h(59),u(),d(60,"button",26),h(61," Imprimir"),u()(),d(62,"mat-menu",null,27)(64,"button",28),De("click",function(){return i.reporteMedicamentosFiltrados(!0,!1,!1,!1,"AGOTADOS")}),d(65,"mat-icon",29),h(66,"print"),u(),d(67,"span"),h(68,"Agotados"),u()(),d(69,"button",28),De("click",function(){return i.reporteMedicamentosFiltrados(!1,!1,!0,!1,"CONTROLADOS")}),d(70,"mat-icon",29),h(71,"print"),u(),d(72,"span"),h(73,"Controlados"),u()(),d(74,"button",28),De("click",function(){return i.reporteMedicamentosFiltrados(!1,!0,!1,!1,"DESABASTECIDOS")}),d(75,"mat-icon",29),h(76,"print"),u(),d(77,"span"),h(78,"Desabastecidos"),u()(),d(79,"button",28),De("click",function(){return i.reporteMedicamentosFiltrados(!1,!1,!1,!0,"NO VIGENTES")}),d(80,"mat-icon",29),h(81,"print"),u(),d(82,"span"),h(83,"No vigentes"),u()()()()(),qe(84,"div",3),u()(),oe(85,Sle,2,0,"div",30),oe(86,Fle,22,1,"div",31),u()),2&r){const o=go(63);w(1),N("formGroup",i.generalForm),w(28),N("ngForOf",i.listFormas),w(9),N("ngForOf",i.listVias),w(21),Qt(" ",i.nombrebtn,""),w(1),N("matMenuTriggerFor",o),w(5),N("ngStyle",Nt(11,Ile)),w(5),N("ngStyle",Nt(12,A6)),w(5),N("ngStyle",Nt(13,Ple)),w(5),N("ngStyle",Nt(14,T6)),w(5),N("ngIf",0==(null==i.listaregistros?null:i.listaregistros.length)),w(1),N("ngIf",(null==i.listaregistros?null:i.listaregistros.length)>0)}},dependencies:[ho,Fi,Jo,n0,Of,r0,mm,Wo,Vs,cl,ul,vo,wd,sl,Ss,No,zo,Dc,bo,Ro,jE]})}return t})();const M6=new Set;let v_,k6=(()=>{class t{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Rle}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function Nle(t){if(!M6.has(t))try{v_||(v_=document.createElement("style"),v_.setAttribute("type","text/css"),document.head.appendChild(v_)),v_.sheet&&(v_.sheet.insertRule(`@media ${t} {body{ }}`,0),M6.add(t))}catch(n){console.error(n)}}(e),this._matchMedia(e)}}return t.\u0275fac=function(e){return new(e||t)(it(Ka))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Rle(t){return{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}let Lle=(()=>{class t{constructor(e,r){this._mediaMatcher=e,this._zone=r,this._queries=new Map,this._destroySubject=new Bt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return F6(rx(e)).some(i=>this._registerQuery(i).mql.matches)}observe(e){let o=w5(F6(rx(e)).map(a=>this._registerQuery(a).observable));return o=Lv(o.pipe(ra(1)),o.pipe(gR(1),xo(0))),o.pipe(gr(a=>{const s={matches:!1,breakpoints:{}};return a.forEach(({matches:l,query:c})=>{s.matches=s.matches||l,s.breakpoints[c]=l}),s}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const r=this._mediaMatcher.matchMedia(e),o={observable:new Ht(a=>{const s=l=>this._zone.run(()=>a.next(l));return r.addListener(s),()=>{r.removeListener(s)}}).pipe(ec(r),gr(({matches:a})=>({query:e,matches:a})),Co(this._destroySubject)),mql:r};return this._queries.set(e,o),o}}return t.\u0275fac=function(e){return new(e||t)(it(k6),it(Wr))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function F6(t){return t.map(n=>n.split(",")).reduce((n,e)=>n.concat(e)).map(n=>n.trim())}function jle(t,n){if(1&t){const e=Fn();d(0,"div",1)(1,"button",2),De("click",function(){return ht(e),pt(ae().action())}),h(2),u()()}if(2&t){const e=ae();w(2),_e(e.data.action)}}function Vle(t,n){}const I6=new U("MatSnackBarData");class yx{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}const Ule=Math.pow(2,31)-1;class zD{constructor(n,e){this._overlayRef=e,this._afterDismissed=new Bt,this._afterOpened=new Bt,this._onAction=new Bt,this._dismissedByAction=!1,this.containerInstance=n,this.onAction().subscribe(()=>this.dismiss()),n._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(n){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(n,Ule))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}let Hle=(()=>{class t{constructor(e,r){this.snackBarRef=e,this.data=r}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return t.\u0275fac=function(e){return new(e||t)(X(zD),X(I6))},t.\u0275cmp=pr({type:t,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(e,r){1&e&&(d(0,"span"),h(1),u(),oe(2,jle,3,1,"div",0)),2&e&&(w(1),_e(r.data.message),w(1),N("ngIf",r.hasAction))},dependencies:[mm,Fi],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}\n"],encapsulation:2,changeDetection:0}),t})();const zle={snackBarState:Zg("state",[Gu("void, hidden",wa({transform:"scale(0.8)",opacity:0})),Gu("visible",wa({transform:"scale(1)",opacity:1})),au("* => visible",ou("150ms cubic-bezier(0, 0, 0.2, 1)")),au("* => void, * => hidden",ou("75ms cubic-bezier(0.4, 0.0, 1, 1)",wa({opacity:0})))])};let $le=(()=>{class t extends cx{constructor(e,r,i,o,a){super(),this._ngZone=e,this._elementRef=r,this._changeDetectorRef=i,this._platform=o,this.snackBarConfig=a,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new Bt,this._onExit=new Bt,this._onEnter=new Bt,this._animationState="void",this.attachDomPortal=s=>(this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachDomPortal(s)),this._live="assertive"!==a.politeness||a.announcementMessage?"off"===a.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(e)}attachTemplatePortal(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(e)}onAnimationEnd(e){const{fromState:r,toState:i}=e;if(("void"===i&&"void"!==r||"hidden"===i)&&this._completeExit(),"visible"===i){const o=this._onEnter;this._ngZone.run(()=>{o.next(),o.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe(ra(1)).subscribe(()=>{this._onExit.next(),this._onExit.complete()})}_applySnackBarClasses(){const e=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(i=>e.classList.add(i)):e.classList.add(r)),"center"===this.snackBarConfig.horizontalPosition&&e.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&e.classList.add("mat-snack-bar-top")}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),r=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&r){let i=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(i=document.activeElement),e.removeAttribute("aria-hidden"),r.appendChild(e),i?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return t.\u0275fac=function(e){return new(e||t)(X(Wr),X($r),X(Zo),X(Ka),X(yx))},t.\u0275cmp=pr({type:t,selectors:[["snack-bar-container"]],viewQuery:function(e,r){if(1&e&&Ko(Qg,7),2&e){let i;Er(i=Sr())&&(r._portalOutlet=i.first)}},hostAttrs:[1,"mat-snack-bar-container"],hostVars:1,hostBindings:function(e,r){1&e&&lv("@state.done",function(o){return r.onAnimationEnd(o)}),2&e&&uv("@state",r._animationState)},features:[_r],decls:3,vars:2,consts:[["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(e,r){1&e&&(d(0,"div",0),oe(1,Vle,0,0,"ng-template",1),u(),qe(2,"div")),2&e&&(w(2),kr("aria-live",r._live)("role",r._role))},dependencies:[Qg],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[zle.snackBarState]}}),t})(),P6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[hx,ux,xf,D6,Wi],Wi]}),t})();const Wle=new U("mat-snack-bar-default-options",{providedIn:"root",factory:function qle(){return new yx}});let Gle=(()=>{class t{constructor(e,r,i,o,a,s){this._overlay=e,this._live=r,this._injector=i,this._breakpointObserver=o,this._parentSnackBar=a,this._defaultConfig=s,this._snackBarRefAtThisLevel=null,this.simpleSnackBarComponent=Hle,this.snackBarContainerComponent=$le,this.handsetCssClass="mat-snack-bar-handset"}get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}openFromComponent(e,r){return this._attach(e,r)}openFromTemplate(e,r){return this._attach(e,r)}open(e,r="",i){const o={...this._defaultConfig,...i};return o.data={message:e,action:r},o.announcementMessage===e&&(o.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,o)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,r){const o=js.create({parent:r&&r.viewContainerRef&&r.viewContainerRef.injector||this._injector,providers:[{provide:yx,useValue:r}]}),a=new Wb(this.snackBarContainerComponent,r.viewContainerRef,o),s=e.attach(a);return s.instance.snackBarConfig=r,s.instance}_attach(e,r){const i={...new yx,...this._defaultConfig,...r},o=this._createOverlay(i),a=this._attachSnackBarContainer(o,i),s=new zD(a,o);if(e instanceof Zl){const l=new p_(e,null,{$implicit:i.data,snackBarRef:s});s.instance=a.attachTemplatePortal(l)}else{const l=this._createInjector(i,s),c=new Wb(e,void 0,l),f=a.attachComponentPortal(c);s.instance=f.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(Co(o.detachments())).subscribe(l=>{o.overlayElement.classList.toggle(this.handsetCssClass,l.matches)}),i.announcementMessage&&a._onAnnounce.subscribe(()=>{this._live.announce(i.announcementMessage,i.politeness)}),this._animateSnackBar(s,i),this._openedSnackBarRef=s,this._openedSnackBarRef}_animateSnackBar(e,r){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),r.duration&&r.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(r.duration))}_createOverlay(e){const r=new Xb;r.direction=e.direction;let i=this._overlay.position().global();const o="rtl"===e.direction,a="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!o||"end"===e.horizontalPosition&&o,s=!a&&"center"!==e.horizontalPosition;return a?i.left("0"):s?i.right("0"):i.centerHorizontally(),"top"===e.verticalPosition?i.top("0"):i.bottom("0"),r.positionStrategy=i,this._overlay.create(r)}_createInjector(e,r){return js.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:zD,useValue:r},{provide:I6,useValue:e.data}]})}}return t.\u0275fac=function(e){return new(e||t)(it(Rh),it(Koe),it(js),it(Lle),it(t,12),it(Wle))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:P6}),t})();const Yle=["primaryValueBar"],Xle=Jg(class{constructor(t){this._elementRef=t}},"primary"),Kle=new U("mat-progress-bar-location",{providedIn:"root",factory:function Zle(){const t=Xr(si),n=t?t.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),Qle=new U("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");let Jle=0,ece=(()=>{class t extends Xle{constructor(e,r,i,o,a){super(e),this._ngZone=r,this._animationMode=i,this._isNoopAnimation=!1,this._value=0,this._bufferValue=0,this.animationEnd=new Vr,this._animationEndSubscription=br.EMPTY,this.mode="determinate",this.progressbarId="mat-progress-bar-"+Jle++;const s=o?o.getPathname().split("#")[0]:"";this._rectangleFillValue=`url('${s}#${this.progressbarId}')`,this._isNoopAnimation="NoopAnimations"===i,a&&(a.color&&(this.color=this.defaultColor=a.color),this.mode=a.mode||this.mode)}get value(){return this._value}set value(e){this._value=O6(um(e)||0)}get bufferValue(){return this._bufferValue}set bufferValue(e){this._bufferValue=O6(e||0)}_primaryTransform(){return{transform:`scale3d(${this.value/100}, 1, 1)`}}_bufferTransform(){return"buffer"===this.mode?{transform:`scale3d(${this.bufferValue/100}, 1, 1)`}:null}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{const e=this._primaryValueBar.nativeElement;this._animationEndSubscription=lu(e,"transitionend").pipe(_o(r=>r.target===e)).subscribe(()=>{("determinate"===this.mode||"buffer"===this.mode)&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))})})}ngOnDestroy(){this._animationEndSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Wr),X(kl,8),X(Kle,8),X(Qle,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-progress-bar"]],viewQuery:function(e,r){if(1&e&&Ko(Yle,5),2&e){let i;Er(i=Sr())&&(r._primaryValueBar=i.first)}},hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-progress-bar"],hostVars:4,hostBindings:function(e,r){2&e&&(kr("aria-valuenow","indeterminate"===r.mode||"query"===r.mode?null:r.value)("mode",r.mode),Ai("_mat-animation-noopable",r._isNoopAnimation))},inputs:{color:"color",value:"value",bufferValue:"bufferValue",mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[_r],decls:10,vars:4,consts:[["aria-hidden","true"],["width","100%","height","4","focusable","false",1,"mat-progress-bar-background","mat-progress-bar-element"],["x","4","y","0","width","8","height","4","patternUnits","userSpaceOnUse",3,"id"],["cx","2","cy","2","r","2"],["width","100%","height","100%"],[1,"mat-progress-bar-buffer","mat-progress-bar-element",3,"ngStyle"],[1,"mat-progress-bar-primary","mat-progress-bar-fill","mat-progress-bar-element",3,"ngStyle"],["primaryValueBar",""],[1,"mat-progress-bar-secondary","mat-progress-bar-fill","mat-progress-bar-element"]],template:function(e,r){1&e&&(d(0,"div",0),Ns(),d(1,"svg",1)(2,"defs")(3,"pattern",2),qe(4,"circle",3),u()(),qe(5,"rect",4),u(),Eu(),qe(6,"div",5)(7,"div",6,7)(9,"div",8),u()),2&e&&(w(3),N("id",r.progressbarId),w(2),kr("fill",r._rectangleFillValue),w(1),N("ngStyle",r._bufferTransform()),w(1),N("ngStyle",r._primaryTransform()))},dependencies:[Jo],styles:['.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-background{display:none}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:"";display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2000ms infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2000ms infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background{animation:none;transition-duration:1ms}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}\n'],encapsulation:2,changeDetection:0}),t})();function O6(t,n=0,e=100){return Math.max(n,Math.min(e,t))}let tce=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[xf,Wi],Wi]}),t})();function nce(t,n){1&t&&(d(0,"div",26)(1,"div",27)(2,"mat-icon",28),h(3,"cloud_upload"),u(),h(4," Importando datos, por favor espere... "),u(),qe(5,"mat-progress-bar",29),u())}function rce(t,n){1&t&&(d(0,"div",30),h(1," No hay registros para mostrar! "),u())}const N6=function(t){return{color:t}},$D=function(){return{color:"#009A94"}},ice=function(t){return["/menu/formula",t]},oce=function(t){return["/menu/historialformula",t]},ace=function(t){return["/menu/paciente",t]},sce=function(){return{color:"red"}};function lce(t,n){if(1&t){const e=Fn();d(0,"tr",34)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),Hi(13,"date"),u(),d(14,"td"),h(15),u(),d(16,"td"),h(17),u(),d(18,"td"),h(19),u(),d(20,"td")(21,"mat-icon",35),h(22,"playlist_add"),u(),d(23,"mat-icon",36),h(24,"list_alt"),u()(),d(25,"td")(26,"mat-icon",37),h(27,"edit"),u(),d(28,"mat-icon",38),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarRegistro(o))}),h(29,"delete_sweep"),u()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);N("ngStyle",Si(20,N6,e.estado?"black":"red")),w(2),_e(r+1),w(2),_e(e.idPaciente),w(2),_e(e.tipoDoc),w(2),_e(e.numDocumento),w(2),_e(i.primerasmayusculas(e.pNombre+" "+e.sNombre+" "+e.pApellido+" "+e.sApellido)),w(2),Qt("",Xo(13,17,e.fecNacimiento,"dd/MM/yyyy")," "),w(3),Qt("",e.municipio.nombre," "),w(2),Qt("",e.dispensario," "),w(2),_e(e.eps.codigo),w(2),N("ngStyle",Nt(22,$D))("routerLink",Si(23,ice,e.idPaciente)),w(2),N("ngStyle",Nt(25,$D))("routerLink",Si(26,oce,e.idPaciente)),w(3),N("ngStyle",Nt(28,$D))("routerLink",Si(29,ace,e.idPaciente)),w(2),N("ngStyle",Nt(31,sce))}}function cce(t,n){if(1&t&&(d(0,"div")(1,"table",31)(2,"thead",32)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"ID"),u(),d(8,"th"),h(9,"Tipo"),u(),d(10,"th"),h(11,"Documento"),u(),d(12,"th"),h(13,"Nombres y apellidos"),u(),d(14,"th"),h(15,"Nacimiento"),u(),d(16,"th"),h(17,"Municipio"),u(),d(18,"th"),h(19,"Dispensario"),u(),d(20,"th"),h(21,"EPS"),u(),d(22,"th"),h(23,"Formula"),u(),d(24,"th"),h(25,"Gesti\xf3n"),u()()(),d(26,"tbody"),oe(27,lce,30,32,"tr",33),u()()()),2&t){const e=ae();w(27),N("ngForOf",e.listaregistros)}}function uce(t,n){if(1&t){const e=Fn();d(0,"button",45),De("click",function(){ht(e);const i=ae().index;return pt(ae(2).actualizarRegistros(i))}),d(1,"mat-icon",19),h(2,"edit"),u(),h(3," Actualizar "),u()}if(2&t){const e=ae().index;N("disabled",ae(2).loadingAccion[e])}}function dce(t,n){1&t&&(d(0,"span"),h(1,"Agregar"),u())}function fce(t,n){1&t&&(d(0,"div",48)(1,"span",49),h(2,"Agregando..."),u()())}function hce(t,n){1&t&&(d(0,"span"),h(1,"Procesando..."),u())}function pce(t,n){1&t&&(xc(0),h(1,"Guardado OK"),Cc())}const mce=function(t,n){return{"btn-outline-success":t,"btn-success":n,"btn-sm":!0,"action-button":!0}};function gce(t,n){if(1&t){const e=Fn();d(0,"button",46),De("click",function(){ht(e);const i=ae(),o=i.$implicit,a=i.index;return pt(ae(2).insertarNuevos(o.d_1,a))}),d(1,"mat-icon",19),h(2),u(),oe(3,dce,2,0,"span",24),oe(4,fce,3,0,"div",47),oe(5,hce,2,0,"span",24),oe(6,pce,2,0,"ng-container",24),u()}if(2&t){const e=ae().index,r=ae(2);N("ngClass",I1(7,mce,!r.btnGuardar,r.btnGuardar))("disabled",r.btnGuardar),w(2),Qt(" ",r.btnGuardar?"check_circle":"save",""),w(1),N("ngIf",!r.loadingAccion[e]&&!r.btnGuardar),w(1),N("ngIf",r.loadingAccion[e]),w(1),N("ngIf",r.loadingAccion[e]),w(1),N("ngIf",r.btnGuardar)}}function _ce(t,n){if(1&t){const e=Fn();d(0,"button",50),De("click",function(){return ht(e),pt(ae(3).exportarPacientes())}),d(1,"mat-icon",19),h(2,"file_download"),u(),h(3," Exportar "),u()}}function vce(t,n){if(1&t&&(d(0,"tr",34)(1,"td",40),h(2),u(),d(3,"td"),h(4),u(),d(5,"td",40),h(6),u(),d(7,"td",40)(8,"div",41),oe(9,uce,4,1,"button",42),oe(10,gce,7,10,"button",43),oe(11,_ce,4,0,"button",44),u()()()),2&t){const e=n.$implicit,r=n.index;N("ngStyle",Si(7,N6,"ERROR"==e.dato_1?"red":"black")),w(2),_e(r+1),w(2),_e("ERROR"===e.dato_1?"Registros con error":"Registros importados "+e.dato_1),w(2),_e(e.d_1),w(3),N("ngIf","OK_EXISTE"===e.dato_1),w(1),N("ngIf","OK"===e.dato_1),w(1),N("ngIf","ERROR"===e.dato_1)}}function bce(t,n){if(1&t&&(d(0,"div",39)(1,"table",31)(2,"thead",32)(3,"tr")(4,"th",40),h(5,"Item"),u(),d(6,"th",40),h(7,"Descripci\xf3n"),u(),d(8,"th",40),h(9,"Nro. de registros"),u(),d(10,"th",40),h(11,"Acci\xf3n"),u()()(),d(12,"tbody"),oe(13,vce,12,9,"tr",33),u()()()),2&t){const e=ae();w(13),N("ngForOf",e.listaImportacion)}}let yce=(()=>{class t{constructor(e,r,i){this.servicio=e,this.fb=r,this.snackBar=i,this.selectedFile=null,this.isLoading=!1,this.loadingAccion={},this.btnGuardar=!1,this.generalForm=this.fb.group({documento:[""],pNombre:[""],sNombre:[""],pApellido:[""],sApellido:[""]}),this.generalForm.get("pNombre").valueChanges.pipe(xo(300),Di(o=>{const a=this.generalForm.get("pNombre")?.value||"",s=this.generalForm.get("sNombre")?.value||"",l=this.generalForm.get("pApellido")?.value||"",c=this.generalForm.get("sApellido")?.value||"";return this.servicio.filtrarPacientes(a,s,l,c)})).subscribe(o=>{this.listaregistros=o}),this.generalForm.get("sNombre").valueChanges.pipe(xo(300),Di(o=>{const a=this.generalForm.get("pNombre")?.value||"",s=this.generalForm.get("sNombre")?.value||"",l=this.generalForm.get("pApellido")?.value||"",c=this.generalForm.get("sApellido")?.value||"";return this.servicio.filtrarPacientes(a,s,l,c)})).subscribe(o=>{this.listaregistros=o}),this.generalForm.get("pApellido").valueChanges.pipe(xo(300),Di(o=>{const a=this.generalForm.get("pNombre")?.value||"",s=this.generalForm.get("sNombre")?.value||"",l=this.generalForm.get("pApellido")?.value||"",c=this.generalForm.get("sApellido")?.value||"";return this.servicio.filtrarPacientes(a,s,l,c)})).subscribe(o=>{this.listaregistros=o,console.log(o)}),this.generalForm.get("sApellido").valueChanges.pipe(xo(300),Di(o=>{const a=this.generalForm.get("pNombre")?.value||"",s=this.generalForm.get("sNombre")?.value||"",l=this.generalForm.get("pApellido")?.value||"",c=this.generalForm.get("sApellido")?.value||"";return this.servicio.filtrarPacientes(a,s,l,c)})).subscribe(o=>{this.listaregistros=o}),this.generalForm.get("documento").valueChanges.pipe(xo(300),Di(o=>{const a=this.generalForm.get("documento")?.value||"";return this.servicio.getRegistroDocumento(a)})).subscribe(o=>{this.listaregistros=o})}eliminarRegistro(e){z().fire({title:"Desea eliminar?",text:`El paciente ${e.pNombre} ${e.pApellido} de la base de datos.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.servicio.delete(e.idPaciente).subscribe(i=>{this.listaregistros=this.listaregistros.filter(o=>o!==e),z().fire({icon:"success",title:"Ok",text:"El paciente ha sido eliminado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}exportarPacientes(){this.listadeEps().then(e=>{z().fire({title:'<h5 class="mb-3 fw-bold text-primary">Seleccionar EPS paciente</h5>',html:`\n          <div class="form-group text-start">\n            <label for="selectEps" class="form-label">EPS disponibles</label>\n            <select id="selectEps" class="form-select form-select-sm border-secondary" multiple size="6">              \n              ${e}\n            </select>\n            <small class="form-text text-muted mt-1">\n              Mant\xe9n presionado <strong>Ctrl</strong> (Windows) o <strong>Cmd</strong> (Mac) para seleccionar varias opciones.\n            </small>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"\u{1f4e4} Exportar",cancelButtonText:"\u274c Cancelar",focusConfirm:!1,customClass:{popup:"swal-wide",confirmButton:"btn btn-success px-4 me-2",cancelButton:"btn btn-outline-secondary px-4"},buttonsStyling:!1,preConfirm:()=>{const r=document.getElementById("selectEps"),i=Array.from(r.selectedOptions).map(o=>o.value);return i.length||z().showValidationMessage("Debe seleccionar al menos una EPS para exportar los pacientes."),i}}).then(r=>{if(r.isConfirmed&&r.value){const i=r.value;let o;z().fire({title:"Generando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),o=i.includes("*")?{control:0,valores:i}:{control:1,valores:i},this.servicio.exportarPacientes(o).subscribe(a=>{this.listaPaciente=a,z().close(),this.exportarExcelPaciente()},a=>{console.error("\u274c Error cargando registros",a),z().close(),z().fire("Error","No se pudieron cargar los registros para exportar.","error")})}})})}listadeEps(){var e=this;return(0,hi.Z)(function*(){try{const r=yield e.servicio.getEps().toPromise();if(!r||!Array.isArray(r))throw new Error("Respuesta no v\xe1lida");return'<option value="*">Todas</option>'+r.map(i=>`<option value="${i.codigo}">${i.codigo} - ${i.nombre}</option>`).join("")}catch(r){return console.error("Error al cargar EPS:",r),z().fire("Error","No se pudo cargar la lista de EPS.","error"),""}})()}exportarExcelPaciente(){const e=[];e.push(["CONSECUTIVO","TIPO ID","NUMERO IDENTIFICACION","PRIMER APELLIDO","SEGUNDO APELLIDO","PRIMER NOMBRE","SEGUNDO NOMBRE","FECHA DE NACIMIENTO","GENERO","ZONA","DIRECCION","BARRIO","TELEFONO PRINCIPAL","TELEFONO SECUNDARIO","CORREO ELECTRONICO","DEPARTAMENTO AFILIACION","MUNICIPIO AFILIACION","EPS","REGIMEN","CATEGORIA","TIPO AFILIADO","DROGUERIA","ESTADO","PAVE","PORTABILIDAD","DEPARTAMENTO PORTABILIDAD","MUNICIPIO PORTABILIDAD","FECHA VENCE PORTABILIDAD","FECHA DE AFILIACION","ID_PACIENTE"]),this.listaPaciente.forEach((s,l)=>{e.push([l+1,s.tipoDoc||"",s.numDocumento||"",s.pApellido?.toUpperCase()||"",s.sApellido?.toUpperCase()||"",s.pNombre?.toUpperCase()||"",s.sNombre?.toUpperCase()||"",s.fecNacimiento?new Date(s.fecNacimiento).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"",s.sexo||"",s.zona||"",s.direccion||"",s.barrio||"",s.celularPrincipal||"",s.celularSecundario||"",s.email?.toLowerCase()||"",s.departamento||"",s.municipio||"",s.eps||"",s.regimen||"",s.categoria||"",s.tipoAfiliado||"",s.dispensario||"",s.estado?"Activo":"Inactivo",s.pave?"SI":"",s.portabilidad?"SI":"",s.dptoportabilidad||"",s.mpoportabilidad||"",s.fecVencePortabilidad?new Date(s.fecVencePortabilidad).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"",s.fecAfiliacion?new Date(s.fecAfiliacion).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"",s.idPaciente||""])});const i=Gr.aoa_to_sheet(e),o=Gr.decode_range(i["!ref"]);for(let s=o.s.c;s<=o.e.c;s++){const l=i[Gr.encode_cell({r:0,c:s})];l&&(l.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const a=Gr.book_new();Gr.book_append_sheet(a,i,"BD"),Pf(a,"Base_Dato_"+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"La base de  datos de las EPS seleccionadas fue exportado correctamente, en su carpeta de descargas en formato xlsx"})}onFileSelected(e){this.selectedFile=e.target.files[0]}onUpload(){this.selectedFile&&(this.isLoading=!0,this.servicio.importarPacientes(this.selectedFile).subscribe({next:e=>{this.isLoading=!1,this.listaImportacion=e,this.snackBar.open(e,"Cerrar",{duration:3e3})},error:e=>{this.isLoading=!1,this.snackBar.open("Error al importar: "+e.error,"Cerrar",{duration:5e3})}}))}insertarNuevos(e,r){this.loadingAccion[r]||this.btnGuardar?z().fire({icon:"info",title:"Registros ya guardados",text:"Los registros ya fueron guardados correctamente a la Base de Datos, no se deben duplicar"}):(this.loadingAccion[r]=!0,z().fire({title:"\xbfAgregar pacientes?",text:`Se agregaran ${e.toString()}  registros de pacientes OK que fueron importados y no tienen error en la estructura!`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, agregar!",cancelButtonText:"\u274c Cancelar"}).then(i=>{i.isConfirmed?(z().fire({title:"Agregando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.loadingAccion[r]=!0,this.servicio.insertarNuevosPacientes().subscribe({next:()=>{this.loadingAccion[r]=!1,this.btnGuardar=!0,z().close(),z().fire({icon:"success",title:"Ok",text:"Los registros nuevos fueron agregados correctamente a la Base de Datos."})},error:o=>{z().close(),this.loadingAccion[r]=!1,z().fire("Error","Se produjo un error agregando los registros a la base de datos de paciente.","error")}})):this.loadingAccion[r]=!1}))}actualizarRegistros(e){this.loadingAccion[e]||(this.loadingAccion[e]=!0,z().fire({title:'<h5 class="mb-3 fw-bold text-primary">Seleccionar CAMPOS a actualizar</h5>',html:"\n          <div class=\"form-group text-start\">\n            <label for=\"selectEps\" class=\"form-label\">Campos disponibles</label>\n            <select id=\"selectEps\" class=\"form-select form-select-sm border-secondary\" multiple size=\"6\">              \n             <option value='*'>Todos los campos</option>           \n\t\t         <option value='p_apellido'>PRIMER APELLIDO</option>\n             <option value='s_apellido'>SEGUNDO APELLIDO</option>\n             <option value='p_nombre'>PRIMER NOMBRE</option>\n             <option value='s_nombre'>SEGUNDO NOMBRE</option>\n             <option value='fec_nacimiento'>FECHA DE NACIMIENTO</option>\n             <option value='sexo'>SEXO</option>\n             <option value='zona'>ZONA</option>\n             <option value='direccion'>DIRECCION</option>\n             <option value='barrio'>BARRIO</option>\n             <option value='celular_principal'>TELEFONO PRINCIPAL</option>\n\n             <option value='celular_secundario'>TELEFONO SECUNDARIO</option>\n             <option value='email'>CORREO ELECTRONICO</option>\n             <option value='municipio'>MUNICIPIO DE AFILIACION</option>\n             <option value='departamento'>DEPARTAMENTO DE AFILIACION</option>\n             <option value='cod_eps'>EPS</option>\n             <option value='regimen'>REGIMEN</option>\n             <option value='categoria'>CATEGORIA</option>\n             <option value='tipo_afiliado'>TIPO DE AFILIADO</option>\n             <option value='dispensario'>DISPENSARIO</option>\n             <option value='estado'>ESTADO</option>\n             <option value='pave'>PAVE</option>\n             <option value='portabilidad'>PORTABILIDAD</option>\n             <option value='dptoportabilidad'>DEPARTAMENTO EN PORTABILIDAD</option>\n             <option value='mpoportabilidad'>MUNICIPIO EN PORTABILIDAD</option>\n             <option value='fec_vence_portabilidad'>FECHA DE VENCIMIENTO DE LA PORTABILIDAD</option>\n           \n           \n            </select>\n            <small class=\"form-text text-muted mt-1\">\n              Mant\xe9n presionado <strong>Ctrl</strong> (Windows) o <strong>Cmd</strong> (Mac) para seleccionar varias opciones.\n            </small>\n           <br>\n            <small class=\"form-text text-muted mt-1\">\n              Ejemplo DATO_ACTUAL = <strong>DATO_NUEVO</strong> de cada campo seleccionado.\n            </small>\n          </div>\n        ",showCancelButton:!0,confirmButtonText:"Actualizar",cancelButtonText:"\u274c Cancelar",focusConfirm:!1,customClass:{popup:"swal-wide",confirmButton:"btn btn-success px-4 me-2",cancelButton:"btn btn-outline-secondary px-4"},buttonsStyling:!1,preConfirm:()=>{const r=document.getElementById("selectEps"),i=Array.from(r.selectedOptions).map(o=>o.value);return i.length||z().showValidationMessage("Debe seleccionar al menos un CAMPO para realizar la actualizaci\xf3n."),i}}).then(r=>{if(r.isConfirmed&&r.value){const i=r.value;let o;z().fire({title:"Actualizando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),o=i.includes("*")?{control:0,valores:i}:{control:1,valores:i},this.servicio.actualizarPacienteTemporal(o).subscribe(a=>{console.log(a),this.loadingAccion[e]=!1,z().close(),z().fire({icon:"success",title:"Ok",text:"Se actualizadon XXX registros correctamente a la Base de Datos de paciente en los campos seleccionados."})},a=>{console.error("\u274c Error actualizando registros en la tabla paciente",a),this.loadingAccion[e]=!1,z().close(),z().fire("Error","No se pudieron actualizar los registros a latabla paciente.","error")})}else this.loadingAccion[e]=!1}))}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(pm),X(ea),X(Gle))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-buscarpaciente"]],decls:59,vars:6,consts:[[1,"container","mt-4"],[1,"row","g-2","align-items-end","mb-3",3,"formGroup"],[1,"col-md"],["for","documento",1,"form-label","small","mb-1"],[1,"input-group","input-group-sm"],[1,"input-group-text","bg-white","border-end-0"],[1,"text-info"],["id","documento","type","text","formControlName","documento","placeholder","Ej: 12345678",1,"form-control"],["for","pNombre",1,"form-label","small","mb-1"],["id","pNombre","type","text","formControlName","pNombre","placeholder","Ej: Juan",1,"form-control"],["for","sNombre",1,"form-label","small","mb-1"],["id","sNombre","type","text","formControlName","sNombre","placeholder","Ej: Carlos",1,"form-control"],["for","pApellido",1,"form-label","small","mb-1"],["id","pApellido","type","text","formControlName","pApellido","placeholder","Ej: Perez",1,"form-control"],["for","sApellido",1,"form-label","small","mb-1"],["id","sApellido","type","text","formControlName","sApellido","placeholder","Ej: Gomez",1,"form-control"],[1,"col-md-auto","d-grid"],[1,"form-label","small","invisible"],["type","button",1,"btn","btn-outline-success","btn-sm","d-flex","align-items-center","justify-content-center",3,"click"],[1,"me-1"],["type","file",3,"change"],["mat-raised-button","","color","primary",3,"disabled","click"],["class","loading-container",4,"ngIf"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],["class","table-container",4,"ngIf"],[1,"loading-container"],[1,"loading-message"],[1,"loading-icon"],["mode","indeterminate","color","accent",1,"custom-progress"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],["title","Nueva formula",1,"pointer-cursor",3,"ngStyle","routerLink"],["title","formulas paciente",1,"pointer-cursor",3,"ngStyle","routerLink"],["title","Actualizar el paciente",1,"pointer-cursor",3,"ngStyle","routerLink"],["title","Eliminar el paciente",1,"pointer-cursor",3,"ngStyle","click"],[1,"table-container"],[1,"text-center"],[1,"button-container"],["type","button","class","btn btn-outline-primary btn-sm action-button",3,"disabled","click",4,"ngIf"],[3,"ngClass","disabled","click",4,"ngIf"],["type","button","class","btn btn-outline-danger btn-sm action-button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-sm","action-button",3,"disabled","click"],[3,"ngClass","disabled","click"],["class","spinner-border spinner-border-sm text-light me-1","role","status",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","text-light","me-1"],[1,"visually-hidden"],["type","button",1,"btn","btn-outline-danger","btn-sm","action-button",3,"click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),h(4,"Documento"),u(),d(5,"div",4)(6,"span",5)(7,"mat-icon",6),h(8,"search"),u()(),qe(9,"input",7),u()(),d(10,"div",2)(11,"label",8),h(12,"Primer nombre"),u(),d(13,"div",4)(14,"span",5)(15,"mat-icon",6),h(16,"search"),u()(),qe(17,"input",9),u()(),d(18,"div",2)(19,"label",10),h(20,"Segundo nombre"),u(),d(21,"div",4)(22,"span",5)(23,"mat-icon",6),h(24,"search"),u()(),qe(25,"input",11),u()(),d(26,"div",2)(27,"label",12),h(28,"Primer apellido"),u(),d(29,"div",4)(30,"span",5)(31,"mat-icon",6),h(32,"search"),u()(),qe(33,"input",13),u()(),d(34,"div",2)(35,"label",14),h(36,"Segundo apellido"),u(),d(37,"div",4)(38,"span",5)(39,"mat-icon",6),h(40,"search"),u()(),qe(41,"input",15),u()(),d(42,"div",16)(43,"label",17),h(44,"Exportar"),u(),d(45,"button",18),De("click",function(){return i.exportarPacientes()}),d(46,"mat-icon",19),h(47,"file_download"),u(),h(48,"Exportar a Xlsx "),u()(),d(49,"div")(50,"input",20),De("change",function(a){return i.onFileSelected(a)}),u(),d(51,"button",21),De("click",function(){return i.onUpload()}),d(52,"mat-icon"),h(53,"upload"),u(),h(54," Importar Datos "),u()(),oe(55,nce,6,0,"div",22),u(),oe(56,rce,2,0,"div",23),oe(57,cce,28,1,"div",24),oe(58,bce,14,1,"div",25),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(50),N("disabled",i.isLoading),w(4),N("ngIf",i.isLoading),w(1),N("ngIf",0==(null==i.listaregistros?null:i.listaregistros.length)),w(1),N("ngIf",(null==i.listaregistros?null:i.listaregistros.length)>0),w(1),N("ngIf",(null==i.listaImportacion?null:i.listaImportacion.length)>0))},dependencies:[wf,ho,Fi,Jo,Hs,mm,Wo,vo,No,zo,bo,Ro,ece,Sc],styles:['class="custom-progress".table-container[_ngcontent-%COMP%]{padding:20px;max-width:100%;overflow-x:auto}.table[_ngcontent-%COMP%]{width:100%;border-radius:8px;box-shadow:0 2px 4px #d7d7d6}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:4px 15px}td[_ngcontent-%COMP%]{vertical-align:middle}.action-button[_ngcontent-%COMP%]{width:150px;height:40px;margin:0 5px;display:flex;justify-content:center;align-items:center}.action-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px}button[_ngcontent-%COMP%]:focus{outline:none;box-shadow:none}button[_ngcontent-%COMP%]:hover{background-color:#083f76}button[_ngcontent-%COMP%]:active{transform:scale(.98)}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:5px}loading-container[_ngcontent-%COMP%]{margin-top:16px;padding:12px;border-radius:6px;background-color:#f9f9f9;box-shadow:0 1px 3px #0000001a}.loading-message[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:14px;color:#555;margin-bottom:8px}.loading-icon[_ngcontent-%COMP%]{margin-right:8px;color:#3f51b5}.custom-progress[_ngcontent-%COMP%]{height:14px;border-radius:8px}']})}return t})();function wce(t,n){if(1&t&&(d(0,"option",73),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),fo("",e.codigo," - ",e.descripcion,"")}}function xce(t,n){if(1&t&&(d(0,"option",73),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),_e(e.nombre)}}function Cce(t,n){if(1&t&&(d(0,"option",73),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),_e(e.nombre)}}function Ece(t,n){if(1&t&&(d(0,"option",73),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),_e(e.nombre)}}function Sce(t,n){if(1&t&&(d(0,"option",73),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),fo("",e.nombre," - ",e.valor,"")}}function Dce(t,n){if(1&t&&(d(0,"option",73),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),_e(e.nombre)}}function Ace(t,n){if(1&t){const e=Fn();d(0,"div",3)(1,"div",4)(2,"label",74),h(3,"Dpto Portabilidad"),u(),d(4,"select",75),De("change",function(){return ht(e),pt(ae().onDptoPortabilidadSeleccionado())}),d(5,"option",7),h(6,"Seleccione el departamento portabilidad"),u(),oe(7,Dce,2,2,"option",8),u()()()}if(2&t){const e=ae();w(7),N("ngForOf",e.listaDpto)}}function Tce(t,n){if(1&t&&(d(0,"option",73),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),_e(e.nombre)}}function Mce(t,n){if(1&t&&(d(0,"div",3)(1,"div",4)(2,"label",76),h(3,"Mpio portabilidad "),u(),d(4,"select",77)(5,"option",7),h(6,"Seleccione el municipio de portabilidad"),u(),oe(7,Tce,2,2,"option",8),u()()()),2&t){const e=ae();w(7),N("ngForOf",e.listaMpioPortabilidad)}}function kce(t,n){if(1&t&&(d(0,"div",3)(1,"div",4)(2,"label",78),h(3,"F. Vence portabilidad"),u(),qe(4,"input",79),u()()),2&t){const e=ae();w(4),N("min",e.hoy)}}let R6=(()=>{class t{constructor(e,r,i,o){this.fb=e,this.servicio=r,this.servicioBodega=i,this.activatedRoute=o,this.mostrarPortabilidad=!1,this.nombrebtn="Crear",this.cargarDepartamentos(),this.cargarEps(),this.cargarCategoria(),this.cargarTipoDocumento()}ngOnInit(){this.crearFormulario(),this.activatedRoute.paramMap.subscribe(r=>{let i=+r.get("id");this.servicio.getRegistroId(i).subscribe(o=>{this.mostrarRegistro(o)})}),this.hoy=(new Date).toISOString().split("T")[0]}onDptoSeleccionado(){const e=this.generalForm.get("departamento")?.value;this.servicioBodega.getMunicipiosDepartamento(e).subscribe(r=>{this.listaMpio=r},r=>{console.error(r)})}onDptoPortabilidadSeleccionado(){const e=this.generalForm.get("dptoportabilidad")?.value;this.servicioBodega.getMunicipiosDepartamento(e).subscribe(r=>{this.listaMpioPortabilidad=r},r=>{console.error(r)})}cargarDepartamentos(){this.servicioBodega.getDepartamentos().subscribe(e=>{this.listaDpto=e},e=>{console.error(e)})}cargarEps(){this.servicio.getEps().subscribe(e=>{this.listaEps=e},e=>{console.error(e)})}cargarCategoria(){this.servicio.getCategoria().subscribe(e=>{this.listaCategoria=e},e=>{console.error(e)})}cargarTipoDocumento(){this.servicio.getTipoDocumento().subscribe(e=>{this.listaTiposDoc=e},e=>{console.error(e)})}buscarDocumento(){const e=this.generalForm.get("numDocumento")?.value;e&&this.servicio.getRegistroDocumento(e).subscribe(r=>{r&&r.length>1?z().fire({icon:"error",title:"DOCUMENTO DUPLICADO",text:"Este documento est\xe1 duplicado en la base de datos. Identifique claramente al paciente para entregar el medicamento."}):r&&1===r.length?(z().fire({icon:"info",title:"EXISTE",text:"El documento  n\xfamero  "+e+" que esta ingresando ya existe con el nombre "+r[0].pNombre+" "+r[0].sNombre+" "+r[0].pApellido+" "+r[0].sApellido}),this.mostrarRegistro(r[0])):console.log("Documento no encontrado")},r=>{console.error("Error al buscar el documento",r)})}crearFormulario(){this.generalForm=this.fb.group({idPaciente:[""],tipoDoc:["",[Zn.required]],numDocumento:["",[Zn.required]],pApellido:["",[Zn.required]],sApellido:[""],pNombre:["",[Zn.required]],sNombre:[""],estado:[!0,[Zn.required]],fecNacimiento:[""],sexo:[""],zona:[""],barrio:[""],direccion:[""],celularPrincipal:[""],celularSecundario:[""],email:[""],eps:[""],regimen:[""],tipoAfiliado:[""],categoria:[""],departamento:[""],municipio:[""],dispensario:[""],pave:[!1],portabilidad:[!1],dptoportabilidad:[""],mpoportabilidad:[""],fecVencePortabilidad:[""]})}mostrarRegistro(e){this.nombrebtn="Actualizar";var r=e.fecNacimiento?new Date(e.fecNacimiento):null,i=e.fecVencePortabilidad?new Date(e.fecVencePortabilidad):null;this.servicioBodega.getMunicipiosDepartamento(e.departamento).subscribe(o=>{this.listaMpio=o,this.generalForm.patchValue({municipio:e.municipio?.codigo||""})},o=>{console.error(o)}),e.portabilidad&&this.servicioBodega.getMunicipiosDepartamento(e.dptoportabilidad).subscribe(o=>{this.listaMpioPortabilidad=o,this.generalForm.patchValue({mpoportabilidad:e.mpoportabilidad?.codigo||""})},o=>{console.error(o)}),this.generalForm.patchValue({idPaciente:e.idPaciente,pApellido:e.pApellido,sApellido:e.sApellido,pNombre:e.pNombre,sNombre:e.sNombre,tipoDoc:e.tipoDoc,numDocumento:e.numDocumento,fecNacimiento:r?r.toJSON().slice(0,10):null,sexo:e.sexo,zona:e.zona,barrio:e.barrio,direccion:e.direccion,celularPrincipal:e.celularPrincipal,celularSecundario:e.celularSecundario,email:e.email,eps:e.eps.codigo,regimen:e.regimen,tipoAfiliado:e.tipoAfiliado,categoria:e.categoria.codigo,departamento:e.departamento,estado:e.estado,pave:e.pave,dispensario:e.dispensario,dptoportabilidad:e.dptoportabilidad||"",portabilidad:e.portabilidad,fecVencePortabilidad:i?i.toJSON().slice(0,10):null}),this.onPortabilidadChange({target:{checked:e.portabilidad}})}create(){this.generalForm.valid?"Crear"==this.nombrebtn?this.servicio.create(this.generalForm.value).subscribe(e=>{z().fire({icon:"success",title:"Ok",text:"El paciente ha sido creado correctamente"}),this.nombrebtn="Crear",this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar el paciente en la base de datos!",footer:e.mensaje})}):this.servicio.update(this.generalForm.value).subscribe(e=>{this.nombrebtn="Crear",z().fire({icon:"success",title:"Ok",text:"El paciente ha sido actualizado correctameente"}),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo actualizar el paciente en la base de datos!",footer:e.mensaje})}):z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para crear el paciente en la base de datos!"})}onPortabilidadChange(e){this.mostrarPortabilidad=e.target.checked}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(pm),X(Ts),X(Us))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-paciente"]],decls:188,vars:11,consts:[[1,"container","mt-4"],[1,"w-100",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md-4","mb-1"],[1,"form-group"],["for","tipoDoc",1,"form-label"],["id","tipoDoc","formControlName","tipoDoc",1,"form-select","uniform-control"],["selected","","value",""],[3,"ngValue",4,"ngFor","ngForOf"],["for","numDocumento",1,"form-label"],["id","numDocumento","type","text","formControlName","numDocumento","placeholder","Ingrese el documento","required","",1,"form-control","uniform-control",3,"blur"],["for","pApellido",1,"form-label"],["id","pApellido","type","text","formControlName","pApellido","placeholder","Ingrese el primer apellido","required","",1,"form-control","uniform-control"],["for","sApellido",1,"form-label"],["id","sApellido","type","text","formControlName","sApellido","placeholder","Ingrese el segundo apellido",1,"form-control","uniform-control"],["for","pNombre",1,"form-label"],["id","pNombre","type","text","formControlName","pNombre","placeholder","Ingrese el primer nombre","required","",1,"form-control","uniform-control"],["for","sNombre",1,"form-label"],["id","sNombre","type","text","formControlName","sNombre","placeholder","Ingrese el segundo nombre",1,"form-control","uniform-control"],["for","fecNacimiento",1,"form-label"],["id","fecNacimiento","type","date","formControlName","fecNacimiento","required","",1,"form-control","uniform-control",3,"max"],["for","sexo",1,"form-label"],["id","sexo","formControlName","sexo",1,"form-select","uniform-control"],["value","M"],["value","F"],["value","T"],["value","N"],["value","O"],["for","zona",1,"form-label"],["id","zona","formControlName","zona",1,"form-select","uniform-control"],["value","U"],["value","R"],["for","barrio",1,"form-label"],["id","barrio","type","text","formControlName","barrio","placeholder","Ingrese el barrio",1,"form-control","uniform-control"],["for","direccion",1,"form-label"],["id","direccion","type","text","formControlName","direccion","placeholder","Ingrese la direcci\xf3n",1,"form-control","uniform-control"],["for","celularPrincipal",1,"form-label"],["id","celularPrincipal","type","text","formControlName","celularPrincipal","placeholder","Ingrese el celular principal","required","",1,"form-control","uniform-control"],["for","celularSecundario",1,"form-label"],["id","celularSecundario","type","text","formControlName","celularSecundario","placeholder","Ingrese el celular secundario",1,"form-control","uniform-control"],["for","email",1,"form-label"],["id","email","type","email","formControlName","email","placeholder","Ingrese el correo electr\xf3nico",1,"form-control","uniform-control"],["for","departamento",1,"form-label"],["id","departamento","formControlName","departamento","required","",1,"form-select","uniform-control",3,"change"],["for","municipio",1,"form-label"],["id","municipio","formControlName","municipio","required","",1,"form-select","uniform-control"],["for","eps",1,"form-label"],["id","eps","formControlName","eps",1,"form-select","uniform-control"],["for","regimen",1,"form-label"],["id","regimen","formControlName","regimen",1,"form-select","uniform-control"],["value","C"],["value","S"],["for","tipoAfiliado",1,"form-label"],["id","tipoAfiliado","formControlName","tipoAfiliado",1,"form-select","uniform-control"],["value","B"],["for","categoria",1,"form-label"],["id","categoria","formControlName","categoria",1,"form-select","uniform-control"],["for","dispensario",1,"form-label"],["id","dispensario","formControlName","dispensario",1,"form-select","uniform-control"],["value","SERSUMAGD"],["value","SISM DISPENSARIO"],["value","SUPLYMEDICAL"],[1,"form-group","d-flex","align-items-center"],["id","estado","type","checkbox","formControlName","estado",1,"form-check-input","me-2"],["for","estado",1,"form-check-label"],["id","pave","type","checkbox","formControlName","pave",1,"form-check-input","me-2"],["for","pave",1,"form-check-label"],["id","portabilidad","type","checkbox","formControlName","portabilidad",1,"form-check-input","me-2",3,"change"],["for","portabilidad",1,"form-check-label"],["class","col-md-4 mb-1",4,"ngIf"],[1,"col-6"],["type","submit",1,"btn","btn-outline-primary","w-100"],[1,"far","fa-save"],[3,"ngValue"],["for","dptoportabilidad",1,"form-label"],["id","dptoportabilidad","formControlName","dptoportabilidad",1,"form-select","uniform-control",3,"change"],["for","mpoportabilidad",1,"form-label"],["id","mpoportabilidad","formControlName","mpoportabilidad",1,"form-select","uniform-control"],["for","fecVencePortabilidad",1,"form-label"],["id","fecVencePortabilidad","type","date","formControlName","fecVencePortabilidad",1,"form-control","uniform-control",3,"min"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1),De("ngSubmit",function(){return i.create()}),d(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),h(6,"Tipo documento"),u(),d(7,"select",6)(8,"option",7),h(9,"Seleccionar Tipo de documento"),u(),oe(10,wce,2,3,"option",8),u()()(),d(11,"div",3)(12,"div",4)(13,"label",9),h(14,"Documento"),u(),d(15,"input",10),De("blur",function(){return i.buscarDocumento()}),u()()(),d(16,"div",3)(17,"div",4)(18,"label",11),h(19,"Primer Apellido"),u(),qe(20,"input",12),u()(),d(21,"div",3)(22,"div",4)(23,"label",13),h(24,"Segundo Apellido"),u(),qe(25,"input",14),u()(),d(26,"div",3)(27,"div",4)(28,"label",15),h(29,"Primer Nombre"),u(),qe(30,"input",16),u()(),d(31,"div",3)(32,"div",4)(33,"label",17),h(34,"Segundo Nombre"),u(),qe(35,"input",18),u()(),d(36,"div",3)(37,"div",4)(38,"label",19),h(39,"F. de Nacimiento"),u(),qe(40,"input",20),u()(),d(41,"div",3)(42,"div",4)(43,"label",21),h(44,"Sexo"),u(),d(45,"select",22)(46,"option",7),h(47,"Seleccionar sexo"),u(),d(48,"option",23),h(49,"Masculino"),u(),d(50,"option",24),h(51,"Femenino"),u(),d(52,"option",25),h(53,"Transexual"),u(),d(54,"option",26),h(55,"No binario"),u(),d(56,"option",27),h(57,"Otro"),u()()()(),d(58,"div",3)(59,"div",4)(60,"label",28),h(61,"Zona"),u(),d(62,"select",29)(63,"option",7),h(64,"Seleccionar zona"),u(),d(65,"option",30),h(66,"Urbana"),u(),d(67,"option",31),h(68,"Rural"),u()()()(),d(69,"div",3)(70,"div",4)(71,"label",32),h(72,"Barrio"),u(),qe(73,"input",33),u()(),d(74,"div",3)(75,"div",4)(76,"label",34),h(77,"Direcci\xf3n"),u(),qe(78,"input",35),u()(),d(79,"div",3)(80,"div",4)(81,"label",36),h(82,"Celular Principal"),u(),qe(83,"input",37),u()(),d(84,"div",3)(85,"div",4)(86,"label",38),h(87,"Celular Secundario"),u(),qe(88,"input",39),u()(),d(89,"div",3)(90,"div",4)(91,"label",40),h(92,"Correo Electr\xf3nico"),u(),qe(93,"input",41),u()(),d(94,"div",3)(95,"div",4)(96,"label",42),h(97,"Departamento"),u(),d(98,"select",43),De("change",function(){return i.onDptoSeleccionado()}),d(99,"option",7),h(100,"Seleccione el departamento"),u(),oe(101,xce,2,2,"option",8),u()()(),d(102,"div",3)(103,"div",4)(104,"label",44),h(105,"Municipio"),u(),d(106,"select",45)(107,"option",7),h(108,"Seleccione el municipio"),u(),oe(109,Cce,2,2,"option",8),u()()(),d(110,"div",3)(111,"div",4)(112,"label",46),h(113,"EPS"),u(),d(114,"select",47)(115,"option",7),h(116,"Seleccionar EPS"),u(),oe(117,Ece,2,2,"option",8),u()()(),d(118,"div",3)(119,"div",4)(120,"label",48),h(121,"R\xe9gimen"),u(),d(122,"select",49)(123,"option",7),h(124,"Seleccionar r\xe9gimen"),u(),d(125,"option",50),h(126,"Contributivo"),u(),d(127,"option",51),h(128,"Subsidiado"),u()()()(),d(129,"div",3)(130,"div",4)(131,"label",52),h(132,"Tipo de Afiliado"),u(),d(133,"select",53)(134,"option",7),h(135,"Seleccionar tipo de afiliado"),u(),d(136,"option",50),h(137,"Cotizante"),u(),d(138,"option",54),h(139,"Beneficiario"),u(),d(140,"option",24),h(141,"Cabeza de familia"),u()()()(),d(142,"div",3)(143,"div",4)(144,"label",55),h(145,"Categor\xeda"),u(),d(146,"select",56)(147,"option",7),h(148,"Seleccionar categor\xeda del afiliado"),u(),oe(149,Sce,2,3,"option",8),u()()(),d(150,"div",3)(151,"div",4)(152,"label",57),h(153,"Dispensario"),u(),d(154,"select",58)(155,"option",7),h(156,"Seleccionar el dispensario del afiliado"),u(),d(157,"option",59),h(158,"SERSUMAGD"),u(),d(159,"option",60),h(160,"SISM DISPENSARIO"),u(),d(161,"option",61),h(162,"SUPLYMEDICAL"),u()()()(),d(163,"div",3)(164,"div",62),qe(165,"input",63),d(166,"label",64),h(167,"Estado"),u()()(),d(168,"div",3)(169,"div",62),qe(170,"input",65),d(171,"label",66),h(172,"PAVE"),u()()(),d(173,"div",3)(174,"div",62)(175,"input",67),De("change",function(a){return i.onPortabilidadChange(a)}),u(),d(176,"label",68),h(177,"Portabilidad"),u()()(),oe(178,Ace,8,1,"div",69),oe(179,Mce,8,1,"div",69),oe(180,kce,5,1,"div",69),u(),qe(181,"hr"),d(182,"div",2)(183,"div",70)(184,"button",71),qe(185,"i",72),h(186),u()()()(),qe(187,"app-buscarpaciente"),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(9),N("ngForOf",i.listaTiposDoc),w(30),N("max",i.hoy),w(61),N("ngForOf",i.listaDpto),w(8),N("ngForOf",i.listaMpio),w(8),N("ngForOf",i.listaEps),w(32),N("ngForOf",i.listaCategoria),w(29),N("ngIf",i.mostrarPortabilidad),w(1),N("ngIf",i.mostrarPortabilidad),w(1),N("ngIf",i.mostrarPortabilidad),w(6),Qt(" ",i.nombrebtn," "))},dependencies:[ho,Fi,Vs,cl,ul,vo,sl,Ss,No,zo,Dc,bo,Ro,yce],styles:[".form-group[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr;gap:.75rem;align-items:center;margin-bottom:0}.form-label[_ngcontent-%COMP%]{justify-self:start}.uniform-control[_ngcontent-%COMP%]{width:100%;height:calc(2.25rem + 2px);border-radius:.25rem;font-size:1rem}.form-check-input[_ngcontent-%COMP%]{margin-top:.3rem}.form-check-label[_ngcontent-%COMP%]{margin-bottom:0}"]})}return t})();class Fce{constructor(){this.idIps=NaN,this.nit="",this.codHabilitacion="",this.nombre="",this.estado=!0}}class Ice{constructor(){this.idMedico=NaN,this.registroMedico="",this.nombre="",this.estado=!0,this.especialidad=""}}class Pce{constructor(){this.idPaciente=NaN,this.tipoDoc="",this.numDocumento="",this.pApellido="",this.sApellido="",this.pNombre="",this.sNombre="",this.fecNacimiento=new Date,this.sexo="",this.zona="",this.barrio="",this.direccion="",this.celularPrincipal="",this.celularSecundario="",this.email="",this.eps="",this.regimen="",this.tipoAfiliado="",this.categoria="",this.tipoPoblacion="",this.categoriaSisben="",this.departamento="",this.municipio="",this.pave=!1,this.estado=!0,this.dispensario="",this.portabilidad=!1,this.dptoportabilidad="",this.mpoportabilidad="",this.fecVencePortabilidad=null}}class wx{constructor(){this.items=[],this.idFormula=NaN,this.nroFormula="",this.observacion="",this.ips=new Fce,this.medico=new Ice,this.fecPrescribe=new Date,this.fecSolicitud=new Date,this.paciente=new Pce,this.fecIngreso=new Date,this.total=NaN,this.estado=!1,this.cieP="",this.cieR1="",this.cieR2="",this.cieR3="",this.cobroCM=!1,this.valorCM=NaN,this.continuidad="",this.origenurgencia=!1,this.pgp=!1,this.programa="",this.idBodega=NaN,this.estadoanulada=!1,this.funcionariocreaformula=""}calcularGranTotal(){return this.total=0,this.items.forEach(n=>{this.total+=n.cantidad*n.medicamento.valor}),this.total}tienePendientesDeEntrega(){return this.items.some(n=>0===n.items.length||n.items.some(e=>!1===e.estado))}}class WD{constructor(){this.idItem=NaN,this.cantidad=1,this.importe=0,this.frecuencia="1 Cada 24 Horas",this.duracion="0",this.habilitarCantidad=!1,this.items=[]}calcularImporte(){return this.cantidad*this.medicamento.valor}calcularTotalEntregado(){var n=0;return this.items.forEach(e=>{n+=e.cantidadEntregada}),n}}let qD=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/ips"}getRegistros(){return this.http.get(this.urlEndPoint).pipe(Pt(e=>It(e)))}getRegistrosActivos(){return this.http.get(`${this.urlEndPoint}/activos`).pipe(Pt(e=>It(e)))}getRegistrosInactivos(){return this.http.get(`${this.urlEndPoint}/inactivos`).pipe(Pt(e=>It(e)))}getRegistroId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unico`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}filtrarIpss(e){const r=(new Pn).set("term",e);return this.http.get(`${this.urlEndPoint}/filtrar`,{params:r}).pipe(Pt(this.handleError("filtrarIpss",[])))}handleError(e="operation",r){return i=>(console.error(`${e} failed: ${i.message}`),On(r))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Oce(t,n){1&t&&(d(0,"div",14),h(1," No hay registros para mostrar! "),u())}const Nce=function(t){return{color:t}},Rce=function(){return{color:"#009A94"}},Lce=function(){return{color:"red"}};function Bce(t,n){if(1&t){const e=Fn();d(0,"tr",18)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td")(8,"mat-icon",19),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarRegistro(o))}),h(9,"edit"),u(),d(10,"mat-icon",20),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarRegistro(o))}),h(11,"delete_sweep"),u()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);N("ngStyle",Si(6,Nce,e.estado?"black":"red")),w(2),_e(r+1),w(2),_e(e.nit),w(2),_e(i.primerasmayusculas(e.nombre)),w(2),N("ngStyle",Nt(8,Rce)),w(2),N("ngStyle",Nt(9,Lce))}}function jce(t,n){if(1&t&&(d(0,"div")(1,"table",15)(2,"thead",16)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Nit"),u(),d(8,"th"),h(9,"Nombre"),u(),d(10,"th"),h(11,"Gesti\xf3n"),u()()(),d(12,"tbody"),oe(13,Bce,12,10,"tr",17),u()()()),2&t){const e=ae();w(13),N("ngForOf",e.listaregistrosFiltrados)}}let GD=(()=>{class t{constructor(e,r,i,o){this.fb=e,this.servicio=r,this.dialogRef=i,this.data=o,this.nombrebtn="Crear"}ngOnInit(){this.crearFormulario(),this.generalForm.get("nombre").valueChanges.pipe(xo(300),Di(e=>this.servicio.filtrarIpss(e))).subscribe(e=>{this.listaregistrosFiltrados=e})}convertirAMayusculas(e){const r=e.target;r.value=r.value.toUpperCase(),this.generalForm.get("nombre")?.setValue(r.value,{emitEvent:!1})}crearFormulario(){this.generalForm=this.fb.group({idIps:[""],nit:[""],codHabilitacion:[""],nombre:["",[Zn.required]],estado:["true",[Zn.required]]})}onNoClick(){this.dialogRef.close()}mostrarRegistro(e){console.log(e),this.nombrebtn="Actualizar",this.generalForm.setValue({idIps:e.idIps,nit:e.nit,codHabilitacion:e.codHabilitacion,nombre:e.nombre,estado:e.estado})}create(){this.generalForm.value.usuario=localStorage.getItem("lidersistema"),this.generalForm.valid?"Crear"==this.nombrebtn?this.servicio.create(this.generalForm.value).subscribe(e=>{z().fire({icon:"success",title:"Ok",text:"La IPS ha sido creado correctamente"}),this.generalForm.reset(),this.nombrebtn="Crear",this.dialogRef.close(e)},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar la IPS en la base de datos!",footer:e.mensaje})}):(console.log(this.generalForm.value),this.servicio.update(this.generalForm.value).subscribe(e=>{this.nombrebtn="Crear",z().fire({icon:"success",title:"Ok",text:"La IPS ha sido actualizado correctameente"}),this.dialogRef.close(e),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo actualizar la IPS en la base de datos!",footer:e.mensaje})})):z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para crear la IPS en la base de datos!"})}eliminarRegistro(e){z().fire({title:"Desea eliminar?",text:"La IPS"+e.nombre+" de la base de datos.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.servicio.delete(e.idIps).subscribe(i=>{this.listaregistrosFiltrados=this.listaregistrosFiltrados.filter(o=>o!==e),z().fire({icon:"success",title:"Ok",text:"La IPS ha sido eliminado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(qD),X(Jb),X(e2))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-ips"]],decls:28,vars:4,consts:[[1,"container","mt-4"],[1,"w-100","d-block",3,"formGroup"],[1,"row"],[1,"input-group","mb-2"],["type","text","formControlName","nombre","placeholder","Ingrese el nombre de la IPS","required","",1,"form-control","border-end-0",3,"input"],[1,"input-group-text","bg-transparent"],[1,"fa","fa-user"],["type","number","formControlName","nit","placeholder","Ingrese el nit de la IPS","required","",1,"form-control","border-end-0"],["type","number","formControlName","codHabilitacion","placeholder","Ingrese el codigo de habilitaci\xf3n","required","",1,"form-control","border-end-0"],["type","checkbox","formControlName","estado",1,"form-check-input"],[1,"col-6"],[1,"btn","btn-outline-primary","w-100",3,"click"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm","mt-2"],[1,"thead-colored"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],["title","Actualizar la IPS",1,"pointer-cursor",3,"ngStyle","click"],["title","Eliminar la IPS",1,"pointer-cursor",3,"ngStyle","click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"input",4),De("input",function(a){return i.convertirAMayusculas(a)}),u(),d(5,"span",5),qe(6,"i",6),u()(),d(7,"div",3),qe(8,"input",7),d(9,"span",5),qe(10,"i",6),u()(),d(11,"div",3),qe(12,"input",8),d(13,"span",5),qe(14,"i",6),u()(),d(15,"div",3),qe(16,"input",9),h(17," Estado "),u(),qe(18,"hr"),d(19,"div",2)(20,"div",10)(21,"button",11),De("click",function(){return i.create()}),h(22),u()(),d(23,"div",10)(24,"button",11),De("click",function(){return i.onNoClick()}),h(25," Cerrar"),u()()()()(),oe(26,Oce,2,0,"div",12),oe(27,jce,14,1,"div",13),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(21),Qt(" ",i.nombrebtn,""),w(4),N("ngIf",0==(null==i.listaregistrosFiltrados?null:i.listaregistrosFiltrados.length)),w(1),N("ngIf",(null==i.listaregistrosFiltrados?null:i.listaregistrosFiltrados.length)>0))},dependencies:[ho,Fi,Jo,Wo,Vs,vo,wd,sl,No,zo,Dc,bo,Ro]})}return t})(),YD=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/medico"}getRegistros(){return this.http.get(this.urlEndPoint).pipe(Pt(e=>It(e)))}getRegistrosActivos(){return this.http.get(`${this.urlEndPoint}/activos`).pipe(Pt(e=>It(e)))}getRegistrosInactivos(){return this.http.get(`${this.urlEndPoint}/inactivos`).pipe(Pt(e=>It(e)))}getRegistroId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unico`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}filtrarMedicos(e){const r=(new Pn).set("term",e);return this.http.get(`${this.urlEndPoint}/filtrar`,{params:r}).pipe(Pt(this.handleError("filtrarMedicos",[])))}buscarMedicosRegistro(e){const r=(new Pn).set("term",e);return this.http.get(`${this.urlEndPoint}/registro`,{params:r}).pipe(Pt(this.handleError("RegistrosMedicos",[])))}handleError(e="operation",r){return i=>(console.error(`${e} failed: ${i.message}`),On(r))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Vce(t,n){1&t&&(d(0,"div",12),h(1," No hay registros para mostrar! "),u())}const Uce=function(t){return{color:t}},Hce=function(){return{color:"#009A94"}},zce=function(){return{color:"red"}};function $ce(t,n){if(1&t){const e=Fn();d(0,"tr",16)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td")(10,"button",17),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarRegistro(o))}),d(11,"mat-icon",16),h(12,"edit"),u()(),d(13,"button",18),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarRegistro(o))}),d(14,"mat-icon",16),h(15,"delete_sweep"),u()()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);N("ngStyle",Si(7,Uce,e.estado?"black":"red")),w(2),_e(r+1),w(2),_e(e.registroMedico),w(2),_e(i.primerasmayusculas(e.nombre)),w(2),_e(i.primerasmayusculas(e.especialidad)),w(3),N("ngStyle",Nt(9,Hce)),w(3),N("ngStyle",Nt(10,zce))}}function Wce(t,n){if(1&t&&(d(0,"div")(1,"table",13)(2,"thead",14)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Nro. Registro"),u(),d(8,"th"),h(9,"Nombre del m\xe9dico"),u(),d(10,"th"),h(11,"Especialidad"),u(),d(12,"th"),h(13,"Gesti\xf3n"),u()()(),d(14,"tbody"),oe(15,$ce,16,11,"tr",15),u()()()),2&t){const e=ae();w(15),N("ngForOf",e.listaregistrosFiltrados)}}let XD=(()=>{class t{constructor(e,r,i,o){this.fb=e,this.servicio=r,this.dialogRef=i,this.data=o,this.nombrebtn="Crear"}ngOnInit(){this.crearFormulario(),this.generalForm.get("nombre").valueChanges.pipe(xo(300),Di(e=>this.servicio.filtrarMedicos(e))).subscribe(e=>{this.listaregistrosFiltrados=e})}onNoClick(){this.dialogRef.close()}convertirAMayusculas(e){const r=e.target;r.value=r.value.toUpperCase(),this.generalForm.get("nombre")?.setValue(r.value,{emitEvent:!1})}convertirAMayusculasEspecialidad(e){const r=e.target;r.value=r.value.toUpperCase(),this.generalForm.get("especialidad")?.setValue(r.value,{emitEvent:!1})}crearFormulario(){this.generalForm=this.fb.group({idMedico:[""],registroMedico:["",[Zn.required]],nombre:["",[Zn.required]],estado:[!0,[Zn.required]],especialidad:["",[Zn.required]]})}buscarRegistro(){const e=this.generalForm.get("registroMedico")?.value;console.log("Esto es lo que voy a buscar en la base de datos:"+e),e&&this.servicio.buscarMedicosRegistro(e).subscribe(r=>{r&&Object.keys(r).length>0?(this.listaregistrosFiltrados=r,z().fire({icon:"info",title:"EXISTE",text:`El n\xfamero de registro ${e} que est\xe1 ingresando ya existe con los datos de ${this.listaregistrosFiltrados[0].nombre}. Por favor verificar y/o actualizar el dato, recuerde no volverlo a crear!`})):console.log("La respuesta est\xe1 vac\xeda o no tiene datos relevantes.")},r=>{console.error("Error al buscar el documento",r)})}mostrarRegistro(e){this.nombrebtn="Actualizar",this.generalForm.setValue({idMedico:e.idMedico,registroMedico:e.registroMedico,nombre:e.nombre,estado:e.estado,especialidad:e.especialidad})}create(){this.generalForm.valid?"Crear"==this.nombrebtn?this.servicio.create(this.generalForm.value).subscribe(e=>{this.dialogRef.close(e),z().fire({icon:"success",title:"Ok",text:"El m\xe9dico ha sido creado correctamente"}),this.generalForm.reset()},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar el m\xe9dico en la base de datos!",footer:e.mensaje})}):(console.log(this.generalForm.value),this.servicio.update(this.generalForm.value).subscribe(e=>{z().fire({icon:"success",title:"Ok",text:"El m\xe9dico ha sido actualizado correctameente"}),this.generalForm.reset(),this.nombrebtn="Crear"},e=>{z().fire({icon:"error",title:"Error...",text:"No se pudo actualizar el m\xe9dico en la base de datos!",footer:e.mensaje})})):z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para crear el m\xe9dico en la base de datos!"})}eliminarRegistro(e){z().fire({title:"Desea eliminar?",text:"El m\xe9dico "+e.nombre+" de la base de datos.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.servicio.delete(e.idMedico).subscribe(i=>{this.listaregistrosFiltrados=this.listaregistrosFiltrados.filter(o=>o!==e),z().fire({icon:"success",title:"Ok",text:"El m\xe9dico ha sido eliminado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(YD),X(Jb),X(e2))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-medicos"]],decls:23,vars:4,consts:[[1,"container","mt-4"],[1,"w-100","d-block",3,"formGroup"],[1,"row"],[1,"input-group","mb-2"],["type","text","formControlName","nombre","placeholder","Ingrese el nombre del m\xe9dico","required","",1,"form-control","border-end-0",3,"input"],["type","text","formControlName","registroMedico","placeholder","Ingrese el registro m\xe9dico","required","",1,"form-control","border-end-0",3,"blur"],["type","text","formControlName","especialidad","placeholder","Ingrese la especialidad","required","",1,"form-control","border-end-0",3,"input"],["type","checkbox","formControlName","estado",1,"form-check-input"],[1,"col-6"],[1,"btn","btn-outline-primary","w-100",3,"click"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm","mt-2"],[1,"thead-colored"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],["title","Editar el m\xe9dico","type","button",1,"btn","btn-sm",3,"click"],["title","Eliminar el m\xe9dico","type","button",1,"btn","btn-sm",3,"click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",3)(5,"input",4),De("input",function(a){return i.convertirAMayusculas(a)}),u()(),d(6,"div",3)(7,"input",5),De("blur",function(){return i.buscarRegistro()}),u()(),d(8,"div",3)(9,"input",6),De("input",function(a){return i.convertirAMayusculasEspecialidad(a)}),u()()(),d(10,"div",3),qe(11,"input",7),h(12," Estado "),u(),qe(13,"hr"),d(14,"div",2)(15,"div",8)(16,"button",9),De("click",function(){return i.create()}),h(17),u()(),d(18,"div",8)(19,"button",9),De("click",function(){return i.onNoClick()}),h(20," Cerrar"),u()()()()(),oe(21,Vce,2,0,"div",10),oe(22,Wce,16,1,"div",11),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(16),Qt(" ",i.nombrebtn,""),w(4),N("ngIf",0==(null==i.listaregistrosFiltrados?null:i.listaregistrosFiltrados.length)),w(1),N("ngIf",(null==i.listaregistrosFiltrados?null:i.listaregistrosFiltrados.length)>0))},dependencies:[ho,Fi,Jo,Wo,Vs,vo,sl,No,zo,Dc,bo,Ro]})}return t})();function qce(t,n){1&t&&(d(0,"div",14),h(1," No hay formulas asociadas a este paciente para mostrar! "),u())}const xx=function(){return{color:"#009A94"}};function Gce(t,n){if(1&t&&(d(0,"div")(1,"mat-icon",19),h(2,"check "),u(),h(3),u()),2&t){const e=ae().$implicit;w(1),N("ngStyle",Nt(2,xx)),w(2),Qt(" ",e.valorCM," ")}}function Yce(t,n){if(1&t){const e=Fn();d(0,"div")(1,"input",28),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.recibe=i)})("change",function(i){ht(e);const o=ae().$implicit;return pt(ae(2).onRecibeChange(i,o))}),u(),h(2," Recibe el mismo paciente "),d(3,"input",29),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.tipoRecibe=i)})("input",function(i){ht(e);const o=ae().$implicit;return pt(ae(2).onInputChange(i,o))}),u(),d(4,"input",30),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.documentoRecibe=i)}),u()()}if(2&t){const e=ae().$implicit;w(1),N("ngModel",e.recibe),w(2),N("ngModel",e.tipoRecibe),w(1),N("ngModel",e.documentoRecibe)}}function Xce(t,n){if(1&t&&(d(0,"div"),h(1),u()),2&t){const e=ae().$implicit;w(1),fo(" ",e.tipoRecibe," ",e.documentoRecibe," ")}}function Kce(t,n){if(1&t){const e=Fn();d(0,"mat-icon",31),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).editarquienRecibe(i))}),h(1,"edit"),u()}2&t&&N("ngStyle",Nt(1,xx))}const L6=function(){return{color:"orange"}};function Zce(t,n){if(1&t){const e=Fn();d(0,"mat-icon",32),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).cancelarquienRecibe(i))}),h(1,"clear"),u()}2&t&&N("ngStyle",Nt(1,L6))}function Qce(t,n){if(1&t){const e=Fn();d(0,"mat-icon",33),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).guardarquienRecibe(i))}),h(1,"check"),u()}2&t&&N("ngStyle",Nt(1,xx))}const B6=function(){return{color:"red"}};function Jce(t,n){if(1&t){const e=Fn();d(0,"mat-icon",34),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).informeAnulacion(i))}),h(1,"block"),u()}2&t&&N("ngStyle",Nt(1,B6))}function eue(t,n){if(1&t){const e=Fn();d(0,"button",35),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).guardarEntregaFormula(i))}),h(1," Generar entrega "),u()}}function tue(t,n){1&t&&(d(0,"mat-icon",19),h(1,"remove_circle_outline"),u()),2&t&&N("ngStyle",Nt(1,B6))}const nue=function(){return{color:"green"}};function rue(t,n){1&t&&(d(0,"mat-icon",19),h(1,"check"),u()),2&t&&N("ngStyle",Nt(1,nue))}const iue=function(t){return["/menu/entrega",t]};function oue(t,n){if(1&t&&(d(0,"button",36),h(1," Ver entrega "),oe(2,tue,2,2,"mat-icon",37),oe(3,rue,2,2,"mat-icon",37),u()),2&t){const e=ae().$implicit;N("routerLink",Si(3,iue,e.idFormula)),w(2),N("ngIf",e.entregaCompleta),w(1),N("ngIf",!e.entregaCompleta)}}function aue(t,n){if(1&t){const e=Fn();d(0,"mat-icon",38),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).anularFormula(i))}),h(1,"block"),u()}2&t&&N("ngStyle",Nt(1,L6))}const sue=function(t){return["/menu/editformula",t]};function lue(t,n){if(1&t&&(d(0,"mat-icon",39),h(1,"edit"),u()),2&t){const e=ae().$implicit;N("ngStyle",Nt(2,xx))("routerLink",Si(3,sue,e.idFormula))}}const cue=function(){return{color:"#2BB6D7"}};function uue(t,n){if(1&t){const e=Fn();d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),Hi(5,"date"),u(),d(6,"td"),h(7),u(),d(8,"td"),h(9),Hi(10,"date"),u(),d(11,"td"),h(12),u(),d(13,"td"),oe(14,Gce,4,3,"div",13),u(),d(15,"td")(16,"button",18),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).verDetalles(o))}),d(17,"mat-icon",19),h(18,"playlist_add_check"),u()(),h(19),u(),d(20,"td"),oe(21,Yce,5,3,"div",13),oe(22,Xce,2,2,"div",13),oe(23,Kce,2,2,"mat-icon",20),oe(24,Zce,2,2,"mat-icon",21),oe(25,Qce,2,2,"mat-icon",22),u(),d(26,"td"),oe(27,Jce,2,2,"mat-icon",23),oe(28,eue,2,0,"button",24),oe(29,oue,4,5,"button",25),oe(30,aue,2,2,"mat-icon",26),oe(31,lue,2,5,"mat-icon",27),u()()}if(2&t){const e=n.$implicit,r=ae(2);w(2),_e(e.idFormula),w(2),_e(Xo(5,18,e.fecPrescribe,"dd/MM/YYYY")),w(3),_e(r.primerasmayusculas(e.ips.nombre)),w(2),_e(Xo(10,21,e.fecSolicitud,"dd/MM/YYYY : hh:mm")),w(3),_e(e.continuidad),w(2),N("ngIf",e.cobroCM),w(3),N("ngStyle",Nt(24,cue)),w(2),Qt(" ",e.items.length," "),w(2),N("ngIf",e.editing),w(1),N("ngIf",!e.editing),w(1),N("ngIf",!e.estado&&!e.editing&&!e.estadoanulada),w(1),N("ngIf",!e.estado&&e.editing),w(1),N("ngIf",!e.estado&&e.editing),w(2),N("ngIf",e.estadoanulada),w(1),N("ngIf",!e.estado&&!e.estadoanulada),w(1),N("ngIf",e.estado),w(1),N("ngIf",!e.estado&&!e.estadoanulada),w(1),N("ngIf",!e.estadoanulada&&r.tieneAcceso(4))}}function due(t,n){if(1&t&&(d(0,"div")(1,"table",15)(2,"thead",16)(3,"tr")(4,"th"),h(5,"Nro. Formula"),u(),d(6,"th"),h(7,"F. Prescripci\xf3n"),u(),d(8,"th"),h(9,"IPS prescribe "),u(),d(10,"th"),h(11,"Fecha y hora de solicitud"),u(),d(12,"th"),h(13,"Continuidad"),u(),d(14,"th"),h(15,"Cuota M"),u(),d(16,"th"),h(17,"Nro Items"),u(),d(18,"th"),h(19,"\xbfQuien recibe?"),u(),d(20,"th"),h(21,"Gesti\xf3n"),u()()(),d(22,"tbody"),oe(23,uue,32,25,"tr",17),u()()()),2&t){const e=ae();w(23),N("ngForOf",e.listaFormula)}}let KD=(()=>{class t{constructor(e,r,i,o){this.servicioformula=e,this.activatedRoute=r,this.router=i,this.fb=o,this.idPaciente=NaN;const a=new Date,s=new Date(a);s.setDate(a.getDate()+90);const l=new Date(a);l.setDate(a.getDate()-90),this.generalForm=this.fb.group({fechainicial:[l.toISOString().split("T")[0]],fechafinal:[s.toISOString().split("T")[0]]})}ngOnInit(){this.parametro=this.activatedRoute.snapshot.paramMap.get("id")||this.idPaciente,this.parametro&&this.buscarRegistro(this.parametro)}onInputChange(e,r){r.tipoRecibe=e.target.value.toUpperCase()}buscarRegistro(e){this.servicioformula.getFormulaIdPaciente(e,this.generalForm.get("fechainicial")?.value,this.generalForm.get("fechafinal")?.value).subscribe(r=>{this.pacienteActual=r[0]?.paciente,this.listaFormula=r,this.listaFormula=this.listaFormula.map(i=>({...i,editing:!1})),this.listaFormula.sort((i,o)=>o.idFormula-i.idFormula),console.log(this.listaFormula)})}verDetalles(e){let r=`Medico que prescribe: ${e.medico.nombre} <br> <br>`;for(let i=0;i<e.items.length;i++)r+=i+1+` - ${e.items[i].medicamento.nombre} - Cantidad - ${e.items[i].cantidad}<br>`;z().fire({icon:"success",title:`Lista de medicamentos, formula Nro.  <b>${e.idFormula}</b>`,html:r})}guardarEntregaFormula(e){let r=sessionStorage.getItem("bodega"),i=parseInt(null!==r?r:"0",10),o=sessionStorage.getItem("nombre");if(o&&r){const a=new Date,s=new Date(e.fecPrescribe),l=v=>new Date(v.getFullYear(),v.getMonth(),v.getDate()),c=l(a);if(l(s)<=c){const v=new Date(a);v.setDate(a.getDate()-30),s>=v?e.tipoRecibe&&e.documentoRecibe?z().fire({title:"Confirma la entrega",text:"Se procedera a hacer el proceso de descargue de los medicamentos del inventario de la bodega al que esta suscrito el funcionario "+o,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, Entregar!"}).then(E=>{E.isConfirmed&&this.servicioformula.saveEntregaFormula(e.idFormula,i,o,"Presencial",e.tipoRecibe,e.documentoRecibe).subscribe({next:D=>{this.router.navigate(["/menu/entrega",e.idFormula])},error:D=>{console.error("Error al guardar la entrega",D)}})}):z().fire({icon:"error",title:"Quien recibe!",text:"No ha diligenciado los datos de quien recibe los medicamentos prescritos en la formula n\xfamero "+e.idFormula+" recuerde debe ser un mayor de edad"}):z().fire({icon:"error",title:"Formula expir\xf3!",text:`La f\xf3rmula expir\xf3, ya no puede ser entregada debio ser reclamada hasta 30 dias despues de su fecha de prescripci\xf3n ${c}`})}else z().fire({icon:"error",title:"Verificar!",text:`La f\xf3rmula a\xfan no est\xe1 habilitada para la entrega, estar\xe1 disponible a partir del ${c}`})}else z().fire({icon:"error",title:"Verificar!",text:"Usuario no esta  logueado para realizar la dispensaci\xf3n de medicamentos, por favor inicie sesi\xf3n!"})}anularFormula(e){let r=sessionStorage.getItem("nombre");z().fire({title:"Anular F\xf3rmula",html:'             \n      <div>Ingrese la observaci\xf3n que se registrar\xe1 en la base de datos para verificar el motivo por el cual se est\xe1 anulando la f\xf3rmula:</div>\n      <textarea id="obsanulacion" placeholder="Ingrese la observaci\xf3n de la anulaci\xf3n" \n        style="width: 100%; height: 110px; padding: 10px; font-size: 14px; border-radius: 20px;"></textarea>\n    ',icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, anular!"}).then(i=>{if(i.isConfirmed){const o=document.getElementById("obsanulacion").value;o.length>10&&r?this.servicioformula.anularFormula(e.idFormula,r,o).subscribe(a=>{this.buscarRegistro(a.paciente.idPaciente),z().fire({icon:"success",title:"Ok",text:`La f\xf3rmula n\xfamero ${e.idFormula} se ha anulada correctamente.`})},a=>{console.error("Error del servidor:",a),z().fire({icon:"error",title:"Error",text:a?.mensaje||"Ocurri\xf3 un error al intentar anular la f\xf3rmula."})}):z().fire({icon:"error",title:"Error",text:"No ha diligenciado caracteres suficiente en el motivo por el cual se va a anular la f\xf3rmula (m\xednimo 10 car\xe1cteres)."})}})}informeAnulacion(e){z().fire({icon:"info",title:"Informaci\xf3n",text:"Formula numero "+e.idFormula+" anulada por funcionario "+e.funcionarioanula+" observaci\xf3n "+e.observacion})}editarquienRecibe(e){e.editing=!0}cancelarquienRecibe(e){e.editing=!1}guardarquienRecibe(e){e.editing=!1}onRecibeChange(e,r){e.target.checked?this.CalcularEdad(this.pacienteActual.fecNacimiento)>17?(r.tipoRecibe=this.pacienteActual.tipoDoc,r.documentoRecibe=this.pacienteActual.numDocumento):(r.tipoRecibe="",r.documentoRecibe="",z().fire({icon:"error",title:"Edad no permitida!",text:"El paciente no tiene la edad para recibir los medicamentos de la formula n\xfamero "+r.idFormula+" por favor agregue los datos del tutor responsable"})):(r.tipoRecibe="",r.documentoRecibe="")}CalcularEdad(e){if(null!=e){const r=new Date(e),i=Math.abs(Date.now()-r.getTime());let o=Math.floor(i/864e5/365);if(o)return o}return 0}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}static#e=this.\u0275fac=function(r){return new(r||t)(X(Dd),X(Us),X(Ds),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-historialformula"]],inputs:{idPaciente:"idPaciente"},decls:21,vars:7,consts:[[1,"container","mt-1"],[1,"container-fluid","p-2"],[1,"d-flex","justify-content-end","align-items-center","gap-2",3,"formGroup"],[1,"d-flex","justify-content-center","align-items-center","gap-1","w-100"],["for","fechainicial",1,"form-label","mb-0","text-center","fw-bold"],[1,"d-flex","align-items-center","gap-1"],["for","fechainicial",1,"form-label","mb-0"],["id","fechainicial","type","date","formControlName","fechainicial",1,"form-control"],["for","fechafinal",1,"form-label","mb-0"],["id","fechafinal","type","date","formControlName","fechafinal",1,"form-control"],["type","button",1,"btn","btn-outline-success","d-flex","align-items-center","justify-content-center",3,"click"],[1,"me-1"],["class","alert alert-info my-2",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info","my-2"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[4,"ngFor","ngForOf"],["title","ver item de la formula","type","button",1,"btn","btn-sm",3,"click"],[3,"ngStyle"],["title","Editar cantidad","class","pointer-cursor","title","Editar cantidad",3,"ngStyle","click",4,"ngIf"],["title","Cancelar","class","pointer-cursor","title","Cancelar edici\xf3n",3,"ngStyle","click",4,"ngIf"],["title","Guardar cantidad","class","pointer-cursor","title","Fijar cantidad",3,"ngStyle","click",4,"ngIf"],["title","Formula anulada","class","pointer-cursor",3,"ngStyle","click",4,"ngIf"],["title","generar la entrega de medicamentos","type","button","class","btn btn-success btn-sm btn-custom-gradient-d",3,"click",4,"ngIf"],["title","ver la entrega","type","button","class","btn btn-sm btn-custom-gradient",3,"routerLink",4,"ngIf"],["title","Anular la formula","class","pointer-cursor",3,"ngStyle","click",4,"ngIf"],["title","Editar la formula","class","pointer-cursor",3,"ngStyle","routerLink",4,"ngIf"],["type","checkbox",1,"form-check-input",2,"margin-right","5px",3,"ngModel","ngModelChange","change"],["type","text","placeholder","Tipo",1,"form-control","mb-1",3,"ngModel","ngModelChange","input"],["type","text","placeholder","Documento",1,"form-control","mb-1",3,"ngModel","ngModelChange"],["title","Editar cantidad","title","Editar cantidad",1,"pointer-cursor",3,"ngStyle","click"],["title","Cancelar","title","Cancelar edici\xf3n",1,"pointer-cursor",3,"ngStyle","click"],["title","Guardar cantidad","title","Fijar cantidad",1,"pointer-cursor",3,"ngStyle","click"],["title","Formula anulada",1,"pointer-cursor",3,"ngStyle","click"],["title","generar la entrega de medicamentos","type","button",1,"btn","btn-success","btn-sm","btn-custom-gradient-d",3,"click"],["title","ver la entrega","type","button",1,"btn","btn-sm","btn-custom-gradient",3,"routerLink"],[3,"ngStyle",4,"ngIf"],["title","Anular la formula",1,"pointer-cursor",3,"ngStyle","click"],["title","Editar la formula",1,"pointer-cursor",3,"ngStyle","routerLink"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),h(5),u()(),d(6,"div",5)(7,"label",6),h(8,"Fecha inicial:"),u(),qe(9,"input",7),u(),d(10,"div",5)(11,"label",8),h(12,"Fecha final:"),u(),qe(13,"input",9),u(),d(14,"div")(15,"button",10),De("click",function(){return i.buscarRegistro(i.parametro)}),d(16,"mat-icon",11),h(17,"search"),u(),h(18," Buscar "),u()()()(),oe(19,qce,2,0,"div",12),oe(20,due,24,1,"div",13),u()),2&r&&(w(2),N("formGroup",i.generalForm),w(3),Up(" ",null==i.pacienteActual?null:i.pacienteActual.pNombre," ",null==i.pacienteActual?null:i.pacienteActual.sNombre," ",null==i.pacienteActual?null:i.pacienteActual.pApellido," ",null==i.pacienteActual?null:i.pacienteActual.sApellido," "),w(14),N("ngIf",0==(null==i.listaFormula?null:i.listaFormula.length)),w(1),N("ngIf",(null==i.listaFormula?null:i.listaFormula.length)>0))},dependencies:[ho,Fi,Jo,Hs,Wo,vo,sl,No,zo,bo,Ro,Ag,Sc],styles:[".card-header[_ngcontent-%COMP%]{background:linear-gradient(to right,#71E0D2,#5D8FA5);color:#fff;border-radius:10px;display:flex;justify-content:space-between;align-items:center}[_nghost-%COMP%]     .mat-tooltip{background-color:#f44336;color:#fff}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;flex-wrap:wrap}.card-title[_ngcontent-%COMP%]{margin-right:1rem;margin-left:10px;white-space:nowrap}.search-input[_ngcontent-%COMP%]{flex:1;max-width:400px;margin-left:auto}.input-group-text[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.form-control[_ngcontent-%COMP%]{flex:1;border-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:25px}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{border-top-left-radius:25px;border-bottom-left-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control.border-end-0[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.btn-custom-gradient[_ngcontent-%COMP%]{background:linear-gradient(to right,#71E0D2,#67ACD6);color:#fff;border:none;transition:color .3s;min-width:140px}.btn-custom-gradient[_ngcontent-%COMP%]:hover{color:#000}.buscar-button[_ngcontent-%COMP%]{margin:0 10px;border-radius:25px}.btn-custom-gradient-d[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff9966,#ff5e62);color:#fff;border:none;min-width:140px}.btn-custom-gradient-d[_ngcontent-%COMP%]:hover{color:#000}@media (max-width: 576px){.card-header[_ngcontent-%COMP%], .header-content[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.card-title[_ngcontent-%COMP%]{margin-bottom:.5rem}.search-input[_ngcontent-%COMP%]{width:100%;max-width:none;margin-left:0}.input-group-text[_ngcontent-%COMP%]{padding:.375rem .75rem}.form-control[_ngcontent-%COMP%]{width:100%}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto}}.date-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.date-input[_ngcontent-%COMP%]{width:120px;padding:.15rem;font-size:.875rem}.date-label[_ngcontent-%COMP%]{margin:0 2px}"]})}return t})();const fue=["connectionContainer"],hue=["inputContainer"],pue=["label"];function mue(t,n){1&t&&(xc(0),d(1,"div",14),qe(2,"div",15)(3,"div",16)(4,"div",17),u(),d(5,"div",18),qe(6,"div",15)(7,"div",16)(8,"div",17),u(),Cc())}function gue(t,n){1&t&&(d(0,"div",19),Ri(1,1),u())}function _ue(t,n){if(1&t&&(xc(0),Ri(1,2),d(2,"span"),h(3),u(),Cc()),2&t){const e=ae(2);w(3),_e(e._control.placeholder)}}function vue(t,n){1&t&&Ri(0,3,["*ngSwitchCase","true"])}function bue(t,n){1&t&&(d(0,"span",23),h(1," *"),u())}function yue(t,n){if(1&t){const e=Fn();d(0,"label",20,21),De("cdkObserveContent",function(){return ht(e),pt(ae().updateOutlineGap())}),oe(2,_ue,4,1,"ng-container",12),oe(3,vue,1,0,"ng-content",12),oe(4,bue,2,0,"span",22),u()}if(2&t){const e=ae();Ai("mat-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-form-field-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-accent","accent"==e.color)("mat-warn","warn"==e.color),N("cdkObserveContentDisabled","outline"!=e.appearance)("id",e._labelId)("ngSwitch",e._hasLabel()),kr("for",e._control.id)("aria-owns",e._control.id),w(2),N("ngSwitchCase",!1),w(1),N("ngSwitchCase",!0),w(1),N("ngIf",!e.hideRequiredMarker&&e._control.required&&!e._control.disabled)}}function wue(t,n){1&t&&(d(0,"div",24),Ri(1,4),u())}function xue(t,n){if(1&t&&(d(0,"div",25),qe(1,"span",26),u()),2&t){const e=ae();w(1),Ai("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)}}function Cue(t,n){1&t&&(d(0,"div"),Ri(1,5),u()),2&t&&N("@transitionMessages",ae()._subscriptAnimationState)}function Eue(t,n){if(1&t&&(d(0,"div",30),h(1),u()),2&t){const e=ae(2);N("id",e._hintLabelId),w(1),_e(e.hintLabel)}}function Sue(t,n){if(1&t&&(d(0,"div",27),oe(1,Eue,2,2,"div",28),Ri(2,6),qe(3,"div",29),Ri(4,7),u()),2&t){const e=ae();N("@transitionMessages",e._subscriptAnimationState),w(1),N("ngIf",e.hintLabel)}}const Due=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Aue=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],Tue=new U("MatError"),Mue={transitionMessages:Zg("transitionMessages",[Gu("enter",wa({opacity:1,transform:"translateY(0%)"})),au("void => enter",[wa({opacity:0,transform:"translateY(-5px)"}),ou("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let ZD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t}),t})();const kue=new U("MatHint");let gm=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["mat-label"]]}),t})(),Fue=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["mat-placeholder"]]}),t})();const Iue=new U("MatPrefix"),j6=new U("MatSuffix");let V6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["","matSuffix",""]],features:[ki([{provide:j6,useExisting:t}])]}),t})(),U6=0;const Oue=Jg(class{constructor(t){this._elementRef=t}},"primary"),Nue=new U("MAT_FORM_FIELD_DEFAULT_OPTIONS"),QD=new U("MatFormField");let b_=(()=>{class t extends Oue{constructor(e,r,i,o,a,s,l){super(e),this._changeDetectorRef=r,this._dir=i,this._defaults=o,this._platform=a,this._ngZone=s,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new Bt,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+U6++,this._labelId="mat-form-field-label-"+U6++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==l,this.appearance=o&&o.appearance?o.appearance:"legacy",this._hideRequiredMarker=!(!o||null==o.hideRequiredMarker)&&o.hideRequiredMarker}get appearance(){return this._appearance}set appearance(e){const r=this._appearance;this._appearance=e||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&r!==e&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=Bo(e)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(e){this._explicitFormFieldControl=e}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${e.controlType}`),e.stateChanges.pipe(ec(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(Co(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Co(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),Ea(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(ec(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(ec(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(Co(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(e){const r=this._control?this._control.ngControl:null;return r&&r[e]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,lu(this._label.nativeElement,"transitionend").pipe(ra(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const r=this._hintChildren?this._hintChildren.find(o=>"start"===o.align):null,i=this._hintChildren?this._hintChildren.find(o=>"end"===o.align):null;r?e.push(r.id):this._hintLabel&&e.push(this._hintLabelId),i&&e.push(i.id)}else this._errorChildren&&e.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(e)}}_validateControlChild(){}updateOutlineGap(){const e=this._label?this._label.nativeElement:null;if(!("outline"===this.appearance&&e&&e.children.length&&e.textContent.trim()&&this._platform.isBrowser))return;if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let r=0,i=0;const o=this._connectionContainerRef.nativeElement,a=o.querySelectorAll(".mat-form-field-outline-start"),s=o.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const l=o.getBoundingClientRect();if(0===l.width&&0===l.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const c=this._getStartEnd(l),f=e.children,v=this._getStartEnd(f[0].getBoundingClientRect());let E=0;for(let D=0;D<f.length;D++)E+=f[D].offsetWidth;r=Math.abs(v-c)-5,i=E>0?.75*E+10:0}for(let l=0;l<a.length;l++)a[l].style.width=`${r}px`;for(let l=0;l<s.length;l++)s[l].style.width=`${i}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(e){return this._dir&&"rtl"===this._dir.value?e.right:e.left}_isAttachedToDOM(){const e=this._elementRef.nativeElement;if(e.getRootNode){const r=e.getRootNode();return r&&r!==e}return document.documentElement.contains(e)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Zo),X(su,8),X(Nue,8),X(Ka),X(Wr),X(kl,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-form-field"]],contentQueries:function(e,r,i){if(1&e&&(so(i,ZD,5),so(i,ZD,7),so(i,gm,5),so(i,gm,7),so(i,Fue,5),so(i,Tue,5),so(i,kue,5),so(i,Iue,5),so(i,j6,5)),2&e){let o;Er(o=Sr())&&(r._controlNonStatic=o.first),Er(o=Sr())&&(r._controlStatic=o.first),Er(o=Sr())&&(r._labelChildNonStatic=o.first),Er(o=Sr())&&(r._labelChildStatic=o.first),Er(o=Sr())&&(r._placeholderChild=o.first),Er(o=Sr())&&(r._errorChildren=o),Er(o=Sr())&&(r._hintChildren=o),Er(o=Sr())&&(r._prefixChildren=o),Er(o=Sr())&&(r._suffixChildren=o)}},viewQuery:function(e,r){if(1&e&&(Ko(fue,7),Ko(hue,5),Ko(pue,5)),2&e){let i;Er(i=Sr())&&(r._connectionContainerRef=i.first),Er(i=Sr())&&(r._inputContainerRef=i.first),Er(i=Sr())&&(r._label=i.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(e,r){2&e&&Ai("mat-form-field-appearance-standard","standard"==r.appearance)("mat-form-field-appearance-fill","fill"==r.appearance)("mat-form-field-appearance-outline","outline"==r.appearance)("mat-form-field-appearance-legacy","legacy"==r.appearance)("mat-form-field-invalid",r._control.errorState)("mat-form-field-can-float",r._canLabelFloat())("mat-form-field-should-float",r._shouldLabelFloat())("mat-form-field-has-label",r._hasFloatingLabel())("mat-form-field-hide-placeholder",r._hideControlPlaceholder())("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-focused",r._control.focused)("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))("_mat-animation-noopable",!r._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[ki([{provide:QD,useExisting:t}]),_r],ngContentSelectors:Aue,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(e,r){1&e&&(Fa(Due),d(0,"div",0)(1,"div",1,2),De("click",function(o){return r._control.onContainerClick&&r._control.onContainerClick(o)}),oe(3,mue,9,0,"ng-container",3),oe(4,gue,2,0,"div",4),d(5,"div",5,6),Ri(7),d(8,"span",7),oe(9,yue,5,16,"label",8),u()(),oe(10,wue,2,0,"div",9),u(),oe(11,xue,2,4,"div",10),d(12,"div",11),oe(13,Cue,2,1,"div",12),oe(14,Sue,5,2,"div",13),u()()),2&e&&(w(3),N("ngIf","outline"==r.appearance),w(1),N("ngIf",r._prefixChildren.length),w(5),N("ngIf",r._hasFloatingLabel()),w(1),N("ngIf",r._suffixChildren.length),w(1),N("ngIf","outline"!=r.appearance),w(1),N("ngSwitch",r._getDisplayedMessages()),w(1),N("ngSwitchCase","error"),w(1),N("ngSwitchCase","hint"))},dependencies:[Fi,Cy,xD,H4],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[Mue.transitionMessages]},changeDetection:0}),t})(),JD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[xf,Wi,ox],Wi]}),t})();const Rue=["panel"];function Lue(t,n){if(1&t&&(d(0,"div",0,1),Ri(2),u()),2&t){const e=n.id,r=ae();N("id",r.id)("ngClass",r._classList),kr("aria-label",r.ariaLabel||null)("aria-labelledby",r._getPanelAriaLabelledby(e))}}const Bue=["*"];let jue=0;class Vue{constructor(n,e){this.source=n,this.option=e}}const Uue=Oh(class{}),z6=new U("mat-autocomplete-default-options",{providedIn:"root",factory:function Hue(){return{autoActiveFirstOption:!1}}});let zue=(()=>{class t extends Uue{constructor(e,r,i,o){super(),this._changeDetectorRef=e,this._elementRef=r,this._activeOptionChanges=br.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new Vr,this.opened=new Vr,this.closed=new Vr,this.optionActivated=new Vr,this._classList={},this.id="mat-autocomplete-"+jue++,this.inertGroups=o?.SAFARI||!1,this._autoActiveFirstOption=!!i.autoActiveFirstOption}get isOpen(){return this._isOpen&&this.showPanel}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(e){this._autoActiveFirstOption=Bo(e)}set classList(e){this._classList=e&&e.length?function Soe(t,n=/\s+/){const e=[];if(null!=t){const r=Array.isArray(t)?t:`${t}`.split(n);for(const i of r){const o=`${i}`.trim();o&&e.push(o)}}return e}(e).reduce((r,i)=>(r[i]=!0,r),{}):{},this._setVisibilityClasses(this._classList),this._elementRef.nativeElement.className=""}ngAfterContentInit(){this._keyManager=new Ioe(this.options).withWrap(),this._activeOptionChanges=this._keyManager.change.subscribe(e=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[e]||null})}),this._setVisibility()}ngOnDestroy(){this._activeOptionChanges.unsubscribe()}_setScrollTop(e){this.panel&&(this.panel.nativeElement.scrollTop=e)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(e){const r=new Vue(this,e);this.optionSelected.emit(r)}_getPanelAriaLabelledby(e){return this.ariaLabel?null:this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_setVisibilityClasses(e){e[this._visibleClass]=this.showPanel,e[this._hiddenClass]=!this.showPanel}}return t.\u0275fac=function(e){return new(e||t)(X(Zo),X($r),X(z6),X(Ka))},t.\u0275dir=jn({type:t,viewQuery:function(e,r){if(1&e&&(Ko(Zl,7),Ko(Rue,5)),2&e){let i;Er(i=Sr())&&(r.template=i.first),Er(i=Sr())&&(r.panel=i.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[_r]}),t})(),c0=(()=>{class t extends zue{constructor(){super(...arguments),this._visibleClass="mat-autocomplete-visible",this._hiddenClass="mat-autocomplete-hidden"}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275cmp=pr({type:t,selectors:[["mat-autocomplete"]],contentQueries:function(e,r,i){if(1&e&&(so(i,YR,5),so(i,hm,5)),2&e){let o;Er(o=Sr())&&(r.optionGroups=o),Er(o=Sr())&&(r.options=o)}},hostAttrs:[1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[ki([{provide:GR,useExisting:t}]),_r],ngContentSelectors:Bue,decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(e,r){1&e&&(Fa(),oe(0,Lue,3,4,"ng-template"))},dependencies:[wf],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}\n"],encapsulation:2,changeDetection:0}),t})();const $6=new U("mat-autocomplete-scroll-strategy"),Wue={provide:$6,deps:[Rh],useFactory:function $ue(t){return()=>t.scrollStrategies.reposition()}},que={provide:Gc,useExisting:Ir(()=>_m),multi:!0};let Gue=(()=>{class t{constructor(e,r,i,o,a,s,l,c,f,v,E){this._element=e,this._overlay=r,this._viewContainerRef=i,this._zone=o,this._changeDetectorRef=a,this._dir=l,this._formField=c,this._document=f,this._viewportRuler=v,this._defaults=E,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=br.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new Bt,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=Xy(()=>this.autocomplete&&this.autocomplete.options?Ea(...this.autocomplete.options.map(D=>D.onSelectionChange)):this._zone.onStable.pipe(ra(1),Di(()=>this.optionSelections))),this._scrollStrategy=s}get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(e){this._autocompleteDisabled=Bo(e)}ngAfterViewInit(){const e=this._getWindow();typeof e<"u"&&this._zone.runOutsideAngular(()=>e.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(e){e.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const e=this._getWindow();typeof e<"u"&&e.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this.autocomplete.closed.emit(),this.autocomplete._isOpen=this._overlayAttached=!1,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._componentDestroyed||this._changeDetectorRef.detectChanges())}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return Ea(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(_o(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(_o(()=>this._overlayAttached)):On()).pipe(gr(e=>e instanceof XR?e:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return Ea(lu(this._document,"click"),lu(this._document,"auxclick"),lu(this._document,"touchend")).pipe(_o(e=>{const r=dm(e),i=this._formField?this._formField._elementRef.nativeElement:null,o=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&r!==this._element.nativeElement&&(!i||!i.contains(r))&&(!o||!o.contains(r))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(r)}))}writeValue(e){Promise.resolve(null).then(()=>this._setTriggerValue(e))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._element.nativeElement.disabled=e}_handleKeydown(e){const r=e.keyCode;if(27===r&&!Ad(e)&&e.preventDefault(),this.activeOption&&13===r&&this.panelOpen)this.activeOption._selectViaInteraction(),this._resetActiveItem(),e.preventDefault();else if(this.autocomplete){const i=this.autocomplete._keyManager.activeItem,o=38===r||40===r;this.panelOpen||9===r?this.autocomplete._keyManager.onKeydown(e):o&&this._canOpen()&&this.openPanel(),(o||this.autocomplete._keyManager.activeItem!==i)&&this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0)}}_handleInput(e){let r=e.target,i=r.value;"number"===r.type&&(i=""==i?null:parseFloat(i)),this._previousValue!==i&&(this._previousValue=i,this._onChange(i),this._canOpen()&&this._document.activeElement===e.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_floatLabel(e=!1){this._formField&&"auto"===this._formField.floatLabel&&(e?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField.floatLabel="auto",this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){return Ea(this._zone.onStable.pipe(ra(1)),this.autocomplete.options.changes.pipe(Ya(()=>this._positionStrategy.reapplyLastPosition()),FD(0))).pipe(Di(()=>{const i=this.panelOpen;return this._resetActiveItem(),this.autocomplete._setVisibility(),this.panelOpen&&(this._overlayRef.updatePosition(),i!==this.panelOpen&&this.autocomplete.opened.emit()),this.panelClosingActions}),ra(1)).subscribe(i=>this._setValueAndClose(i))}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_setTriggerValue(e){const i=(this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(e):e)??"";this._formField?this._formField._control.value=i:this._element.nativeElement.value=i,this._previousValue=i}_setValueAndClose(e){e&&e.source&&(this._clearPreviousSelectedOption(e.source),this._setTriggerValue(e.source.value),this._onChange(e.source.value),this._element.nativeElement.focus(),this.autocomplete._emitSelectEvent(e.source)),this.closePanel()}_clearPreviousSelectedOption(e){this.autocomplete.options.forEach(r=>{r!==e&&r.selected&&r.deselect()})}_attachOverlay(){let e=this._overlayRef;e?(this._positionStrategy.setOrigin(this._getConnectedElement()),e.updateSize({width:this._getPanelWidth()})):(this._portal=new p_(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),e=this._overlay.create(this._getOverlayConfig()),this._overlayRef=e,e.keydownEvents().subscribe(i=>{(27===i.keyCode&&!Ad(i)||38===i.keyCode&&Ad(i,"altKey"))&&(this._closeKeyEventStream.next(),this._resetActiveItem(),i.stopPropagation(),i.preventDefault())}),this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&e&&e.updateSize({width:this._getPanelWidth()})})),e&&!e.hasAttached()&&(e.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const r=this.panelOpen;this.autocomplete._setVisibility(),this.autocomplete._isOpen=this._overlayAttached=!0,this.panelOpen&&r!==this.panelOpen&&this.autocomplete.opened.emit()}_getOverlayConfig(){return new Xb({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){const e=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(e),this._positionStrategy=e,e}_setStrategyPositions(e){const r=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],i=this._aboveClass,o=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:i},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:i}];let a;a="above"===this.position?o:"below"===this.position?r:[...r,...o],e.withPositions(a)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const e=this.autocomplete;e.autoActiveFirstOption?e._keyManager.setFirstItemActive():e._keyManager.setActiveItem(-1)}_canOpen(){const e=this._element.nativeElement;return!e.readOnly&&!e.disabled&&!this._autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(e){const r=this.autocomplete,i=function Mae(t,n,e){if(e.length){let r=n.toArray(),i=e.toArray(),o=0;for(let a=0;a<t+1;a++)r[a].group&&r[a].group===i[o]&&o++;return o}return 0}(e,r.options,r.optionGroups);if(0===e&&1===i)r._setScrollTop(0);else if(r.panel){const o=r.options.toArray()[e];if(o){const a=o._getHostElement(),s=function kae(t,n,e,r){return t<e?t:t+n>e+r?Math.max(0,t-r+n):e}(a.offsetTop,a.offsetHeight,r._getScrollTop(),r.panel.nativeElement.offsetHeight);r._setScrollTop(s)}}}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Rh),X(Ml),X(Wr),X(Zo),X($6),X(su,8),X(QD,9),X(si,8),X(e0),X(z6,8))},t.\u0275dir=jn({type:t,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[gn]}),t})(),_m=(()=>{class t extends Gue{constructor(){super(...arguments),this._aboveClass="mat-autocomplete-panel-above"}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275dir=jn({type:t,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(e,r){1&e&&De("focusin",function(){return r._handleFocus()})("blur",function(){return r._onTouched()})("input",function(o){return r._handleInput(o)})("keydown",function(o){return r._handleKeydown(o)}),2&e&&kr("autocomplete",r.autocompleteAttribute)("role",r.autocompleteDisabled?null:"combobox")("aria-autocomplete",r.autocompleteDisabled?null:"list")("aria-activedescendant",r.panelOpen&&r.activeOption?r.activeOption.id:null)("aria-expanded",r.autocompleteDisabled?null:r.panelOpen.toString())("aria-owns",r.autocompleteDisabled||!r.panelOpen||null==r.autocomplete?null:r.autocomplete.id)("aria-haspopup",!r.autocompleteDisabled)},exportAs:["matAutocompleteTrigger"],features:[ki([que]),_r]}),t})(),Yue=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:[Wue],imports:[[hx,KR,Wi,xf],__,KR,Wi]}),t})();const W6=f_({passive:!0});let Xue=(()=>{class t{constructor(e,r){this._platform=e,this._ngZone=r,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return Zs;const r=Ih(e),i=this._monitoredElements.get(r);if(i)return i.subject;const o=new Bt,a="cdk-text-field-autofilled",s=l=>{"cdk-text-field-autofill-start"!==l.animationName||r.classList.contains(a)?"cdk-text-field-autofill-end"===l.animationName&&r.classList.contains(a)&&(r.classList.remove(a),this._ngZone.run(()=>o.next({target:l.target,isAutofilled:!1}))):(r.classList.add(a),this._ngZone.run(()=>o.next({target:l.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{r.addEventListener("animationstart",s,W6),r.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(r,{subject:o,unlisten:()=>{r.removeEventListener("animationstart",s,W6)}}),o}stopMonitoring(e){const r=Ih(e),i=this._monitoredElements.get(r);i&&(i.unlisten(),i.subject.complete(),r.classList.remove("cdk-text-field-autofill-monitored"),r.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(r))}ngOnDestroy(){this._monitoredElements.forEach((e,r)=>this.stopMonitoring(r))}}return t.\u0275fac=function(e){return new(e||t)(it(Ka),it(Wr))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),q6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[Ub]]}),t})();const Kue=new U("MAT_INPUT_VALUE_ACCESSOR"),Zue=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let Que=0;const Jue=bae(class{constructor(t,n,e,r){this._defaultErrorStateMatcher=t,this._parentForm=n,this._parentFormGroup=e,this.ngControl=r}});let u0=(()=>{class t extends Jue{constructor(e,r,i,o,a,s,l,c,f,v){super(s,o,a,i),this._elementRef=e,this._platform=r,this._autofillMonitor=c,this._formField=v,this._uid="mat-input-"+Que++,this.focused=!1,this.stateChanges=new Bt,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(k=>vR().has(k));const E=this._elementRef.nativeElement,D=E.nodeName.toLowerCase();this._inputValueAccessor=l||E,this._previousNativeValue=this.value,this.id=this.id,r.IOS&&f.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",k=>{const T=k.target;!T.value&&0===T.selectionStart&&0===T.selectionEnd&&(T.setSelectionRange(1,1),T.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===D,this._isTextarea="textarea"===D,this._isInFormField=!!v,this._isNativeSelect&&(this.controlType=E.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(e){this._disabled=Bo(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(Zn.required)??!1}set required(e){this._required=Bo(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&vR().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=Bo(e)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){const e=this._formField?._hideControlPlaceholder?.()?null:this.placeholder;if(e!==this._previousPlaceholder){const r=this._elementRef.nativeElement;this._previousPlaceholder=e,e?r.setAttribute("placeholder",e):r.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_validateType(){Zue.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,r=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&r&&r.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Ka),X(Eh,10),X($y,8),X(bo,8),X(jR),X(Kue,10),X(Xue),X(Wr),X(QD,8))},t.\u0275dir=jn({type:t,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:11,hostBindings:function(e,r){1&e&&De("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),2&e&&(T1("disabled",r.disabled)("required",r.required),kr("id",r.id)("data-placeholder",r.placeholder)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required),Ai("mat-input-server",r._isServer)("mat-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[ki([{provide:ZD,useExisting:t}]),_r,gn]}),t})(),ede=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:[jR],imports:[[q6,JD,Wi],q6,JD]}),t})();const tde=["thumbContainer"],nde=["toggleBar"],rde=["input"],ide=function(t){return{enterDuration:t}},ode=["*"],ade=new U("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let sde=0;const lde={provide:Gc,useExisting:Ir(()=>eA),multi:!0};class cde{constructor(n,e){this.source=n,this.checked=e}}const ude=vae(Jg(Oh(m_(class{constructor(t){this._elementRef=t}}))));let eA=(()=>{class t extends ude{constructor(e,r,i,o,a,s){super(e),this._focusMonitor=r,this._changeDetectorRef=i,this.defaults=a,this._onChange=l=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++sde,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new Vr,this.toggleChange=new Vr,this.tabIndex=parseInt(o)||0,this.color=this.defaultColor=a.color||"accent",this._noopAnimations="NoopAnimations"===s}get required(){return this._required}set required(e){this._required=Bo(e)}get checked(){return this._checked}set checked(e){this._checked=Bo(e),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{"keyboard"===e||"program"===e?this._inputElement.nativeElement.focus():e||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(e){e.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(e){e.stopPropagation()}writeValue(e){this.checked=!!e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck()}focus(e,r){r?this._focusMonitor.focusVia(this._inputElement,r,e):this._inputElement.nativeElement.focus(e)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new cde(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(fm),X(Zo),jc("tabindex"),X(ade),X(kl,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-slide-toggle"]],viewQuery:function(e,r){if(1&e&&(Ko(tde,5),Ko(nde,5),Ko(rde,5)),2&e){let i;Er(i=Sr())&&(r._thumbEl=i.first),Er(i=Sr())&&(r._thumbBarEl=i.first),Er(i=Sr())&&(r._inputElement=i.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(e,r){2&e&&(T1("id",r.id),kr("tabindex",r.disabled?null:-1)("aria-label",null)("aria-labelledby",null),Ai("mat-checked",r.checked)("mat-disabled",r.disabled)("mat-slide-toggle-label-before","before"==r.labelPosition)("_mat-animation-noopable",r._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[ki([lde]),_r],ngContentSelectors:ode,decls:16,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(e,r){if(1&e&&(Fa(),d(0,"label",0,1)(2,"div",2,3)(4,"input",4,5),De("change",function(o){return r._onChangeEvent(o)})("click",function(o){return r._onInputClick(o)}),u(),d(6,"div",6,7),qe(8,"div",8),d(9,"div",9),qe(10,"div",10),u()()(),d(11,"span",11,12),De("cdkObserveContent",function(){return r._onLabelTextChange()}),d(13,"span",13),h(14,"\xa0"),u(),Ri(15),u()()),2&e){const i=go(1),o=go(12);kr("for",r.inputId),w(2),Ai("mat-slide-toggle-bar-no-side-margin",!o.textContent||!o.textContent.trim()),w(2),N("id",r.inputId)("required",r.required)("tabIndex",r.tabIndex)("checked",r.checked)("disabled",r.disabled),kr("name",r.name)("aria-checked",r.checked.toString())("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby),w(5),N("matRippleTrigger",i)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",Si(18,ide,r._noopAnimations?0:150))}},dependencies:[Nh,xD],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;-moz-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),t})(),G6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({}),t})(),hde=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[G6,g_,Wi,ox],G6,Wi]}),t})();function pde(t,n){1&t&&(d(0,"div",78),h(1," El n\xfamero del paciente es requerido. "),u())}function mde(t,n){if(1&t&&(d(0,"mat-option",79),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function gde(t,n){if(1&t&&(d(0,"mat-option",79),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),fo(" ",e.nombre," - ",e.especialidad," ")}}function _de(t,n){1&t&&(d(0,"div",78),h(1," M\xe9dico que prescribe la f\xf3rmula es requerido. "),u())}function vde(t,n){1&t&&(d(0,"div",78),h(1," La fecha de la prescripci\xf3n de la f\xf3rmula es requerida. "),u())}function bde(t,n){1&t&&(d(0,"div",78),h(1," La fecha de solicitud de la f\xf3rmula es requerida. "),u())}function yde(t,n){1&t&&(d(0,"div",78),h(1," El Dx Principal es requerido. "),u())}function wde(t,n){if(1&t&&(d(0,"small",81),h(1),u()),2&t){const e=ae(2);w(1),Qt(" ",e.mensajeComentario," ")}}function xde(t,n){if(1&t&&(d(0,"div",78),oe(1,wde,2,1,"small",80),u()),2&t){const e=ae();w(1),N("ngIf",e.comentarioVisible)}}function Cde(t,n){if(1&t&&(d(0,"small",81),h(1),u()),2&t){const e=ae(2);w(1),Qt(" ",e.mensajeErrorDx," ")}}function Ede(t,n){if(1&t&&(d(0,"div",78),oe(1,Cde,2,1,"small",80),u()),2&t){const e=ae();w(1),N("ngIf",e.comentarioVisible)}}function Sde(t,n){1&t&&(d(0,"div",78),h(1," El programa del paciente es requerido. "),u())}function Dde(t,n){if(1&t&&(d(0,"h5",84)(1,"span",85),h(2),Hi(3,"currency"),u()()),2&t){const e=ae(2);w(2),fo(" ",e.pacienteActual.categoria.nombre," : ",QC(3,2,e.pacienteActual.categoria.valor,"COP","symbol-narrow","1.0-0")," ")}}function Ade(t,n){if(1&t&&(d(0,"div",7)(1,"p")(2,"mat-slide-toggle",82),h(3,"Cobro la cuota moderadora!"),u()(),oe(4,Dde,4,7,"h5",83),u()),2&t){const e=ae();w(2),N("checked",e.cobroCuotaModeradora()),w(2),N("ngIf","C"===(null==e.pacienteActual?null:e.pacienteActual.regimen))}}function Tde(t,n){if(1&t){const e=Fn();xc(0),d(1,"p")(2,"strong"),h(3,"Direcci\xf3n:"),u(),h(4),qe(5,"br"),d(6,"strong"),h(7,"Contacto:"),u(),h(8),d(9,"button",88),De("click",function(){return ht(e),pt(ae(2).enEdicion())}),d(10,"mat-icon"),h(11,"edit"),u()()(),Cc()}if(2&t){const e=ae(2);w(4),Qt(" ",e.pacienteActual.direccion,""),w(4),fo(" ",e.pacienteActual.celularPrincipal," - ",e.pacienteActual.celularSecundario," ")}}function Mde(t,n){if(1&t){const e=Fn();d(0,"div",89)(1,"div")(2,"mat-label"),h(3,"Datos de contacto"),u(),qe(4,"input",90)(5,"input",91)(6,"input",92)(7,"input",93)(8,"input",94),u(),d(9,"div",95)(10,"button",96),De("click",function(){return ht(e),pt(ae(2).guardarDatosContacto())}),d(11,"mat-icon"),h(12,"check"),u()(),d(13,"button",97),De("click",function(){return ht(e),pt(ae(2).cancelarEdicion())}),d(14,"mat-icon"),h(15,"close"),u()()()()}}function kde(t,n){if(1&t&&(d(0,"div",63)(1,"p")(2,"strong"),h(3,"Nombre:"),u(),h(4),u(),d(5,"p")(6,"strong"),h(7,"Eps:"),u(),h(8),u(),d(9,"div"),oe(10,Tde,12,3,"ng-container",86),oe(11,Mde,16,0,"ng-template",null,87,TM),u(),d(13,"p")(14,"strong"),h(15,"Sexo:"),u(),h(16),d(17,"strong"),h(18," - Edad:"),u(),h(19),u()()),2&t){const e=go(12),r=ae();w(4),Up(" ",r.pacienteActual.pNombre," ",r.pacienteActual.sNombre," ",r.pacienteActual.pApellido," ",r.pacienteActual.sApellido,""),w(4),Qt(" ",r.pacienteActual.eps.nombre,""),w(2),N("ngIf",!r.editarContacto)("ngIfElse",e),w(6),Qt(" ",r.pacienteActual.sexo," "),w(3),Qt(" ",r.calcularEdad(r.pacienteActual.fecNacimiento)," a\xf1os")}}function Fde(t,n){1&t&&(d(0,"div",100)(1,"p")(2,"strong"),h(3,"Paciente PAVE"),u()()())}function Ide(t,n){if(1&t&&(d(0,"div",101)(1,"p")(2,"strong"),h(3),Hi(4,"date"),u()()()),2&t){const e=ae(2);w(3),fo("Portabilidad - ",e.pacienteActual.mpoportabilidad.nombre," vence: ",Xo(4,2,e.pacienteActual.fecVencePortabilidad,"dd/MM/YYYY"),"")}}function Pde(t,n){if(1&t&&(d(0,"div",4)(1,"p")(2,"strong"),h(3,"Municipio:"),u(),h(4),u(),d(5,"p")(6,"strong"),h(7,"Dispensario:"),u(),h(8),u(),oe(9,Fde,4,0,"div",98),oe(10,Ide,5,5,"div",99),u()),2&t){const e=ae();w(4),fo(" ",e.pacienteActual.municipio.nombre," - ",e.pacienteActual.municipio.departamento.nombre,""),w(4),Qt(" ",e.pacienteActual.dispensario," "),w(1),N("ngIf",e.pacienteActual.pave),w(1),N("ngIf",e.pacienteActual.portabilidad)}}function Ode(t,n){if(1&t&&(d(0,"mat-option",79),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function Nde(t,n){1&t&&(d(0,"div",78),h(1," No ha seleccionado los medicamentos de la f\xf3rmula. "),u())}function Rde(t,n){1&t&&(d(0,"div",102),h(1," No hay medicamentos asignados para la f\xf3rmula, debe agregar al menos uno. "),u())}function Lde(t,n){1&t&&qe(0,"th")}function Bde(t,n){if(1&t&&(d(0,"td"),qe(1,"input",114),u()),2&t){const e=ae().index;w(1),N("formControlName",e)}}function jde(t,n){if(1&t&&(d(0,"option",79),h(1),u()),2&t){const e=n.$implicit;N("value",e.valor),kr("data-multiplicador",e.multiplicador),w(1),Qt(" ",e.nombre," ")}}const Vde=function(t){return{color:t}},Ude=function(t){return{"background-color":t}};function Hde(t,n){if(1&t){const e=Fn();d(0,"tr",109),oe(1,Bde,2,1,"td",105),d(2,"td"),h(3),u(),d(4,"td")(5,"select",110),De("change",function(i){const a=ht(e).$implicit;return pt(ae(2).seleccionFrecuencia(a.medicamento.idMedicamento,i))}),oe(6,jde,2,3,"option",19),u()(),d(7,"td")(8,"input",111),De("change",function(i){const a=ht(e).$implicit;return pt(ae(2).duracionTratamiento(a.medicamento.idMedicamento,i))}),u()(),d(9,"td")(10,"input",112),De("change",function(i){const a=ht(e).$implicit;return pt(ae(2).actualizarCantidad(a.medicamento.idMedicamento,i))}),u()(),d(11,"td")(12,"button",113),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarItemFormula(o.medicamento.idMedicamento))}),h(13,"x"),u()(),d(14,"td"),h(15),u()()}if(2&t){const e=n.$implicit,r=ae(2);let i;N("ngStyle",Si(12,Vde,e.medicamento.desabastecido?"red":"black")),w(1),N("ngIf",null==(i=r.facturaForm.get("checkcontinuidad"))?null:i.value),w(2),_e(e.medicamento.nombre),w(2),N("value",e.frecuencia),w(1),N("ngForOf",r.frecuencias),w(2),N("value",e.duracion)("min",1),w(2),N("value",e.cantidad)("disabled",e.habilitarCantidad)("ngStyle",Si(14,Ude,e.habilitarCantidad?"gris":"#A5E3C6"))("min",1),w(5),_e(r.existencias[e.medicamento.idMedicamento]||"0")}}function zde(t,n){if(1&t&&(d(0,"table",103)(1,"thead",104)(2,"tr"),oe(3,Lde,1,0,"th",105),d(4,"th"),h(5,"Medicamento"),u(),d(6,"th",106),h(7,"Frecuencia"),u(),d(8,"th",107),h(9,"Duraci\xf3n"),u(),d(10,"th",107),h(11,"Cantidad"),u(),d(12,"th",107),h(13,"Eliminar"),u(),d(14,"th"),h(15,"Inventario"),u()()(),d(16,"tbody"),oe(17,Hde,16,16,"tr",108),u()()),2&t){const e=ae();let r;w(3),N("ngIf",null==(r=e.facturaForm.get("checkcontinuidad"))?null:r.value),w(14),N("ngForOf",e.formula.items)}}function $de(t,n){1&t&&qe(0,"input",118)}function Wde(t,n){if(1&t&&(d(0,"h6",115),qe(1,"input",116),h(2," Post fechar f\xf3rmula: "),oe(3,$de,1,0,"input",117),u()),2&t){const e=ae();let r;w(3),N("ngIf",null==(r=e.facturaForm.get("checkcontinuidad"))?null:r.value)}}function qde(t,n){if(1&t&&(d(0,"div",119),qe(1,"app-historialformula",120),u()),2&t){const e=ae();w(1),N("idPaciente",e.pacienteActual.idPaciente)}}let Y6=(()=>{class t{ngAfterViewInit(){this.historialFormulaComponente&&console.log("historialFormulaComponente inicializado correctamente")}constructor(e,r,i,o,a,s,l,c,f,v){this.pacienteService=e,this.formulaService=r,this.medicamentoService=i,this.medicoService=o,this.ipsService=a,this.bodegaService=s,this.router=l,this.formBuilder=c,this.activatedRoute=f,this.dialog=v,this.formula=new wx,this.mostrarComponente=!1,this.existencias={},this.comentarioVisible=!1,this.mensajeComentario="",this.mensajeErrorDx="",this.dxValido=!0,this.editarContacto=!1,this.celularPrincipalEditado="",this.celularSecundarioEditado="",this.direccionEditada="",this.frecuencias=[{nombre:"1 Cada 24 Horas",multiplicador:1,valor:"1 Cada 24 Horas"},{nombre:"1 Cada 12 Horas",multiplicador:2,valor:"1 Cada 12 Horas"},{nombre:"1 Cada 8 Horas",multiplicador:3,valor:"1 Cada 8 Horas"},{nombre:"1 Cada 6 Horas",multiplicador:4,valor:"1 Cada 6 Horas"},{nombre:"1 Cada 4 Horas",multiplicador:6,valor:"1 Cada 4 Horas"},{nombre:"1 Despues de cada comida",multiplicador:3,valor:"1 Despues de cada comida"},{nombre:"1 Cada 15 dias",multiplicador:2,valor:"1 Cada 15 dias"},{nombre:"1 Cada Mes",multiplicador:1,valor:"1 Cada Mes"},{nombre:"1 Cada Trimestre",multiplicador:1,valor:"1 Cada Trimestre"},{nombre:"2 Cada 24 Horas",multiplicador:2,valor:"2 Cada 24 Horas"},{nombre:"2 Cada 12 Horas",multiplicador:4,valor:"2 Cada 12 Horas"},{nombre:"2 Cada 8 Horas",multiplicador:6,valor:"2 Cada 8 Horas"},{nombre:"2 Cada 6 Horas",multiplicador:8,valor:"2 Cada 6 Horas"},{nombre:"2 Cada 4 Horas",multiplicador:12,valor:"2 Cada 4 Horas"},{nombre:"3 Cada 8 Horas",multiplicador:9,valor:"3 Cada 8 Horas"},{nombre:"4 Cada 8 Horas",multiplicador:12,valor:"4 Cada 8 Horas"},{nombre:"2 Despues de cada comida",multiplicador:6,valor:"2 Despues de cada comida"},{nombre:"1 Cada 7 dias",multiplicador:4,valor:"1 Cada 7 dias"},{nombre:"2 Cada 15 dias",multiplicador:4,valor:"2 Cada 15 dias"},{nombre:"2 Cada Mes",multiplicador:2,valor:"2 Cada Mes"},{nombre:"2 Cada Trimestre",multiplicador:2,valor:"2 Cada Trimestre"},{nombre:"Dosis unica",multiplicador:1,valor:"Dosis unica"}],this.medicamentosFiltrados=[],this.medicosFiltrados=[],this.ipsFiltrados=[],this.facturaForm=this.formBuilder.group({idFormula:[""],nroFormula:["N/A"],observacion:[""],ips:["",Zn.required],medico:["",Zn.required],fecPrescribe:["",Zn.required],fecSolicitud:[(new Date).toISOString().split("T")[0],Zn.required],total:[""],paciente:["",Zn.required],items:this.formBuilder.array([]),estado:[!1],medicamento:[""],cieP:["",[Zn.required,Zn.maxLength(4)]],cieR1:["",[Zn.maxLength(4)]],cieR2:["",[Zn.maxLength(4)]],cieR3:["",[Zn.maxLength(4)]],origenurgencia:[!1],programa:["",Zn.required],cobroCM:[!1],pgp:[!1],valorCM:["0"],checkcontinuidad:[!1],cantidadmeses:[""],posfechados:this.formBuilder.array([]),direccion:[""],celularPrincipal:[""],celularSecundario:[""],barrio:[""],email:[""]})}ngOnInit(){this.deshabilitarControles(),this.activatedRoute.paramMap.subscribe(o=>{let a=+o.get("id"),s=+o.get("idFormula");a?this.pacienteService.getRegistroId(a).subscribe(l=>{this.procesarPaciente(l)}):s&&this.formulaService.getFormulaId(s).subscribe(l=>{this.formula=l,this.mostrarComponente=!0,this.pacienteActual=l.paciente,this.mostrarRegistro(l),this.facturaForm.get("cobroCM")?.setValue(this.cobroCuotaModeradora())})}),this.facturaForm.get("medico").valueChanges.pipe(xo(300),Di(o=>this.medicoService.filtrarMedicos(o))).subscribe(o=>{this.medicosFiltrados=o}),this.facturaForm.get("ips").valueChanges.pipe(xo(300),Di(o=>this.ipsService.filtrarIpss(o))).subscribe(o=>{this.ipsFiltrados=o}),this.facturaForm.get("medicamento").valueChanges.pipe(xo(300),Di(o=>this.pacienteActual&&this.pacienteActual.eps?this.formulaService.filtrarMedicamentosEps(o,this.pacienteActual.eps.codigo):On([]))).subscribe(o=>{this.medicamentosFiltrados=o});let e=sessionStorage.getItem("bodega"),r=parseInt(null!==e?e:"0",10);this.bodegaService.getRegistroId(r).subscribe(o=>{this.bodegaActual=o},o=>{console.error(o)}),this.setPosfechados(),this.fechaActual=new Date;const i=new Date(this.fechaActual);i.setDate(this.fechaActual.getDate()-5),this.hoy=this.fechaActual.toISOString().split("T")[0],this.minimohoy=i.toISOString().split("T")[0]}mostrarRegistro(e){var r=new Date(e.fecPrescribe),i=new Date(e.fecSolicitud);this.facturaForm.patchValue({idFormula:e.idFormula,nroFormula:e.nroFormula,observacion:e.observacion,ips:e.ips,medico:e.medico,fecPrescribe:r.toJSON().slice(0,10),fecSolicitud:i.toJSON().slice(0,10),total:e.total,paciente:e.paciente.numDocumento,items:e.items,estado:e.estado,medicamento:e.medicamento,cieP:e.cieP,cieR1:e.cieR1,cieR2:e.cieR2,cieR3:e.cieR3,cobroCM:e.cobroCM,valorCM:e.valorCM,continuidad:e.continuidad,pgp:e.pgp})}get posfechados(){return this.facturaForm.get("posfechados")}setPosfechados(){const e=this.posfechados;for(;0!==e.length;)e.removeAt(0);this.formula.items.forEach(()=>e.push(this.formBuilder.control(!1)))}isPosfechadosSelected(e){return this.posfechados.at(e).value}openDialogIps(){this.dialog.open(GD,{width:"400px",data:{}}).afterClosed().subscribe(r=>{r&&this.facturaForm.get("ips").setValue(r.nombre)})}openDialogMedico(){this.dialog.open(XD,{width:"400px",data:{}}).afterClosed().subscribe(r=>{r&&this.facturaForm.get("medico").setValue(r.nombre)})}cobroCuotaModeradora(){return!(!this.pacienteActual||!this.pacienteActual.regimen)&&"C"===this.pacienteActual.regimen}onOptionSelectedIps(e){this.facturaForm.get("ips")?.setValue(e)}onOptionSelectedMedico(e){this.facturaForm.get("medico")?.setValue(e)}displayIps(e){return e?e.nombre:""}displayMedico(e){return e?e.nombre:""}autocompletadoValido(e){return r=>{const i=r.value;return e.some(a=>a.nombre===i)?null:{opcionInvalida:{value:r.value}}}}buscarDocumento(){this.deshabilitarControles(),this.pacienteService.getRegistroDocumento(this.facturaForm.get("paciente").value).subscribe(e=>{e&&e.length>1?z().fire({icon:"error",title:"DOCUMENTO DUPLICADO",text:"Este documento est\xe1 duplicado en la base de datos. Identifique claramente al paciente para entregar el medicamento."}):e&&1===e.length&&this.procesarPaciente(e[0])})}procesarPaciente(e){if(this.formula.paciente=e,this.pacienteActual=e,this.mostrarComponente=!0,this.facturaForm.patchValue({direccion:this.pacienteActual.direccion,celularPrincipal:this.pacienteActual.celularPrincipal,celularSecundario:this.pacienteActual.celularSecundario,barrio:this.pacienteActual.barrio,email:this.pacienteActual.email}),this.historialFormulaComponente&&this.historialFormulaComponente.buscarRegistro(this.pacienteActual.idPaciente),this.formula.items=[],!0===this.pacienteActual.estado)if("SISM DISPENSARIO"===this.pacienteActual.dispensario){this.facturaForm.get("cobroCM")?.setValue(this.cobroCuotaModeradora());const r=this.pacienteActual.municipio.codigo,i=this.pacienteActual.mpoportabilidad?.codigo,o=new Date(this.pacienteActual?.fecVencePortabilidad),a=new Date(this.fechaActual);this.bodegaActual.municipio===r||this.pacienteActual.portabilidad&&this.bodegaActual.municipio===i&&o>=a?(this.habilitarControles(),console.log("Controles habilitados"),this.facturaForm.updateValueAndValidity()):z().fire({icon:"warning",title:"OTRO MUNICIPIO",text:"El paciente est\xe1 en otro municipio o portabilidad vencida."})}else z().fire({icon:"warning",title:"OTRO DISPENSARIO",text:"El paciente pertenece a otro dispensario."});else z().fire({icon:"info",title:"INACTIVO",text:"El paciente est\xe1 inactivo. No se puede generar la entrega de medicamentos."})}convertirAMayusculasCieP(e){const r=e.target;r.value=r.value.toUpperCase(),this.facturaForm.get("cieP")?.setValue(r.value,{emitEvent:!1})}convertirAMayusculasCieR1(e){const r=e.target;r.value=r.value.toUpperCase(),this.facturaForm.get("cieR1")?.setValue(r.value,{emitEvent:!1})}convertirAMayusculasCieR2(e){const r=e.target;r.value=r.value.toUpperCase(),this.facturaForm.get("cieR2")?.setValue(r.value,{emitEvent:!1})}convertirAMayusculasCieR3(e){const r=e.target;r.value=r.value.toUpperCase(),this.facturaForm.get("cieR3")?.setValue(r.value,{emitEvent:!1})}habilitarControles(){this.facturaForm.get("observacion")?.enable(),this.facturaForm.get("ips")?.enable(),this.facturaForm.get("medico")?.enable(),this.facturaForm.get("fecPrescribe")?.enable(),this.facturaForm.get("medicamento")?.enable(),this.facturaForm.get("cieP")?.enable(),this.facturaForm.get("cieR1")?.enable(),this.facturaForm.get("cieR2")?.enable(),this.facturaForm.get("cieR3")?.enable(),this.facturaForm.get("cobroCM")?.enable(),this.facturaForm.get("programa")?.enable(),this.facturaForm.get("origenurgencia")?.enable(),this.facturaForm.get("pgp")?.enable(),this.facturaForm.get("fecSolicitud")?.enable()}deshabilitarControles(){this.facturaForm.get("observacion")?.disable(),this.facturaForm.get("ips")?.disable(),this.facturaForm.get("medico")?.disable(),this.facturaForm.get("fecPrescribe")?.disable(),this.facturaForm.get("medicamento")?.disable(),this.facturaForm.get("cieP")?.disable(),this.facturaForm.get("cieR1")?.disable(),this.facturaForm.get("cieR2")?.disable(),this.facturaForm.get("cieR3")?.disable(),this.facturaForm.get("cobroCM")?.disable(),this.facturaForm.get("programa")?.disable(),this.facturaForm.get("origenurgencia")?.disable(),this.facturaForm.get("pgp")?.disable(),this.facturaForm.get("fecSolicitud")?.disable()}mostrarMedicamento(e){return e?e.nombre.toString():""}seleccionarMedicamento(e){var r=this;return(0,hi.Z)(function*(){let i=e.option.value,o=parseInt(sessionStorage.getItem("bodega")||"0",10);if(i&&r.pacienteActual)if(yield r.medicamentoEntegadoMenos30Dias(i.idMedicamento,r.pacienteActual.idPaciente))r.facturaForm.get("medicamento")?.reset();else{if(r.existeItem(i.idMedicamento))r.incrementaCantidad(i.idMedicamento);else{let s=new WD;s.medicamento=i,s.importe=s.calcularImporte(),s.habilitarCantidad=[3,15,19,20,22,24,116].includes(i.forma.idForma),r.formula.items=r.formula.items||[],r.formula.items.push(s),r.setPosfechados(),r.existenciaAcutal(i.idMedicamento,o),(i.desabastecido||i.agotado)&&z().fire({icon:"warning",title:"MEDICAMENTO CON CARTA DE AGOTADO Y/O DESABASTECIDO",text:"Por favor si tienes en existencia en tu bodega agregalo a la formula, de lo contrario notificale al paciente! recuerde si no tiene en existencia no lo agregue a la formula."})}r.facturaForm.get("medicamento")?.reset()}else console.error("Medicamento o paciente no definido.")})()}existenciaAcutal(e,r){this.medicamentoService.getMedicamentoBodega(e,r).subscribe(i=>{this.existencias[e]=i.cantidad},i=>{console.error("Error fetching existencia:",i)})}actualizarCantidad(e,r){let i=r.target.value;if(0==i)return this.eliminarItemFormula(e);this.formula.items=this.formula.items.map(o=>(e===o.medicamento.idMedicamento&&(o.cantidad=i,o.importe=o.calcularImporte()),o))}duracionTratamiento(e,r){let i=r.target.value;this.formula.items=this.formula.items.map(o=>(e===o.medicamento.idMedicamento&&(o.duracion=i.toString(),o.habilitarCantidad&&this.calcularCantidad(o)),o))}calcularCantidad(e){const r=this.frecuencias.find(o=>o.valor===e.frecuencia);e.cantidad=(r?r.multiplicador:1)*e.duracion}seleccionFrecuencia(e,r){let i=r.target.value;this.formula.items=this.formula.items.map(o=>(e===o.medicamento.idMedicamento&&(o.frecuencia=i,o.habilitarCantidad&&this.calcularCantidad(o)),o))}existeItem(e){let r=!1;return this.formula.items.forEach(i=>{e===i.medicamento.idMedicamento&&(r=!0)}),r}incrementaCantidad(e){this.formula.items=this.formula.items.map(r=>(e===r.medicamento.idMedicamento&&(++r.cantidad,r.importe=r.calcularImporte()),r))}eliminarItemFormula(e){this.formula.items=this.formula.items.filter(r=>e!==r.medicamento.idMedicamento),this.setPosfechados()}medicamentoEntegadoMenos30Dias(e,r){var i=this;return(0,hi.Z)(function*(){try{const o=yield i.formulaService.getMedicamentoEntregadoPacienteMenosDe30Dias(e,r).toPromise();return!!(o&&o.length>0&&o[0].medicamento)&&(z().fire({icon:"warning",title:"Entregado menos de 30 d\xedas",text:`El medicamento ${o[0].medicamento.nombre} ya fue entregado hace menos de 30 d\xedas. No se puede agregar.`}),!0)}catch(o){return console.error("Error al consultar entrega reciente:",o),z().fire("Error","No se pudo verificar el historial de entregas del medicamento.","error"),!0}})()}create(){if(this.facturaForm.get("cieP")?.invalid||this.dxValido)z().fire({icon:"error",title:"Error",text:"El diagnostico principal que estas digitando no es valido o no esta acorde al sexo o la edad, corregirlo y continuar!"});else if(this.facturaForm.valid){const e=new Date(this.facturaForm.get("fecPrescribe")?.value),r=new Date;if(r.setDate(r.getDate()-31),e>=this.fechaActual||e<=r)return void z().fire({icon:"error",title:"Error",text:"La fecha digitada en la prescripci\xf3n de la f\xf3rmula est\xe1 fuera del rango definido para procesarla. Corregirla y continuar."});if(this.bodegaActual.dispensa)if(0==this.formula.items.length&&this.facturaForm.get("medicamento")?.setErrors({invalid:!0}),this.formula.items.length>0){if(!this.validateItems())return;if(this.facturaForm.get("checkcontinuidad").value)if(this.facturaForm.get("cantidadmeses").value>1&&this.facturaForm.get("cantidadmeses").value<=6){let i=!1;for(let o=0;o<this.formula.items.length;o++)this.posfechados.at(o).value&&(i=!0);if(i){let o="Con estos items y cantidades <br>";for(let a=0;a<this.formula.items.length;a++)o+=a+1+` - ${this.formula.items[a].medicamento.nombre} - Cantidad - ${this.formula.items[a].cantidad}<br>`;z().fire({title:"Confirma agregar la formula?",icon:"question",html:o,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar!"}).then(a=>{a.isConfirmed&&(this.agregarFormula(this.facturaForm.get("cantidadmeses").value),z().fire({icon:"success",title:"Ok",text:"La formula ha sido agregada correctamente!"}),this.facturaForm.reset(),this.facturaForm.get("paciente")?.setValue(this.pacienteActual.numDocumento))})}else z().fire({icon:"error",title:"Verificar!",text:"No ha seleccionado ning\xfan medicamento para pos fechar en la formula!"})}else z().fire({icon:"error",title:"Verificar!",text:"El n\xfamero de meses a pos fechar la formula debe ser mayor que 0 o menor o igual que 6 para poderlas generar!"});else{let i="Con estos items y cantidades <br>";for(let o=0;o<this.formula.items.length;o++)i+=o+1+` - ${this.formula.items[o].medicamento.nombre} - Cantidad - ${this.formula.items[o].cantidad}<br>`;z().fire({title:"Confirma agregar la formula?",icon:"question",html:i,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar!"}).then(o=>{o.isConfirmed&&(this.agregarFormula(1),z().fire({icon:"success",title:"Ok",text:"La formula ha sido agregada correctamente!"}),this.facturaForm.reset(),this.facturaForm.get("paciente")?.setValue(this.pacienteActual.numDocumento))})}}else z().fire({icon:"warning",title:"Verificar!",text:"No se ha agregado ning\xfan medicamento a la formula que intenta guardar!"});else z().fire({icon:"warning",title:"!Alerta",text:"La bodega "+this.bodegaActual.nombre+" donde esta logueado el usuario no esta habilitada para dispensar formulas a pacientes!"})}else z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para crear la formula en la base de datos!"})}agregarFormula(e){let r=sessionStorage.getItem("bodega"),i=sessionStorage.getItem("nombre"),o=parseInt(null!==r?r:"0",10);this.formula.idBodega=o,this.formula.ips=this.facturaForm.get("ips")?.value,this.formula.medico=this.facturaForm.get("medico")?.value,this.formula.nroFormula=this.facturaForm.get("nroFormula")?.value,this.formula.fecPrescribe=this.facturaForm.get("fecPrescribe")?.value;const a=this.facturaForm.get("fecSolicitud")?.value,s=(new Date).toISOString().split("T")[0];if(this.formula.fecSolicitud=a===s?new Date:a,this.formula.observacion=this.facturaForm.get("observacion")?.value,this.formula.cobroCM=this.facturaForm.get("cobroCM")?.value,this.formula.valorCM=this.formula.cobroCM?this.pacienteActual.categoria.valor:0,this.formula.cieP=this.facturaForm.get("cieP")?.value,this.formula.cieR1=this.facturaForm.get("cieR1")?.value,this.formula.cieR2=this.facturaForm.get("cieR2")?.value,this.formula.origenurgencia=this.facturaForm.get("origenurgencia")?.value,this.formula.pgp=this.facturaForm.get("pgp")?.value,this.formula.programa=this.facturaForm.get("programa")?.value,this.formula.total=this.formula.calcularGranTotal(),this.formula.funcionariocreaformula=i,1===e)this.formula.continuidad="1 de 1",console.log(this.formula),this.formulaService.create(this.formula).subscribe(l=>{this.historialFormulaComponente.buscarRegistro(this.pacienteActual.idPaciente),this.formula.items=[]},l=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar la formula en la base de datos!",footer:l.mensaje})});else{const l=[];this.formula.continuidad="1 de "+e,l.push(this.formula);const c=new Date;for(let f=1;f<e;f++){let v=new wx;const E=new Date(c);E.setDate(c.getDate()+30*f),v.paciente=this.pacienteActual,v.ips=this.formula.ips,v.medico=this.formula.medico,v.nroFormula=this.formula.nroFormula,v.fecPrescribe=E,v.fecSolicitud=null,v.observacion=this.formula.observacion,v.cobroCM=!1,v.valorCM=0,v.cieP=this.formula.cieP,v.cieR1=this.formula.cieR1,v.cieR2=this.formula.cieR2,v.origenurgencia=this.formula.origenurgencia,v.programa=this.formula.programa,v.continuidad=f+1+" de "+e,v.idBodega=o,v.funcionariocreaformula=this.formula.funcionariocreaformula;for(let D=0;D<this.formula.items.length;D++)if(this.posfechados.at(D).value){let k=new WD;k.medicamento=this.formula.items[D].medicamento,k.cantidad=this.formula.items[D].cantidad,k.frecuencia=this.formula.items[D].frecuencia,k.duracion=this.formula.items[D].duracion,k.importe=k.calcularImporte(),v.items.push(k)}v.total=v.calcularGranTotal(),l.push(v)}Br(l).pipe(xh(f=>this.formulaService.create(f)),Bv(()=>{this.historialFormulaComponente.buscarRegistro(this.pacienteActual.idPaciente),this.formula.items=[]})).subscribe(f=>{console.log(f)},f=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar la formula en la base de datos!",footer:f.mensaje})})}}ocultarComentario(){this.comentarioVisible=!1}actualizarComentario(e){const i=e.target.value;this.mensajeErrorDx="",4===i.length?this.formulaService.getDxFormula(i).subscribe(o=>{o?(this.dxValido=!1,this.mensajeComentario=o.nombre,"A"!=o.sexo&&o.sexo!=this.pacienteActual.sexo&&(this.mensajeErrorDx="Error de diagn\xf3stico diligenciado, no corresponde con el sexo del paciente por favor verificar!",this.dxValido=!0)):(this.mensajeComentario="El diagn\xf3stico no se encontr\xf3.",this.dxValido=!0)},o=>{this.mensajeComentario="Error al obtener el diagn\xf3stico."}):(this.mensajeComentario="El c\xf3digo debe tener 4 caracteres.",this.dxValido=!0),this.comentarioVisible=!0}calcularEdad(e){if(null!=e){const r=new Date(e),i=Math.abs(Date.now()-r.getTime());let o=Math.floor(i/864e5/365);if(o)return o.toString()}return"-"}validateItems(){return!this.formula.items.some(r=>0===Number(r.duracion))||(z().fire({icon:"error",title:"Error",text:"La duraci\xf3n de tratamiento del medicamento y/o insumo no puede ser cero (0), por favor corregirlo y continuar."}),!1)}cancelarEdicion(){this.editarContacto=!1}enEdicion(){this.editarContacto=!0}validarCelular(e){return/^[3][0-9]{9}$/.test(e)}validarEmail(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)}guardarDatosContacto(){this.pacienteActual.celularPrincipal=String(this.facturaForm.get("celularPrincipal").value||"").trim(),this.pacienteActual.celularSecundario=String(this.facturaForm.get("celularSecundario").value||"").trim(),this.pacienteActual.direccion=String(this.facturaForm.get("direccion").value||"").trim(),this.pacienteActual.barrio=String(this.facturaForm.get("barrio").value||"").trim(),this.pacienteActual.email=String(this.facturaForm.get("email").value||"").trim().toLowerCase(),!this.pacienteActual.celularPrincipal||this.validarCelular(this.pacienteActual.celularPrincipal)?!this.pacienteActual.email||this.validarEmail(this.pacienteActual.email)?(z().fire({title:"\xbfDesea actualizar?",html:`\n      <p style="margin:2px 0;"><strong>Tel\xe9fono Principal:</strong> ${this.pacienteActual.celularPrincipal}</p>\n      <p style="margin:2px 0;"><strong>Tel\xe9fono Secundario:</strong> ${this.pacienteActual.celularSecundario}</p>\n      <p style="margin:2px 0;"><strong>Direcci\xf3n:</strong> ${this.pacienteActual.direccion}</p>\n      <p style="margin:2px 0;"><strong>Barrio:</strong> ${this.pacienteActual.barrio}</p>\n      <p style="margin:2px 0;"><strong>Correo:</strong> ${this.pacienteActual.email}</p>   \n      `,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Actualizar!"}).then(e=>{e.isConfirmed&&this.pacienteService.update(this.pacienteActual).subscribe({next:r=>{z().fire({icon:"success",title:"Actualizaci\xf3n exitosa",text:`Los datos de contacto del paciente ${this.pacienteActual.pNombre} ${this.pacienteActual.sNombre} ${this.pacienteActual.pApellido} ${this.pacienteActual.sApellido} fueron actualizados correctamente.`})},error:r=>{console.error("\u274c Error actualizando el registro",r),z().fire("Error","No se pudo actualizar el registro.","error")}})}),this.editarContacto=!1):z().fire("Correo inv\xe1lido","Si ingresa un correo electr\xf3nico, debe tener un formato v\xe1lido.","warning"):z().fire("Celular inv\xe1lido","Si ingresa un celular principal, debe tener un formato v\xe1lido.","warning")}static#e=this.\u0275fac=function(r){return new(r||t)(X(pm),X(Dd),X(l0),X(YD),X(qD),X(Ts),X(Ds),X(ea),X(Us),X(bx))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-formula"]],viewQuery:function(r,i){if(1&r&&Ko(KD,5),2&r){let o;Er(o=Sr())&&(i.historialFormulaComponente=o.first)}},decls:156,vars:29,consts:[[1,"card","bg-light"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-5"],[1,"form-group","row"],["for","cliente",1,"col-sm-4","col-form-label"],[1,"col-sm-8"],[1,"input-group"],["type","text","formControlName","paciente","placeholder","Digite el documento",1,"form-control",3,"keyup.enter"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],["class","alert alert-danger mt-2",4,"ngIf"],[1,"form-group","row","align-items-center"],["for","ipsPrescribe",1,"col-sm-4","col-form-label"],[1,"w-100"],["type","text","matInput","","formControlName","ips",3,"matAutocomplete"],["mat-icon-button","","matSuffix","",3,"click"],[3,"displayWith","optionSelected"],["autoips","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["for","medicoPrescribe",1,"col-sm-4","col-form-label"],["type","text","matInput","","formControlName","medico",3,"matAutocomplete"],["automedico","matAutocomplete"],["for","fecPrescribe",1,"col-sm-4","col-form-label"],[1,"col-sm-4"],[1,"diagnosticos-group"],["type","date","formControlName","fecPrescribe",1,"form-control",2,"width","350px",3,"max"],["type","checkbox","formControlName","origenurgencia",1,"form-check-input"],["for","fecSolicitud",1,"col-sm-4","col-form-label"],["type","date","formControlName","fecSolicitud",1,"form-control",2,"width","350px",3,"max","min"],["type","checkbox","formControlName","pgp",1,"form-check-input"],["for","diagnosticos",1,"col-sm-4","col-form-label"],["type","text","formControlName","cieP","placeholder","Dx principal *","maxlength","4",1,"form-control",3,"focus","input","blur"],["type","text","formControlName","cieR1","placeholder","Dx rel 1","maxlength","4",1,"form-control",3,"focus","input","blur"],["type","text","formControlName","cieR2","placeholder","Dx rel 2","maxlength","4",1,"form-control",3,"focus","input","blur"],["type","text","formControlName","cieR3","placeholder","Dx rel 3","maxlength","4",1,"form-control",3,"focus","input","blur"],["for","programa",1,"col-sm-4","col-form-label"],["formControlName","programa",1,"form-select"],["selected","","value",""],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],["value","8"],["value","9"],["value","10"],["value","11"],["value","12"],["value","13"],["value","14"],["value","15"],["value","16"],["value","17"],["value","18"],["value","19"],["value","20"],["value","21"],["for","observacion",1,"col-sm-4","col-form-label"],["formControlName","observacion",1,"form-control"],["class","col-sm-8",4,"ngIf"],[1,"col-md-7"],["class","card","class","col-md-7",4,"ngIf"],["class","card","class","col-md-5",4,"ngIf"],[1,"col-sm-4","col-form-label"],["appearance","fill",1,"w-100"],["type","text","matInput","","formControlName","medicamento",3,"matAutocomplete"],[3,"optionSelected"],["automedicamento","matAutocomplete"],["class","alert alert-info mt-4",4,"ngIf"],["class","table table-striped table-hover table-sm mt-3",4,"ngIf"],["class","float-right mt-3","style","display: flex; align-items: center;",4,"ngIf"],[1,"form-group","row","mt-3"],[1,"col-sm-12"],["type","button","value","Guardar F\xf3rmula",1,"btn","btn-secondary","w-100",3,"disabled","click"],["class","mt-4",4,"ngIf"],[1,"alert","alert-danger","mt-2"],[3,"value"],["class","form-text text-muted",4,"ngIf"],[1,"form-text","text-muted"],["formControlName","cobroCM","labelPosition","before",3,"checked"],["class","float-right mt-3",4,"ngIf"],[1,"float-right","mt-3"],[1,"text-green"],[4,"ngIf","ngIfElse"],["modoEdicion",""],["mat-icon-button","",3,"click"],[1,"contacto-edicion-container"],["type","number","formControlName","celularPrincipal","placeholder","Digite tel\xe9fono principal",1,"form-control"],["type","number","formControlName","celularSecundario","placeholder","Digite tel\xe9fono secundario",1,"form-control"],["type","text","formControlName","direccion","placeholder","Digite direcci\xf3n",1,"form-control"],["type","text","formControlName","barrio","placeholder","Digite barrio",1,"form-control"],["type","text","formControlName","email","placeholder","Digite correo electr\xf3nico",1,"form-control"],[1,"acciones"],["mat-icon-button","","color","primary","matTooltip","Guardar",3,"click"],["mat-icon-button","","color","warn","matTooltip","Cancelar",3,"click"],["class","blink",4,"ngIf"],["class","porta",4,"ngIf"],[1,"blink"],[1,"porta"],[1,"alert","alert-info","mt-4"],[1,"table","table-striped","table-hover","table-sm","mt-3"],[1,"thead-colored"],[4,"ngIf"],[2,"width","180px"],[2,"width","80px"],["formArrayName","posfechados",3,"ngStyle",4,"ngFor","ngForOf"],["formArrayName","posfechados",3,"ngStyle"],[1,"form-select",3,"value","change"],["type","number",1,"form-control","col-sm-4",3,"value","min","change"],["type","number",1,"form-control","col-sm-4",3,"value","disabled","ngStyle","min","change"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],["type","checkbox",1,"form-check-input",3,"formControlName"],[1,"float-right","mt-3",2,"display","flex","align-items","center"],["type","checkbox","formControlName","checkcontinuidad",1,"form-check-input"],["class","form-control","formControlName","cantidadmeses","type","number","placeholder","Ingrese Nro. de meses","style","margin-left: 10px; width: 200px;",4,"ngIf"],["formControlName","cantidadmeses","type","number","placeholder","Ingrese Nro. de meses",1,"form-control",2,"margin-left","10px","width","200px"],[1,"mt-4"],[3,"idPaciente"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"div",1)(2,"form",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),h(7,"Documento *"),u(),d(8,"div",7)(9,"div",8)(10,"input",9),De("keyup.enter",function(){return i.buscarDocumento()}),u(),d(11,"button",10),De("click",function(){return i.buscarDocumento()}),h(12,"Buscar paciente"),u()(),oe(13,pde,2,0,"div",11),u()(),d(14,"div",12)(15,"label",13),h(16,"IPS que prescribe *"),u(),d(17,"div",7)(18,"mat-form-field",14)(19,"mat-label"),h(20,"Buscar IPS"),u(),qe(21,"input",15),d(22,"button",16),De("click",function(){return i.openDialogIps()}),d(23,"mat-icon"),h(24,"add_circle"),u()(),d(25,"mat-autocomplete",17,18),De("optionSelected",function(a){return i.onOptionSelectedIps(a.option.value)}),oe(27,mde,2,2,"mat-option",19),u()()()(),d(28,"div",12)(29,"label",20),h(30,"M\xe9dico prescribe *"),u(),d(31,"div",7)(32,"mat-form-field",14)(33,"mat-label"),h(34,"Buscar m\xe9dico"),u(),qe(35,"input",21),d(36,"button",16),De("click",function(){return i.openDialogMedico()}),d(37,"mat-icon"),h(38,"add_circle"),u()(),d(39,"mat-autocomplete",17,22),De("optionSelected",function(a){return i.onOptionSelectedMedico(a.option.value)}),oe(41,gde,2,3,"mat-option",19),u()(),oe(42,_de,2,0,"div",11),u()(),d(43,"div",5)(44,"label",23),h(45,"Fecha de prescripci\xf3n *"),u(),d(46,"div",24)(47,"div",25),qe(48,"input",26),u(),oe(49,vde,2,0,"div",11),u(),qe(50,"input",27),h(51," \xbfFue por urgencia? "),u(),d(52,"div",5)(53,"label",28),h(54,"Fecha de entrega *"),u(),d(55,"div",24)(56,"div",25),qe(57,"input",29),u(),oe(58,bde,2,0,"div",11),u(),qe(59,"input",30),h(60," \xbfEs PGP? "),u(),d(61,"div",5)(62,"label",31),h(63,"Diagn\xf3sticos *"),u(),d(64,"div",7)(65,"div",25)(66,"input",32),De("focus",function(a){return i.actualizarComentario(a)})("input",function(a){return i.convertirAMayusculasCieP(a)})("blur",function(){return i.ocultarComentario()})("input",function(a){return i.actualizarComentario(a)}),u(),d(67,"input",33),De("focus",function(a){return i.actualizarComentario(a)})("input",function(a){return i.convertirAMayusculasCieR1(a)})("blur",function(){return i.ocultarComentario()})("input",function(a){return i.actualizarComentario(a)}),u(),d(68,"input",34),De("focus",function(a){return i.actualizarComentario(a)})("input",function(a){return i.convertirAMayusculasCieR2(a)})("blur",function(){return i.ocultarComentario()})("input",function(a){return i.actualizarComentario(a)}),u(),d(69,"input",35),De("focus",function(a){return i.actualizarComentario(a)})("input",function(a){return i.convertirAMayusculasCieR3(a)})("blur",function(){return i.ocultarComentario()})("input",function(a){return i.actualizarComentario(a)}),u()(),oe(70,yde,2,0,"div",11),oe(71,xde,2,1,"div",11),oe(72,Ede,2,1,"div",11),u()(),d(73,"div",5)(74,"label",36),h(75,"Programa *"),u(),d(76,"div",7)(77,"div",25)(78,"select",37)(79,"option",38),h(80,"Seleccionar el programa"),u(),d(81,"option",39),h(82,"Mayores de 70 a\xf1os no incluidos en cohortes"),u(),d(83,"option",40),h(84,"Menores de 70 a\xf1os no incluidos en cohortes"),u(),d(85,"option",41),h(86,"Hipertensi\xf3n arterial"),u(),d(87,"option",42),h(88,"Diabetes Mellitu"),u(),d(89,"option",43),h(90,"Cardiopatias y Enfermedades Cerebrovasculares"),u(),d(91,"option",44),h(92,"Terapia de remplazo renal"),u(),d(93,"option",45),h(94,"Artritis y otras autoinmunes"),u(),d(95,"option",46),h(96,"Epoc"),u(),d(97,"option",47),h(98,"Asma"),u(),d(99,"option",48),h(100,"Vih"),u(),d(101,"option",49),h(102,"TBC o Hepatitis C"),u(),d(103,"option",50),h(104,"Enfermedad neurologica"),u(),d(105,"option",51),h(106,"Salud Mental"),u(),d(107,"option",52),h(108,"Hemofilia"),u(),d(109,"option",53),h(110,"Discapacitados"),u(),d(111,"option",54),h(112,"Enfermedad Huerfana"),u(),d(113,"option",55),h(114,"Trasplantes"),u(),d(115,"option",56),h(116,"Desnutrici\xf3n"),u(),d(117,"option",57),h(118,"Gestantes"),u(),d(119,"option",58),h(120,"Hipertensi\xf3n y Diabete"),u(),d(121,"option",59),h(122,"Ni\xf1os menores de 5 a\xf1os"),u()()(),oe(123,Sde,2,0,"div",11),u()(),d(124,"div",5)(125,"label",60),h(126,"Observaci\xf3n"),u(),d(127,"div",7),qe(128,"textarea",61),u()(),d(129,"div",5)(130,"label",60),h(131,"Cuota Moderadora"),u(),oe(132,Ade,5,2,"div",62),u()(),d(133,"div",63)(134,"div",3),oe(135,kde,20,9,"div",64),oe(136,Pde,11,5,"div",65),u(),d(137,"div",12)(138,"label",66),h(139,"Agregar lista de medicamentos "),u(),d(140,"div",7)(141,"mat-form-field",67)(142,"mat-label"),h(143,"Buscar medicamento a agregar "),u(),qe(144,"input",68),d(145,"mat-autocomplete",69,70),De("optionSelected",function(a){return i.seleccionarMedicamento(a)}),oe(147,Ode,2,2,"mat-option",19),u()(),oe(148,Nde,2,0,"div",11),u()(),oe(149,Rde,2,0,"div",71),oe(150,zde,18,2,"table",72),oe(151,Wde,4,1,"h6",73),d(152,"div",74)(153,"div",75)(154,"input",76),De("click",function(){return i.create()}),u()()()()()(),oe(155,qde,2,1,"div",77),u()()),2&r){const o=go(26),a=go(40),s=go(146);let l,c,f,v,E,D,k;w(2),N("formGroup",i.facturaForm),w(11),N("ngIf",(null==(l=i.facturaForm.get("paciente"))?null:l.invalid)&&(null==(l=i.facturaForm.get("paciente"))?null:l.touched)),w(8),N("matAutocomplete",o),w(4),N("displayWith",i.displayIps),w(2),N("ngForOf",i.ipsFiltrados),w(8),N("matAutocomplete",a),w(4),N("displayWith",i.displayMedico),w(2),N("ngForOf",i.medicosFiltrados),w(1),N("ngIf",(null==(c=i.facturaForm.get("medico"))?null:c.invalid)&&(null==(c=i.facturaForm.get("medico"))?null:c.touched)),w(6),N("max",i.hoy),w(1),N("ngIf",(null==(f=i.facturaForm.get("fecPrescribe"))?null:f.invalid)&&(null==(f=i.facturaForm.get("fecPrescribe"))?null:f.touched)),w(8),N("max",i.hoy)("min",i.minimohoy),w(1),N("ngIf",(null==(v=i.facturaForm.get("fecSolicitud"))?null:v.invalid)&&(null==(v=i.facturaForm.get("fecSolicitud"))?null:v.touched)),w(12),N("ngIf",(null==(E=i.facturaForm.get("cieP"))?null:E.invalid)&&(null==(E=i.facturaForm.get("cieP"))?null:E.touched)),w(1),N("ngIf",i.comentarioVisible),w(1),N("ngIf",i.comentarioVisible),w(51),N("ngIf",(null==(D=i.facturaForm.get("programa"))?null:D.invalid)&&(null==(D=i.facturaForm.get("programa"))?null:D.touched)),w(9),N("ngIf",i.mostrarComponente),w(3),N("ngIf",i.mostrarComponente),w(1),N("ngIf",i.mostrarComponente),w(8),N("matAutocomplete",s),w(3),N("ngForOf",i.medicamentosFiltrados),w(1),N("ngIf",null==(k=i.facturaForm.get("autocompleteControl"))?null:k.invalid),w(1),N("ngIf",0==i.formula.items.length),w(1),N("ngIf",i.formula.items.length>0),w(1),N("ngIf",i.formula.items.length>0),w(3),N("disabled",!i.facturaForm.valid),w(1),N("ngIf",i.mostrarComponente)}},dependencies:[ho,Fi,Jo,mm,Wo,Vs,cl,ul,vo,wd,sl,Ss,No,zo,Gy,bo,Ro,qy,c0,_m,hm,b_,gm,V6,u0,eA,KD,Ey,Sc],styles:[".card-body[_ngcontent-%COMP%]{padding:10px}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;font-size:14px;line-height:1.2}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}.card[_ngcontent-%COMP%]{margin:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;font-weight:700;padding:10px;border-radius:8px 8px 0 0}.form-group[_ngcontent-%COMP%]{margin-bottom:2px}.form-group.row[_ngcontent-%COMP%]{display:flex;align-items:center}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}.form-control[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{border-radius:5px}.alert[_ngcontent-%COMP%]{border-radius:5px;margin-top:5px}.float-right[_ngcontent-%COMP%]{margin-top:5px;font-weight:700}@media (max-width: 768px){.form-group[_ngcontent-%COMP%]{flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:5px}}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]{padding:0 2px}.mat-option[_ngcontent-%COMP%]{font-size:12px;line-height:1;padding:2px 12px;transition:background-color .2s}.mat-option[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.mat-autocomplete-panel[_ngcontent-%COMP%]{border-radius:4px;box-shadow:0 4px 8px #0000001a;max-height:300px;overflow-y:auto}.mat-input-element[_ngcontent-%COMP%]{padding:5px 10px}.input-container[_ngcontent-%COMP%]{margin-bottom:2px}@media (max-width: 768px){.mat-input-element[_ngcontent-%COMP%]{padding:5px 10px}.mat-option[_ngcontent-%COMP%]{font-size:13px;padding:5px 12px}}.diagnosticos-group[_ngcontent-%COMP%]{display:flex;gap:7px}.diagnosticos-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1;margin-bottom:0}.input-group[_ngcontent-%COMP%]{display:flex;align-items:center}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1;margin-right:10px}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex-shrink:0}.alert[_ngcontent-%COMP%]{margin-top:10px}.text-green[_ngcontent-%COMP%]{color:green}.thead-colored[_ngcontent-%COMP%]{background-color:#5d8ea4;color:#fff}.blink[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_glowing 1.5s ease-in-out infinite;background-color:#ff4d4d;border-radius:15px;padding:10px;color:#fff;box-shadow:0 0 5px #fff,0 0 10px #fff,0 0 15px #39548b,0 0 20px #39548b}.porta[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_glowing 1.5s ease-in-out infinite;background-color:#39548b;border-radius:15px;padding:10px;color:#fff;box-shadow:0 0 5px #fff,0 0 10px #fff,0 0 15px #39548b,0 0 20px #39548b}@keyframes _ngcontent-%COMP%_glowing{0%,to{box-shadow:0 0 5px #fff,0 0 10px #fff,0 0 15px #39548b,0 0 20px #f37053}50%{box-shadow:0 0 10px #fff,0 0 20px #fff,0 0 30px #39548b,0 0 40px #ec2828}}.contacto-edicion-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5px;max-width:300px}.acciones[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:0px}"]})}return t})();function Gde(t,n){1&t&&(d(0,"div",12),h(1," No hay medicamentos asociados a esta formula para mostrar! "),u())}const Yde=function(){return{color:"#009A94"}};function Xde(t,n){1&t&&(d(0,"mat-icon",26),h(1,"check_circle_outline"),u()),2&t&&N("ngStyle",Nt(1,Yde))}const X6=function(){return{color:"red"}};function Kde(t,n){1&t&&(d(0,"mat-icon",27),h(1,"remove_circle_outline"),u()),2&t&&(ae(),N("matMenuTriggerFor",go(17))("ngStyle",Nt(2,X6)))}const K6=function(){return{color:"orange"}};function Zde(t,n){1&t&&(d(0,"mat-icon",27),h(1,"remove_circle_outline"),u()),2&t&&(ae(),N("matMenuTriggerFor",go(17))("ngStyle",Nt(2,K6)))}function Qde(t,n){if(1&t){const e=Fn();d(0,"button",22),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).subsanarPendiente(i))}),d(1,"mat-icon",23),h(2,"remove_circle_outline"),u(),d(3,"span"),h(4,"Cancelacion Administrativa"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,K6)))}const Jde=function(t){return{color:t}};function efe(t,n){if(1&t){const e=Fn();d(0,"tr",23)(1,"td",18),h(2),u(),d(3,"td"),h(4),Hi(5,"date"),u(),d(6,"td"),h(7),u(),d(8,"td"),h(9),u(),d(10,"td"),h(11),u(),d(12,"td"),h(13),Hi(14,"uppercase"),u(),d(15,"td")(16,"mat-icon",28),De("click",function(){const o=ht(e).$implicit,a=ae().$implicit;return pt(ae(2).eliminarRegistroEntrega(o,a.medicamento.idMedicamento))}),h(17,"clear"),u()()()}if(2&t){const e=n.$implicit,r=ae(3);N("ngStyle",Si(14,Jde,e.estado?"black":"red")),w(2),_e(e.cantidadEntregada||0),w(2),_e(Xo(5,9,e.fecEntrega,"dd/MM/YYYY : hh:mm")),w(3),_e(e.medioEntrega||""),w(2),_e(r.primerasmayusculas(e.bodega.puntoEntrega)||""),w(2),_e(r.primerasmayusculas(e.funcionarioEntrega)||""),w(2),fo("",_h(14,12,e.tipoRecibe)," ",e.documentoRecibe,""),w(3),N("ngStyle",Nt(16,X6))}}const tfe=function(){return{color:"#2BB6D7"}};function nfe(t,n){if(1&t){const e=Fn();xc(0),d(1,"tr")(2,"td",17),h(3),u(),d(4,"td",17),h(5),u(),d(6,"td",17),h(7),u(),d(8,"td",18),h(9),u(),d(10,"td",18),h(11),u(),d(12,"td",18),oe(13,Xde,2,2,"mat-icon",19),oe(14,Kde,2,3,"mat-icon",20),oe(15,Zde,2,3,"mat-icon",20),d(16,"mat-menu",null,21)(18,"button",22),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).entregarPendiente(o))}),d(19,"mat-icon",23),h(20,"playlist_add_check"),u(),d(21,"span"),h(22,"Entregar pendiente"),u()(),oe(23,Qde,5,2,"button",24),u()()(),oe(24,efe,18,17,"tr",25),Cc()}if(2&t){const e=n.$implicit,r=ae(2);w(2),kr("rowspan",e.itemsEntrega.length+1),w(1),_e(e.medicamento.idMedicamento),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),_e(e.medicamento.nombre),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),_e(e.medicamento.forma.nombre),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),_e(e.cantidad),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),Qt("",r.calcularPendiente(e)," "),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),N("ngIf",e.cantidad==e.totalEntregado),w(1),N("ngIf",e.cantidad!=e.totalEntregado&&0==e.totalEntregado),w(1),N("ngIf",e.cantidad!=e.totalEntregado&&e.totalEntregado>0),w(4),N("ngStyle",Nt(17,tfe)),w(4),N("ngIf",r.tieneAcceso(2)),w(1),N("ngForOf",e.itemsEntrega)}}const rfe=function(){return{color:"green"}};function ife(t,n){if(1&t&&(d(0,"div")(1,"table",13)(2,"thead",14)(3,"tr")(4,"th"),h(5,"ID"),u(),d(6,"th"),h(7,"Medicamento"),u(),d(8,"th"),h(9,"Presentaci\xf3n"),u(),d(10,"th"),h(11,"Cant. presc"),u(),d(12,"th"),h(13,"Pendientes"),u(),d(14,"th"),h(15,"Estado"),u(),d(16,"th"),h(17,"Entregados"),u(),d(18,"th"),h(19,"Fec entrega"),u(),d(20,"th"),h(21,"Med entrega"),u(),d(22,"th"),h(23,"Dispensario"),u(),d(24,"th"),h(25,"Quien entrega"),u(),d(26,"th"),h(27,"Quien recibe"),u(),d(28,"th")(29,"mat-icon",15),h(30,"account_circle"),u()()()(),d(31,"tbody"),oe(32,nfe,25,18,"ng-container",16),u()()()),2&t){const e=ae();w(29),N("ngStyle",Nt(2,rfe)),w(3),N("ngForOf",e.listaItemsFormula)}}const ofe=function(t){return["/menu/editformula",t]};function afe(t,n){if(1&t&&(xc(0),d(1,"button",29)(2,"mat-icon",9),h(3,"edit"),u(),h(4," Editar f\xf3rmula "),u(),Cc()),2&t){const e=ae();w(1),N("routerLink",Si(1,ofe,e.listaregistros.idFormula))}}function sfe(t,n){if(1&t){const e=Fn();xc(0),d(1,"button",30),De("click",function(){return ht(e),pt(ae().imprimirTirilla())}),d(2,"mat-icon",9),h(3,"receipt_long"),u(),h(4," Pre Factura "),u(),Cc()}}const lfe=function(){return["/menu/formula"]};let cfe=(()=>{class t{constructor(e,r,i,o,a){this.servicio=e,this.medicamentoService=r,this.servicioformula=i,this.serviciobodega=o,this.activatedRoute=a,this.listaregistros={},this.formulaRecibida=NaN,this.existencias={},this.enProceso=!1}ngOnInit(){this.parametro=this.formulaRecibida,this.activatedRoute.paramMap.subscribe(e=>{this.parametro=e.get("id"),this.parametro&&this.buscarRegistro(this.parametro)}),this.formulaRecibida&&(this.buscarRegistro(this.formulaRecibida),this.parametro=this.formulaRecibida),this.hoy=(new Date).toISOString().split("T")[0]}ngOnChanges(e){e.datoRecibido&&!e.datoRecibido.isFirstChange()&&this.buscarRegistro(this.formulaRecibida)}buscarRegistro(e){this.servicioformula.getFormulaId(e).subscribe(r=>{this.listaregistros=r,this.listaItemsFormula=r.items,console.log(r.items)})}entregarPendiente(e){var r=this;return(0,hi.Z)(function*(){if(!r.enProceso)try{let i=sessionStorage.getItem("bodega"),o=parseInt(null!==i?i:"0",10),a=sessionStorage.getItem("nombre");const s=yield r.existenciaAcutal(e.medicamento.idMedicamento,o);z().fire({title:"Entrega de pendiente",html:`  \n        <div class="swal-container">           \n    <div>${e.medicamento.nombre}<br><br>Cantidad en bodega: ${s}</div>\n    <input id="cantidadentregada" type="number" placeholder="Ingrese cantidad a entregar" class="form-control mb-1" />\n    <div class="form-group">      \n      <select id="selectMedio" class="form-select">\n        <option value="-1">Seleccione el medio de entrega</option>\n        <option value="Presencial">Presencial</option>\n        <option value="Domicilio">Domicilio</option>                         \n      </select>   \n    </div>  \n    <label for="entrega">Fecha de entrega</label>\n    <input id="fechaentrega" type="date" class="form-control mb-1" max="${r.hoy}">\n    <input id="checkRecibe" class="form-check-input" style="margin-right: 5px" type="checkbox" /> Recibe el mismo paciente\n    <input id="tipoRecibe" type="text" placeholder="Tipo" class="form-control mb-1" />\n    <input id="documentoRecibe" type="text" placeholder="Documento" class="form-control mb-1" />\n  </div>  \n        `,showCancelButton:!0,confirmButtonText:"Entregar",cancelButtonText:"Cancelar"}).then(function(){var l=(0,hi.Z)(function*(c){if(c.isConfirmed){const v=document.getElementById("selectMedio").value,D=document.getElementById("fechaentrega").value;if("-1"!==v&&""!==D){let k=document.getElementById("cantidadentregada");const T=parseInt(k.value);if(T>e.cantidad-e.totalEntregado)z().fire("Verificar!","Ingresaste una mayor cantidad de medicamentos para entregar, que la cantidad que tiene el paciente, como pendiente","error");else if(s>=T)if(T>0)if(a&&i){const Z=document.getElementById("tipoRecibe").value,Ee=document.getElementById("documentoRecibe").value;""!==Z&&""!==Ee?(r.enProceso=!0,r.servicioformula.saveItemEntregaFormula(e.idItem,o,a,v,T,Z,Ee,D,r.listaregistros.idBodega).subscribe({next:Le=>{r.enProceso=!1,z().fire("Correcto!",`Ingresado y descargado correctamente el medicamento pendiente ${e.medicamento.nombre}`,"success"),r.buscarRegistro(r.parametro)},error:Le=>{r.enProceso=!1,console.error("Error al guardar la entrega",Le)}})):z().fire({icon:"error",title:"Quien recibe!",text:"No ha diligenciado los datos de quien recibe el medicamento pendiente prescrito en la formula n\xfamero "+e.idFormula+" recuerde debe ser un mayor de edad"})}else z().fire({icon:"error",title:"Verificar",text:"Usuario no esta  logueado para realizar la dispensaci\xf3n de medicamentos, por favor inicie sesi\xf3n!"});else z().fire({icon:"error",title:"Verificar",text:"La cantidad del pendiente a entregar no es valida!"});else z().fire("Verificar!","La cantidad existente en la bodega es menor que la cantidad que est\xe1s intentando entregar al paciente","error")}else z().fire("Falta!",`No has seleccionado el medio de entrega y/o la fecha de entrega, para descargar el pendiente del medicamento ${e.medicamento.nombre}`,"warning")}});return function(c){return l.apply(this,arguments)}}()),document.getElementById("checkRecibe")?.addEventListener("change",l=>r.onRecibeChange(l,e))}catch(i){console.error("Error obteniendo la existencia actual:",i)}})()}onRecibeChange(e,r){const i=e.target.checked,o=document.getElementById("tipoRecibe"),a=document.getElementById("documentoRecibe");i?this.CalcularEdad(this.listaregistros.paciente.fecNacimiento)>17?(o.value=this.listaregistros.paciente.tipoDoc,a.value=this.listaregistros.paciente.numDocumento):(o.value="",a.value="",z().fire({icon:"error",title:"Edad no permitida!",text:"El paciente no tiene la edad para recibir los medicamentos de la formula n\xfamero "+r.idFormula+" por favor agregue los datos del tutor responsable"})):(o.value="",a.value="")}CalcularEdad(e){if(null!=e){const r=new Date(e),i=Math.abs(Date.now()-r.getTime());let o=Math.floor(i/864e5/365);if(o)return o}return 0}subsanarPendiente(e){var r=this;return(0,hi.Z)(function*(){try{r.hoy=(new Date).toISOString().split("T")[0];let i=r.listaregistros.idBodega,o=sessionStorage.getItem("nombre");const a=yield r.existenciaAcutal(e.medicamento.idMedicamento,i);z().fire({title:"Cancelaci\xf3n administrativa",html:`  \n        <div class="swal-container">           \n        <div >${e.medicamento.nombre}<br>Cantidad en bodega: ${a}</div><br>\n         <label for="entrega">Cantidad pendiente: ${e.cantidad-e.totalEntregado} </label>\n        <div class="form-group">      \n        <select id="selectMedio" class="form-select">\n          <option value="-1">Seleccione motivo de la cancelacion de la entrega</option>\n          <option value="Ajuste por presentaci\xf3n">Ajuste por presentaci\xf3n</option>   \n          <option value="Agotado">Agotado</option>   \n          <option value="Desabastecido">Desabastecido</option> \n          <option value="Usuario no adherente al tratamiento">Usuario no adherente al tratamiento</option>\n          <option value="Usuario Fallecido">Usuario Fallecido</option>\n          <option value="Usuario Inactivo">Usuario Inactivo</option>                          \n        </select>   \n         </div>         \n          </div>  \n        `,showCancelButton:!0,confirmButtonText:"Subsanar",cancelButtonText:"Cancelar"}).then(function(){var s=(0,hi.Z)(function*(l){if(l.isConfirmed){const f=document.getElementById("selectMedio").value;"-1"!=f?o?r.servicioformula.subsanacionItemEntregaFormula(e.idItem,i,o,f,e.cantidad-e.totalEntregado).subscribe({next:E=>{z().fire("Correcto!",`Ingresado y notificado correctamente por ${f},  el medicamento pendiente ${e.medicamento.nombre}`,"success"),r.buscarRegistro(r.parametro)},error:E=>{console.error("Error al guardar la entrega",E)}}):z().fire({icon:"error",title:"Verificar",text:"Usuario no esta  logueado para realizar la dispensaci\xf3n de medicamentos, por favor inicie sesi\xf3n!"}):z().fire("Falta!",`No has seleccionado el motivo por el que se cancelara la entrega el pendiente del medicamento ${e.medicamento.nombre}`,"warning")}});return function(l){return s.apply(this,arguments)}}())}catch(i){console.error("Error obteniendo la existencia actual:",i)}})()}existenciaAcutal(e,r){return new Promise((i,o)=>{this.medicamentoService.getMedicamentoBodega(e,r).subscribe(a=>{const s=a&&a.cantidad?a.cantidad:0;this.existencias[e]=s,i(s)},a=>{console.error("Error fetching existencia:",a),o(a)})})}calcularPendiente(e){return e.cantidad-e.totalEntregado}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}calcularEdad(e){if(null!=e){const r=new Date(e),i=Math.abs(Date.now()-r.getTime());let o=Math.floor(i/864e5/365);if(o)return o.toString()}return"-"}imprimir(e){var r=this;return(0,hi.Z)(function*(){const i=1===e?yield r.generarContenidoPOSPendiente(r.listaregistros):yield r.generarContenidoPOSEntrega(r.listaregistros),o=document.createElement("iframe");o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.border="none",document.body.appendChild(o);const a=o.contentWindow?.document;a&&(a.open(),a.write(`\n      <html>\n      <head>\n        <style>\n          @media print {\n            body {\n              font-family: 'Courier New', Courier, monospace;\n              font-size: 20px;\n              font-weight: bold;\n              margin: 2mm;\n              padding: 0;\n            }\n            pre {\n              font-size: 20px;\n              line-height: 1.5;\n              margin: 2mm;\n              padding: 0;\n            }\n          }\n        </style>\n      </head>\n      <body onload="window.print(); window.onafterprint = function() { window.close(); }">\n        ${i}\n      </body>\n      </html>\n    `),a.close()),setTimeout(()=>{document.body.removeChild(o)},3e3)})()}generarContenidoPOSPendiente(e){var r=this;return(0,hi.Z)(function*(){const i=yield r.serviciobodega.getRegistroId(e.idBodega).toPromise(),o=new Date(e.fecSolicitud),a=new Intl.DateTimeFormat("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).format(o),s=new Date,l=new Intl.DateTimeFormat("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).format(s);return`\n    <pre style="font-family: Courier, monospace; font-size: 20px; font-weight: bold;">\n     FORMATO DE PENDIENTES  \n      SISM - SUPLYMEDICAL\n${i?.direccion}\nNro: ${e.idFormula}\nImpresi\xf3n: ${l}\n\n-------------------------------------\nDocumento:${e.paciente.numDocumento}  \nPaciente: ${e.paciente.pNombre} ${e.paciente.sNombre}\n          ${e.paciente.pApellido} ${e.paciente.sApellido}\n-------------------------------------\nDispensario:${i?.puntoEntrega}\nFuncionario:${e.funcionariocreaformula}\nPendiente:${a}\nConvenio: ${e.paciente.eps.nombre}\n-------------------------------------\n\n  Detalle de los medicamentos\n-------------------------------------\n${e.items.filter(c=>c.pendiente>0).map((c,f)=>`${r.dividirEnLineas(`${f+1}. ${c.medicamento.nombre}`,35).join("\n")}\n    Presentaci\xf3n:  ${c.medicamento.forma.nombre}\n    Pendiente.  :  ${c.pendiente}`).join("\n")}\n-------------------------------------\n\n\n       \nFirma    :___________________________\nDocumento:___________________________\n\n\nEste documento es v\xe1lido hasta \n90 d\xedas, para hacer su reclamo.\n\nSi quieres saber si tu pendiente \nya esta disponible, contactanos\natrav\xe9s de WhatsApp ${i?.telefono} \n\n</pre>\n  `})()}dividirEnLineas(e,r){const i=e.split(" ");let o="";const a=[];return i.forEach(s=>{(o+s).length>r?(a.push(o.trim()),o=s+" "):o+=s+" "}),o.trim().length>0&&a.push(o.trim()),a}generarContenidoPOSEntrega(e){var r=this;return(0,hi.Z)(function*(){const i=yield r.serviciobodega.getRegistroId(e.idBodega).toPromise(),o=new Date(e.fecSolicitud),a=new Intl.DateTimeFormat("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).format(o),s=new Date,l=new Intl.DateTimeFormat("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).format(s);return`\n    <pre style="font-family: Courier, monospace; font-size: 20px; font-weight: bold;">\n      FORMATO DE ENTREGA\n      SISM - SUPLYMEDICAL\n${i?.direccion}\nNro: ${e.idFormula}\nImpresi\xf3n: ${l}\n\n-------------------------------------\nDocumento:${e.paciente.numDocumento}  \nPaciente: ${e.paciente.pNombre} ${e.paciente.sNombre}\n          ${e.paciente.pApellido} ${e.paciente.sApellido}\n-------------------------------------\nDispensario:${i?.puntoEntrega}\nFuncionario:${e.funcionariocreaformula}\nEntrega: ${a}\nConvenio:${e.paciente.eps.nombre}\n-------------------------------------\n\n  Detalle de los medicamentos\n-------------------------------------\n${e.items.filter(c=>c.totalEntregado>0).map((c,f)=>`${r.dividirEnLineas(`${f+1}. ${c.medicamento.nombre}`,35).join("\n")}\n    Presentaci\xf3n:  ${c.medicamento.forma.nombre}\n    Entregados.  : ${c.totalEntregado}`).join("\n")}\n-------------------------------------\n\n\n       \nFirma    :___________________________\nDocumento:___________________________\n\n\n\nDonar medicamentos,puede hacer la \ndiferencia en la vida de alguien. \nRecuerde! no los deje vencer. \n\n</pre>\n\n  `})()}imprimirTirilla(){var e=this;return(0,hi.Z)(function*(){const r=yield e.generarContenidoPOSTirilla(e.listaregistros),i=document.createElement("iframe");i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.border="none",document.body.appendChild(i);const o=i.contentWindow?.document;o&&(o.open(),o.write(`\n    <html>\n    <head>\n      <style>\n        @media print {\n          body {\n            font-family: 'Courier New', Courier, monospace;\n            font-size: 20px;\n            font-weight: bold;\n            margin: 2mm;\n            padding: 0;\n          }\n          pre {\n            font-size: 20px;\n            line-height: 1.5;\n            margin: 2mm;\n            padding: 0;\n          }\n        }\n      </style>\n    </head>\n    <body onload="window.print(); window.onafterprint = function() { window.close(); }">\n      ${r}\n    </body>\n    </html>\n  `),o.close()),setTimeout(()=>{document.body.removeChild(i)},3e3)})()}generarContenidoPOSTirilla(e){var r=this;return(0,hi.Z)(function*(){const i=yield r.serviciobodega.getRegistroId(e.idBodega).toPromise(),o=new Date(e.fecSolicitud),a=new Intl.DateTimeFormat("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).format(o),s=new Date,c=(new Intl.DateTimeFormat("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).format(s),r.generarTextoEntrega(e));return`\n    <pre style="font-family: Courier, monospace; font-size: 20px; font-weight: bold;">\n  FORMATO DE PREFACTURA SISM\n       Nit 900018045-5      \n${i?.direccion}\nNro: ${e.idFormula}\nFecha: ${a}\n-------------------------------------\nDocumento:${e.paciente.numDocumento}  \nPaciente: ${e.paciente.pNombre} ${e.paciente.sNombre}\n          ${e.paciente.pApellido} ${e.paciente.sApellido}\n-------------------------------------\nDispensario:${i?.puntoEntrega}\nFuncionario:${e.funcionariocreaformula}\nConvenio:${e.paciente.eps.nombre}\n-------------------------------------\nDetalle de (los) medicamento(s)\nCantidad Valor Uni. Valor Total  \n-------------------------------------\n${c}\n-------------------------------------\n\nFirma    :___________________________\nDocumento:___________________________\n\n</pre>\n  `})()}generarTextoEntrega(e){let r=0;return`${e.items.filter(a=>a.totalEntregado>0).map(a=>{const s=a.importe/a.cantidad,l=s*a.totalEntregado;r+=l;const c=this.dividirEnLineas(`${a.medicamento.nombre}`,35),f=s.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:2}),v=l.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:2}),E=a.totalEntregado.toString().padStart(3," "),D=f.padStart(12," "),k=v.padStart(15," ");return`${c.join("")}\n${E} ${D} ${k}`}).join("\n\n")}\n\n     TOTAL: ${r.toLocaleString("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:2})}`}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}eliminarRegistroEntrega(e,r){this.tieneAcceso(2)?z().fire({title:"Desea eliminar?",text:"Esta seguro de quitar el item de la entrega de este medicamento, se devolvera a su inventario la cantidad si habia sido entregado efectiva y quedara como pendiente por entregar!",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(i=>{i.isConfirmed&&this.servicioformula.deleteItemFormulaEntrega(e.idItemEntrega,r).subscribe(o=>{z().fire({icon:"success",title:"Ok",text:"El registro de la entrega se ha quitado en la base de datos correctamente!, y le fue devuelta a su inventario si era una entrega efectiva."}),this.buscarRegistro(this.parametro)},o=>{z().fire({icon:"error",title:"Error",text:o.mensaje})})}):z().fire({icon:"warning",title:"Falta de permisos",text:"No tienes permisos para realizar la modificaci\xf3n en la entrega de medicamentos, comunicate con el funcionario encargado!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(pm),X(l0),X(Dd),X(Ts),X(Us))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-entregas"]],inputs:{formulaRecibida:"formulaRecibida"},features:[gn],decls:108,vars:41,consts:[[1,"container"],[1,"card-body"],[1,"row"],[1,"col-md-6"],[1,"card-header"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[1,"d-flex","justify-content-end","flex-wrap","gap-2"],["mat-stroked-button","","color","primary",3,"routerLink"],[1,"me-1"],["mat-stroked-button","","color","warn",3,"click"],["mat-stroked-button","",1,"btn-success",3,"click"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],["title","Proceso con permisos",3,"ngStyle"],[4,"ngFor","ngForOf"],[1,"centercelda"],[1,"centered"],["title","Entrega completa",3,"ngStyle",4,"ngIf"],["class","pointer-cursor","title","Gestionar Pendiente",3,"matMenuTriggerFor","ngStyle",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click"],[3,"ngStyle"],["mat-menu-item","",3,"click",4,"ngIf"],[3,"ngStyle",4,"ngFor","ngForOf"],["title","Entrega completa",3,"ngStyle"],["title","Gestionar Pendiente",1,"pointer-cursor",3,"matMenuTriggerFor","ngStyle"],["title","Eliminar la entrega",1,"pointer-cursor",3,"ngStyle","click"],["mat-stroked-button","","color","accent",3,"routerLink"],["mat-stroked-button","","color","primary",3,"click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),h(5," Datos del paciente "),u(),d(6,"div",1)(7,"p")(8,"strong"),h(9,"Nombre:"),u(),h(10),d(11,"strong"),h(12," Documento:"),u(),h(13),u(),d(14,"p")(15,"strong"),h(16,"Sexo:"),u(),h(17),d(18,"strong"),h(19," - Edad:"),u(),h(20),u(),d(21,"p")(22,"strong"),h(23,"Eps:"),u(),h(24),d(25,"strong"),h(26,"Regimen:"),u(),h(27),d(28,"strong"),h(29,"Categoria:"),u(),h(30),u(),d(31,"p")(32,"strong"),h(33,"Direcci\xf3n:"),u(),h(34),u(),d(35,"p")(36,"strong"),h(37,"Tel\xe9fono:"),u(),h(38),d(39,"strong"),h(40,"Municipio:"),u(),h(41),u(),d(42,"p")(43,"strong"),h(44,"\xbfPGP?:"),u(),h(45),d(46,"strong"),h(47,"\xbfServicio de Origen?:"),u(),h(48),u()()(),d(49,"div",3)(50,"div",4),h(51," Datos de la formula Nro. "),d(52,"strong"),h(53),u()(),d(54,"div",1)(55,"p")(56,"strong"),h(57,"IPS que prescribe:"),u(),h(58),u(),d(59,"p")(60,"strong"),h(61,"Medico que prescribe:"),u(),h(62),u(),d(63,"p")(64,"strong"),h(65,"Fecha de prescripci\xf3n:"),u(),h(66),Hi(67,"date"),d(68,"strong"),h(69,"Fecha y hora de solicitud:"),u(),h(70),Hi(71,"date"),u(),d(72,"p")(73,"strong"),h(74,"Continuidad:"),u(),h(75),d(76,"strong"),h(77,"Programa:"),u(),h(78),u(),d(79,"p")(80,"strong"),h(81,"Diagnostico:"),u(),h(82),d(83,"strong"),h(84,"Funcionario crea formula: "),u(),h(85),u(),d(86,"p")(87,"strong"),h(88,"Observaci\xf3n de la formula:"),u(),h(89),u()()()()(),oe(90,Gde,2,0,"div",5),oe(91,ife,33,3,"div",6),qe(92,"hr"),d(93,"div",7)(94,"button",8)(95,"mat-icon",9),h(96,"arrow_back"),u(),h(97," Regresar "),u(),oe(98,afe,5,3,"ng-container",6),d(99,"button",10),De("click",function(){return i.imprimir(1)}),d(100,"mat-icon",9),h(101,"receipt_long"),u(),h(102," Imprimir pendiente "),u(),d(103,"button",11),De("click",function(){return i.imprimir(0)}),d(104,"mat-icon",9),h(105,"local_printshop"),u(),h(106," Imprimir entrega "),u(),oe(107,sfe,5,0,"ng-container",6),u()()),2&r&&(w(10),Up(" ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.pNombre," ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.sNombre," ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.pApellido," ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.sApellido," "),w(3),fo(" ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.tipoDoc," - ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.numDocumento," "),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.sexo," "),w(3),Qt(" ",i.calcularEdad(null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.fecNacimiento)," a\xf1os"),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.eps.nombre," "),w(3),Qt(" ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.regimen," "),w(3),Qt(" ",null==i.listaregistros||null==i.listaregistros.paciente||null==i.listaregistros.paciente.categoria?null:i.listaregistros.paciente.categoria.nombre,""),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.direccion,""),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.paciente?null:i.listaregistros.paciente.celularPrincipal," "),w(3),fo(" ",null==i.listaregistros||null==i.listaregistros.paciente||null==i.listaregistros.paciente.municipio?null:i.listaregistros.paciente.municipio.nombre," - ",null==i.listaregistros||null==i.listaregistros.paciente||null==i.listaregistros.paciente.municipio||null==i.listaregistros.paciente.municipio.departamento?null:i.listaregistros.paciente.municipio.departamento.nombre,""),w(4),Qt(" ",null!=i.listaregistros&&i.listaregistros.pgp?"SI":"NO"," "),w(3),Qt(" ",null!=i.listaregistros&&i.listaregistros.origenurgencia?"URGENCIA":"CONSULTA EXTERNA",""),w(5),_e(null==i.listaregistros?null:i.listaregistros.idFormula),w(5),Qt(" ",null==i.listaregistros||null==i.listaregistros.ips?null:i.listaregistros.ips.nombre,""),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.medico?null:i.listaregistros.medico.nombre,""),w(4),Qt(" ",Xo(67,34,null==i.listaregistros?null:i.listaregistros.fecPrescribe,"dd/MM/YYYY")," "),w(4),Qt("",Xo(71,37,null==i.listaregistros?null:i.listaregistros.fecSolicitud,"dd/MM/YYYY : hh:mm")," "),w(5),Qt(" ",null==i.listaregistros?null:i.listaregistros.continuidad," "),w(3),Qt(" ",null==i.listaregistros||null==i.listaregistros.programa?null:i.listaregistros.programa.nombre,""),w(4),zC(" ",null==i.listaregistros?null:i.listaregistros.cieP," ",null==i.listaregistros?null:i.listaregistros.cieR1," ",null==i.listaregistros?null:i.listaregistros.cieR2," "),w(3),Qt(" ",null==i.listaregistros?null:i.listaregistros.funcionariocreaformula,""),w(4),Qt(" ",null==i.listaregistros?null:i.listaregistros.observacion,""),w(1),N("ngIf",0==(null==i.listaItemsFormula?null:i.listaItemsFormula.length)),w(1),N("ngIf",(null==i.listaItemsFormula?null:i.listaItemsFormula.length)>0),w(3),N("routerLink",Nt(40,lfe)),w(4),N("ngIf",i.tieneAcceso(4)),w(9),N("ngIf",i.tieneAcceso(3)))},dependencies:[ho,Fi,Jo,Hs,n0,Of,r0,mm,Wo,BE,Sc],styles:[".card-body[_ngcontent-%COMP%]{padding:10px}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:14px;line-height:1.3}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}.card[_ngcontent-%COMP%]{margin:15px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.card-header[_ngcontent-%COMP%]{background:linear-gradient(to right,#5D8FA5,#6CC5D4);color:#fff;font-weight:700;padding:8px;border-radius:8px 8px 0 0}@media print{body[_ngcontent-%COMP%]{font-size:20px;margin:1mm;padding:10px}pre[_ngcontent-%COMP%]{font-size:20px;line-height:1.5;margin:1mm}}pre[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace;font-size:20px;font-weight:700;line-height:1.5}"]})}return t})();class Z6{constructor(){this.itemsDespacho=[],this.idDespacho=NaN,this.fechaDespacho=new Date,this.fechaEntradaDestino=null,this.bodegaOrigen=NaN,this.bodegaDestino=NaN,this.observacion="",this.funcionarioDespacho="",this.funcionarioEntradaDestino="",this.estado="Creaci\xf3n",this.tipo="",this.nitProvedor="",this.nomProvedor="",this.numFactura="",this.valor=NaN}}class Cx{constructor(){this.medicamento=NaN,this.cantidad=NaN,this.fechaVencimiento=new Date,this.lote="",this.laboratorio="",this.invima="",this.estadoEntradaBodega=!1}}let y_=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/despacho"}getOrdenDespachoId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unica`,{params:r})}getOrdenDespachoBodegaOrigen(e,r,i){const o=(new Pn).set("idBodegaOrigen",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/bodegaorigen`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getOrdenDespachoBodegaDestino(e,r,i){const o=(new Pn).set("idBodegaDestino",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/bodegadestino`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}getOrdenDespachoBodegaTodas(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/bodega`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r})}deleteItem(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}/item`,{params:r})}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}descargarinventarioBodegacange(e,r,i){const o=(new Pn).set("idDespacho",e).set("idBodega",r).set("funcionario",i);return this.http.get(`${this.urlEndPoint}/bodegacange`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}cargarinventariocangeBodega(e,r,i){const o=(new Pn).set("idDespacho",e).set("idBodega",r).set("funcionario",i);return this.http.get(`${this.urlEndPoint}/cangebodega`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}regresarinventariocangeBodegaorigen(e,r,i){const o=(new Pn).set("idDespacho",e).set("idBodega",r).set("funcionario",i);return this.http.get(`${this.urlEndPoint}/regresarorigen`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}regresarItemcangeBodegaorigen(e,r,i,o){const a=(new Pn).set("idDespacho",e).set("idItemDespacho",r).set("idMedicamento",i).set("cantidad",o);return this.http.get(`${this.urlEndPoint}/regresaritemorigen`,{params:a}).pipe(Pt(s=>(401!=s.status&&s.error.mensaje&&console.error(s.error.mensaje),It(s))))}agregarItemAOrden(e,r){return this.http.post(`${this.urlEndPoint}/${e}/items`,r).pipe(Pt(i=>{let o="Ocurri\xf3 un error desconocido";return i.error&&i.error.message&&(o=i.error.message),It(()=>new Error(o))}))}getDetalleOrdenDespacho(e,r,i,o){const a=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i).set("tipoReporte",o);return this.http.get(`${this.urlEndPoint}/detallesalida`,{params:a}).pipe(Pt(s=>(401!=s.status&&s.error.mensaje&&console.error(s.error.mensaje),It(s))))}getMedicamentoOrdenDespacho(e,r,i,o){const a=(new Pn).set("idMedicamento",e).set("idBodega",r).set("fInicial",i).set("fFinal",o);return this.http.get(`${this.urlEndPoint}/medicamento`,{params:a}).pipe(Pt(s=>(401!=s.status&&s.error.mensaje&&console.error(s.error.mensaje),It(s))))}getMedicamentoOrdenDespachoEnvio(e){const r=(new Pn).set("idMedicamento",e);return this.http.get(`${this.urlEndPoint}/medicamentoenvio`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ufe(t,n){if(1&t&&(d(0,"option",39),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),fo(" ",e.nombre," - ",e.puntoEntrega," ")}}function dfe(t,n){if(1&t&&(d(0,"option",39),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),fo(" ",e.nombre," - ",e.puntoEntrega," ")}}function ffe(t,n){1&t&&(d(0,"div",40)(1,"div",9)(2,"label",10),h(3,"Nit"),u(),d(4,"div",11),qe(5,"input",41),u()(),d(6,"div",9)(7,"label",10),h(8,"Nombre del proveedor"),u(),d(9,"div",11),qe(10,"input",42),u()(),d(11,"div",9)(12,"label",10),h(13,"N\xfamero de la factura"),u(),d(14,"div",11),qe(15,"input",43),u()(),d(16,"div",9)(17,"label",10),h(18,"Valor de la factura"),u(),d(19,"div",11),qe(20,"input",44),u()()())}function hfe(t,n){if(1&t){const e=Fn();d(0,"button",22),De("click",function(){return ht(e),pt(ae().sugerir())}),h(1," Despacho sugerido "),u()}}function pfe(t,n){if(1&t){const e=Fn();d(0,"div",45)(1,"input",46),De("change",function(i){return ht(e),pt(ae().onFileChange(i))}),u()()}}function mfe(t,n){if(1&t){const e=Fn();d(0,"button",22),De("click",function(){return ht(e),pt(ae().procesarOrdenDespacho())}),h(1," Procesar orden "),u()}}function gfe(t,n){1&t&&(d(0,"div",47),h(1," No hay registros para mostrar!\n"),u())}function _fe(t,n){if(1&t){const e=Fn();d(0,"div")(1,"input",58),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.cantidadDespacho=i)}),u(),d(2,"input",59),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.laboratorio=i)}),u(),d(3,"input",60),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.invima=i)}),u(),d(4,"input",61),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.lote=i)}),u(),d(5,"input",62),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.fechaVencimiento=i)}),u()()}if(2&t){const e=ae().$implicit,r=ae(2);w(1),N("ngModel",e.cantidadDespacho),w(1),N("ngModel",e.laboratorio),w(1),N("ngModel",e.invima),w(1),N("ngModel",e.lote),w(1),N("ngModel",e.fechaVencimiento)("min",r.hoy)}}function vfe(t,n){if(1&t&&(d(0,"div"),h(1),u()),2&t){const e=ae().$implicit;w(1),Qt(" ",e.cantidadDespacho," ")}}const tA=function(){return{color:"#009A94"}};function bfe(t,n){if(1&t){const e=Fn();d(0,"mat-icon",63),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).editarMedicamentoOrdenDespacho(i))}),h(1,"edit"),u()}2&t&&N("ngStyle",Nt(1,tA))}const yfe=function(){return{color:"red"}};function wfe(t,n){if(1&t){const e=Fn();d(0,"mat-icon",64),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).quitarMedicamentoDespacho(i.idMedicamento))}),h(1,"delete_sweep"),u()}2&t&&N("ngStyle",Nt(1,yfe))}const xfe=function(){return{color:"orange"}};function Cfe(t,n){if(1&t){const e=Fn();d(0,"mat-icon",65),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).cancelEdicion(i))}),h(1,"clear"),u()}2&t&&N("ngStyle",Nt(1,xfe))}function Efe(t,n){if(1&t){const e=Fn();d(0,"mat-icon",66),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).guardarMedicamentoOrdenDespacho(i))}),h(1,"check"),u()}2&t&&N("ngStyle",Nt(1,tA))}function Sfe(t,n){if(1&t&&(d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td",51),h(12),u(),d(13,"td",52)(14,"strong"),h(15),u()(),d(16,"td",53)(17,"strong"),h(18),u()(),d(19,"td",51),h(20),u(),d(21,"td",51),oe(22,_fe,6,6,"div",38),oe(23,vfe,2,1,"div",38),u(),d(24,"td"),oe(25,bfe,2,2,"mat-icon",54),oe(26,wfe,2,2,"mat-icon",55),oe(27,Cfe,2,2,"mat-icon",56),oe(28,Efe,2,2,"mat-icon",57),u()()),2&t){const e=n.$implicit,r=n.index,i=ae(2);w(2),_e(r+1),w(2),_e(i.primerasmayusculas(e.cum)),w(2),_e(e.idMedicamento),w(2),_e(i.primerasmayusculas(e.nombre)),w(2),_e(i.primerasmayusculas(e.forma)),w(2),_e(e.cantidad),w(3),_e(e.stopMinimo),w(3),_e(e.pendiente),w(2),_e(e.cantidadEntregada),w(2),N("ngIf",e.editing),w(1),N("ngIf",!e.editing),w(2),N("ngIf",!e.estado&&!e.editing&&e.cantidad>0),w(1),N("ngIf",!e.estado&&0==e.cantidad&&e.cantidadDespacho>0),w(1),N("ngIf",!e.estado&&e.editing),w(1),N("ngIf",!e.estado&&e.editing)}}function Dfe(t,n){if(1&t&&(d(0,"div")(1,"table",48)(2,"thead",49)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"CUM"),u(),d(8,"th"),h(9,"ID"),u(),d(10,"th"),h(11,"Nombre"),u(),d(12,"th"),h(13,"Forma Farmac\xe9utica"),u(),d(14,"th"),h(15,"Existencias Origen"),u(),d(16,"th"),h(17,"Existencias Destino"),u(),d(18,"th"),h(19,"Pendientes Destino"),u(),d(20,"th"),h(21,"Prom. mes \xfaltimo trimestre"),u(),d(22,"th"),h(23,"Cantidad a despachar"),u(),d(24,"th"),h(25,"Gesti\xf3n"),u()()(),d(26,"tbody"),oe(27,Sfe,29,15,"tr",50),u()()()),2&t){const e=ae();w(27),N("ngForOf",e.listaItemsFiltro)}}const Afe=function(){return["/menu/historialordendespacho"]};let Q6=(()=>{class t{constructor(e,r,i,o,a){this.fb=e,this.servicio=r,this.medicamentoServicio=i,this.ordenDespachoservicio=o,this.activatedRoute=a,this.ordenDespacho=new Z6,this.listaItems=[],this.listaItemsFiltro=[],this.data=[],this.importar=!1,this.procesar=!1,this.isCompra=!1,this.nombrebtn="Crear orden"}ngOnInit(){this.crearFormulario(),this.cargarRegistros(),this.activatedRoute.paramMap.subscribe(e=>{this.parametro=e.get("id"),this.parametro&&this.buscarRegistro(this.parametro)}),this.generalForm.get("listFilter").valueChanges.pipe(xo(300),Di(e=>this.buscarMedicamentos(e))).subscribe(e=>{this.listaItemsFiltro=e}),this.generalForm.get("soloajuste")?.valueChanges.subscribe(e=>{this.onAjuste(e)}),this.fechaActual=new Date,this.hoy=this.fechaActual.toISOString().split("T")[0],this.onTipoChange()}onTipoChange(){const e=this.generalForm.get("tipo")?.value;this.isCompra="ORDEN DE COMPRA"===e}buscarRegistro(e){this.ordenDespachoservicio.getOrdenDespachoId(e).subscribe(r=>{this.registroUpdate=r,this.ordenDespacho=r,this.mostrarOrdenDespacho()})}buscarMedicamentos(e){return e&&e.length>3?(e=e.toLocaleLowerCase(),On(this.listaItems.filter(i=>i.nombre.toLowerCase().includes(e)))):On(this.listaItems)}crearFormulario(){this.generalForm=this.fb.group({idDespacho:[""],idBodegaOrigen:["0",[Zn.required]],idBodegaDestino:["0",[Zn.required]],fechaDespacho:["",[Zn.required]],observacion:["",[Zn.required]],estado:[!1,[Zn.required]],tipo:["ORDEN DE DESPACHO"],nitProvedor:[""],nomProvedor:[""],numFactura:[""],valor:[""],itemsDespacho:this.fb.array([]),listFilter:[""],soloajuste:[""],solopendiente:[""]})}mostrarOrdenDespacho(){this.nombrebtn="Actualizar",this.generalForm.patchValue({idDespacho:this.registroUpdate.idDespacho,idBodegaOrigen:this.registroUpdate.bodegaOrigen.idBodega,idBodegaDestino:this.registroUpdate.bodegaDestino.idBodega,fechaDespacho:this.registroUpdate.fechaDespacho,observacion:this.registroUpdate.observacion,estado:this.registroUpdate.estado,tipo:this.registroUpdate.tipo,nitProvedor:this.registroUpdate.nitProvedor,nomProvedor:this.registroUpdate.nomProvedor,numFactura:this.registroUpdate.numFactura,valor:this.registroUpdate.valor,itemsDespacho:this.registroUpdate.itemsDespacho}),"ORDEN DE COMPRA"===this.registroUpdate.tipo&&(this.isCompra=!0),this.servicio.getMedicamentosBodegaOrdenDespacho(this.registroUpdate.bodegaOrigen.idBodega,this.registroUpdate.bodegaDestino.idBodega).subscribe(e=>{this.listaItems=e.map(r=>({...r,estado:!1,editing:!1,cantidadDespacho:""})),this.listaItems.forEach(r=>{const i=this.registroUpdate.itemsDespacho.find(o=>o.medicamento.idMedicamento===r.idMedicamento);i&&(r.cantidadDespacho=i.cantidad)}),this.listaItems.sort((r,i)=>r.nombre.localeCompare(i.nombre)),this.listaItemsFiltro=this.listaItems,this.generalForm.get("soloajuste")?.setValue(!0)},e=>{console.error(e)}),this.generalForm.get("idBodegaOrigen")?.disable(),this.generalForm.get("idBodegaDestino")?.disable(),this.generalForm.get("nitProvedor")?.disable(),this.generalForm.get("nomProvedor")?.disable(),this.generalForm.get("numFactura")?.disable(),this.generalForm.get("valor")?.disable(),this.importar=!1,this.procesar=!0}onBodegaChange(){const e=this.generalForm.get("idBodegaOrigen")?.value,r=this.generalForm.get("idBodegaDestino")?.value;e!==r?"0"!==e&&"0"!==r&&(this.listaItems=[],this.listaItemsFiltro=[],z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.servicio.getMedicamentosBodegaOrdenDespacho(e,r).subscribe(i=>{this.listaItems=i.map(o=>({...o,estado:!1,editing:!1,cantidadDespacho:""})),this.listaItems.sort((o,a)=>o.nombre.localeCompare(a.nombre)),this.listaItemsFiltro=this.listaItems,this.importar=!0,z().close()},i=>{console.error("\u274c Error cargando registros",i),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})):z().fire({icon:"error",title:"Bodegas iguales!",text:"No se puede seleccionar la misma bodega de origen como bodega de destino!"})}cargarRegistros(){this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistrosOrigen=e.filter(r=>!0===r.salida),this.listaregistrosDestino=e.filter(r=>!0===r.entrada),this.listaregistrosOrigen.sort((r,i)=>r.nombre.localeCompare(i.nombre)),this.listaregistrosDestino.sort((r,i)=>r.nombre.localeCompare(i.nombre))},e=>{console.error(e)})}itemsDespachoFormArray(){return this.generalForm.get("itemsDespacho")}editarMedicamentoOrdenDespacho(e){e.editing=!0}agregarItemDespacho(e){this.itemsDespachoFormArray().push(this.fb.group({medicamento:[e.medicamento,Zn.required],cantidad:[e.cantidad,Zn.required],invima:[e.invima],laboratorio:[e.laboratorio],lote:[e.lote],fechaVencimiento:[e.fechaVencimiento]}))}cancelEdicion(e){e.editing=!1}guardarMedicamentoOrdenDespacho(e){if(e.editing=!1,e&&e.idMedicamento){if(this.existeItem(e.idMedicamento))this.actualizarCantidad(e.idMedicamento,e.cantidadDespacho);else if(e.cantidadDespacho>0){let r=new Cx;r.medicamento=e.idMedicamento,r.cantidad=e.cantidadDespacho,r.invima=e.invima,r.laboratorio=e.laboratorio,r.lote=e.lote,r.fechaVencimiento=e.fechaVencimiento,this.ordenDespacho.itemsDespacho.push(r)}}else console.error("Item o idMedicamento no disponible:",e)}existeItem(e){let r=!1;return this.ordenDespacho.itemsDespacho.forEach(i=>{e===i.medicamento.idMedicamento&&(r=!0),e===i.medicamento&&(r=!0)}),r}actualizarCantidad(e,r){if(0==r||null==r)return this.eliminarItemOrdenDespacho(e);this.ordenDespacho.itemsDespacho=this.ordenDespacho.itemsDespacho.map(i=>(e===("object"==typeof i.medicamento?i.medicamento.idMedicamento:i.medicamento)&&(i.cantidad=r),i))}eliminarItemOrdenDespacho(e){if(this.itemParaEliminar=this.ordenDespacho.itemsDespacho.find(i=>e===("object"==typeof i.medicamento?i.medicamento.idMedicamento:i.medicamento)),!this.itemParaEliminar)return void console.error(`No se encontr\xf3 ning\xfan \xedtem con el ID: ${e}`);const r=this.itemParaEliminar.id;this.ordenDespacho.itemsDespacho=this.ordenDespacho.itemsDespacho.filter(i=>e!==("object"==typeof i.medicamento?i.medicamento.idMedicamento:i.medicamento)),r&&this.ordenDespachoservicio.deleteItem(r).subscribe(i=>{alert(`El \xedtem "${r}" ha sido eliminado correctamente.`)},i=>{console.error(`Error al eliminar el \xedtem con ID ${r} de la base de datos:`,i)})}quitarMedicamentoDespacho(e){if(this.itemParaEliminar=this.ordenDespacho.itemsDespacho.find(i=>e===("object"==typeof i.medicamento?i.medicamento.idMedicamento:i.medicamento)),!this.itemParaEliminar)return void console.error(`No se encontr\xf3 ning\xfan \xedtem con el ID: ${e}`);const r=this.itemParaEliminar.id;this.ordenDespacho.itemsDespacho=this.ordenDespacho.itemsDespacho.filter(i=>e!==("object"==typeof i.medicamento?i.medicamento.idMedicamento:i.medicamento)),r&&this.ordenDespachoservicio.deleteItem(r).subscribe(i=>{z().fire({icon:"success",title:"Item eliminado!",text:"El item de la orden de despacho ha sido eleiminado correctamente!"})},i=>{console.error(`Error al eliminar el \xedtem con ID ${r} de la base de datos:`,i)})}procesarOrdenDespacho(){let e=sessionStorage.getItem("nombre");this.listaItems.some(i=>i.cantidadDespacho>i.cantidad&&(z().fire({icon:"error",title:"Cantidad insuficiente",text:"La orden tiene items donde la cantidad a despachar supera la cantidad existente en la bodega origen. "+i.nombre+" cantidad actual en el origen "+i.cantidad+" cantidad solicitada para despachar "+i.cantidadDespacho}),!0))||z().fire({title:"\xbfConfirma?",icon:"question",text:"Trasladar los medicamentos de la orden n\xfamero "+this.registroUpdate.idDespacho+" del inventario de la bodega de origen "+this.registroUpdate.bodegaOrigen.nombre+" al estado de cange a la bodega destino "+this.registroUpdate.bodegaDestino.nombre,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar!"}).then(i=>{i.isConfirmed&&(z().fire({title:"Procesando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ordenDespachoservicio.descargarinventarioBodegacange(this.ordenDespacho.idDespacho,this.registroUpdate.bodegaOrigen.idBodega,e).subscribe(o=>{z().close(),this.nuevaOrdenDespacho(),z().fire({icon:"success",title:"Ok",html:"La orden ha sido descargada del inventario de la bodega de origen y los medicamentos est\xe1n en <b>cange</b> para ser ingresados a la bodega destino."})},o=>{z().close(),z().fire({icon:"error",title:"Error",text:"No se pudo actualizar la orden en la base de datos."})}))})}create(){if(this.generalForm.valid)if(this.ordenDespacho.itemsDespacho.length>0){const e=this.generalForm.get("idBodegaOrigen")?.value,r=this.listaregistrosOrigen.find(c=>c.idBodega===e),i=this.generalForm.get("idBodegaDestino")?.value,o=this.listaregistrosDestino.find(c=>c.idBodega===i);let a=sessionStorage.getItem("nombre"),s="Bodega de origen:  <b>"+r.nombre+" </b> <br>";s=s+"Bodega de destino:  <b>"+o.nombre+"</b> <br>",s=s+"N\xfamero de items de medicamentos:  <b>"+this.ordenDespacho.itemsDespacho.length+"</b>";let l="\xbfConfirma crear la orden?";null!=this.parametro&&(l="\xbfConfirma actualizar la orden?"),z().fire({title:l,icon:"question",html:s,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar!"}).then(c=>{c.isConfirmed&&(null!=this.parametro?this.actualizarOrdenDespacho(a):this.crearNuevaOrdenDespacho(a),this.procesar=!0)})}else z().fire({icon:"warning",title:"Verificar!",text:"No se ha agregado ning\xfan medicamento a la orden que intenta guardar!"});else z().fire({icon:"error",title:"!Alerta",text:"Datos incompletos para crear la orden en la base de datos!"})}crearNuevaOrdenDespacho(e){z().fire({title:"Creando la orden..",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ordenDespacho.bodegaOrigen=this.generalForm.get("idBodegaOrigen")?.value,this.ordenDespacho.bodegaDestino=this.generalForm.get("idBodegaDestino")?.value,this.ordenDespacho.fechaDespacho=this.generalForm.get("fechaDespacho")?.value,this.ordenDespacho.observacion=this.generalForm.get("observacion")?.value,this.ordenDespacho.tipo=this.generalForm.get("tipo")?.value,this.ordenDespacho.nitProvedor=this.generalForm.get("nitProvedor")?.value,this.ordenDespacho.nomProvedor=this.generalForm.get("nomProvedor")?.value,this.ordenDespacho.numFactura=this.generalForm.get("numFactura")?.value,this.ordenDespacho.valor=this.generalForm.get("valor")?.value,this.ordenDespacho.funcionarioDespacho=e,this.ordenDespachoservicio.create(this.ordenDespacho).subscribe(r=>{this.generalForm.get("idBodegaOrigen")?.enable(),this.generalForm.get("idBodegaDestino")?.enable(),this.generalForm.get("nitProvedor")?.enable(),this.generalForm.get("nomProvedor")?.enable(),this.generalForm.get("numFactura")?.enable(),this.generalForm.get("valor")?.enable(),this.buscarRegistro(r.idDespacho),z().close(),this.parametro=r.idDespacho,z().fire({icon:"success",title:"Ok",text:"La orden ha sido agregada correctamente con el numero: "+r.idDespacho+" de fecha "+this.generalForm.get("fechaDespacho")?.value})},r=>{z().close(),z().fire({icon:"error",title:"Error",text:"No se pudo agregar la nueva orden en la base de datos "+r.mensaje})})}nuevaOrdenDespacho(){this.generalForm.reset({idDespacho:"",idBodegaOrigen:"",idBodegaDestino:"",fechaDespacho:"",observacion:"",nomProvedor:"",numFactura:"",nitProvedor:"",tipo:"ORDEN DE DESPACHO",valor:"",estado:!1,itemsDespacho:this.fb.array([])}),this.listaItems=[],this.ordenDespacho=new Z6,this.nombrebtn="Crear orden",this.generalForm.get("idBodegaOrigen")?.enable(),this.generalForm.get("idBodegaDestino")?.enable(),this.generalForm.get("nitProvedor")?.enable(),this.generalForm.get("nomProvedor")?.enable(),this.generalForm.get("numFactura")?.enable(),this.generalForm.get("valor")?.enable(),this.parametro=null}actualizarOrdenDespacho(e){z().fire({title:"Actualizando la orden..",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ordenDespacho.fechaDespacho=this.generalForm.get("fechaDespacho")?.value,this.ordenDespacho.observacion=this.generalForm.get("observacion")?.value,this.ordenDespachoservicio.update(this.ordenDespacho).subscribe(r=>{z().close(),z().fire({icon:"success",title:"Ok",text:"La orden ha sido actualizada correctamente."})},r=>{z().close(),z().fire({icon:"error",title:"Error",text:"No se pudo actualizar la orden en la base de datos."})})}onFileChange(e){const r=e.target;if(1!==r.files.length)return void console.error("No se puede cargar m\xfaltiples archivos");const i=new FileReader;i.onload=o=>{const s=Nb(o.target.result,{type:"binary",cellDates:!0});this.data=Gr.sheet_to_json(s.Sheets[s.SheetNames[0]],{header:1}),this.validateData(this.data)?(z().fire({icon:"success",title:"OK",text:"Ya le fueron asignados las cantidades a despachar desde el archivo de excel, por favor verificar los datos antes de crear la orden de despacho!"}),this.processData(this.data),this.generalForm.get("soloajuste")?.setValue(!0)):z().fire({icon:"error",title:"Error",text:"Hay una inconsistencia en el archivo de excel de cargue para crear la orden de despacho. Revisa los errores en la consola."}),e.target.value=""},i.readAsBinaryString(r.files[0])}validateData(e){for(let r=1;r<e.length;r++){const i=e[r];if(10!==i.length)return console.error(`Error en la fila ${r}: la cantidad de columnas es incorrecta`),!1;const o=i[0],a=this.listaItems.find(l=>l.idMedicamento===o);if(!a)return console.error(`Error en la fila ${r}: El id del medicamento ${o} no existe en la base de datos.`),!1;if(a.cantidadDespacho=i[9],isNaN(i[9]))return console.error(`Error en la fila ${r}: La columna 3 debe ser un n\xfamero v\xe1lido. Valor encontrado: ${i[9]}`),!1;const s=i[8];if(!this.isValidDate(s))return console.error(`Error en la fila ${r}: La columna 'fechaVencimiento' debe ser una fecha v\xe1lida. Valor encontrado: ${s}`),!1}return!0}isValidDate(e){const r=Date.parse(e);return!(isNaN(r)||r<=this.fechaActual.getTime()&&(console.log("Medicamento con fecha ya vencido o se vence hoy"),1))}processData(e){const r=e.map(i=>({idMedicamento:i[0],codigoCum:i[1],nombre:i[2],forma:i[3],via:i[4],invima:i[5],laboratorio:i[6],lote:i[7],fechaVencimiento:i[8],cantidad:i[9]}));this.saveToDatabase(r)}saveToDatabase(e){for(let r=1;r<e.length;r++){let i=new Cx;i.medicamento=e[r].idMedicamento,i.cantidad=e[r].cantidad,i.invima=e[r].invima,i.laboratorio=e[r].laboratorio,i.lote=e[r].lote,i.fechaVencimiento=e[r].fechaVencimiento,this.ordenDespacho.itemsDespacho.push(i)}}onAjuste(e){this.listaItemsFiltro=e?this.listaItems.filter(r=>""!=r.cantidadDespacho):this.listaItems}onPendiente(e){this.listaItemsFiltro=e.target.checked?this.listaItems.filter(r=>r.pendiente>0&&r.cantidad>0&&r.stopMinimo<r.cantidadEntregada+r.pendiente):this.listaItems}sugerir(){this.listaItems.forEach(e=>{const r=e.cantidadEntregada+e.pendiente,i=e.stopMinimo-r;if(r>0&&i<0&&e.cantidad>=-1*i&&!this.existeItem(e.idMedicamento)){e.cantidadDespacho=-1*i;let o=new Cx;o.medicamento=e.idMedicamento,o.cantidad=-1*i,o.invima=e.invima,o.laboratorio=e.laboratorio,o.lote=e.lote,o.fechaVencimiento=e.fechaVencimiento,this.ordenDespacho.itemsDespacho.push(o)}}),this.listaItemsFiltro=this.listaItems,this.generalForm.get("soloajuste")?.setValue(!0),z().fire({icon:"success",title:"Ok",text:"Se llenaron las cantidades sugeridas a despachar hacia La bodega destino con la siguiente formula (env\xedo= (Promedio de consumo + pendiente) - existencia actual ) siempre y cuando la cantidad en origen alcance para surtir esa proyecci\xf3n; por favor revisar y si est\xe1s de acuerdo crear la orden de despacho."})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(Ts),X(l0),X(y_),X(Us))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-despacho"]],decls:70,vars:15,consts:[[1,"container","mt-4"],[1,"w-100",3,"formGroup"],[1,"form-row"],[1,"form-group","col-md-12","d-flex"],[2,"margin-right","30px"],["type","radio","formControlName","tipo","value","ORDEN DE DESPACHO",3,"change"],["type","radio","formControlName","tipo","value","ORDEN DE COMPRA",3,"change"],[1,"row"],[1,"col-md-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["type","date","formControlName","fechaDespacho",1,"form-control",3,"max"],["formControlName","idBodegaOrigen","required","",1,"form-select",3,"change"],["selected","","value","0"],[3,"ngValue",4,"ngFor","ngForOf"],["formControlName","idBodegaDestino","required","",1,"form-select",3,"change"],["formControlName","observacion",1,"form-control"],["class","w-100",4,"ngIf"],[1,"form-row","mt-2"],[1,"d-flex","justify-content-between","w-100","align-items-center"],["class","btn btn-outline-primary w-25",3,"click",4,"ngIf"],[1,"btn","btn-outline-primary","w-25",3,"click"],[1,"far","fa-save"],["class","file-upload w-25 text-center",4,"ngIf"],[1,"btn","btn-outline-primary","w-25",3,"routerLink"],[1,"text-container"],[1,"input-group","mb-2","align-center"],[1,"bodega-nombre"],[1,"input-group-text","bg-transparent"],[3,"ngStyle"],["type","text","formControlName","listFilter","placeholder","Buscar por nombre del medicamento",1,"form-control","border-end-0","search-input"],[1,"form-group","d-flex","align-items-center","ms-3"],["id","portabilidad","type","checkbox","formControlName","soloajuste",1,"form-check-input","me-2"],["for","portabilidad",1,"form-check-label"],["id","portabilidad","type","checkbox","formControlName","solopendiente",1,"form-check-input","me-2",3,"change"],[1,"form-check-label"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[3,"ngValue"],[1,"w-100"],["type","text","formControlName","nitProvedor","placeholder","Digite el nit",1,"form-control"],["type","text","formControlName","nomProvedor","placeholder","Digite el nombre del proveedor",1,"form-control"],["type","text","formControlName","numFactura","placeholder","Digite la factura",1,"form-control"],["type","text","formControlName","valor","placeholder","Digite el valor",1,"form-control"],[1,"file-upload","w-25","text-center"],["type","file","accept",".xlsx, .xls",1,"form-control-file",3,"change"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[4,"ngFor","ngForOf"],[2,"text-align","right"],[2,"color","green","text-align","right"],[2,"color","red","text-align","right"],["title","Editar cantidad","class","pointer-cursor","title","Editar cantidad",3,"ngStyle","click",4,"ngIf"],["class","pointer-cursor","title","Eliminar cantidad a despachar",3,"ngStyle","click",4,"ngIf"],["title","Cancelar","class","pointer-cursor","title","Cancelar edici\xf3n",3,"ngStyle","click",4,"ngIf"],["title","Guardar cantidad","class","pointer-cursor","title","Fijar cantidad",3,"ngStyle","click",4,"ngIf"],["type","number","placeholder","Cantidad",1,"form-control","mb-1",3,"ngModel","ngModelChange"],["type","text","placeholder","Laboratorio",1,"form-control","mb-1",3,"ngModel","ngModelChange"],["type","text","placeholder","Invima",1,"form-control","mb-1",3,"ngModel","ngModelChange"],["type","text","placeholder","Lote",1,"form-control","mb-1",3,"ngModel","ngModelChange"],["type","date","placeholder","Vencimiento",1,"form-control","mb-1",3,"ngModel","min","ngModelChange"],["title","Editar cantidad","title","Editar cantidad",1,"pointer-cursor",3,"ngStyle","click"],["title","Eliminar cantidad a despachar",1,"pointer-cursor",3,"ngStyle","click"],["title","Cancelar","title","Cancelar edici\xf3n",1,"pointer-cursor",3,"ngStyle","click"],["title","Guardar cantidad","title","Fijar cantidad",1,"pointer-cursor",3,"ngStyle","click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label")(6,"input",5),De("change",function(){return i.onTipoChange()}),u(),h(7," Orden de despacho "),u()(),d(8,"div")(9,"label")(10,"input",6),De("change",function(){return i.onTipoChange()}),u(),h(11," Orden de compra "),u()()(),qe(12,"hr"),d(13,"div",7)(14,"div",8)(15,"div",9)(16,"label",10),h(17,"Fecha"),u(),d(18,"div",11),qe(19,"input",12),u()(),d(20,"div",9)(21,"label",10),h(22,"Bodega de Origen"),u(),d(23,"div",11)(24,"select",13),De("change",function(){return i.onBodegaChange()}),d(25,"option",14),h(26,"Seleccione la bodega de origen"),u(),oe(27,ufe,2,3,"option",15),u()()(),d(28,"div",9)(29,"label",10),h(30,"Bodega de Destino"),u(),d(31,"div",11)(32,"select",16),De("change",function(){return i.onBodegaChange()}),d(33,"option",14),h(34,"Seleccione la bodega de destino"),u(),oe(35,dfe,2,3,"option",15),u()()(),d(36,"div",9)(37,"label",10),h(38,"Registrar anotaciones"),u(),d(39,"div",11),qe(40,"textarea",17),u()()(),d(41,"div",8),oe(42,ffe,21,0,"div",18),u()(),d(43,"div",19)(44,"div",20),oe(45,hfe,2,0,"button",21),d(46,"button",22),De("click",function(){return i.create()}),qe(47,"i",23),h(48),u(),oe(49,pfe,2,0,"div",24),oe(50,mfe,2,0,"button",21),d(51,"button",25),h(52," Ver orden "),u()()()(),d(53,"div",26)(54,"div",27),qe(55,"span",28),d(56,"span",29)(57,"mat-icon",30),h(58,"zoom_in"),u()(),qe(59,"input",31),d(60,"div",32),qe(61,"input",33),d(62,"label",34),h(63,"Ver solo los medicamentos en la orden"),u()(),d(64,"div",32)(65,"input",35),De("change",function(a){return i.onPendiente(a)}),u(),d(66,"label",36),h(67,"Ver pendientes en destino"),u()()()()(),oe(68,gfe,2,0,"div",37),oe(69,Dfe,28,1,"div",38),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(18),N("max",i.hoy),w(8),N("ngForOf",i.listaregistrosOrigen),w(8),N("ngForOf",i.listaregistrosDestino),w(7),N("ngIf",i.isCompra),w(3),N("ngIf",i.importar&&i.tieneAcceso(3)),w(3),Qt(" ",i.nombrebtn," "),w(1),N("ngIf",i.importar),w(1),N("ngIf",i.procesar),w(1),N("routerLink",Nt(13,Afe)),w(6),N("ngStyle",Nt(14,tA)),w(11),N("ngIf",(null==i.listaregistrosOrigen?null:i.listaregistrosOrigen.length)<=0),w(1),N("ngIf",(null==i.listaregistrosOrigen?null:i.listaregistrosOrigen.length)>0))},dependencies:[ho,Fi,Jo,Hs,Wo,Vs,cl,ul,vo,wd,sl,Ss,Wy,No,zo,Dc,bo,Ro,Ag]})}return t})();function Tfe(t,n){if(1&t&&(d(0,"option",17),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),Qt(" ",e.nombre," ")}}function Mfe(t,n){if(1&t&&(d(0,"div")(1,"div",4)(2,"div",5)(3,"label",6),h(4,"Nombre de la bodega"),u(),d(5,"select",7)(6,"option",8),h(7,"Seleccione la bodega"),u(),oe(8,Tfe,2,2,"option",9),u()(),d(9,"div",10)(10,"label",6),h(11,"Buscar medicamento"),u(),d(12,"div",11)(13,"span",12)(14,"mat-icon",13),h(15,"search"),u()(),qe(16,"input",14),u()(),d(17,"div",15)(18,"div",16)(19,"small")(20,"strong"),h(21,"Nro. de mol\xe9culas:\xa0"),u(),h(22),u()()()()()),2&t){const e=ae();w(8),N("ngForOf",e.listaregistros),w(14),Qt(" ",(null==e.listaItemBodega?null:e.listaItemBodega.length)||0," ")}}function kfe(t,n){1&t&&(d(0,"div",18),h(1," No hay medicamentos asociados a esta bodega para mostrar! "),u())}function Ffe(t,n){if(1&t){const e=Fn();d(0,"input",34),De("ngModelChange",function(i){return ht(e),pt(ae(2).$implicit.pendiente=i)}),u()}2&t&&N("ngModel",ae(2).$implicit.pendiente)}function Ife(t,n){if(1&t){const e=Fn();d(0,"div")(1,"input",28),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.invima=i)}),u(),d(2,"input",29),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.laboratorio=i)}),u(),d(3,"input",30),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.lote=i)}),u(),d(4,"input",31),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.fechaVencimiento=i)}),u(),d(5,"input",32),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.stopMinimo=i)}),u(),oe(6,Ffe,1,1,"input",33),u()}if(2&t){const e=ae().$implicit,r=ae(2);w(1),N("ngModel",e.invima),w(1),N("ngModel",e.laboratorio),w(1),N("ngModel",e.lote),w(1),N("ngModel",e.fechaVencimiento),w(1),N("ngModel",e.stopMinimo),w(1),N("ngIf",r.tieneAcceso(6))}}function Pfe(t,n){if(1&t){const e=Fn();d(0,"mat-icon",35),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).editarMedicamentoBodega(i))}),h(1,"list_alt"),u()}}const Ofe=function(){return{color:"green"}};function Nfe(t,n){if(1&t){const e=Fn();d(0,"mat-icon",36),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).guardarMedicamentoBodega(i))}),h(1,"check"),u()}2&t&&N("ngStyle",Nt(1,Ofe))}const Rfe=function(){return{color:"orange"}};function Lfe(t,n){if(1&t){const e=Fn();d(0,"mat-icon",37),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).cancelEdicion(i))}),h(1,"clear"),u()}2&t&&N("ngStyle",Nt(1,Rfe))}function Bfe(t,n){if(1&t&&(d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td",22)(12,"strong"),h(13),u()(),d(14,"td"),h(15),Hi(16,"date"),u(),d(17,"td",23)(18,"strong"),h(19),u()(),d(20,"td",24),h(21),u(),d(22,"td"),oe(23,Ife,7,6,"div",2),oe(24,Pfe,2,0,"mat-icon",25),oe(25,Nfe,2,2,"mat-icon",26),oe(26,Lfe,2,2,"mat-icon",27),u()()),2&t){const e=n.$implicit,r=n.index;w(2),_e(r+1),w(2),_e(e.cum),w(2),_e(e.idMedicamento),w(2),Qt(" ",e.nombre,""),w(2),_e(e.forma),w(3),_e(e.cantidad),w(2),_e(Xo(16,13,e.ultFecIngreso,"dd/MM/YYYY")),w(4),_e(e.pendiente),w(2),_e(e.cantidadEntregada),w(2),N("ngIf",e.editing),w(1),N("ngIf",e.cantidad>0&&!e.editing),w(1),N("ngIf",e.editing),w(1),N("ngIf",e.editing)}}function jfe(t,n){if(1&t&&(d(0,"div")(1,"table",19)(2,"thead",20)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Cum"),u(),d(8,"th"),h(9,"ID"),u(),d(10,"th"),h(11,"Nombre "),u(),d(12,"th"),h(13,"Presentaci\xf3n"),u(),d(14,"th"),h(15,"Existencia"),u(),d(16,"th"),h(17,"Ult. Fecha Dotaci\xf3n"),u(),d(18,"th"),h(19,"Pendiente"),u(),d(20,"th"),h(21,"Prom. mes \xfaltimo trimestre"),u(),d(22,"th"),h(23,"..M\xe1s"),u()()(),d(24,"tbody"),oe(25,Bfe,27,16,"tr",21),u()()()),2&t){const e=ae();w(25),N("ngForOf",e.listaItemBodegaFiltro)}}let J6=(()=>{class t{constructor(e,r,i){this.servicio=e,this.fb=r,this.activatedRoute=i,this.listaItemBodega=[],this.listaItemBodegaFiltro=[],this.datoRecibido=NaN,this.parametroInicializado=!1}ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{const r=e.get("id");r&&!isNaN(Number(r))?(this.parametro=Number(r),this.buscarRegistro(this.parametro)):(this.parametro=parseInt(sessionStorage.getItem("bodega")||"0",10),this.parametro&&!isNaN(this.parametro)&&this.buscarRegistro(this.parametro))}),this.generalForm=this.fb.group({idBodega:[this.parametro],listFilter:[""]}),this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e,this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);return 0===o?r.puntoEntrega.localeCompare(i.puntoEntrega):o}),this.parametro&&this.generalForm.patchValue({idBodega:+this.parametro},{emitEvent:!1})},e=>{console.error(e)}),this.generalForm.get("listFilter").valueChanges.pipe(xo(300),Di(e=>this.buscarMedicamentos(e))).subscribe(e=>{this.listaItemBodegaFiltro=e}),this.generalForm.get("idBodega").valueChanges.subscribe(e=>{e&&(this.parametro=e,this.buscarRegistro(e))})}buscarRegistro(e){var r=this;return(0,hi.Z)(function*(){e&&!isNaN(e)&&0!==e?(r.listaItemBodega=[],r.listaItemBodegaFiltro=[],z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),r.servicio.getRegistrosMedicamentoBodega(e).subscribe(i=>{r.listaItemBodega=i.map(o=>({...o,editing:!1})),console.log(i),r.listaItemBodega.sort((o,a)=>o.nombre.localeCompare(a.nombre)),r.listaItemBodegaFiltro=r.listaItemBodega,z().close()},i=>{console.error("\u274c Error cargando registros",i),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})):console.warn("\u274c ID inv\xe1lido para buscar registros:",e)})()}buscarMedicamentos(e){return e&&e.length>3?(e=e.toLocaleLowerCase(),On(this.listaItemBodega.filter(i=>i.nombre.toLowerCase().includes(e)))):On(this.listaItemBodega)}editarMedicamentoBodega(e){e.editing=!0}guardarMedicamentoBodega(e){if(!(e.invima&&e.laboratorio&&e.lote&&e.fechaVencimiento&&null!=e.stopMinimo))return void z().fire("Campos incompletos","Por favor complete todos los campos antes de guardar.","warning");if(isNaN(e.stopMinimo)||e.stopMinimo<0)return void z().fire("Stock inv\xe1lido","El stock m\xednimo debe ser un n\xfamero positivo.","warning");if(isNaN(e.pendiente)||e.pendiente<0)return void z().fire("Pendiente inv\xe1lido","El pendiente debe ser un n\xfamero positivo.","warning");e.invima=e.invima.toUpperCase(),e.laboratorio=e.laboratorio.toUpperCase(),e.lote=e.lote.toUpperCase();const i=new Date(e.fechaVencimiento).toLocaleDateString("es-CO");e.editing=!1,z().fire({title:"\xbfDesea actualizar?",html:`\n      <p style="margin:2px 0;"><strong>Medicamento:</strong> ${e.nombre}</p>\n      <p style="margin:2px 0;"><strong>Invima:</strong> ${e.invima}</p>\n      <p style="margin:2px 0;"><strong>Laboratorio:</strong> ${e.laboratorio}</p>\n      <p style="margin:2px 0;"><strong>Lote:</strong> ${e.lote}</p>\n      <p style="margin:2px 0;"><strong>Fecha Vencimiento:</strong> ${i}</p>\n     <p style="margin:2px 0;"><strong>Stock m\xednimo:</strong> ${e.stopMinimo}</p>\n      `,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Actualizar!"}).then(o=>{o.isConfirmed&&this.servicio.updateMedicamentoBodega(e).subscribe(a=>{z().fire({icon:"success",title:"Actualizaci\xf3n exitosa",text:`Los datos del medicamento ${e.nombre} de la bodega seleccionada fueron actualizados correctamente.`})},a=>{console.error("\u274c Error actualizando el registro",a),z().fire("Error","No se pudo actualizar el registro.","error")})})}cancelEdicion(e){e.editing=!1}eliminarMedicamentoBodega(e){e.cantidad<=0?z().fire({title:"Desea eliminar?",text:`El medicamento ${e.nombre} de la bodega  ${e.nombreBodega} en la base de datos.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&z().fire({icon:"info",title:"Falta de permisos",text:`No tienes permisos para eliminar un medicamento de la bodega  ${e.nombreBodega} comunicate con el \xe1rea de sistemas para el proceso.`})}):z().fire({icon:"info",title:"Falta de permisos",text:`No tienes permisos para eliminar un medicamento de la bodega  ${e.nombreBodega} comunicate con el \xe1rea de sistemas para el proceso.`})}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(Ts),X(ea),X(Us))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-medicamentobodega"]],inputs:{datoRecibido:"datoRecibido"},decls:5,vars:4,consts:[[1,"container","mt-1"],[1,"mb-3",3,"formGroup"],[4,"ngIf"],["class","alert alert-info my-2",4,"ngIf"],[1,"row","g-2","align-items-end"],[1,"col-md-6"],[1,"form-label","mb-1","fw-bold"],["formControlName","idBodega",1,"form-select","form-select-sm"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"input-group"],[1,"input-group-text","bg-white","border-end-0"],[1,"text-info"],["type","text","formControlName","listFilter","placeholder","Ingrese el nombre del medicamento",1,"form-control","form-control-sm","border-start-0"],[1,"col-md-2"],[1,"alert","alert-info","text-center","py-2","mb-0"],[3,"ngValue"],[1,"alert","alert-info","my-2"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[4,"ngFor","ngForOf"],[2,"color","green","text-align","right"],[2,"color","red","text-align","right"],[2,"text-align","right"],["title","Editar","class","puntero","style","font-size: 16px; color: #009A94;",3,"click",4,"ngIf"],["title","Guardar","class","puntero",3,"ngStyle","click",4,"ngIf"],["class","puntero","title","Cancelar edici\xf3n",3,"ngStyle","click",4,"ngIf"],["type","text","placeholder","Invima",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","Laboratorio",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","Lote",1,"form-control",3,"ngModel","ngModelChange"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],["type","number","placeholder","Stock",1,"form-control",3,"ngModel","ngModelChange"],["type","number","class","form-control","placeholder","Pendiente",3,"ngModel","ngModelChange",4,"ngIf"],["type","number","placeholder","Pendiente",1,"form-control",3,"ngModel","ngModelChange"],["title","Editar",1,"puntero",2,"font-size","16px","color","#009A94",3,"click"],["title","Guardar",1,"puntero",3,"ngStyle","click"],["title","Cancelar edici\xf3n",1,"puntero",3,"ngStyle","click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"div",1),oe(2,Mfe,23,2,"div",2),u(),oe(3,kfe,2,0,"div",3),oe(4,jfe,26,1,"div",2),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(1),N("ngIf",(null==i.listaItemBodega?null:i.listaItemBodega.length)>0),w(1),N("ngIf",0==(null==i.listaItemBodega?null:i.listaItemBodega.length)),w(1),N("ngIf",(null==i.listaItemBodega?null:i.listaItemBodega.length)>0))},dependencies:[ho,Fi,Jo,Wo,cl,ul,vo,wd,Ss,No,zo,bo,Ro,Ag,Sc],styles:[".card-header[_ngcontent-%COMP%]{background:linear-gradient(to right,#71E0D2,#5D8FA5);color:#fff;border-radius:10px;display:flex;justify-content:space-between;align-items:center}.text-container[_ngcontent-%COMP%]{flex:1}.icons-container[_ngcontent-%COMP%]{display:flex;gap:10px}.puntero[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]     .mat-tooltip{background-color:#f44336;color:#fff}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;flex-wrap:wrap}.card-title[_ngcontent-%COMP%]{margin-right:1rem;margin-left:10px;white-space:nowrap}.input-group-text[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.form-control[_ngcontent-%COMP%]{flex:1;border-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:25px}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{border-top-left-radius:25px;border-bottom-left-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control.border-end-0[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.align-center[_ngcontent-%COMP%]{display:flex;align-items:center}.bodega-nombre[_ngcontent-%COMP%]{margin-right:10px;font-weight:700}.search-input[_ngcontent-%COMP%]{width:300px;margin-left:auto;border-top-left-radius:30px;border-bottom-left-radius:30px;border-right:none;padding:.375rem 1rem;display:flex;align-items:center}"]})}return t})(),e8=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint="http://52.87.239.13:3001/lead"}enviarMensaje(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Vfe(t,n){if(1&t&&(d(0,"option",29),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),Qt(" ",e.nombre," ")}}function Ufe(t,n){if(1&t&&(d(0,"div",30)(1,"div",31)(2,"small")(3,"strong"),h(4,"Mol\xe9culas con pendientes:"),u(),h(5),u()()()),2&t){const e=ae();w(5),Qt(" ",(null==e.listaPendienteBodega?null:e.listaPendienteBodega.length)||0," ")}}function Hfe(t,n){1&t&&(d(0,"div",32),h(1," No hay medicamentos penidientes, asociados a esta bodega en la fecha seleccionada! "),u())}function zfe(t,n){1&t&&(d(0,"mat-icon",44),Ns(),d(1,"svg",45),qe(2,"path",46),u()()),2&t&&(ae(),N("matMenuTriggerFor",go(26)))}const $fe=function(t,n,e,r){return["/menu/pacientependiente",t,n,e,r]},Wfe=function(){return{color:"red"}},qfe=function(){return{color:"#2BB6D7"}};function Gfe(t,n){if(1&t){const e=Fn();d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td",36)(12,"strong"),h(13),u()(),d(14,"td"),h(15),Hi(16,"date"),u(),d(17,"td",37)(18,"strong"),h(19),u()(),d(20,"td")(21,"div",38)(22,"mat-icon",39),h(23," people_outline "),u(),oe(24,zfe,3,1,"mat-icon",40),d(25,"mat-menu",null,41)(27,"button",42),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mensajesWSPave(o.idBodega,o.idMedicamento))}),d(28,"mat-icon",43),h(29,"people_outline"),u(),d(30,"span"),h(31,"Solo pacientes PAVE"),u()(),d(32,"button",42),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mensajesWSTodo(o.idBodega,o.idMedicamento))}),d(33,"mat-icon",43),h(34,"people_outline"),u(),d(35,"span"),h(36,"A todos los pacientes"),u()()()()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);w(2),_e(r+1),w(2),_e(e.cum),w(2),_e(e.idMedicamento),w(2),_e(e.nombre),w(2),_e(e.forma),w(3),_e(e.cantidad),w(2),_e(Xo(16,12,e.ultFecIngreso,"dd/MM/YYYY")),w(4),_e(e.pendiente),w(3),N("routerLink",function pM(t,n,e,r,i,o,a){return vM(fn(),Ho(),t,n,e,r,i,o,a)}(15,$fe,e.idBodega,e.idMedicamento,i.generalForm.value.fechainicial,i.generalForm.value.fechafinal)),w(2),N("ngIf",i.tieneAcceso(2)&&e.cantidad>0),w(4),N("ngStyle",Nt(20,Wfe)),w(5),N("ngStyle",Nt(21,qfe))}}function Yfe(t,n){if(1&t&&(d(0,"div")(1,"table",33)(2,"thead",34)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Cum"),u(),d(8,"th"),h(9,"ID"),u(),d(10,"th"),h(11,"Nombre "),u(),d(12,"th"),h(13,"Presentaci\xf3n"),u(),d(14,"th"),h(15,"Existencia"),u(),d(16,"th"),h(17,"Ult. Fecha Dotaci\xf3n"),u(),d(18,"th"),h(19,"Pendiente"),u(),d(20,"th"),h(21,"Gesti\xf3n"),u()()(),d(22,"tbody"),oe(23,Gfe,37,22,"tr",35),u()()()),2&t){const e=ae();w(23),N("ngForOf",e.listaPendienteBodegaFiltro)}}let t8=(()=>{class t{constructor(e,r,i,o){this.servicio=e,this.activatedRoute=r,this.whatsappService=i,this.fb=o,this.listaPendienteBodega=[],this.listaPendienteBodegaFiltro=[],this.datoRecibido=NaN,this.listaPaciente=[],this.enviandoMensajes=!1,this.mayorExistencia="";const a=new Date,s=new Date(a);s.setDate(a.getDate()-90),this.generalForm=this.fb.group({idBodega:[""],fechainicial:[s.toISOString().split("T")[0]],fechafinal:[a.toISOString().split("T")[0]],listFilter:[""],existenciaPendiente:[""]})}ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{const r=e.get("id");r&&!isNaN(Number(r))?(this.parametro=Number(r),this.buscarRegistro(this.parametro)):(this.parametro=parseInt(sessionStorage.getItem("bodega")||"0",10),this.parametro&&!isNaN(this.parametro)&&this.buscarRegistro(this.parametro))}),this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e.filter(r=>!0===r.dispensa),this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);return 0===o?r.puntoEntrega.localeCompare(i.puntoEntrega):o}),this.parametro&&this.generalForm.patchValue({idBodega:+this.parametro},{emitEvent:!1})},e=>{console.error(e)}),this.generalForm.get("listFilter").valueChanges.pipe(xo(300),Di(e=>this.buscarMedicamentos(e))).subscribe(e=>{this.listaPendienteBodegaFiltro=e}),this.generalForm.get("idBodega").valueChanges.subscribe(e=>{e&&(this.parametro=e,this.buscarRegistro(e))}),this.generalForm.patchValue({idBodega:this.datoRecibido})}buscarRegistro(e){var r=this;return(0,hi.Z)(function*(){r.listaPendienteBodega=[],r.listaPendienteBodegaFiltro=[],z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),r.servicio.getMedicamentosBodegaPendiente(e,r.generalForm.get("fechainicial")?.value,r.generalForm.get("fechafinal")?.value).subscribe(i=>{r.listaPendienteBodega=i.map(o=>({...o,estado:!1,editing:!1})),r.listaPendienteBodega.sort((o,a)=>o.nombre.localeCompare(a.nombre)),r.listaPendienteBodegaFiltro=r.listaPendienteBodega,z().close()},i=>{console.error("\u274c Error cargando registros",i),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})})()}buscarMedicamentos(e){return e&&e.length>3?(e=e.toLocaleLowerCase(),On(this.listaPendienteBodega.filter(i=>i.nombre.toLowerCase().includes(e)))):On(this.listaPendienteBodega)}buscarPacientePendiente(e,r){return new Promise((i,o)=>{this.servicio.getPacientePendiente(e,this.generalForm.get("fechainicial")?.value,this.generalForm.get("fechafinal")?.value,r).subscribe(a=>{this.listaPaciente=a,i()},a=>{console.error("\u274c Error buscando pacientes:",a),z().fire("Error","No se pudieron cargar los pacientes.","error"),o(a)})})}mensajesWSPave(e,r){var i=this;return(0,hi.Z)(function*(){yield i.buscarPacientePendiente(e,r),i.listaPaciente=i.listaPaciente.filter(o=>"SI"===o.pave),0!==i.listaPaciente.length?i.enviarMensajesConRetraso():yield z().fire("Sin pacientes PAVE","No se encontraron pacientes PAVE con pendientes de este medicamento!.","info")})()}mensajesWSTodo(e,r){var i=this;return(0,hi.Z)(function*(){yield i.buscarPacientePendiente(e,r),0!==i.listaPaciente.length?i.enviarMensajesConRetraso():yield z().fire("Sin pacientes","No se encontraron pacientes con pendientes, para enviar el mensaje!","warning")})()}enviarMensajesConRetraso(){var e=this;return(0,hi.Z)(function*(){if(!(yield z().fire({title:"\xbfConfirmar env\xedo masivo?",html:`Se enviar\xe1n mensajes de WhatsApp a <strong>${e.listaPaciente.length}</strong> pacientes.<br><br>\xbfDeseas continuar?`,icon:"question",showCancelButton:!0,confirmButtonText:"S\xed, enviar",cancelButtonText:"Cancelar"})).isConfirmed)return;e.enviandoMensajes=!0;let i=0;z().fire({title:"Enviando mensajes...",html:`0 de ${e.listaPaciente.length} enviados`,allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});try{for(const o of e.listaPaciente){const a=`Hola *${o.pNombre}*! \n${o.bodega} te informa que el pendiente Nro. *${o.idFormula}* de tu medicamento. \n\u{1f48a}${o.nombreMedicamento} \nYa se encuentra disponible para que lo puedas recoger, en tu punto de entrega. \nRecuerde que debe traer su volante de pendiente. \n\n*POR FAVOR NO RESPONDER ESTE MENSAJE*`,s="57"+o?.telefono.replace(/\s/g,"");if(e.celularValido(o?.telefono.replace(/\s/g,"")))try{i++,yield e.whatsappService.enviarMensaje({phone:s,message:a}).toPromise()}catch(l){console.error(`\u274c Error enviando a ${s}`,l)}else console.warn(`\u26a0\ufe0f Tel\xe9fono inv\xe1lido: ${o.telefono}`);z().update({html:`<strong>${i}</strong> de <strong>${e.listaPaciente.length}</strong> mensajes enviados`}),yield new Promise(l=>setTimeout(l,2e3))}}catch(o){console.error("\u274c Error general enviando mensajes:",o),yield z().fire("Error","Ocurri\xf3 un error durante el env\xedo de mensajes.","error")}finally{e.enviandoMensajes=!1,z().close()}yield z().fire("\u2714\ufe0f Mensajes procesados",`Se enviaron <strong>${i}</strong> mensajes de un total de <strong>${e.listaPaciente.length}</strong>.<br>Los dem\xe1s presentaron inconvenientes en el n\xfamero de celular.`,"success")})()}celularValido(e){return/^[3][0-9]{9}$/.test(e)}onMayorExistencia(e){e.target.checked?(this.listaPendienteBodegaFiltro=this.listaPendienteBodega.filter(r=>r.cantidad>r.pendiente),this.mayorExistencia=this.listaPendienteBodegaFiltro.length.toString()):(this.listaPendienteBodegaFiltro=this.listaPendienteBodega,this.mayorExistencia="")}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(Ts),X(Us),X(e8),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-pendientes"]],inputs:{datoRecibido:"datoRecibido"},decls:42,vars:6,consts:[[1,"container","mt-2"],[1,"px-2",3,"formGroup"],[1,"row","align-items-end","g-2","mb-2"],[1,"col-md-3"],[1,"form-label","mb-1","fw-bold"],["formControlName","idBodega",1,"form-select","form-select-sm"],["selected","","value","0"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"d-flex","gap-1"],["type","date","formControlName","fechainicial",1,"form-control","form-control-sm"],[1,"px-1","text-muted"],["type","date","formControlName","fechafinal",1,"form-control","form-control-sm"],[1,"col-md-2","d-flex","align-items-end"],["type","button",1,"btn","btn-info","w-100","d-flex","align-items-center","justify-content-center",3,"click"],[1,"me-1"],["class","col-md-3 d-flex align-items-end",4,"ngIf"],[1,"row","g-2"],[1,"col-md-12"],[1,"d-flex","align-items-center"],[1,"input-group","flex-grow-1","me-2"],[1,"input-group-text","bg-white","border-end-0"],[1,"text-info"],["type","text","formControlName","listFilter","placeholder","Digite el nombre del medicamento",1,"form-control","form-control-sm","border-start-0"],[1,"form-check","d-flex","align-items-center","ms-auto"],["type","checkbox","formControlName","existenciaPendiente",1,"form-check-input","me-1",3,"change"],["for","portabilidad",1,"form-check-label","small"],["class","alert alert-info my-2",4,"ngIf"],[4,"ngIf"],[3,"ngValue"],[1,"col-md-3","d-flex","align-items-end"],[1,"alert","alert-danger","d-flex","align-items-center","justify-content-center","mb-0","w-100","py-2"],[1,"alert","alert-info","my-2"],[1,"table","table-striped","table-hover","table-sm","mt-2"],[1,"thead-colored"],[4,"ngFor","ngForOf"],[2,"color","green","text-align","right"],[2,"color","red","text-align","right"],[2,"display","flex","align-items","center","gap","2px"],["title","Ver detalle de pacientes",1,"puntero",2,"font-size","18px","color","black",3,"routerLink"],["class","puntero","title","Enviar mensaje","style","font-size: 20px; color: #25D366;",3,"matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click"],[3,"ngStyle"],["title","Enviar mensaje",1,"puntero",2,"font-size","20px","color","#25D366",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","height","20","viewBox","0 0 448 512","fill","currentColor"],["d","M380.9 97.1C339 55.1 283.2 32 224.2 32c-115 0-208 93-208 208 \n                                        0 36.7 9.7 72.4 28.1 103.9L2.5 470.1c-2.2 6.5-.4 13.7 4.5 \n                                        18.5 3.6 3.6 8.4 5.5 13.1 5.5 2 0 4.1-.3 6-1l119.8-38.2c30.4 \n                                        16.6 64.7 25.4 99.1 25.4h.1c115 0 208-93 208-208 \n                                        0-55.6-21.6-107.9-60.2-146.2zM224.2 438.6c-30.5 0-60.6-8.2-86.7-23.7l-6.2-3.7-71.2 \n                                        22.7 22.9-69.3-4.1-6.4c-17.7-27.6-27-59.5-27-92.2 \n                                        0-95.1 77.4-172.4 172.5-172.4 46 0 89.2 17.9 121.7 \n                                        50.4s50.3 75.8 50.3 121.6c.1 95.1-77.3 172.6-172.2 \n                                        172.6zm101.4-138.1c-5.5-2.8-32.7-16.1-37.8-17.9-5.1-1.9-8.8-2.8-12.6 \n                                        2.8s-14.5 17.9-17.8 21.6c-3.3 3.7-6.5 4.2-12 \n                                        1.4s-23.4-8.6-44.6-27.4c-16.5-14.7-27.6-32.9-30.8-38.4-3.2-5.6-.3-8.6 \n                                        2.4-11.4 2.5-2.6 5.6-6.6 8.4-9.9 2.8-3.3 3.7-5.6 \n                                        5.6-9.3s.9-7-0.5-9.9c-1.4-2.8-12.6-30.3-17.3-41.4-4.5-10.8-9.1-9.3-12.6-9.5-3.3-.2-7.1-.2-10.9-.2s-10.1 \n                                        1.4-15.4 7c-5.3 5.6-20.2 19.7-20.2 48.1s20.7 55.8 \n                                        23.5 59.7c2.8 3.7 40.7 62.1 98.6 87.2 13.8 5.9 \n                                        24.6 9.4 33 12 13.9 4.4 26.5 3.8 36.5 2.3 11.1-1.7 \n                                        32.7-13.3 37.3-26.2 4.6-12.9 4.6-23.9 3.2-26.2-1.3-2.2-5-3.6-10.5-6.3z"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"label",4),h(5,"Bodega de pendiente"),u(),d(6,"select",5)(7,"option",6),h(8,"TODAS LAS BODEGAS"),u(),oe(9,Vfe,2,2,"option",7),u()(),d(10,"div",8)(11,"label",4),h(12,"Rango de fechas"),u(),d(13,"div",9),qe(14,"input",10),d(15,"span",11),h(16,"al"),u(),qe(17,"input",12),u()(),d(18,"div",13)(19,"button",14),De("click",function(){return i.buscarRegistro(i.parametro)}),d(20,"mat-icon",15),h(21,"search"),u(),h(22," Buscar "),u()(),oe(23,Ufe,6,1,"div",16),u(),d(24,"div",17)(25,"div",18)(26,"label",4),h(27,"Buscar medicamento"),u(),d(28,"div",19)(29,"div",20)(30,"span",21)(31,"mat-icon",22),h(32,"search"),u()(),qe(33,"input",23),u(),d(34,"div",24)(35,"input",25),De("change",function(a){return i.onMayorExistencia(a)}),u(),d(36,"label",26),h(37," Ver medicamentos con existencias mayor que pendientes "),d(38,"strong"),h(39),u()()()()()()(),oe(40,Hfe,2,0,"div",27),oe(41,Yfe,24,1,"div",28),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(8),N("ngForOf",i.listaregistros),w(14),N("ngIf",(null==i.listaPendienteBodega?null:i.listaPendienteBodega.length)>0),w(16),_e(i.mayorExistencia),w(1),N("ngIf",0==(null==i.listaPendienteBodega?null:i.listaPendienteBodega.length)),w(1),N("ngIf",(null==i.listaPendienteBodega?null:i.listaPendienteBodega.length)>0))},dependencies:[ho,Fi,Jo,Hs,n0,Of,r0,Wo,Vs,cl,ul,vo,sl,Ss,No,zo,bo,Ro,Sc],styles:[".input-ancho[_ngcontent-%COMP%]{width:80px!important}.form-control[_ngcontent-%COMP%]{flex:1;border-radius:25px}.align-center[_ngcontent-%COMP%]{display:flex;align-items:center}.bodega-nombre[_ngcontent-%COMP%]{margin-right:10px;font-weight:700}.search-input[_ngcontent-%COMP%]{width:300px;margin-left:auto;border-top-left-radius:30px;border-bottom-left-radius:30px;border-right:none;padding:.375rem 1rem;display:flex;align-items:center}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:25px}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{border-top-left-radius:25px;border-bottom-left-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control.border-end-0[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.card-header[_ngcontent-%COMP%]{background:linear-gradient(to right,#71E0D2,#5D8FA5);color:#fff;border-radius:10px;display:flex;justify-content:space-between;align-items:center}.icons-container[_ngcontent-%COMP%]{display:flex;gap:10px}mat-icon[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]     .mat-tooltip{background-color:#f44336;color:#fff}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;flex-wrap:wrap}.card-title[_ngcontent-%COMP%]{margin-right:1rem;margin-left:10px;white-space:nowrap}.input-group-text[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}"]})}return t})(),Xfe=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/usuario"}getRegistroId(e){const r=(new Pn).set("username",e);return this.http.get(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(401!=i.status&&i.error.mensaje&&console.error(i.error.mensaje),It(i))))}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}delete(e){const r=(new Pn).set("username",e);return this.http.delete(`${this.urlEndPoint}`,{params:r}).pipe(Pt(i=>(i.error.mensaje&&console.error(i.error.mensaje),It(i))))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),nA=(()=>{class t{constructor(e){this.router=e,this.isAuthenticated=!1}checkLoginStatus(){return"true"===sessionStorage.getItem("loggedIn")}login(){sessionStorage.setItem("loggedIn","true"),this.isAuthenticated=!0}logout(){sessionStorage.removeItem("loggedIn"),this.isAuthenticated=!1,this.router.navigate(["/login"])}isLoggedIn(){return this.isAuthenticated}static#e=this.\u0275fac=function(r){return new(r||t)(it(Ds))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Kfe(t,n){if(1&t&&(d(0,"option",15),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),fo("",e.nombre," - ",e.puntoEntrega,"")}}function Zfe(t,n){1&t&&(d(0,"small"),h(1,"Dispensario es requerido."),u())}function Qfe(t,n){if(1&t&&(d(0,"div"),oe(1,Zfe,2,0,"small",7),u()),2&t){const e=ae();let r;w(1),N("ngIf",null==(r=e.loginForm.get("idBodega"))||null==r.errors?null:r.errors.required)}}function Jfe(t,n){1&t&&(d(0,"small"),h(1,"El Usuario es requerido."),u())}function ehe(t,n){if(1&t&&(d(0,"div"),oe(1,Jfe,2,0,"small",7),u()),2&t){const e=ae();let r;w(1),N("ngIf",null==(r=e.loginForm.get("usuario"))||null==r.errors?null:r.errors.required)}}function the(t,n){1&t&&(d(0,"small"),h(1,"Password es requerido."),u())}function nhe(t,n){1&t&&(d(0,"small"),h(1,"Contrase\xf1a debe ser mayor a 6 characteres de longitud."),u())}function rhe(t,n){if(1&t&&(d(0,"div"),oe(1,the,2,0,"small",7),oe(2,nhe,2,0,"small",7),u()),2&t){const e=ae();let r,i;w(1),N("ngIf",null==(r=e.loginForm.get("password"))||null==r.errors?null:r.errors.required),w(1),N("ngIf",null==(i=e.loginForm.get("password"))||null==i.errors?null:i.errors.minlength)}}let ihe=(()=>{class t{constructor(e,r,i,o,a){this.fb=e,this.servicio=r,this.usuarioservicio=i,this.router=o,this.authservicio=a,this.loginForm=this.fb.group({idBodega:["",[Zn.required]],usuario:["",[Zn.required]],password:["",[Zn.required,Zn.minLength(6)]]})}ngOnInit(){this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e,this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);if(0===o){const a=r.puntoEntrega.localeCompare(i.puntoEntrega);return 0===a?r.puntoEntrega.localeCompare(i.puntoEntrega):a}return o})},e=>{console.error(e)})}onSubmit(){this.loginForm.valid?this.usuarioservicio.getRegistroId(this.loginForm.get("usuario")?.value).subscribe(e=>{e.password===this.loginForm.get("password")?.value&&e.idBodega===this.loginForm.get("idBodega")?.value?(sessionStorage.setItem("nombre",e.nombre),sessionStorage.setItem("bodega",e.idBodega),sessionStorage.setItem("nivel",e.nivel),this.authservicio.login(),this.router.navigate(["/menu"])):z().fire({icon:"warning",title:"Verificar",text:"Las credenciales suministradas no corresponden con el usuario, por favor verificar su contrase\xf1a y su dispensario"})},e=>{console.error(e),z().fire({icon:"error",title:"Error",text:"El usuario ingresado no esta registrado en la base de datos!"})}):(console.log("Form Not Valid"),z().fire({icon:"warning",title:"Verificar",text:"Faltan datos en el formulario para continuar ingresar"}))}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(Ts),X(Xfe),X(Ds),X(nA))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-login"]],decls:27,vars:6,consts:[[1,"login-container"],[1,"login-form"],[3,"formGroup","ngSubmit"],["for","idBodega"],["formControlName","idBodega","required","",1,"form-select"],["selected","","value",""],[3,"ngValue",4,"ngFor","ngForOf"],[4,"ngIf"],["for","Usuario"],["id","usuario","formControlName","usuario","type","number",1,"form-select"],["for","password"],["id","password","formControlName","password","type","password",1,"form-select"],["type","submit",1,"btn-custom-gradient",3,"disabled"],[1,"login-image"],["src","assets/logosism.png","alt","Login Image"],[3,"ngValue"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"div",1)(2,"h2"),h(3,"Iniciar Sesi\xf3n"),u(),d(4,"form",2),De("ngSubmit",function(){return i.onSubmit()}),d(5,"div")(6,"label",3),h(7,"Dispensario de medicamento:"),u(),d(8,"select",4)(9,"option",5),h(10,"Seleccione la bodega"),u(),oe(11,Kfe,2,3,"option",6),u(),oe(12,Qfe,2,1,"div",7),u(),d(13,"div")(14,"label",8),h(15,"Usuario:"),u(),qe(16,"input",9),oe(17,ehe,2,1,"div",7),u(),d(18,"div")(19,"label",10),h(20,"Password:"),u(),qe(21,"input",11),oe(22,rhe,3,2,"div",7),u(),d(23,"button",12),h(24,"Ingresar"),u()()(),d(25,"div",13),qe(26,"img",14),u()()),2&r){let o,a,s;w(4),N("formGroup",i.loginForm),w(7),N("ngForOf",i.listaregistros),w(1),N("ngIf",(null==(o=i.loginForm.get("idBodega"))?null:o.invalid)&&(null==(o=i.loginForm.get("idBodega"))?null:o.touched)),w(5),N("ngIf",(null==(a=i.loginForm.get("usuario"))?null:a.invalid)&&(null==(a=i.loginForm.get("usuario"))?null:a.touched)),w(5),N("ngIf",(null==(s=i.loginForm.get("password"))?null:s.invalid)&&(null==(s=i.loginForm.get("password"))?null:s.touched)),w(1),N("disabled",i.loginForm.invalid)}},dependencies:[ho,Fi,Vs,cl,ul,vo,wd,Ss,No,zo,Dc,bo,Ro],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:20px;height:100vh;background-color:#f5f5f5}.login-form[_ngcontent-%COMP%]{flex:1;max-width:400px;background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 10px #0000001a;margin-right:20px}.login-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:20px;text-align:center}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px}.btn-custom-gradient[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:30px;width:100%;padding:15px;background-color:#007bff;border:none;color:#fff;border-radius:4px;cursor:pointer;font-size:18px;text-align:center}.btn-custom-gradient[_ngcontent-%COMP%]:hover{background-color:#0056b3}.btn-custom-gradient[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}small[_ngcontent-%COMP%]{color:red;font-size:12px}.login-image[_ngcontent-%COMP%]{flex:1;text-align:center}.login-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:80%;height:auto;border-radius:8px;display:block;margin-left:auto;margin-right:auto}@media (max-width: 768px){.login-container[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;align-items:center}.login-form[_ngcontent-%COMP%]{margin-right:0;margin-bottom:20px;display:flex}.login-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:60%}}"]})}return t})();const ohe=["*",[["mat-toolbar-row"]]],ahe=["*","mat-toolbar-row"],she=Jg(class{constructor(t){this._elementRef=t}});let lhe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),t})(),n8=(()=>{class t extends she{constructor(e,r,i){super(e),this._platform=r,this._document=i}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Ka),X(si))},t.\u0275cmp=pr({type:t,selectors:[["mat-toolbar"]],contentQueries:function(e,r,i){if(1&e&&so(i,lhe,5),2&e){let o;Er(o=Sr())&&(r._toolbarRows=o)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,r){2&e&&Ai("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",0===r._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[_r],ngContentSelectors:ahe,decls:2,vars:0,template:function(e,r){1&e&&(Fa(ohe),Ri(0),Ri(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}\n"],encapsulation:2,changeDetection:0}),t})(),che=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[Wi],Wi]}),t})();const Ex=["*"];function uhe(t,n){if(1&t){const e=Fn();d(0,"div",2),De("click",function(){return ht(e),pt(ae()._onBackdropClicked())}),u()}2&t&&Ai("mat-drawer-shown",ae()._isShowingBackdrop())}function dhe(t,n){1&t&&(d(0,"mat-drawer-content"),Ri(1,2),u())}const fhe=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],hhe=["mat-drawer","mat-drawer-content","*"];function phe(t,n){if(1&t){const e=Fn();d(0,"div",2),De("click",function(){return ht(e),pt(ae()._onBackdropClicked())}),u()}2&t&&Ai("mat-drawer-shown",ae()._isShowingBackdrop())}function mhe(t,n){1&t&&(d(0,"mat-sidenav-content",3),Ri(1,2),u())}const ghe=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],_he=["mat-sidenav","mat-sidenav-content","*"],r8={transformDrawer:Zg("transform",[Gu("open, open-instant",wa({transform:"none",visibility:"visible"})),Gu("void",wa({"box-shadow":"none",visibility:"hidden"})),au("void => open-instant",ou("0ms")),au("void <=> open, open-instant => void",ou("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},bhe=new U("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function yhe(){return!1}}),rA=new U("MAT_DRAWER_CONTAINER");let Sx=(()=>{class t extends fx{constructor(e,r,i,o,a){super(i,o,a),this._changeDetectorRef=e,this._container=r}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return t.\u0275fac=function(e){return new(e||t)(X(Zo),X(Ir(()=>o8)),X($r),X(dx),X(Wr))},t.\u0275cmp=pr({type:t,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(e,r){2&e&&A1("margin-left",r._container._contentMargins.left,"px")("margin-right",r._container._contentMargins.right,"px")},features:[_r],ngContentSelectors:Ex,decls:1,vars:0,template:function(e,r){1&e&&(Fa(),Ri(0))},encapsulation:2,changeDetection:0}),t})(),i8=(()=>{class t{constructor(e,r,i,o,a,s,l,c){this._elementRef=e,this._focusTrapFactory=r,this._focusMonitor=i,this._platform=o,this._ngZone=a,this._interactivityChecker=s,this._doc=l,this._container=c,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Bt,this._animationEnd=new Bt,this._animationState="void",this.openedChange=new Vr(!0),this._openedStream=this.openedChange.pipe(_o(f=>f),gr(()=>{})),this.openedStart=this._animationStarted.pipe(_o(f=>f.fromState!==f.toState&&0===f.toState.indexOf("open")),Zy(void 0)),this._closedStream=this.openedChange.pipe(_o(f=>!f),gr(()=>{})),this.closedStart=this._animationStarted.pipe(_o(f=>f.fromState!==f.toState&&"void"===f.toState),Zy(void 0)),this._destroyed=new Bt,this.onPositionChanged=new Vr,this._modeChanged=new Bt,this.openedChange.subscribe(f=>{f?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{lu(this._elementRef.nativeElement,"keydown").pipe(_o(f=>27===f.keyCode&&!this.disableClose&&!Ad(f)),Co(this._destroyed)).subscribe(f=>this._ngZone.run(()=>{this.close(),f.stopPropagation(),f.preventDefault()}))}),this._animationEnd.pipe(_D((f,v)=>f.fromState===v.fromState&&f.toState===v.toState)).subscribe(f=>{const{fromState:v,toState:E}=f;(0===E.indexOf("open")&&"void"===v||"void"===E&&0===v.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(e){(e="end"===e?"end":"start")!=this._position&&(this._position=e,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(e){this._disableClose=Bo(e)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(e){("true"===e||"false"===e)&&(e=Bo(e)),this._autoFocus=e}get opened(){return this._opened}set opened(e){this.toggle(Bo(e))}_forceFocus(e,r){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{e.addEventListener("blur",()=>e.removeAttribute("tabindex")),e.addEventListener("mousedown",()=>e.removeAttribute("tabindex"))})),e.focus(r)}_focusByCssSelector(e,r){let i=this._elementRef.nativeElement.querySelector(e);i&&this._forceFocus(i,r)}_takeFocus(){if(!this._focusTrap)return;const e=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{!r&&"function"==typeof this._elementRef.nativeElement.focus&&e.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(e){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,e):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const e=this._doc?.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(e){return this.toggle(!0,e)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(e=!this.opened,r){e&&r&&(this._openedVia=r);const i=this._setOpen(e,!e&&this._isFocusWithinDrawer(),this._openedVia||"program");return e||(this._openedVia=null),i}_setOpen(e,r,i){return this._opened=e,e?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",r&&this._restoreFocus(i)),this._updateFocusTrapState(),new Promise(o=>{this.openedChange.pipe(ra(1)).subscribe(a=>o(a?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_animationStartListener(e){this._animationStarted.next(e)}_animationDoneListener(e){this._animationEnd.next(e)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(DR),X(fm),X(Ka),X(Wr),X(ED),X(si,8),X(rA,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(e,r){1&e&&lv("@transform.start",function(o){return r._animationStartListener(o)})("@transform.done",function(o){return r._animationDoneListener(o)}),2&e&&(kr("align",null),uv("@transform",r._animationState),Ai("mat-drawer-end","end"===r.position)("mat-drawer-over","over"===r.mode)("mat-drawer-push","push"===r.mode)("mat-drawer-side","side"===r.mode)("mat-drawer-opened",r.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Ex,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(e,r){1&e&&(Fa(),d(0,"div",0),Ri(1),u())},dependencies:[fx],encapsulation:2,data:{animation:[r8.transformDrawer]},changeDetection:0}),t})(),o8=(()=>{class t{constructor(e,r,i,o,a,s=!1,l){this._dir=e,this._element=r,this._ngZone=i,this._changeDetectorRef=o,this._animationMode=l,this._drawers=new Hp,this.backdropClick=new Vr,this._destroyed=new Bt,this._doCheckSubject=new Bt,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Bt,e&&e.change.pipe(Co(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),a.change().pipe(Co(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=s}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(e){this._autosize=Bo(e)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(e){this._backdropOverride=null==e?null:Bo(e)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(ec(this._allDrawers),Co(this._destroyed)).subscribe(e=>{this._drawers.reset(e.filter(r=>!r._container||r._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(ec(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(e=>{this._watchDrawerToggle(e),this._watchDrawerPosition(e),this._watchDrawerMode(e)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(xo(10),Co(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(e=>e.open())}close(){this._drawers.forEach(e=>e.close())}updateContentMargins(){let e=0,r=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._getWidth();else if("push"==this._left.mode){const i=this._left._getWidth();e+=i,r-=i}if(this._right&&this._right.opened)if("side"==this._right.mode)r+=this._right._getWidth();else if("push"==this._right.mode){const i=this._right._getWidth();r+=i,e-=i}e=e||null,r=r||null,(e!==this._contentMargins.left||r!==this._contentMargins.right)&&(this._contentMargins={left:e,right:r},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(e){e._animationStarted.pipe(_o(r=>r.fromState!==r.toState),Co(this._drawers.changes)).subscribe(r=>{"open-instant"!==r.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==e.mode&&e.openedChange.pipe(Co(this._drawers.changes)).subscribe(()=>this._setContainerClass(e.opened))}_watchDrawerPosition(e){e&&e.onPositionChanged.pipe(Co(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(ra(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(e){e&&e._modeChanged.pipe(Co(Ea(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(e){const r=this._element.nativeElement.classList,i="mat-drawer-container-has-open";e?r.add(i):r.remove(i)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(e=>{"end"==e.position?this._end=e:this._start=e}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(e=>e&&!e.disableClose&&this._canHaveBackdrop(e)).forEach(e=>e._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(e){return"side"!==e.mode||!!this._backdropOverride}_isDrawerOpen(e){return null!=e&&e.opened}}return t.\u0275fac=function(e){return new(e||t)(X(su,8),X($r),X(Wr),X(Zo),X(e0),X(bhe),X(kl,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-drawer-container"]],contentQueries:function(e,r,i){if(1&e&&(so(i,Sx,5),so(i,i8,5)),2&e){let o;Er(o=Sr())&&(r._content=o.first),Er(o=Sr())&&(r._allDrawers=o)}},viewQuery:function(e,r){if(1&e&&Ko(Sx,5),2&e){let i;Er(i=Sr())&&(r._userContent=i.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(e,r){2&e&&Ai("mat-drawer-container-explicit-backdrop",r._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[ki([{provide:rA,useExisting:t}])],ngContentSelectors:hhe,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(e,r){1&e&&(Fa(fhe),oe(0,uhe,1,2,"div",0),Ri(1),Ri(2,1),oe(3,dhe,2,0,"mat-drawer-content",1)),2&e&&(N("ngIf",r.hasBackdrop),w(3),N("ngIf",!r._content))},dependencies:[Sx,Fi],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),t})(),iA=(()=>{class t extends Sx{constructor(e,r,i,o,a){super(e,r,i,o,a)}}return t.\u0275fac=function(e){return new(e||t)(X(Zo),X(Ir(()=>aA)),X($r),X(dx),X(Wr))},t.\u0275cmp=pr({type:t,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(e,r){2&e&&A1("margin-left",r._container._contentMargins.left,"px")("margin-right",r._container._contentMargins.right,"px")},features:[_r],ngContentSelectors:Ex,decls:1,vars:0,template:function(e,r){1&e&&(Fa(),Ri(0))},encapsulation:2,changeDetection:0}),t})(),oA=(()=>{class t extends i8{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(e){this._fixedInViewport=Bo(e)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(e){this._fixedTopGap=um(e)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(e){this._fixedBottomGap=um(e)}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275cmp=pr({type:t,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(e,r){2&e&&(kr("align",null),A1("top",r.fixedInViewport?r.fixedTopGap:null,"px")("bottom",r.fixedInViewport?r.fixedBottomGap:null,"px"),Ai("mat-drawer-end","end"===r.position)("mat-drawer-over","over"===r.mode)("mat-drawer-push","push"===r.mode)("mat-drawer-side","side"===r.mode)("mat-drawer-opened",r.opened)("mat-sidenav-fixed",r.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[_r],ngContentSelectors:Ex,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(e,r){1&e&&(Fa(),d(0,"div",0),Ri(1),u())},dependencies:[fx],encapsulation:2,data:{animation:[r8.transformDrawer]},changeDetection:0}),t})(),aA=(()=>{class t extends o8{}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275cmp=pr({type:t,selectors:[["mat-sidenav-container"]],contentQueries:function(e,r,i){if(1&e&&(so(i,iA,5),so(i,oA,5)),2&e){let o;Er(o=Sr())&&(r._content=o.first),Er(o=Sr())&&(r._allDrawers=o)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(e,r){2&e&&Ai("mat-drawer-container-explicit-backdrop",r._backdropOverride)},exportAs:["matSidenavContainer"],features:[ki([{provide:rA,useExisting:t}]),_r],ngContentSelectors:_he,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],["cdkScrollable","",4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"],["cdkScrollable",""]],template:function(e,r){1&e&&(Fa(ghe),oe(0,phe,1,2,"div",0),Ri(1),Ri(2,1),oe(3,mhe,2,0,"mat-sidenav-content",1)),2&e&&(N("ngIf",r.hasBackdrop),w(3),N("ngIf",!r._content))},dependencies:[iA,Fi,fx],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),t})(),whe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[xf,Wi,Ub,__],__,Wi]}),t})(),s8=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[Wi],Wi]}),t})();const l8=["*"],Che=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],Ehe=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],Mhe=m_(Oh(class{})),khe=Oh(class{}),Fhe=new U("MatList"),c8=new U("MatNavList");let u8=(()=>{class t extends Mhe{constructor(){super(...arguments),this._stateChanges=new Bt}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return t.\u0275fac=function(){let n;return function(r){return(n||(n=co(t)))(r||t)}}(),t.\u0275cmp=pr({type:t,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[ki([{provide:c8,useExisting:t}]),_r,gn],ngContentSelectors:l8,decls:1,vars:0,template:function(e,r){1&e&&(Fa(),Ri(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n'],encapsulation:2,changeDetection:0}),t})(),d8=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),t})(),f8=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=jn({type:t,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),t})(),h8=(()=>{class t extends khe{constructor(e,r,i,o){super(),this._element=e,this._isInteractiveList=!1,this._destroyed=new Bt,this._disabled=!1,this._isInteractiveList=!!(i||o&&"action-list"===o._getListType()),this._list=i||o;const a=this._getHostElement();"button"===a.nodeName.toLowerCase()&&!a.hasAttribute("type")&&a.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe(Co(this._destroyed)).subscribe(()=>{r.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(e){this._disabled=Bo(e)}ngAfterContentInit(){!function UR(t,n,e="mat"){t.changes.pipe(ec(t)).subscribe(({length:r})=>{Gb(n,`${e}-2-line`,!1),Gb(n,`${e}-3-line`,!1),Gb(n,`${e}-multi-line`,!1),2===r||3===r?Gb(n,`${e}-${r}-line`,!0):r>3&&Gb(n,`${e}-multi-line`,!0)})}(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Zo),X(c8,8),X(Fhe,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(e,r,i){if(1&e&&(so(i,d8,5),so(i,f8,5),so(i,VR,5)),2&e){let o;Er(o=Sr())&&(r._avatar=o.first),Er(o=Sr())&&(r._icon=o.first),Er(o=Sr())&&(r._lines=o)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:6,hostBindings:function(e,r){2&e&&Ai("mat-list-item-disabled",r.disabled)("mat-list-item-avatar",r._avatar||r._icon)("mat-list-item-with-avatar",r._avatar||r._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[_r],ngContentSelectors:Ehe,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(e,r){1&e&&(Fa(Che),d(0,"div",0),qe(1,"div",1),Ri(2),d(3,"div",2),Ri(4,1),u(),Ri(5,2),u()),2&e&&(w(1),N("matRippleTrigger",r._getHostElement())("matRippleDisabled",r._isRippleDisabled()))},dependencies:[Nh],encapsulation:2,changeDetection:0}),t})(),Lhe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[HR,g_,Wi,ND,xf],HR,Wi,ND,s8]}),t})();function Bhe(t,n){if(1&t&&(d(0,"span",15),h(1),Hi(2,"uppercase"),qe(3,"br"),h(4),Hi(5,"titlecase"),qe(6,"br"),h(7),Hi(8,"titlecase"),u()),2&t){const e=ae(2);w(1),Qt(" ",_h(2,3,e.funcionario)," "),w(3),Qt("",_h(5,5,null==e.bodegaActual?null:e.bodegaActual.nombre)," "),w(3),Qt("",_h(8,7,null==e.bodegaActual?null:e.bodegaActual.puntoEntrega)," ")}}const jhe=function(t){return{"menu-parent":t}};function Vhe(t,n){if(1&t&&(d(0,"a",17)(1,"mat-icon",18),h(2),u(),h(3),u()),2&t){const e=ae().$implicit;N("routerLink",e.route)("ngClass",Si(4,jhe,e.subNav)),w(2),_e(e.icon),w(1),Qt(" ",e.name," ")}}function Uhe(t,n){if(1&t&&(xc(0),oe(1,Vhe,4,6,"a",16),Cc()),2&t){const e=n.$implicit,r=ae(2);w(1),N("ngIf",r.tieneAcceso(e.nivel))}}function Hhe(t,n){if(1&t){const e=Fn();d(0,"div",2)(1,"mat-toolbar",3)(2,"button",4),De("click",function(){return ht(e),pt(go(16).toggle())}),d(3,"mat-icon"),h(4,"menu"),u()(),d(5,"div",5),qe(6,"img",6),d(7,"h1",7),h(8,"Dispensario SISM App"),u()(),qe(9,"span",8),d(10,"div",9)(11,"mat-icon"),h(12,"person"),u()(),oe(13,Bhe,9,9,"span",10),u(),d(14,"mat-sidenav-container",11)(15,"mat-sidenav",12,13)(17,"mat-nav-list"),oe(18,Uhe,2,1,"ng-container",14),u()(),d(19,"mat-sidenav-content"),qe(20,"router-outlet"),u()()()}if(2&t){const e=ae();Ai("example-is-mobile",e.mobileQuery.matches),w(13),N("ngIf",e.isLoggedIn),w(1),A1("margin-top",e.mobileQuery.matches?56:0,"px"),w(1),N("mode",e.mobileQuery.matches?"over":"side")("fixedInViewport",e.mobileQuery.matches),w(3),N("ngForOf",e.fillerNav)}}function zhe(t,n){1&t&&(d(0,"div"),h(1,"Please open on Stackblitz to see result"),u())}let $he=(()=>{class t{constructor(e,r,i,o){this.authservicio=i,this.bodegaservicio=o,this.isLoggedIn=!1,this.fillerNav=[{name:"Paciente",route:"paciente",icon:"perm_identity",nivel:3},{name:"Medicamentos",route:"medicamento",icon:"hdr_weak",nivel:3,menu:"medicamentosMenu",subNav:[{name:"Consulta",route:"/menu/medicamento",icon:"search"},{name:"Registro",route:"/menu/medicamento/register",icon:"add"}]},{name:"Dispensar Formula",route:"formula",icon:"playlist_add",nivel:2},{name:"Editar Formula",route:"editformula",icon:"edit",nivel:4},{name:"Bodegas",route:"bodega",icon:"domain",nivel:2},{name:"Existencias",route:"existencias",icon:"playlist_add_check",nivel:2},{name:"Pendientes",route:"pendiente",icon:"remove_circle_outline",nivel:2},{name:"Medicamentos bodega",route:"medicamentobodega",icon:"filter_tilt_shift",nivel:2},{name:"Medicamento entregado",route:"entregados",icon:"check_circle_outline",nivel:2},{name:"Medicamento contrato",route:"medicamentoeps",icon:"list_alt",nivel:3},{name:"Prescritos y entregas",route:"prescritos",icon:"donut_small",nivel:3},{name:"Ordenes",route:"despacho",icon:"input",nivel:2},{name:"Trazabilidad de Medicamento",route:"trazamedicamento",icon:"shuffle",nivel:2},{name:"Ajuste por inventario",route:"ajusteinventario",icon:"compare_arrows",nivel:2},{name:"Historial de entrega",route:"historialentrega",icon:"group_add",nivel:1}],this.fillerContent=Array.from({length:50},()=>"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut\n       labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco\n       laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in\n       voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat\n       cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),this.shouldRun=!0,this.mobileQuery=r.matchMedia("(max-width: 600px)"),this._mobileQueryListener=()=>e.detectChanges(),this.mobileQuery.addListener(this._mobileQueryListener)}ngOnDestroy(){this.mobileQuery.removeListener(this._mobileQueryListener)}ngOnInit(){this.isLoggedIn=this.authservicio.checkLoginStatus(),this.funcionario=sessionStorage.getItem("nombre")??"Nombre no disponible";let e=sessionStorage.getItem("bodega"),r=parseInt(null!==e?e:"0",10);this.bodegaservicio.getRegistroId(r).subscribe(i=>{this.bodegaActual=i},i=>{console.error(i)})}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}static#e=this.\u0275fac=function(r){return new(r||t)(X(Zo),X(k6),X(nA),X(Ts))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-menu"]],decls:2,vars:2,consts:[["class","example-container",3,"example-is-mobile",4,"ngIf"],[4,"ngIf"],[1,"example-container"],["color","primary",1,"example-toolbar"],["mat-icon-button","",3,"click"],[1,"logo-container"],["src","assets/logosism.png","alt","Logo",1,"logo"],[1,"example-app-name"],[1,"spacer"],[1,"icon-center"],["class","user-info",4,"ngIf"],[1,"example-sidenav-container"],["fixedTopGap","56",3,"mode","fixedInViewport"],["snav",""],[4,"ngFor","ngForOf"],[1,"user-info"],["mat-list-item","","routerLinkActive","active-link",3,"routerLink","ngClass",4,"ngIf"],["mat-list-item","","routerLinkActive","active-link",3,"routerLink","ngClass"],[1,"icono"]],template:function(r,i){1&r&&(oe(0,Hhe,21,8,"div",0),oe(1,zhe,2,0,"div",1)),2&r&&(N("ngIf",i.shouldRun),w(1),N("ngIf",!i.shouldRun))},dependencies:[wf,ho,Fi,cw,Hs,RI,n8,oA,aA,iA,mm,Wo,u8,h8,BE,$4],styles:[".example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;inset:0}.example-is-mobile[_ngcontent-%COMP%]   .example-toolbar[_ngcontent-%COMP%]{position:fixed;z-index:2}h1.example-app-name[_ngcontent-%COMP%]{margin-left:8px;color:#036!important;font-weight:700!important}.logo-container[_ngcontent-%COMP%]{display:flex;align-items:center}.logo[_ngcontent-%COMP%]{height:40px;margin-right:10px}.example-sidenav-container[_ngcontent-%COMP%]{flex:1}.example-is-mobile[_ngcontent-%COMP%]   .example-sidenav-container[_ngcontent-%COMP%]{flex:1 0 auto}mat-sidenav[_ngcontent-%COMP%]{width:200px}.icono[_ngcontent-%COMP%]{margin-right:10px}mat-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.example-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center}.spacer[_ngcontent-%COMP%]{flex:1}.user-info[_ngcontent-%COMP%]{font-size:.75rem;line-height:1.2;text-align:right}.icon-center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:.2rem 0}.icon-center[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.5rem}[_nghost-%COMP%]     .mat-toolbar{background:linear-gradient(90deg,#67ACD6,#5D8FA5)!important}.mat-list-item.active-link[_ngcontent-%COMP%]{background-color:#cff4fc!important;box-shadow:inset 3px 0 #fd0d29;border-radius:5px;padding-left:10px;font-weight:700;color:#39548b!important}.mat-list-item.active-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:tomato!important}"]})}return t})(),Whe=(()=>{class t{constructor(e,r){this.authService=e,this.router=r}canActivate(){return!!this.authService.isLoggedIn()||(this.router.navigate(["/login"]),!1)}static#e=this.\u0275fac=function(r){return new(r||t)(it(nA),it(Ds))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const qhe=function(){return["/home"]};let Ghe=(()=>{class t{constructor(){this.menuItems=[{name:"Inicio",icon:"home",route:"/home"},{name:"Paciente",icon:"person",route:"/paciente"},{name:"Medicamentos",icon:"medication",route:"/medicamentos",submenu:[{name:"Consulta",icon:"search",route:"/medicamentos/consulta"},{name:"Registro",icon:"add",route:"/medicamentos/registro"}]},{name:"F. Farmaceutica",icon:"local_pharmacy",route:"/farmaceutica"},{name:"V. Administracion",icon:"admin_panel_settings",route:"/administracion"},{name:"Bodegas",icon:"store",route:"/bodegas"},{name:"Medicos",icon:"doctor",route:"/medicos"},{name:"Ips",icon:"hospital",route:"/ips"},{name:"Despacho",icon:"delivery_dining",route:"/despacho"}]}ngOnInit(){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-estadistica"]],decls:16,vars:3,consts:[["mode","side",3,"fixedInViewport"],["sidenav",""],["color","primary"],["mat-icon-button","",3,"click"],["mat-list-item","",3,"routerLink"]],template:function(r,i){if(1&r){const o=Fn();d(0,"p"),h(1,"estadistica works!"),u(),d(2,"mat-sidenav-container")(3,"mat-sidenav",0,1)(5,"mat-toolbar",2)(6,"button",3),De("click",function(){return ht(o),pt(go(4).toggle())}),d(7,"mat-icon"),h(8,"menu"),u()(),d(9,"span"),h(10,"Dispensario SISM App"),u()(),d(11,"mat-nav-list")(12,"a",4)(13,"mat-icon"),h(14,"home"),u(),h(15," Inicio "),u()()()()}2&r&&(w(3),N("fixedInViewport",!0),w(9),N("routerLink",Nt(2,qhe)))},dependencies:[Hs,n8,oA,aA,mm,Wo,u8,h8],styles:["mat-sidenav-container[_ngcontent-%COMP%]{height:100vh;display:flex}mat-sidenav[_ngcontent-%COMP%]{width:250px;background:#fff}mat-toolbar[_ngcontent-%COMP%]{position:fixed;top:0;width:100%}mat-nav-list[_ngcontent-%COMP%]{margin-top:56px}mat-list-item[_ngcontent-%COMP%]{display:flex;align-items:center}mat-icon[_ngcontent-%COMP%]{margin-right:16px}"]})}return t})();function Yhe(t,n){if(1&t&&(d(0,"option",25),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),fo("",e.nombre," - ",e.puntoEntrega,"")}}function Xhe(t,n){1&t&&(d(0,"button",26),h(1," Exportar Detalles"),u()),2&t&&(ae(),N("matMenuTriggerFor",go(35)))}function Khe(t,n){1&t&&(d(0,"div",27),h(1," No hay ordenes de despacho a esta bodega para mostrar!\n"),u())}const sA=function(){return{color:"#009A94"}},Zhe=function(t){return["/menu/despacho",t]};function Qhe(t,n){if(1&t&&(d(0,"mat-icon",42),h(1,"edit"),u()),2&t){const e=ae().$implicit;N("ngStyle",Nt(2,sA))("routerLink",Si(3,Zhe,e.idDespacho))}}const Jhe=function(){return{color:"orange"}},m8=function(t){return["/menu/verordendespacho",t]};function epe(t,n){if(1&t&&(d(0,"mat-icon",43),h(1,"input "),u()),2&t){const e=ae().$implicit;N("ngStyle",Nt(2,Jhe))("routerLink",Si(3,m8,e.idDespacho))}}const lA=function(){return{color:"red"}};function tpe(t,n){if(1&t){const e=Fn();d(0,"mat-icon",44),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).eliminarOrdenDespacho(i))}),h(1,"delete_sweep"),u()}2&t&&N("ngStyle",Nt(1,lA))}const Dx=function(){return{color:"green"}};function npe(t,n){if(1&t&&(d(0,"mat-icon",45),h(1,"check_circle_outline "),u()),2&t){const e=ae().$implicit;N("ngStyle",Nt(2,Dx))("routerLink",Si(3,m8,e.idDespacho))}}function rpe(t,n){if(1&t&&(d(0,"mat-icon",46),h(1,"edit"),u()),2&t){ae();const e=go(39);N("ngStyle",Nt(2,Dx))("matMenuTriggerFor",e)}}function ipe(t,n){if(1&t){const e=Fn();d(0,"button",21),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).reporteOrdenDespacho(i,!0))}),d(1,"mat-icon",22),h(2,"print"),u(),d(3,"span"),h(4,"O. despacho con cantidades"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,sA)))}const ope=function(t){return{"text-danger":t}},ape=function(){return{color:"#2BB6D7"}},spe=function(t){return["/menu/ordendespachoedit",t]};function lpe(t,n){if(1&t){const e=Fn();d(0,"tr",31)(1,"td"),h(2),u(),d(3,"td"),h(4),Hi(5,"date"),u(),d(6,"td"),h(7),u(),d(8,"td"),h(9),u(),d(10,"td"),h(11),u(),d(12,"td"),h(13),Hi(14,"date"),u(),d(15,"td"),h(16),u(),d(17,"td"),h(18),u(),d(19,"td"),h(20),u(),d(21,"td")(22,"div")(23,"mat-icon",32),h(24,"print"),u(),oe(25,Qhe,2,5,"mat-icon",33),oe(26,epe,2,5,"mat-icon",34),oe(27,tpe,2,2,"mat-icon",35),oe(28,npe,2,5,"mat-icon",36),oe(29,rpe,2,3,"mat-icon",37),u(),d(30,"mat-menu",null,38)(32,"button",21),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).reporteOrdenDespacho(o,!1))}),d(33,"mat-icon",22),h(34,"playlist_add_check"),u(),d(35,"span"),h(36,"O. despacho sin cantidades"),u()(),oe(37,ipe,5,2,"button",39),u(),d(38,"mat-menu",null,40)(40,"button",21),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).devolverOrdenDespacho(o))}),d(41,"mat-icon",22),h(42,"settings_backup_restore"),u(),d(43,"span"),h(44,"Devolver orden de cange"),u()(),d(45,"button",41)(46,"mat-icon",22),h(47,"compare_arrows"),u(),d(48,"span"),h(49,"Agregar o quitar item"),u()()()()()}if(2&t){const e=n.$implicit,r=go(31),i=ae(2);N("ngClass",Si(28,ope,e.bodegaOrigen.idBodega===i.idBodegaSeleccionada)),w(2),Qt(" ",e.idDespacho,""),w(2),_e(Xo(5,22,e.fechaDespacho,"dd/MM/YYYY")),w(3),_e(e.bodegaOrigen.nombre),w(2),_e(e.bodegaDestino.nombre),w(2),_e(i.primerasmayusculas(e.funcionarioDespacho)),w(2),_e(Xo(14,25,e.fechaEntradaDestino,"dd/MM/YYYY")),w(3),_e(i.primerasmayusculas(e.funcionarioEntradaDestino)),w(2),_e(e.itemsDespacho.length),w(2),_e(e.estado),w(3),N("ngStyle",Nt(30,sA))("matMenuTriggerFor",r),w(2),N("ngIf","Creaci\xf3n"===e.estado&&i.tieneAcceso(2)),w(1),N("ngIf","Env\xedo"===e.estado),w(1),N("ngIf","Creaci\xf3n"===e.estado&&i.tieneAcceso(2)),w(1),N("ngIf","Recepci\xf3n"===e.estado),w(1),N("ngIf","Env\xedo"===e.estado&&i.tieneAcceso(3)),w(4),N("ngStyle",Nt(31,ape)),w(4),N("ngIf",i.tieneAcceso(3)||"Recepci\xf3n"===e.estado),w(4),N("ngStyle",Nt(32,lA)),w(4),N("routerLink",Si(33,spe,e.idDespacho)),w(1),N("ngStyle",Nt(35,Dx))}}function cpe(t,n){if(1&t&&(d(0,"div")(1,"table",28)(2,"thead",29)(3,"tr")(4,"th"),h(5,"Orden"),u(),d(6,"th"),h(7,"Fecha "),u(),d(8,"th"),h(9,"Origen "),u(),d(10,"th"),h(11,"Destino"),u(),d(12,"th"),h(13,"Despacho"),u(),d(14,"th"),h(15,"Fecha"),u(),d(16,"th"),h(17,"Entrada"),u(),d(18,"th"),h(19,"Items"),u(),d(20,"th"),h(21,"Estado"),u(),d(22,"th"),h(23,"Gesti\xf3n"),u()()(),d(24,"tbody"),oe(25,lpe,50,36,"tr",30),u()()()),2&t){const e=ae();w(25),N("ngForOf",e.listaOrdendespacho)}}let upe=(()=>{class t{constructor(e,r,i){this.fb=e,this.ordendespachoservicio=r,this.bodegaservicio=i,this.consultaSeleccionada="",this.idBodegaSeleccionada="",this.idBodegausuario=!1,this.contador=0,this.lista=[];const o=new Date,a=new Date(o);a.setDate(o.getDate()-30),this.generalForm=this.fb.group({idBodega:[""],tipoConsulta:["todas"],fInicial:[a.toISOString().split("T")[0]],fFinal:[o.toISOString().split("T")[0]],soloajuste:[""]})}ngOnInit(){this.parametro=parseInt(sessionStorage.getItem("bodega")||"0",10),this.bodegaservicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e,this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);return 0===o?r.puntoEntrega.localeCompare(i.puntoEntrega):o})},e=>{console.error(e)}),this.generalForm.patchValue({idBodega:+this.parametro}),this.buscarOrdenDespacho()}onBodegaChange(e){this.buscarOrdenDespacho()}buscarOrdenDespacho(){const e=this.generalForm.get("idBodega")?.value;this.idBodegaSeleccionada=e;const r=sessionStorage.getItem("bodega");this.idBodegausuario=r==e;const i=this.generalForm.get("tipoConsulta")?.value;e&&i&&("origen"===i?this.consultarOrdenesPorBodegaOrigen(e):"destino"===i?this.consultarOrdenesPorBodegaDestino(e):"todas"===i&&this.consultarTodasOrdenesPorBodega(e))}consultarOrdenesPorBodegaOrigen(e){this.listaOrdendespacho=[],this.listaOrdendespachofiltrada=[],z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ordendespachoservicio.getOrdenDespachoBodegaOrigen(e,this.generalForm.get("fInicial")?.value,this.generalForm.get("fFinal")?.value).subscribe(r=>{this.listaOrdendespacho=r,this.listaOrdendespacho.sort((i,o)=>{const a=new Date(o.fechaDespacho).getTime()-new Date(i.fechaDespacho).getTime();return 0===a?o.idDespacho-i.idDespacho:a}),this.listaOrdendespachofiltrada=this.listaOrdendespacho,this.generalForm.patchValue({soloajuste:0}),z().close()},r=>{console.error("\u274c Error cargando registros",r),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})}consultarOrdenesPorBodegaDestino(e){this.listaOrdendespacho=[],this.listaOrdendespachofiltrada=[],z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ordendespachoservicio.getOrdenDespachoBodegaDestino(e,this.generalForm.get("fInicial")?.value,this.generalForm.get("fFinal")?.value).subscribe(r=>{this.listaOrdendespacho=r,this.listaOrdendespacho.sort((i,o)=>{const a=new Date(o.fechaDespacho).getTime()-new Date(i.fechaDespacho).getTime();return 0===a?o.idDespacho-i.idDespacho:a}),this.listaOrdendespachofiltrada=this.listaOrdendespacho,this.generalForm.patchValue({soloajuste:0}),z().close()},r=>{console.error("\u274c Error cargando registros",r),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})}consultarTodasOrdenesPorBodega(e){this.listaOrdendespacho=[],this.listaOrdendespachofiltrada=[],z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ordendespachoservicio.getOrdenDespachoBodegaTodas(e,this.generalForm.get("fInicial")?.value,this.generalForm.get("fFinal")?.value).subscribe(r=>{this.listaOrdendespacho=r,this.listaOrdendespacho.sort((i,o)=>{const a=new Date(o.fechaDespacho).getTime()-new Date(i.fechaDespacho).getTime();return 0===a?o.idDespacho-i.idDespacho:a}),this.listaOrdendespachofiltrada=this.listaOrdendespacho,this.generalForm.patchValue({soloajuste:0}),z().close()},r=>{console.error("\u274c Error cargando registros",r),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})}eliminarOrdenDespacho(e){z().fire({title:"Desea eliminar?",text:"La orden de despacho Nro. "+e.idDespacho+" dirigida a la bodega "+e.bodegaDestino.nombre+" de la base de datos.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.ordendespachoservicio.delete(e.idDespacho).subscribe(i=>{this.listaOrdendespacho=this.listaOrdendespacho.filter(o=>o!==e),z().fire({icon:"success",title:"Ok",text:"La orden de despacho n\xfamero "+e.idDespacho+" dirigida a la bodega "+e.bodegaDestino.nombre+" ha sido eliminado correctamente."})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}reporteOrdenDespacho(e,r){const i=new Kc.default({orientation:"l",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let o="{total_pages_count_string}",a=1;const s=this,l=r?[["Nro","Nombre del medicamento","Presentaci\xf3n","CUM","Invima","Laboratorio","Lote","Vencimiento","Cantidad"]]:[["Nro","Nombre del medicamento","Presentaci\xf3n","CUM","Invima","Laboratorio","Lote","Vencimiento"]];Zc()(i,{head:l,body:this.datosOrden(e,r),startY:37,theme:"striped",willDrawPage:function(v){i.setFontSize(11),i.setDrawColor(0);let E=i.internal.pageSize.getWidth()/2-i.getTextWidth("ORDEN DE DESPACHO / RECEPCION TECNICA  Nro. "+ +e.idDespacho.toString())/2,D=i.getTextWidth("ORDEN DE DESPACHO / RECEPCION TECNICA Nro. "+e.idDespacho.toString());i.setDrawColor("#D3E3FD"),i.setFillColor("#D3E3FD"),i.roundedRect(E-10,9,D+20,7,3,3,"FD"),i.addImage("/assets/logo.png","JPEG",238,3,25,20),i.text("ORDEN DE DESPACHO / RECEPCION TECNICA Nro. "+e.idDespacho.toString(),E,14),i.setTextColor("#000000"),i.text("Numero y fecha orden:",17,20),i.text(e.idDespacho.toString()+" - "+e.fechaDespacho,60,20),i.text("Bodega de origen:",17,25),i.text(s.primerasmayusculas(e.bodegaOrigen.nombre),60,25),i.text("Funcionario despacho:",17,30),i.text(e.funcionarioDespacho,60,30),i.text("Direcci\xf3n:",17,35),i.text(e.bodegaOrigen.direccion,60,35),i.text("Fecha recibe:",150,20),i.text(s.controlRespuesta(e.fechaEntradaDestino),185,20),i.text("Bodega de destino:",150,25),i.text(s.primerasmayusculas(e.bodegaDestino.nombre),185,25),i.text("Funcionario recibe:",150,30),i.text(s.controlRespuesta(e.funcionarioEntradaDestino),185,30),i.text("Estado de la orden:",150,35),i.text(e.estado,185,35)},didDrawPage:function(v){i.setFontSize(10),i.text("P\xe1gina "+a+" de "+o,220,i.internal.pageSize.height-10),i.text(e.bodegaOrigen.direccion.toString(),12,i.internal.pageSize.height-12),i.text("Cel: "+e.bodegaOrigen.telefono.toString()+", Email: "+e.bodegaOrigen.email.toString(),12,i.internal.pageSize.height-7),i.setLineWidth(1.3),i.setDrawColor(236,255,83),i.line(10,i.internal.pageSize.height-20,10,i.internal.pageSize.height-5),a++}}),"function"==typeof i.putTotalPages&&i.putTotalPages(o);var c=i.output("datauri"),f=window.open();f?f.document.write('<iframe src="'+c+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")}datosOrden(e,r){const i=[];this.contador=1,this.listaItemOrden=e.itemsDespacho,this.listaItemOrden=this.listaItemOrden.sort((o,a)=>o.medicamento.nombre.localeCompare(a.medicamento.nombre));for(let o=0;o<this.listaItemOrden.length;o++){const a=[this.contador.toString(),this.primerasmayusculas(this.listaItemOrden[o].medicamento.nombre||""),this.primerasmayusculas(this.listaItemOrden[o].medicamento.forma.nombre||""),(this.listaItemOrden[o].medicamento.codigoCum||"").toString(),(this.listaItemOrden[o].invima||"").toString(),this.primerasmayusculas(this.listaItemOrden[o].laboratorio||""),(this.listaItemOrden[o].lote||"").toString(),this.listaItemOrden[o].fechaVencimiento||""];r&&a.push(this.listaItemOrden[o].cantidad.toString()),i.push(a),this.contador++}return i}salidasExcelDetalleOrden(e){var r=this;return(0,hi.Z)(function*(){const i=r.generalForm.get("fInicial")?.value,o=r.generalForm.get("fFinal")?.value,a=r.generalForm.get("idBodega")?.value;if(i&&o)if(a)if(new Date(i)>new Date(o))z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"});else try{const c=Number(a);let f,v=0===e?"Entradas":"Salidas";f=yield r.ordendespachoservicio.getDetalleOrdenDespacho(c,i,o,e).toPromise(),Array.isArray(f)?(r.lista=f,r.excelDetalleOrdenDespacho(v)):console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array.")}catch(c){console.error("Error al obtener los datos de detallados de las ordenes de despacho:",c)}else z().fire({icon:"error",title:"Orden Despacho!",text:"No ha seleccionado la bodega de la que desea generar el reporte!"});else z().fire({icon:"error",title:"Orden Despacho!",text:"Falta la informacion de las fechas del periodo que desea generar!"})})()}excelDetalleOrdenDespacho(e){const r=[];r.push(["ID MEDICAMENTO","CUM","NOMBRE MEDICAMENTO","PRESENTACION","CONTROLADO","CANTIDAD","ID ORDEN","FECHA DESPACHO","ESTADO","BODEGA ORIGEN","FUNCIONARIO DESPACHO","BODEGA DESTINO","FUNCIONARIO INGRESO","TIPO DE ORDEN"]);let o="";this.lista.forEach(c=>{o=c.controlado?"SI":"NO",r.push([c.idMedicamento||"",c.codigoCum||"",c.nombreMedicamento||"",c.presentacion||"",o,c.cantidad||"",c.idDespacho||"",c.fechaDespacho||"",c.estado||"",c.bodegaOrigen||"",c.funcionarioDespacho||"",c.bodegaDestino||"",c.funcionarioEntradaDestino||"",c.tipo||""])});const a=Gr.aoa_to_sheet(r),s=Gr.decode_range(a["!ref"]);for(let c=s.s.c;c<=s.e.c;c++){const f=a[Gr.encode_cell({r:0,c})];f&&(f.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const l=Gr.book_new();Gr.book_append_sheet(l,a,e),Pf(l,"Relacion_Despachos_"+e+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Su reporte fue exportado en su carpeta de descargas en formato xslx"})}calcularTotal(e){return this.listaItemOrden.reduce((i,o)=>i+(o[e]?1:0),0).toString()}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}controlRespuesta(e){return null!=e?e.toString():""}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}onAjuste(e){e.target.checked?(this.listaOrdendespachofiltrada=this.listaOrdendespacho,this.listaOrdendespacho=this.listaOrdendespacho.filter(r=>"Recepci\xf3n"!=r.estado)):this.listaOrdendespacho=this.listaOrdendespachofiltrada}devolverOrdenDespacho(e){let r=sessionStorage.getItem("nombre");this.tieneAcceso(3)?z().fire({title:"Desea devolver?",text:"Esta seguro de devolver las catidades de los medicamentos de la orden de despacho Nro. "+e.idDespacho+" , se regresara al inventario de la bodega de origen "+e.bodegaOrigen.nombre+" y la orden quedar\xe1 en modo creaci\xf3n para que la edite, la reprocese o la elimine.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, devolver!"}).then(i=>{i.isConfirmed&&this.ordendespachoservicio.regresarinventariocangeBodegaorigen(e.idDespacho,e.bodegaOrigen.idBodega,r).subscribe(o=>{this.buscarOrdenDespacho(),z().fire({icon:"success",title:"Ok",text:"De la orden de despacho Nr. "+e.idDespacho+" fueron devuelto todas las cantidades de cada medicamento a la bodega de origen "+e.bodegaOrigen.nombre+" correctamente, queda en modo creaci\xf3n!"})},o=>{z().fire({icon:"error",title:"Error",text:o.mensaje})})}):z().fire({icon:"warning",title:"Falta de permisos",text:"No tienes permisos para realizar la modificaci\xf3n en la devoluci\xf3n del medicamento en la orden de despacho, comunicate con el funcionario encargado!"})}reporteEnConstruccion(){z().fire({icon:"info",title:"En construcci\xf3n!",text:"El reporte esta en proceso de construcci\xf3n, te estaremos informando cuando est\xe9 disponible!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(y_),X(Ts))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-historialordendespacho"]],decls:48,vars:9,consts:[[1,"container","mt-3",3,"formGroup"],[1,"row"],[1,"col-md-6"],["type","radio","formControlName","tipoConsulta","value","origen",3,"change"],["type","radio","formControlName","tipoConsulta","value","destino",3,"change"],["type","radio","formControlName","tipoConsulta","value","todas",3,"change"],[1,"input-group","mt-2"],["formControlName","idBodega","required","",1,"form-select",3,"change"],["selected","","value","0"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"date-inputs"],["type","date","formControlName","fInicial",1,"form-control","border-end-0"],[1,"date-label"],["type","date","formControlName","fFinal",1,"form-control","border-end-0"],["type","button",1,"btn","btn-info","btn-sm","btn-custom-gradient","buscar-button",3,"click"],["type","button","class","btn btn-info btn-sm btn-custom-gradient buscar-button",3,"matMenuTriggerFor",4,"ngIf"],[1,"form-group","d-flex","align-items-center","justify-content-end"],["id","portabilidad","type","checkbox","formControlName","soloajuste",1,"form-check-input","me-2",3,"change"],["for","portabilidad",1,"form-check-label"],["menuC","matMenu"],["mat-menu-item","",3,"click"],[3,"ngStyle"],["class","alert alert-info my-2 mb-2",4,"ngIf"],[4,"ngIf"],[3,"ngValue"],["type","button",1,"btn","btn-info","btn-sm","btn-custom-gradient","buscar-button",3,"matMenuTriggerFor"],[1,"alert","alert-info","my-2","mb-2"],[1,"table","table-striped","table-hover","table-sm","mt-2"],[1,"thead-colored"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["title","Imprimir la orden despacho",1,"puntero",3,"ngStyle","matMenuTriggerFor"],["class","puntero","title","Editar la orden despacho",3,"ngStyle","routerLink",4,"ngIf"],["class","puntero","title","Recepcionar la orden despacho",3,"ngStyle","routerLink",4,"ngIf"],["class","puntero","title","Eliminar la orden despacho",3,"ngStyle","click",4,"ngIf"],["class","puntero","title","Ver la orden despacho",3,"ngStyle","routerLink",4,"ngIf"],["class","puntero","title","Editar la orden despacho",3,"ngStyle","matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["menuEdicion","matMenu"],["mat-menu-item","",3,"routerLink"],["title","Editar la orden despacho",1,"puntero",3,"ngStyle","routerLink"],["title","Recepcionar la orden despacho",1,"puntero",3,"ngStyle","routerLink"],["title","Eliminar la orden despacho",1,"puntero",3,"ngStyle","click"],["title","Ver la orden despacho",1,"puntero",3,"ngStyle","routerLink"],["title","Editar la orden despacho",1,"puntero",3,"ngStyle","matMenuTriggerFor"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"label")(5,"input",3),De("change",function(a){return i.onBodegaChange(a)}),u(),h(6," Consultar ordenes de despacho de salidas "),u()(),d(7,"div")(8,"label")(9,"input",4),De("change",function(a){return i.onBodegaChange(a)}),u(),h(10," Consultar ordenes de despacho de entradas "),u()(),d(11,"div")(12,"label")(13,"input",5),De("change",function(a){return i.onBodegaChange(a)}),u(),h(14," Consultar todas las ordenes de despacho "),u()(),d(15,"div",6)(16,"select",7),De("change",function(a){return i.onBodegaChange(a)}),d(17,"option",8),h(18,"Seleccione la bodega a consultar"),u(),oe(19,Yhe,2,3,"option",9),u()()(),d(20,"div",2)(21,"div",10)(22,"div",11),qe(23,"input",12),d(24,"div",13),h(25,"al"),u(),qe(26,"input",14),u(),d(27,"button",15),De("click",function(){return i.buscarOrdenDespacho()}),h(28," Buscar"),u(),oe(29,Xhe,2,1,"button",16),d(30,"div",17)(31,"input",18),De("change",function(a){return i.onAjuste(a)}),u(),d(32,"label",19),h(33,"Ver \xf3rdenes pendientes por entrada"),u()(),d(34,"mat-menu",null,20)(36,"button",21),De("click",function(){return i.salidasExcelDetalleOrden(1)}),d(37,"mat-icon",22),h(38,"art_track"),u(),d(39,"span"),h(40,"Detalles de salidas"),u()(),d(41,"button",21),De("click",function(){return i.salidasExcelDetalleOrden(0)}),d(42,"mat-icon",22),h(43,"tune"),u(),d(44,"span"),h(45,"Detalles de entradas"),u()()()()()(),oe(46,Khe,2,0,"div",23),oe(47,cpe,26,1,"div",24),u()),2&r&&(N("formGroup",i.generalForm),w(19),N("ngForOf",i.listaregistros),w(10),N("ngIf",i.tieneAcceso(3)||i.idBodegausuario),w(8),N("ngStyle",Nt(7,lA)),w(5),N("ngStyle",Nt(8,Dx)),w(4),N("ngIf",0==(null==i.listaOrdendespacho?null:i.listaOrdendespacho.length)),w(1),N("ngIf",(null==i.listaOrdendespacho?null:i.listaOrdendespacho.length)>0))},dependencies:[wf,ho,Fi,Jo,Hs,n0,Of,r0,Wo,cl,ul,vo,sl,Ss,Wy,No,zo,Dc,bo,Ro,Sc],styles:[".puntero[_ngcontent-%COMP%]{cursor:pointer}.card-header[_ngcontent-%COMP%]{background:linear-gradient(to right,#71E0D2,#5D8FA5);color:#fff;border-radius:10px;display:flex;justify-content:space-between;align-items:center}.text-container[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]     .mat-tooltip{background-color:#f44336;color:#fff}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;flex-wrap:wrap}.card-title[_ngcontent-%COMP%]{margin-right:1rem;margin-left:10px;white-space:nowrap}.date-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;width:400px;padding:.15rem;font-size:.875rem}.input-group-text[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.form-control[_ngcontent-%COMP%]{flex:1;border-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:25px}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{border-top-left-radius:25px;border-bottom-left-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control.border-end-0[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.btn-custom-gradient[_ngcontent-%COMP%]{background:linear-gradient(to right,#71E0D2,#67ACD6);color:#fff;border:none;transition:color .3s}.btn-custom-gradient[_ngcontent-%COMP%]:hover{color:#000}.buscar-button[_ngcontent-%COMP%]{margin:0 10px;border-radius:25px;width:140px}.btn-custom-gradient-d[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff9966,#ff5e62);color:#fff;border:none;min-width:60px}.btn-custom-gradient-d[_ngcontent-%COMP%]:hover{color:#000}"]})}return t})();function dpe(t,n){1&t&&(d(0,"th"),h(1,"Control"),u())}const fpe=function(){return{color:"green"}};function hpe(t,n){if(1&t&&(d(0,"div")(1,"mat-icon",15),h(2,"check"),u(),h(3),u()),2&t){const e=ae().$implicit;w(1),N("ngStyle",Nt(2,fpe)),w(2),Qt(" ",e.cantidad," ")}}function ppe(t,n){if(1&t){const e=Fn();d(0,"input",16),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.cantidadDespacho=i)})("change",function(i){ht(e);const o=ae().$implicit;return pt(ae(2).verificarCantidad(o,i))}),u()}2&t&&N("ngModel",ae().$implicit.cantidadDespacho)}const mpe=function(){return{color:"#009A94"}};function gpe(t,n){1&t&&(d(0,"mat-icon",15),h(1,"done"),u()),2&t&&N("ngStyle",Nt(1,mpe))}const _pe=function(){return{color:"red"}};function vpe(t,n){1&t&&(d(0,"mat-icon",15),h(1,"clear"),u()),2&t&&N("ngStyle",Nt(1,_pe))}function bpe(t,n){if(1&t&&(d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),u(),d(15,"td"),h(16),u(),d(17,"td"),h(18),u(),d(19,"td"),oe(20,hpe,4,3,"div",6),oe(21,ppe,1,1,"input",13),u(),d(22,"td"),oe(23,gpe,2,2,"mat-icon",14),oe(24,vpe,2,2,"mat-icon",14),u()()),2&t){const e=n.$implicit,r=n.index,i=ae(2);w(2),_e(r+1),w(2),_e(e.medicamento.idMedicamento),w(2),_e(e.medicamento.nombre),w(2),_e(e.medicamento.forma.nombre),w(2),_e(e.medicamento.codigoCum),w(2),_e(e.invima),w(2),_e(e.laboratorio),w(2),_e(e.lote),w(2),_e(e.fechaVencimiento),w(2),N("ngIf",!e.control&&"Recepci\xf3n"===(null==i.listaregistros?null:i.listaregistros.estado)),w(1),N("ngIf","Env\xedo"===(null==i.listaregistros?null:i.listaregistros.estado)),w(2),N("ngIf",e.control),w(1),N("ngIf",!e.control&&"Env\xedo"===(null==i.listaregistros?null:i.listaregistros.estado))}}function ype(t,n){if(1&t&&(d(0,"div")(1,"table",10)(2,"thead",11)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"ID"),u(),d(8,"th"),h(9,"Medicamento"),u(),d(10,"th"),h(11,"Presentaci\xf3n"),u(),d(12,"th"),h(13,"CUM"),u(),d(14,"th"),h(15,"Invima"),u(),d(16,"th"),h(17,"Laboratorio"),u(),d(18,"th"),h(19,"Lote"),u(),d(20,"th"),h(21,"Vencimiento"),u(),d(22,"th"),h(23,"Cantidad"),u(),oe(24,dpe,2,0,"th",6),u()(),d(25,"tbody"),oe(26,bpe,25,13,"tr",12),u()()()),2&t){const e=ae();w(24),N("ngIf","Env\xedo"===(null==e.listaregistros?null:e.listaregistros.estado)),w(2),N("ngForOf",e.listaItemsFormula)}}function wpe(t,n){if(1&t){const e=Fn();d(0,"div",7)(1,"button",17),De("click",function(){return ht(e),pt(ae().procesarOrdenDespachoIngreso())}),h(2," Validar y Generar ingresos"),u()()}}const xpe=function(){return["/menu/historialordendespacho"]};let Cpe=(()=>{class t{constructor(e,r){this.ordenDespachoservicio=e,this.activatedRoute=r,this.existencias={}}ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{this.parametro=e.get("id"),this.parametro&&this.buscarRegistro(this.parametro)})}buscarRegistro(e){this.ordenDespachoservicio.getOrdenDespachoId(e).subscribe(r=>{this.listaregistros=r,this.listaItemsFormula=r.itemsDespacho.map(i=>({...i,control:!1,cantidadDespacho:""})),this.listaItemsFormula.sort((i,o)=>i.medicamento.nombre.localeCompare(o.medicamento.nombre))})}verificarCantidad(e,r){e.control=e.cantidad===e.cantidadDespacho}procesarOrdenDespachoIngreso(){let e=sessionStorage.getItem("nombre");this.tieneAcceso(5)||this.listaItemsFormula.some(o=>o.cantidadDespacho!=o.cantidad&&(z().fire({icon:"error",title:"Cantidad inconsistente",text:"La orden de despacho tiene items donde la cantidad a ingresar difiere de la cantidad de la orden de despacho."}),!0)),z().fire({title:"\xbfConfirma?",icon:"question",text:"Agregar los medicamentos de la orden de despacho n\xfamero "+this.listaregistros.idDespacho+" de la bodega de origen "+this.listaregistros.bodegaOrigen.nombre+" a la bodega destino "+this.listaregistros.bodegaDestino.nombre,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar!"}).then(i=>{i.isConfirmed&&(z().fire({title:"Actualizando inventario..",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ordenDespachoservicio.cargarinventariocangeBodega(this.listaregistros.idDespacho,this.listaregistros.bodegaDestino.idBodega,e).subscribe(o=>{this.buscarRegistro(this.parametro),z().close(),z().fire({icon:"success",title:"Ok",html:"La orden de despacho ha sido cargada al inventario de la bodega de destino. satisfactoriamente"})},o=>{z().close(),z().fire({icon:"error",title:"Error",text:"No se pudo actualizar la orden de despacho al inventario de la bodega destino en la base de datos."})}))})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}static#e=this.\u0275fac=function(r){return new(r||t)(X(y_),X(Us))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-verordendespacho"]],decls:58,vars:19,consts:[[1,"card-body"],[1,"row"],[1,"col-md-6"],[1,"card-header"],[1,"col-12","text-center","mt-1"],[1,"fw-bold"],[4,"ngIf"],[1,"col-6"],[1,"btn","btn-outline-primary","w-50",3,"routerLink"],["class","col-6",4,"ngIf"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[4,"ngFor","ngForOf"],["type","number","placeholder","Cantidad recibida","class","form-control",3,"ngModel","ngModelChange","change",4,"ngIf"],[3,"ngStyle",4,"ngIf"],[3,"ngStyle"],["type","number","placeholder","Cantidad recibida",1,"form-control",3,"ngModel","ngModelChange","change"],[1,"btn","btn-outline-primary","w-50",3,"click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),h(4," Origen "),d(5,"strong"),h(6),u()(),d(7,"div",0)(8,"p")(9,"strong"),h(10,"Direcci\xf3n:"),u(),h(11),u(),d(12,"p")(13,"strong"),h(14,"Tel\xe9fono:"),u(),h(15),d(16,"strong"),h(17,"Funcionario despacho:"),u(),h(18),u(),d(19,"p")(20,"strong"),h(21,"Departamento y municipio:"),u(),h(22),u(),d(23,"p")(24,"strong"),h(25,"Observaci\xf3n:"),u(),h(26),u()()(),d(27,"div",2)(28,"div",3),h(29," Destino "),d(30,"strong"),h(31),u()(),d(32,"div",0)(33,"p")(34,"strong"),h(35,"Direcci\xf3n:"),u(),h(36),u(),d(37,"p")(38,"strong"),h(39,"Tel\xe9fono:"),u(),h(40),d(41,"strong"),h(42,"Funcionario ingreso:"),u(),h(43),u(),d(44,"p")(45,"strong"),h(46,"Departamento y municipio:"),u(),h(47),u()()()(),d(48,"div",4)(49,"span",5),h(50),u()(),oe(51,ype,27,2,"div",6),qe(52,"hr"),d(53,"div",1)(54,"div",7)(55,"button",8),h(56," Regresar"),u()(),oe(57,wpe,3,0,"div",9),u()()),2&r&&(w(6),Qt("(",null==i.listaregistros||null==i.listaregistros.bodegaOrigen?null:i.listaregistros.bodegaOrigen.nombre,")"),w(5),Qt(" ",null==i.listaregistros||null==i.listaregistros.bodegaOrigen?null:i.listaregistros.bodegaOrigen.direccion,""),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.bodegaOrigen?null:i.listaregistros.bodegaOrigen.telefono," "),w(3),Qt(" ",null==i.listaregistros?null:i.listaregistros.funcionarioDespacho,""),w(4),fo(" ",null==i.listaregistros||null==i.listaregistros.bodegaOrigen?null:i.listaregistros.bodegaOrigen.departamento," - ",null==i.listaregistros||null==i.listaregistros.bodegaOrigen?null:i.listaregistros.bodegaOrigen.municipio,""),w(4),Qt(" ",null==i.listaregistros?null:i.listaregistros.observacion,""),w(5),Qt("(",null==i.listaregistros||null==i.listaregistros.bodegaDestino?null:i.listaregistros.bodegaDestino.nombre,")"),w(5),Qt(" ",null==i.listaregistros||null==i.listaregistros.bodegaDestino?null:i.listaregistros.bodegaDestino.direccion,""),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.bodegaDestino?null:i.listaregistros.bodegaDestino.telefono," "),w(3),Qt(" ",null==i.listaregistros?null:i.listaregistros.funcionarioEntradaDestino,""),w(4),fo(" ",null==i.listaregistros||null==i.listaregistros.bodegaDestino?null:i.listaregistros.bodegaDestino.departamento," - ",null==i.listaregistros||null==i.listaregistros.bodegaDestino?null:i.listaregistros.bodegaDestino.municipio,""),w(3),fo("MEDICAMENTOS ASOCIADOS A LA ORDEN DE DESPACHO Nro. ",null==i.listaregistros?null:i.listaregistros.idDespacho," DEL ",null==i.listaregistros?null:i.listaregistros.fechaDespacho," "),w(1),N("ngIf",(null==i.listaItemsFormula?null:i.listaItemsFormula.length)>0),w(4),N("routerLink",Nt(18,xpe)),w(2),N("ngIf","Env\xedo"===(null==i.listaregistros?null:i.listaregistros.estado)))},dependencies:[ho,Fi,Jo,Hs,Wo,vo,wd,No,Ag],styles:[".card-body[_ngcontent-%COMP%]{padding:10px}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:14px;line-height:1.3}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}.card[_ngcontent-%COMP%]{margin:15px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.card-header[_ngcontent-%COMP%]{background:linear-gradient(to right,#5D8FA5,#6CC5D4);color:#fff;font-weight:700;padding:8px;border-radius:8px 8px 0 0}.card-body[_ngcontent-%COMP%]{padding:15px}.form-group[_ngcontent-%COMP%]{margin-bottom:5px}.form-group.row[_ngcontent-%COMP%]{display:flex;align-items:center}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}.form-control[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{border-radius:4px}.btn-info[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;color:#fff}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;border-color:#dc3545;color:#fff}.alert[_ngcontent-%COMP%]{border-radius:4px;margin-top:5px}.float-right[_ngcontent-%COMP%]{margin-top:5px;font-weight:700}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]{padding:0 2px}.mat-option[_ngcontent-%COMP%]{font-size:12px;line-height:1.1;padding:2px 8px;transition:background-color .2s}.mat-option[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.mat-autocomplete-panel[_ngcontent-%COMP%]{border-radius:4px;box-shadow:0 4px 8px #0000001a;max-height:250px;overflow-y:auto}.mat-input-element[_ngcontent-%COMP%]{padding:5px 8px}.input-container[_ngcontent-%COMP%]{margin-bottom:2px}@media (max-width: 768px){.mat-input-element[_ngcontent-%COMP%]{padding:5px 8px}.mat-option[_ngcontent-%COMP%]{font-size:13px;padding:5px 10px}}.input-group[_ngcontent-%COMP%]{display:flex;align-items:center}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1;margin-right:8px}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin:0}"]})}return t})();class Epe{constructor(){this.phone="",this.message=""}}function Spe(t,n){1&t&&(Ns(),Eu(),d(0,"span"),h(1,"Enviar PAVE"),u())}function Dpe(t,n){1&t&&(Ns(),Eu(),d(0,"div",24)(1,"span",25),h(2,"Cargando..."),u()())}function Ape(t,n){1&t&&(Ns(),Eu(),d(0,"span"),h(1,"Enviando..."),u())}function Tpe(t,n){if(1&t){const e=Fn();d(0,"button",20),De("click",function(){return ht(e),pt(ae().mensajesWSPave())}),Ns(),d(1,"svg",21),qe(2,"path",22),u(),oe(3,Spe,2,0,"span",19),oe(4,Dpe,3,0,"div",23),oe(5,Ape,2,0,"span",19),u()}if(2&t){const e=ae();N("disabled",e.enviandoMensajes),w(3),N("ngIf",!e.enviandoMensajes),w(1),N("ngIf",e.enviandoMensajes),w(1),N("ngIf",e.enviandoMensajes)}}function Mpe(t,n){1&t&&(Ns(),Eu(),d(0,"span"),h(1,"Enviar a todos"),u())}function kpe(t,n){1&t&&(Ns(),Eu(),d(0,"div",24)(1,"span",25),h(2,"Cargando..."),u()())}function Fpe(t,n){1&t&&(Ns(),Eu(),d(0,"span"),h(1,"Enviando..."),u())}function Ipe(t,n){if(1&t){const e=Fn();d(0,"button",26),De("click",function(){return ht(e),pt(ae().enviarMensajesConRetraso())}),Ns(),d(1,"svg",21),qe(2,"path",27),u(),oe(3,Mpe,2,0,"span",19),oe(4,kpe,3,0,"div",23),oe(5,Fpe,2,0,"span",19),u()}if(2&t){const e=ae();N("disabled",e.enviandoMensajes),w(3),N("ngIf",!e.enviandoMensajes),w(1),N("ngIf",e.enviandoMensajes),w(1),N("ngIf",e.enviandoMensajes)}}function Ppe(t,n){if(1&t&&(d(0,"div",28)(1,"strong"),h(2,"Nro de formulas:\xa0 "),u(),h(3),u()),2&t){const e=ae();w(3),Qt(" ",null==e.listaPaciente?null:e.listaPaciente.length," ")}}function Ope(t,n){if(1&t&&(d(0,"div",29)(1,"strong"),h(2,"Total pendientes:\xa0 "),u(),h(3),u()),2&t){const e=ae();w(3),Qt(" ",e.totalCantidadPendiente||0," ")}}function Npe(t,n){1&t&&(d(0,"div",30),h(1," No hay registros para mostrar! "),u())}const g8=function(){return{color:"red"}};function Rpe(t,n){1&t&&(d(0,"mat-icon",40),h(1,"person_outline"),u()),2&t&&N("ngStyle",Nt(1,g8))}const _8=function(t){return["/menu/entrega",t]};function Lpe(t,n){if(1&t&&(d(0,"button",41)(1,"mat-icon",39),h(2,"remove_circle_outline"),u()()),2&t){const e=ae().$implicit;N("routerLink",Si(2,_8,e.idFormula)),w(1),N("ngStyle",Nt(4,g8))}}const Bpe=function(){return{color:"orange"}};function jpe(t,n){if(1&t&&(d(0,"button",41)(1,"mat-icon",39),h(2,"remove_circle_outline"),u()()),2&t){const e=ae().$implicit;N("routerLink",Si(2,_8,e.idFormula)),w(1),N("ngStyle",Nt(4,Bpe))}}function Vpe(t,n){1&t&&(d(0,"mat-icon",42),Ns(),d(1,"svg",43),qe(2,"path",44),u()()),2&t&&(ae(),N("matMenuTriggerFor",go(25)))}const Upe=function(){return{color:"green"}},Hpe=function(){return{color:"#2BB6D7"}};function zpe(t,n){if(1&t){const e=Fn();d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),oe(12,Rpe,2,2,"mat-icon",34),u(),d(13,"td"),h(14),u(),d(15,"td"),h(16),Hi(17,"date"),u(),d(18,"td"),h(19),u(),d(20,"td"),oe(21,Lpe,3,5,"button",35),oe(22,jpe,3,5,"button",35),oe(23,Vpe,3,1,"mat-icon",36),d(24,"mat-menu",null,37)(26,"button",38),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).vermensajeWhatsApp(o))}),d(27,"mat-icon",39),h(28,"art_track"),u(),d(29,"span"),h(30,"Ver mensaje"),u()(),d(31,"button",38),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).enviarWhatsApp(o))}),d(32,"mat-icon",39),h(33,"playlist_add"),u(),d(34,"span"),h(35,"Enviar mensaje"),u()()()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);w(2),_e(r+1),w(2),fo("",e.tipoDoc||"","-",e.numDocumento||"",""),w(2),Up("",e.pNombre||""," ",e.sNombre||""," ",e.pApellido||""," ",e.sApellido||"",""),w(2),_e(e.telefono),w(2),_e(e.codEps),w(2),N("ngIf","SI"===e.pave),w(2),_e(e.idFormula||""),w(2),_e(Xo(17,18,e.fecSolicitud,"dd/MM/YYYY")),w(3),_e(e.pendiente),w(2),N("ngIf",0===e.cantidadEntrega),w(1),N("ngIf",e.cantidadEntrega>0),w(1),N("ngIf",i.tieneAcceso(2)),w(4),N("ngStyle",Nt(21,Upe)),w(5),N("ngStyle",Nt(22,Hpe))}}function $pe(t,n){if(1&t&&(d(0,"div")(1,"table",31)(2,"thead",32)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Documento"),u(),d(8,"th"),h(9,"Nombres y apellidos paciente"),u(),d(10,"th"),h(11,"Celular"),u(),d(12,"th"),h(13,"EPS "),u(),d(14,"th"),h(15,"PAVE "),u(),d(16,"th"),h(17,"Formula "),u(),d(18,"th"),h(19,"Fecha del pendiente"),u(),d(20,"th"),h(21,"Cantidad"),u(),d(22,"th"),h(23,"Gesti\xf3n"),u()()(),d(24,"tbody"),oe(25,zpe,36,23,"tr",33),u()()()),2&t){const e=ae();w(25),N("ngForOf",e.listaPaciente)}}const Wpe=function(t){return["/menu/pendiente",t]};let qpe=(()=>{class t{constructor(e,r,i,o){this.servicio=e,this.activatedRoute=r,this.whatsappService=i,this.fb=o,this.listaPaciente=[],this.idBodega=NaN,this.idMedicamento=NaN,this.mensajeWhat=new Epe,this.enviandoMensajes=!1,this.listaPacientePave=[],this.totalCantidadPendiente=0;const a=new Date,s=new Date(a);s.setDate(a.getDate()-90),this.generalForm=this.fb.group({idBodega:[""],fechainicial:[s.toISOString().split("T")[0]],fechafinal:[a.toISOString().split("T")[0]],listFilter:[""]})}ngOnInit(){this.idBodega=Number(this.activatedRoute.snapshot.paramMap.get("idBodega")),this.idMedicamento=Number(this.activatedRoute.snapshot.paramMap.get("idMedicamento"));const e=this.activatedRoute.snapshot.paramMap.get("fInicial"),r=this.activatedRoute.snapshot.paramMap.get("fFinal");!isNaN(this.idBodega)&&!isNaN(this.idMedicamento)&&e&&r&&this.buscarRegistro(this.idBodega,e,r,this.idMedicamento)}buscarRegistro(e,r,i,o){this.totalCantidadPendiente=0,z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.servicio.getPacientePendiente(e,r,i,o).subscribe(a=>{this.listaPaciente=a,this.listaPaciente.sort((l,c)=>new Date(c.fecSolicitud).getTime()-new Date(l.fecSolicitud).getTime()),z().close();const s=this.listaPaciente.reduce((l,c)=>l+(c.pendiente||0),0);this.totalCantidadPendiente=s},a=>{console.error("\u274c Error cargando registros",a),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})}buscarPendiente(){z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.servicio.getPacientePendiente(this.idBodega,this.generalForm.get("fechainicial")?.value,this.generalForm.get("fechafinal")?.value,this.idMedicamento).subscribe(e=>{this.listaPaciente=e,this.listaPacientePave=e,this.listaPaciente.sort((r,i)=>new Date(i.fecSolicitud).getTime()-new Date(r.fecSolicitud).getTime()),z().close()},e=>{console.error("\u274c Error cargando registros",e),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})}enviarWhatsApp(e){const r="Hola *"+e.pNombre+"*! \n"+e.bodega+" te informa que el pendiente Nro. *"+e.idFormula+"* de tu medicamento. \n\u{1f48a}"+e.nombreMedicamento+" \nYa se encuentra disponible para que lo puedas recoger, en tu punto de entrega. \nRecuerde que debe traer su volante de pendiente. \n\n*POR FAVOR NO RESPONDER ESTE MENSAJE*";z().fire({title:"\xbfEnviar mensaje?",html:`\n      <p><strong>N\xfamero:</strong> ${e?.telefono}</p>\n      <p><strong>Mensaje:</strong></p>\n      <p>${r}</p>\n    `,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, enviar!"}).then(i=>{i.isConfirmed&&(this.mensajeWhat.phone=e?.telefono.replace(/\s/g,""),this.mensajeWhat.message=r,this.celularValido(e?.telefono.replace(/\s/g,""))?this.whatsappService.enviarMensaje(this.mensajeWhat).subscribe(o=>{z().fire("\u{1f4e4} Mensaje enviado","","success")},o=>{z().fire("\u274c Error al enviar el mensaje",o.message||"Error desconocido","error"),console.error(o)}):z().fire("Error","\u274c El n\xfamero del paciente "+e?.telefono+",  no es v\xe1lido para enviar el mensaje!","error"))})}vermensajeWhatsApp(e){var r=this;return(0,hi.Z)(function*(){const i="Hola *"+e.pNombre+"*! \n"+e.bodega+" te informa que el pendiente Nro. *"+e.idFormula+"* de tu medicamento. \n\u{1f48a}"+e.nombreMedicamento+" \nYa se encuentra disponible para que lo puedas recoger, en tu punto de entrega. \nRecuerde que debe traer su volante de pendiente. \n\n*POR FAVOR NO RESPONDER ESTE MENSAJE*",{value:o}=yield z().fire({title:"Editar y enviar WhatsApp",html:`\n                  <label style="display:block; text-align:left;">Mensaje:</label>\n                  <textarea id="mensaje" placeholder="Mensaje a enviar"\n                  style="width: 100%; height: 180px; padding: 10px; resize: vertical; font-size: 14px;">${i}</textarea>\n                  <label style="display:block; margin-top:10px; text-align:left;">N\xfamero celular:</label>\n                  <input id="telefono" class="swal2-input" placeholder="N\xfamero celular" value="${e?.telefono||""}">\n                `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Continuar",cancelButtonText:"Cancelar",preConfirm:()=>{const a=document.getElementById("mensaje").value,s=document.getElementById("telefono").value;return a&&s?{mensaje:a,telefono:s}:(z().showValidationMessage("Ninguno de los campos debe ser vacio"),null)}});if(o)if((yield z().fire({title:"\xbfEnviar mensaje?",html:`\n                    <p><strong>N\xfamero:</strong> ${o.telefono}</p>\n                    <p><strong>Mensaje:</strong></p>\n                    <p>${o.mensaje}</p>\n                  `,icon:"question",showCancelButton:!0,confirmButtonText:"S\xed, enviar",cancelButtonText:"No, cancelar"})).isConfirmed){const s=o.mensaje;r.mensajeWhat.phone="57"+o.telefono,r.mensajeWhat.message=s,r.celularValido(o.telefono)?r.whatsappService.enviarMensaje(r.mensajeWhat).subscribe(l=>{z().fire("\u{1f4e4} Mensaje enviado","","success")},l=>{z().fire("\u274c Error al enviar el mensaje",l.message||"Error desconocido","error"),console.error(l)}):z().fire("Celular invalido","El numero de celular "+o.telefono+" no es valido para realizar el envio del mensaje.","error")}else z().fire("\u274c Env\xedo cancelado","","info")})()}celularValido(e){return/^[3][0-9]{9}$/.test(e)}mensajesWSPave(){var e=this;return(0,hi.Z)(function*(){if(e.listaPacientePave=e.listaPaciente,e.listaPaciente=e.listaPaciente.filter(r=>"SI"===r.pave),0===e.listaPaciente.length)return z().fire("Sin pacientes PAVE","No se encontraron pacientes PAVE con pendientes de este medicamento, por lo tanto no se le dio tramite de env\xedo de ningun mensaje!.","info"),void(e.listaPaciente=e.listaPacientePave);yield e.enviarMensajesConRetraso(),e.listaPaciente=e.listaPacientePave})()}enviarMensajesConRetraso(){var e=this;return(0,hi.Z)(function*(){if(!(yield z().fire({title:"\xbfConfirmar env\xedo masivo?",html:`Se enviar\xe1n mensajes de WhatsApp a <strong>${e.listaPaciente.length}</strong> pacientes.<br><br>\xbfDeseas continuar?`,icon:"question",showCancelButton:!0,confirmButtonText:"S\xed, enviar",cancelButtonText:"Cancelar"})).isConfirmed)return;e.enviandoMensajes=!0;let i=0;for(const o of e.listaPaciente){const a=`Hola *${o.pNombre}*! \n${o.bodega} te informa que el pendiente Nro. *${o.idFormula}* de tu medicamento. \n\u{1f48a}${o.nombreMedicamento} \nYa se encuentra disponible para que lo puedas recoger, en tu punto de entrega. \nRecuerde que debe traer su volante de pendiente. \n\n*POR FAVOR NO RESPONDER ESTE MENSAJE*`,s="57"+o?.telefono.replace(/\s/g,"");if(e.celularValido(o?.telefono.replace(/\s/g,"")))try{i++,yield e.whatsappService.enviarMensaje({phone:s,message:a}).toPromise()}catch(l){console.error(`\u274c Error enviando a ${s}`,l)}else console.warn(`\u26a0\ufe0f Tel\xe9fono inv\xe1lido: ${o.telefono}`);yield new Promise(l=>setTimeout(l,3e3))}e.enviandoMensajes=!1,yield z().fire("\u2714\ufe0f Mensajes procesados",`Se enviaron <strong>${i}</strong> mensajes de un total de <strong>${e.listaPaciente.length}</strong>.<br>Los dem\xe1s presentaron inconvenientes en el n\xfamero de celular.`,"success")})()}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}static#e=this.\u0275fac=function(r){return new(r||t)(X(Ts),X(Us),X(e8),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-pacientependiente"]],decls:31,vars:12,consts:[[1,"container","mt-2"],[1,"row","mb-3",3,"formGroup"],[1,"col-md-6"],[1,"d-flex","align-items-center","mb-2"],["for","fechainicial",1,"form-label","me-2","mb-0"],["id","fechainicial","type","date","formControlName","fechainicial",1,"form-control","me-3"],["for","fechafinal",1,"form-label","me-2","mb-0"],["id","fechafinal","type","date","formControlName","fechafinal",1,"form-control"],[1,"col-md-6","d-flex","justify-content-end","align-items-start"],[1,"d-flex","flex-column","flex-md-row","flex-wrap","gap-2","w-100","justify-content-md-end"],["type","button",1,"btn","btn-info","d-flex","align-items-center","justify-content-center",3,"click"],[1,"me-1"],["type","button","class","btn btn-warning btn-sm btn-uniform",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-success btn-sm btn-uniform d-flex align-items-center justify-content-center",3,"disabled","click",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary","btn-sm","btn-uniform",3,"routerLink"],[1,"text-muted","small","d-flex","align-items-center","justify-content-between","flex-wrap","gap-2","w-100"],["class","alert alert-info mb-0 py-1 px-2 d-inline-flex align-items-center",4,"ngIf"],["class","alert alert-danger mb-0 py-1 px-2 d-inline-flex align-items-center",4,"ngIf"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-warning","btn-sm","btn-uniform",3,"disabled","click"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","fill","white","viewBox","0 0 448 512",2,"margin-right","6px"],["d","M380.9 97.1C339 55.1 283.2 32 224.2 32c-115 0-208 93-208 208 \n                 0 36.7 9.7 72.4 28.1 103.9L2.5 470.1c-2.2 6.5-.4 13.7 4.5 \n                 18.5 3.6 3.6 8.4 5.5 13.1 5.5 2 0 4.1-.3 6-1l119.8-38.2c30.4 \n                 16.6 64.7 25.4 99.1 25.4h.1c115 0 208-93 208-208 \n                 0-55.6-21.6-107.9-60.2-146.2zM224.2 438.6c-30.5 0-60.6-8.2-86.7-23.7l-6.2-3.7-71.2 \n                 22.7 22.9-69.3-4.1-6.4c-17.7-27.6-27-59.5-27-92.2 \n                 0-95.1 77.4-172.4 172.5-172.4 46 0 89.2 17.9 121.7 \n                 50.4s50.3 75.8 50.3 121.6c.1 95.1-77.3 172.6-172.2 \n                 172.6zm101.4-138.1c-5.5-2.8-32.7-16.1-37.8-17.9-5.1-1.9-8.8-2.8-12.6 \n                 2.8s-14.5 17.9-17.8 21.6c-3.3 3.7-6.5 4.2-12 \n                 1.4s-23.4-8.6-44.6-27.4c-16.5-14.7-27.6-32.9-30.8-38.4-3.2-5.6-.3-8.6 \n                 2.4-11.4 2.5-2.6 5.6-6.6 8.4-9.9 2.8-3.3 3.7-5.6 \n                 5.6-9.3s.9-7-0.5-9.9c-1.4-2.8-12.6-30.3-17.3-41.4-4.5-10.8-9.1-9.3-12.6-9.5-3.3-.2-7.1-.2-10.9-.2s-10.1 \n                 1.4-15.4 7c-5.3 5.6-20.2 19.7-20.2 48.1s20.7 55.8 \n                 23.5 59.7c2.8 3.7 40.7 62.1 98.6 87.2 13.8 5.9 \n                 24.6 9.4 33 12 13.9 4.4 26.5 3.8 36.5 2.3 11.1-1.7 \n                 32.7-13.3 37.3-26.2 4.6-12.9 4.6-23.9 3.2-26.2-1.3-2.2-5-3.6-10.5-6.3z"],["class","spinner-border spinner-border-sm text-light me-1","role","status",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","text-light","me-1"],[1,"visually-hidden"],["type","button",1,"btn","btn-success","btn-sm","btn-uniform","d-flex","align-items-center","justify-content-center",3,"disabled","click"],["d","M380.9 97.1C339 55.1 283.2 32 224.2 32c-115 0-208 93-208 208 \n                       0 36.7 9.7 72.4 28.1 103.9L2.5 470.1c-2.2 6.5-.4 13.7 4.5 \n                       18.5 3.6 3.6 8.4 5.5 13.1 5.5 2 0 4.1-.3 6-1l119.8-38.2c30.4 \n                       16.6 64.7 25.4 99.1 25.4h.1c115 0 208-93 208-208 \n                       0-55.6-21.6-107.9-60.2-146.2zM224.2 438.6c-30.5 0-60.6-8.2-86.7-23.7l-6.2-3.7-71.2 \n                       22.7 22.9-69.3-4.1-6.4c-17.7-27.6-27-59.5-27-92.2 \n                       0-95.1 77.4-172.4 172.5-172.4 46 0 89.2 17.9 121.7 \n                       50.4s50.3 75.8 50.3 121.6c.1 95.1-77.3 172.6-172.2 \n                       172.6zm101.4-138.1c-5.5-2.8-32.7-16.1-37.8-17.9-5.1-1.9-8.8-2.8-12.6 \n                       2.8s-14.5 17.9-17.8 21.6c-3.3 3.7-6.5 4.2-12 \n                       1.4s-23.4-8.6-44.6-27.4c-16.5-14.7-27.6-32.9-30.8-38.4-3.2-5.6-.3-8.6 \n                       2.4-11.4 2.5-2.6 5.6-6.6 8.4-9.9 2.8-3.3 3.7-5.6 \n                       5.6-9.3s.9-7-0.5-9.9c-1.4-2.8-12.6-30.3-17.3-41.4-4.5-10.8-9.1-9.3-12.6-9.5-3.3-.2-7.1-.2-10.9-.2s-10.1 \n                       1.4-15.4 7c-5.3 5.6-20.2 19.7-20.2 48.1s20.7 55.8 \n                       23.5 59.7c2.8 3.7 40.7 62.1 98.6 87.2 13.8 5.9 \n                       24.6 9.4 33 12 13.9 4.4 26.5 3.8 36.5 2.3 11.1-1.7 \n                       32.7-13.3 37.3-26.2 4.6-12.9 4.6-23.9 3.2-26.2-1.3-2.2-5-3.6-10.5-6.3z"],[1,"alert","alert-info","mb-0","py-1","px-2","d-inline-flex","align-items-center"],[1,"alert","alert-danger","mb-0","py-1","px-2","d-inline-flex","align-items-center"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[4,"ngFor","ngForOf"],["title","paciente PAVE",3,"ngStyle",4,"ngIf"],["title","Gestionar Pendiente","type","button","class","btn btn-sm",3,"routerLink",4,"ngIf"],["class","puntero","title","Enviar mensaje","style","font-size: 20px; color: #25D366;",3,"matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click"],[3,"ngStyle"],["title","paciente PAVE",3,"ngStyle"],["title","Gestionar Pendiente","type","button",1,"btn","btn-sm",3,"routerLink"],["title","Enviar mensaje",1,"puntero",2,"font-size","20px","color","#25D366",3,"matMenuTriggerFor"],["xmlns","http://www.w3.org/2000/svg","height","20","viewBox","0 0 448 512","fill","currentColor"],["d","M380.9 97.1C339 55.1 283.2 32 224.2 32c-115 0-208 93-208 208 \n                                            0 36.7 9.7 72.4 28.1 103.9L2.5 470.1c-2.2 6.5-.4 13.7 4.5 \n                                            18.5 3.6 3.6 8.4 5.5 13.1 5.5 2 0 4.1-.3 6-1l119.8-38.2c30.4 \n                                            16.6 64.7 25.4 99.1 25.4h.1c115 0 208-93 208-208 \n                                            0-55.6-21.6-107.9-60.2-146.2zM224.2 438.6c-30.5 0-60.6-8.2-86.7-23.7l-6.2-3.7-71.2 \n                                            22.7 22.9-69.3-4.1-6.4c-17.7-27.6-27-59.5-27-92.2 \n                                            0-95.1 77.4-172.4 172.5-172.4 46 0 89.2 17.9 121.7 \n                                            50.4s50.3 75.8 50.3 121.6c.1 95.1-77.3 172.6-172.2 \n                                            172.6zm101.4-138.1c-5.5-2.8-32.7-16.1-37.8-17.9-5.1-1.9-8.8-2.8-12.6 \n                                            2.8s-14.5 17.9-17.8 21.6c-3.3 3.7-6.5 4.2-12 \n                                            1.4s-23.4-8.6-44.6-27.4c-16.5-14.7-27.6-32.9-30.8-38.4-3.2-5.6-.3-8.6 \n                                            2.4-11.4 2.5-2.6 5.6-6.6 8.4-9.9 2.8-3.3 3.7-5.6 \n                                            5.6-9.3s.9-7-0.5-9.9c-1.4-2.8-12.6-30.3-17.3-41.4-4.5-10.8-9.1-9.3-12.6-9.5-3.3-.2-7.1-.2-10.9-.2s-10.1 \n                                            1.4-15.4 7c-5.3 5.6-20.2 19.7-20.2 48.1s20.7 55.8 \n                                            23.5 59.7c2.8 3.7 40.7 62.1 98.6 87.2 13.8 5.9 \n                                            24.6 9.4 33 12 13.9 4.4 26.5 3.8 36.5 2.3 11.1-1.7 \n                                            32.7-13.3 37.3-26.2 4.6-12.9 4.6-23.9 3.2-26.2-1.3-2.2-5-3.6-10.5-6.3z"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),h(5,"Desde:"),u(),qe(6,"input",5),d(7,"label",6),h(8,"Hasta:"),u(),qe(9,"input",7),u()(),d(10,"div",8)(11,"div",9)(12,"button",10),De("click",function(){return i.buscarPendiente()}),d(13,"mat-icon",11),h(14,"search"),u(),h(15," Buscar "),u(),oe(16,Tpe,6,4,"button",12),oe(17,Ipe,6,4,"button",13),d(18,"button",14),h(19," Regresar "),u()()(),d(20,"div",15)(21,"span")(22,"strong"),h(23),u(),h(24," - Pendiente: "),d(25,"strong"),h(26),u()(),oe(27,Ppe,4,1,"div",16),oe(28,Ope,4,1,"div",17),u()(),oe(29,Npe,2,0,"div",18),oe(30,$pe,26,1,"div",19),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(15),N("ngIf",i.tieneAcceso(2)),w(1),N("ngIf",i.tieneAcceso(2)),w(1),N("routerLink",Si(10,Wpe,i.idBodega)),w(5),_e((null==i.listaPaciente[0]?null:i.listaPaciente[0].bodega)||""),w(3),_e((null==i.listaPaciente[0]?null:i.listaPaciente[0].nombreMedicamento)||""),w(1),N("ngIf",(null==i.listaPaciente?null:i.listaPaciente.length)>0),w(1),N("ngIf",(null==i.listaPaciente?null:i.listaPaciente.length)>0),w(1),N("ngIf",0==(null==i.listaPaciente?null:i.listaPaciente.length)),w(1),N("ngIf",(null==i.listaPaciente?null:i.listaPaciente.length)>0))},dependencies:[ho,Fi,Jo,Hs,n0,Of,r0,Wo,vo,No,zo,bo,Ro,Sc],styles:[".btn-uniform[_ngcontent-%COMP%] {\n      min-width: 130px;\n      \n    }"]})}return t})();function Gpe(t,n){if(1&t&&(d(0,"mat-option",11),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function Ype(t,n){if(1&t&&(d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),u(),d(15,"td",15)(16,"strong"),h(17),u()()()),2&t){const e=n.$implicit,r=n.index;w(2),_e(r+1),w(2),_e(e.id),w(2),_e(e.dato_1),w(2),_e(e.dato_2),w(2),_e(e.dato_3),w(2),_e(e.dato_4),w(2),_e(e.dato_5),w(3),_e(e.d_1)}}function Xpe(t,n){if(1&t&&(d(0,"div")(1,"table",12)(2,"thead",13)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"ID"),u(),d(8,"th"),h(9,"Nombre del medicamento"),u(),d(10,"th"),h(11,"Cum"),u(),d(12,"th"),h(13,"Presentaci\xf3n"),u(),d(14,"th"),h(15,"Via"),u(),d(16,"th"),h(17,"Bodega"),u(),d(18,"th"),h(19,"Existencia"),u()()(),d(20,"tbody"),oe(21,Ype,18,8,"tr",14),u()()()),2&t){const e=ae();w(21),N("ngForOf",e.listaItemBodega)}}function Kpe(t,n){if(1&t&&(d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),Hi(5,"date"),u(),d(6,"td"),h(7),u(),d(8,"td"),h(9),u(),d(10,"td"),h(11),u(),d(12,"td"),h(13),u(),d(14,"td",15)(15,"strong"),h(16),u()()()),2&t){const e=n.$implicit;w(2),_e(e.idDespacho),w(2),_e(Xo(5,7,e.fechaDespacho,"dd/MM/YYYY")),w(3),_e(e.bodegaOrigen),w(2),_e(e.bodegaDestino),w(2),_e(e.nombreMedicamento),w(2),_e(e.presentacion),w(3),_e(e.cantidad)}}function Zpe(t,n){if(1&t&&(d(0,"div")(1,"div",16)(2,"span",17)(3,"strong"),h(4," EXISTENCIA DEL MEDICAMENTO EN CANJE EN ESTADO ENVIO "),u()()(),d(5,"table",18)(6,"thead",19)(7,"tr")(8,"th"),h(9,"Orden"),u(),d(10,"th"),h(11,"Fecha "),u(),d(12,"th"),h(13,"Origen "),u(),d(14,"th"),h(15,"Destino"),u(),d(16,"th"),h(17,"Nombre Medicamento"),u(),d(18,"th"),h(19,"Presentacion"),u(),d(20,"th"),h(21,"Cantidad"),u()()(),d(22,"tbody"),oe(23,Kpe,17,10,"tr",14),u()()()),2&t){const e=ae();w(23),N("ngForOf",e.listaItemEnvio)}}let Qpe=(()=>{class t{constructor(e,r,i,o){this.servicio=e,this.formulaService=r,this.ordendespachoservicio=i,this.fb=o,this.listaItemBodega=[],this.medicamentosFiltrados=[],this.medicamentoActual=NaN,this.listaItemEnvio=[]}ngOnInit(){this.generalForm=this.fb.group({medicamento:[""]}),this.generalForm.get("medicamento").valueChanges.pipe(xo(300),Di(e=>this.formulaService.filtrarMedicamentos(e))).subscribe(e=>{this.medicamentosFiltrados=e})}seleccionarMedicamento(e){this.medicamentoActual=e.option.value.idMedicamento,console.log(this.medicamentoActual),this.generalForm.get("medicamento")?.setValue(e.option.value.nombre),this.buscarRegistro(this.medicamentoActual),this.buscarRegistroEnvio(this.medicamentoActual)}buscarRegistro(e){return e?(this.servicio.getExistenciasMedicamentoPuntual(e).subscribe(r=>{this.listaItemBodega=r.sort((i,o)=>i.dato_5.localeCompare(o.dato_5))}),On(this.listaItemBodega)):On([])}buscarRegistroEnvio(e){return e?(this.ordendespachoservicio.getMedicamentoOrdenDespachoEnvio(e).subscribe(r=>{this.listaItemEnvio=r}),On(this.listaItemEnvio)):On([])}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(Ts),X(Dd),X(y_),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-existencias"]],decls:15,vars:5,consts:[[1,"container","mt-2"],[1,"mb-2"],[1,"text-container"],[1,"input-group","mb-2","align-center",3,"formGroup"],[1,"bodega-nombre"],["appearance","fill",1,"w-100"],["type","text","matInput","","formControlName","medicamento",3,"matAutocomplete"],[3,"optionSelected"],["automedicamento","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[4,"ngFor","ngForOf"],[2,"color","green","text-align","right"],[1,"col-12","text-center"],[1,"text-green"],[1,"table","table-striped","table-hover","table-sm","mt-2"],[1,"thead-gradient-d"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),h(5," Visualiza solo los registros que tienen existencias "),u(),d(6,"mat-form-field",5)(7,"mat-label"),h(8,"Digite y seleccione el nombre del medicamento a buscar "),u(),qe(9,"input",6),d(10,"mat-autocomplete",7,8),De("optionSelected",function(a){return i.seleccionarMedicamento(a)}),oe(12,Gpe,2,2,"mat-option",9),u()()()()(),oe(13,Xpe,22,1,"div",10),oe(14,Zpe,24,1,"div",10),u()),2&r){const o=go(11);w(3),N("formGroup",i.generalForm),w(6),N("matAutocomplete",o),w(3),N("ngForOf",i.medicamentosFiltrados),w(1),N("ngIf",(null==i.listaItemBodega?null:i.listaItemBodega.length)>0),w(1),N("ngIf",(null==i.listaItemEnvio?null:i.listaItemEnvio.length)>0)}},dependencies:[ho,Fi,vo,No,zo,bo,Ro,c0,_m,hm,b_,gm,u0,Sc],styles:[".bodega-nombre[_ngcontent-%COMP%]{margin-right:10px;font-weight:700}.text-green[_ngcontent-%COMP%]{color:green}"]})}return t})(),Jpe=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-norotan"]],decls:2,vars:0,template:function(r,i){1&r&&(d(0,"p"),h(1,"norotan works! Version 2.1"),u())}})}return t})();function eme(t,n){1&t&&(d(0,"div",77),h(1," El n\xfamero de la formula es requerido. "),u())}function tme(t,n){if(1&t&&(d(0,"mat-option",78),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function nme(t,n){if(1&t&&(d(0,"mat-option",78),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),fo(" ",e.nombre," - ",e.especialidad," ")}}function rme(t,n){1&t&&(d(0,"div",77),h(1," M\xe9dico que prescribe la f\xf3rmula es requerido. "),u())}function ime(t,n){1&t&&(d(0,"div",77),h(1," La fecha de la prescripci\xf3n de la f\xf3rmula es requerida. "),u())}function ome(t,n){1&t&&(d(0,"div",77),h(1," La fecha de solicitud de la f\xf3rmula es requerida. "),u())}function ame(t,n){if(1&t&&(d(0,"div",7)(1,"mat-slide-toggle",79),h(2,"Cobro la cuota moderadora!"),u(),d(3,"h5",80)(4,"span",81),h(5),Hi(6,"currency"),u()()()),2&t){const e=ae();w(1),N("checked",e.cobroCuotaModeradora()),w(4),fo(" ",e.pacienteActual.categoria.nombre," : ",QC(6,3,e.formula.valorCM,"COP","symbol-narrow","1.0-0")," ")}}function sme(t,n){if(1&t){const e=Fn();d(0,"div",82)(1,"p")(2,"strong"),h(3,"Nombre:"),u(),h(4),u(),d(5,"p")(6,"strong"),h(7,"Documento:"),u(),h(8),d(9,"button",83),De("click",function(){return ht(e),pt(ae().reporteEnConstruccion())}),d(10,"mat-icon",84),h(11,"edith"),u()()(),d(12,"p")(13,"strong"),h(14,"Eps:"),u(),h(15),u(),d(16,"p")(17,"strong"),h(18,"Direcci\xf3n:"),u(),h(19),u(),d(20,"p")(21,"strong"),h(22,"Celular:"),u(),h(23),d(24,"button",85),De("click",function(){return ht(e),pt(ae().reporteEnConstruccion())}),d(25,"mat-icon",84),h(26,"edith"),u()()(),d(27,"p")(28,"strong"),h(29,"Sexo:"),u(),h(30),d(31,"strong"),h(32," - Edad:"),u(),h(33),u()()}if(2&t){const e=ae();w(4),Up(" ",e.pacienteActual.pNombre," ",e.pacienteActual.sNombre," ",e.pacienteActual.pApellido," ",e.pacienteActual.sApellido,""),w(4),fo(" ",e.pacienteActual.tipoDoc," - ",e.pacienteActual.numDocumento," "),w(7),Qt(" ",e.pacienteActual.eps.nombre,""),w(4),Qt(" ",e.pacienteActual.direccion,""),w(4),fo(" ",e.pacienteActual.celularPrincipal," - ",e.pacienteActual.celularSecundario," "),w(7),Qt(" ",e.pacienteActual.sexo," "),w(3),Qt(" ",e.calcularEdad(e.pacienteActual.fecNacimiento)," a\xf1os")}}function lme(t,n){1&t&&(d(0,"div",87)(1,"p")(2,"strong"),h(3,"Paciente PAVE"),u()()())}function cme(t,n){if(1&t&&(d(0,"div",88)(1,"p")(2,"strong"),h(3),Hi(4,"date"),u()()()),2&t){const e=ae(2);w(3),fo("Portabilidad - ",e.pacienteActual.mpoportabilidad.nombre," vence: ",Xo(4,2,e.pacienteActual.fecVencePortabilidad,"dd/MM/YYYY"),"")}}function ume(t,n){if(1&t&&(d(0,"div",86)(1,"p")(2,"strong"),h(3,"Municipio:"),u(),h(4),u(),d(5,"p")(6,"strong"),h(7,"Dispensario:"),u(),h(8),u(),d(9,"p")(10,"strong"),h(11,"Continuidad:"),u(),h(12),u(),oe(13,lme,4,0,"div",63),oe(14,cme,5,5,"div",64),u()),2&t){const e=ae();w(4),fo(" ",e.pacienteActual.municipio.nombre," - ",e.pacienteActual.municipio.departamento.nombre,""),w(4),Qt(" ",e.pacienteActual.dispensario," "),w(4),Qt(" ",e.formula.continuidad," "),w(1),N("ngIf",e.pacienteActual.pave),w(1),N("ngIf",e.pacienteActual.portabilidad)}}function dme(t,n){1&t&&(d(0,"div",77),h(1," El Dx Principal es requerido. "),u())}function fme(t,n){if(1&t&&(d(0,"small",90),h(1),u()),2&t){const e=ae(2);w(1),Qt(" ",e.mensajeComentario," ")}}function hme(t,n){if(1&t&&(d(0,"div",77),oe(1,fme,2,1,"small",89),u()),2&t){const e=ae();w(1),N("ngIf",e.comentarioVisible)}}function pme(t,n){if(1&t&&(d(0,"small",90),h(1),u()),2&t){const e=ae(2);w(1),Qt(" ",e.mensajeErrorDx," ")}}function mme(t,n){if(1&t&&(d(0,"div",77),oe(1,pme,2,1,"small",89),u()),2&t){const e=ae();w(1),N("ngIf",e.comentarioVisible)}}function gme(t,n){1&t&&(d(0,"div",77),h(1," El programa del paciente es requerido. "),u())}function _me(t,n){1&t&&(d(0,"div",87)(1,"p")(2,"strong"),h(3,"FORMULA YA PROCESADA"),u()()())}function vme(t,n){1&t&&(d(0,"div",88)(1,"p")(2,"strong"),h(3,"FORMULA PENDIENTE PROCESAR"),u()()())}function bme(t,n){if(1&t&&(d(0,"mat-option",78),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function yme(t,n){1&t&&(d(0,"div",77),h(1," No ha seleccionado los medicamentos de la f\xf3rmula. "),u())}function wme(t,n){1&t&&(d(0,"div",91),h(1," No hay medicamentos asignados para la f\xf3rmula, debe agregar al menos uno. "),u())}function xme(t,n){if(1&t&&(d(0,"option",103),h(1),u()),2&t){const e=n.$implicit,r=ae().$implicit;N("value",e.valor)("selected",e.valor===r.frecuencia),kr("data-multiplicador",e.multiplicador),w(1),Qt(" ",e.nombre," ")}}const Cme=function(t){return{color:t}},Eme=function(t){return{"background-color":t}};function Sme(t,n){if(1&t){const e=Fn();d(0,"tr",97)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td")(6,"select",98),De("change",function(i){const a=ht(e).$implicit;return pt(ae(2).seleccionFrecuencia(a.medicamento.idMedicamento,i))}),oe(7,xme,2,4,"option",99),u()(),d(8,"td")(9,"input",100),De("change",function(i){const a=ht(e).$implicit;return pt(ae(2).duracionTratamiento(a.medicamento.idMedicamento,i))}),u()(),d(10,"td")(11,"input",101),De("change",function(i){const a=ht(e).$implicit;return pt(ae(2).actualizarCantidad(a.medicamento.idMedicamento,i))}),u()(),d(12,"td"),h(13),Hi(14,"currency"),u(),d(15,"td"),h(16),Hi(17,"currency"),u(),d(18,"td")(19,"button",102),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarItemFormula(o.idItem))}),h(20,"x"),u()(),d(21,"td"),h(22),u()()}if(2&t){const e=n.$implicit,r=ae(2);N("ngStyle",Si(18,Cme,e.medicamento.desabastecido?"red":"black")),w(2),_e(e.medicamento.idMedicamento),w(2),_e(e.medicamento.nombre),w(2),N("value",e.frecuencia),w(1),N("ngForOf",r.frecuencias),w(2),N("value",e.duracion)("min",1),w(2),N("value",e.cantidad)("disabled",e.habilitarCantidad)("ngStyle",Si(20,Eme,e.habilitarCantidad?"gris":"#A5E3C6"))("min",1),w(2),Qt(" ",_h(14,14,e.medicamento.valor)," "),w(3),Qt(" ",_h(17,16,e.importe)," "),w(6),_e(r.existencias[e.medicamento.idMedicamento]||"0")}}function Dme(t,n){if(1&t&&(d(0,"table",92)(1,"thead",93)(2,"tr")(3,"th"),h(4,"ID"),u(),d(5,"th"),h(6,"Medicamento"),u(),d(7,"th",94),h(8,"Frecuencia"),u(),d(9,"th",95),h(10,"Duraci\xf3n"),u(),d(11,"th",95),h(12,"Cantidad"),u(),d(13,"th",95),h(14,"Precio Unitario"),u(),d(15,"th",95),h(16,"Total"),u(),d(17,"th",95),h(18,"Eliminar"),u(),d(19,"th"),h(20,"Inventario"),u()()(),d(21,"tbody"),oe(22,Sme,23,22,"tr",96),u()()),2&t){const e=ae();w(22),N("ngForOf",e.formula.items)}}let v8=(()=>{class t{constructor(e,r,i,o,a,s,l,c,f,v){this.pacienteService=e,this.formulaService=r,this.medicamentoService=i,this.medicoService=o,this.ipsService=a,this.bodegaService=s,this.router=l,this.formBuilder=c,this.activatedRoute=f,this.dialog=v,this.formula=new wx,this.mostrarComponente=!1,this.existencias={},this.comentarioVisible=!1,this.mensajeComentario="",this.mensajeErrorDx="",this.dxValido=!0,this.formasConCantidadHabilitada=[3,15,19,20,22,24,116],this.frecuencias=[{nombre:"1 Cada 24 Horas",multiplicador:1,valor:"1 Cada 24 Horas"},{nombre:"1 Cada 12 Horas",multiplicador:2,valor:"1 Cada 12 Horas"},{nombre:"1 Cada 8 Horas",multiplicador:3,valor:"1 Cada 8 Horas"},{nombre:"1 Cada 6 Horas",multiplicador:4,valor:"1 Cada 6 Horas"},{nombre:"1 Cada 4 Horas",multiplicador:6,valor:"1 Cada 4 Horas"},{nombre:"1 Despues de cada comida",multiplicador:3,valor:"1 Despues de cada comida"},{nombre:"1 Cada 15 dias",multiplicador:2,valor:"1 Cada 15 dias"},{nombre:"1 Cada Mes",multiplicador:1,valor:"1 Cada Mes"},{nombre:"1 Cada Trimestre",multiplicador:1,valor:"1 Cada Trimestre"},{nombre:"2 Cada 24 Horas",multiplicador:2,valor:"2 Cada 24 Horas"},{nombre:"2 Cada 12 Horas",multiplicador:4,valor:"2 Cada 12 Horas"},{nombre:"2 Cada 8 Horas",multiplicador:6,valor:"2 Cada 8 Horas"},{nombre:"2 Cada 6 Horas",multiplicador:8,valor:"2 Cada 6 Horas"},{nombre:"2 Cada 4 Horas",multiplicador:12,valor:"2 Cada 4 Horas"},{nombre:"3 Cada 8 Horas",multiplicador:9,valor:"3 Cada 8 Horas"},{nombre:"2 Despues de cada comida",multiplicador:6,valor:"2 Despues de cada comida"},{nombre:"1 Cada 7 dias",multiplicador:4,valor:"1 Cada 7 dias"},{nombre:"2 Cada 15 dias",multiplicador:4,valor:"2 Cada 15 dias"},{nombre:"2 Cada Mes",multiplicador:2,valor:"2 Cada Mes"},{nombre:"2 Cada Trimestre",multiplicador:2,valor:"2 Cada Trimestre"},{nombre:"Dosis unica",multiplicador:1,valor:"Dosis unica"}],this.medicamentosFiltrados=[],this.medicosFiltrados=[],this.ipsFiltrados=[],this.facturaForm=this.formBuilder.group({idFormula:[""],nroFormula:["N/A"],observacion:[""],ips:["",Zn.required],medico:["",Zn.required],fecPrescribe:["",Zn.required],fecSolicitud:[""],total:[""],paciente:["",Zn.required],items:this.formBuilder.array([]),estado:[!1],medicamento:[""],cieP:["",[Zn.required,Zn.maxLength(4)]],cieR1:["",[Zn.maxLength(4)]],cieR2:["",[Zn.maxLength(4)]],cieR3:["",[Zn.maxLength(4)]],origenurgencia:[!1],programa:["",Zn.required],cobroCM:[!1],pgp:[!1],valorCM:["0"]})}ngOnInit(){this.activatedRoute.paramMap.subscribe(o=>{let a=+o.get("id");a&&this.formulaService.getFormulaId(a).subscribe(s=>{this.formula=s,s&&(this.formula.items=this.formula.items.map(l=>({...l,habilitarCantidad:this.formasConCantidadHabilitada.includes(l.medicamento.forma.idForma)})),this.formula.items.forEach(l=>{this.existenciaAcutal(l.medicamento.idMedicamento,r)})),this.mostrarComponente=!0,this.pacienteActual=s.paciente,this.mostrarRegistro(s),this.facturaForm.get("cobroCM")?.setValue(this.cobroCuotaModeradora())})}),this.facturaForm.get("medico").valueChanges.pipe(xo(300),Di(o=>this.medicoService.filtrarMedicos(o))).subscribe(o=>{this.medicosFiltrados=o}),this.facturaForm.get("ips").valueChanges.pipe(xo(300),Di(o=>this.ipsService.filtrarIpss(o))).subscribe(o=>{this.ipsFiltrados=o}),this.facturaForm.get("medicamento").valueChanges.pipe(xo(300),Di(o=>this.pacienteActual&&this.pacienteActual.eps?this.formulaService.filtrarMedicamentosEps(o,this.pacienteActual.eps.codigo):On([]))).subscribe(o=>{this.medicamentosFiltrados=o});let e=sessionStorage.getItem("bodega"),r=parseInt(null!==e?e:"0",10);this.bodegaService.getRegistroId(r).subscribe(o=>{this.bodegaActual=o},o=>{console.error(o)}),this.fechaActual=new Date;const i=new Date(this.fechaActual);i.setDate(this.fechaActual.getDate()-5),this.hoy=this.fechaActual.toISOString().split("T")[0],this.minimohoy=i.toISOString().split("T")[0]}mostrarRegistro(e){var r=new Date(e.fecPrescribe),i=new Date(e.fecSolicitud);this.facturaForm.patchValue({idFormula:e.idFormula,nroFormula:e.nroFormula,observacion:e.observacion,ips:e.ips,medico:e.medico,fecPrescribe:r.toJSON().slice(0,10),fecSolicitud:i.toJSON().slice(0,10),total:e.total,paciente:e.paciente.numDocumento,items:e.items,estado:e.estado,medicamento:e.medicamento,cieP:e.cieP,cieR1:e.cieR1,cieR2:e.cieR2,cieR3:e.cieR3,cobroCM:e.cobroCM,valorCM:e.valorCM,continuidad:e.continuidad,pgp:e.pgp,origenurgencia:e.origenurgencia,programa:e.programa.codigo})}openDialogIps(){this.dialog.open(GD,{width:"400px",data:{}}).afterClosed().subscribe(r=>{r&&this.facturaForm.get("ips").setValue(r.nombre)})}openDialogMedico(){this.dialog.open(XD,{width:"400px",data:{}}).afterClosed().subscribe(r=>{r&&this.facturaForm.get("medico").setValue(r.nombre)})}cobroCuotaModeradora(){return!(!this.pacienteActual||!this.pacienteActual.regimen)&&"C"===this.pacienteActual.regimen}onOptionSelectedIps(e){this.facturaForm.get("ips")?.setValue(e)}onOptionSelectedMedico(e){this.facturaForm.get("medico")?.setValue(e)}displayIps(e){return e?e.nombre:""}displayMedico(e){return e?e.nombre:""}autocompletadoValido(e){return r=>{const i=r.value;return e.some(a=>a.nombre===i)?null:{opcionInvalida:{value:r.value}}}}buscarFormula(){let e=parseInt(sessionStorage.getItem("bodega")||"0",10);this.formula=new wx,this.pacienteActual={},this.mostrarComponente=!1,this.formulaService.getFormulaId(this.facturaForm.get("idFormula").value).subscribe(r=>{r?(this.formula=r,this.formula.items=this.formula.items.map(i=>({...i,habilitarCantidad:this.formasConCantidadHabilitada.includes(i.medicamento.forma.idForma)})),this.formula.items.forEach(i=>{this.existenciaAcutal(i.medicamento.idMedicamento,e)}),this.mostrarComponente=!0,this.pacienteActual=r.paciente,this.mostrarRegistro(r),this.ValidaPaciente(),this.facturaForm.get("cobroCM")?.setValue(this.cobroCuotaModeradora())):z().fire({icon:"info",title:"Informaci\xf3n",text:"No se encontr\xf3 ninguna formula asociada a ese numero ID proporcionado."})},r=>{z().fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al buscar la formula. Intente nuevamente m\xe1s tarde."})})}convertirAMayusculasCieP(e){const r=e.target;r.value=r.value.toUpperCase(),this.facturaForm.get("cieP")?.setValue(r.value,{emitEvent:!1})}convertirAMayusculasCieR1(e){const r=e.target;r.value=r.value.toUpperCase(),this.facturaForm.get("cieR1")?.setValue(r.value,{emitEvent:!1})}convertirAMayusculasCieR2(e){const r=e.target;r.value=r.value.toUpperCase(),this.facturaForm.get("cieR2")?.setValue(r.value,{emitEvent:!1})}convertirAMayusculasCieR3(e){const r=e.target;r.value=r.value.toUpperCase(),this.facturaForm.get("cieR3")?.setValue(r.value,{emitEvent:!1})}habilitarControles(){this.facturaForm.get("observacion")?.enable(),this.facturaForm.get("ips")?.enable(),this.facturaForm.get("medico")?.enable(),this.facturaForm.get("fecPrescribe")?.enable(),this.facturaForm.get("medicamento")?.enable(),this.facturaForm.get("cieP")?.enable(),this.facturaForm.get("cieR1")?.enable(),this.facturaForm.get("cieR2")?.enable(),this.facturaForm.get("cieR3")?.enable(),this.facturaForm.get("cobroCM")?.enable(),this.facturaForm.get("programa")?.enable(),this.facturaForm.get("origenurgencia")?.enable(),this.facturaForm.get("pgp")?.enable(),this.facturaForm.get("fecSolicitud")?.enable()}deshabilitarControles(){this.facturaForm.get("observacion")?.disable(),this.facturaForm.get("ips")?.disable(),this.facturaForm.get("medico")?.disable(),this.facturaForm.get("fecPrescribe")?.disable(),this.facturaForm.get("medicamento")?.disable(),this.facturaForm.get("cieP")?.disable(),this.facturaForm.get("cieR1")?.disable(),this.facturaForm.get("cieR2")?.disable(),this.facturaForm.get("cieR3")?.disable(),this.facturaForm.get("cobroCM")?.disable(),this.facturaForm.get("programa")?.disable(),this.facturaForm.get("origenurgencia")?.disable(),this.facturaForm.get("pgp")?.disable(),this.facturaForm.get("fecSolicitud")?.disable()}mostrarMedicamento(e){return e?e.nombre.toString():""}seleccionarMedicamento(e){let r=e.option.value,i=parseInt(sessionStorage.getItem("bodega")||"0",10);if(r&&this.pacienteActual){if(this.medicamentoEntegadoMenos30Dias(r.idMedicamento,this.pacienteActual.idPaciente),this.existeItem(r.idMedicamento))this.incrementaCantidad(r.idMedicamento);else{let o=new WD;o.medicamento=r,o.importe=o.calcularImporte(),o.habilitarCantidad=this.formasConCantidadHabilitada.includes(r.forma.idForma),this.formula.items=this.formula.items||[],this.formula.items.push(o),this.existenciaAcutal(r.idMedicamento,i),(r.desabastecido||r.agotado)&&z().fire({icon:"warning",title:"MEDICAMENTO CON CARTA DE AGOTADO Y/O DESABASTECIDO",text:"Por favor si tienes en existencia en tu bodega agregalo a la formula, de lo contrario notificale al paciente! recuerde si no tiene en existencia no lo agregue a la formula."})}this.facturaForm.get("medicamento")?.reset()}else console.error("Medicamento o paciente no definido.")}existenciaAcutal(e,r){this.medicamentoService.getMedicamentoBodega(e,r).subscribe(i=>{this.existencias[e]=i.cantidad},i=>{console.error("Error fetching existencia:",i)})}actualizarCantidad(e,r){let i=r.target.value;if(0==i)return this.eliminarItemFormula(e);this.formula.items=this.formula.items.map(o=>(e===o.medicamento.idMedicamento&&(o.cantidad=i,o.importe=o.cantidad*o.medicamento.valor,this.formula.total=0),o))}duracionTratamiento(e,r){let i=r.target.value;this.formula.items=this.formula.items.map(o=>(e===o.medicamento.idMedicamento&&(o.duracion=i.toString(),o.habilitarCantidad&&this.calcularCantidad(o),o.importe=o.cantidad*o.medicamento.valor,this.formula.total=0),o))}calcularCantidad(e){const r=this.frecuencias.find(o=>o.valor===e.frecuencia);e.cantidad=(r?r.multiplicador:1)*e.duracion}seleccionFrecuencia(e,r){let i=r.target.value;this.formula.items=this.formula.items.map(o=>(e===o.medicamento.idMedicamento&&(o.frecuencia=i,o.habilitarCantidad&&this.calcularCantidad(o),o.importe=o.cantidad*o.medicamento.valor,this.formula.total=0),o))}existeItem(e){let r=!1;return this.formula.items.forEach(i=>{e===i.medicamento.idMedicamento&&(r=!0)}),r}incrementaCantidad(e){this.formula.items=this.formula.items.map(r=>(e===r.medicamento.idMedicamento&&(++r.cantidad,r.importe=r.cantidad*r.medicamento.valor,this.formula.total=0),r))}eliminarItemFormula(e){z().fire({title:"Desea eliminar?",text:"Esta seguro de quitar el medicamento de la formula, ya no hara parte de la formulacion del paciente en esta formula!",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.formulaService.deleteItemFormula(this.formula.idBodega,e,this.formula.estado).subscribe(i=>{this.formula.items=this.formula.items.filter(o=>e!==o.idItem),z().fire({icon:"success",title:"Ok",text:"El medicamento se ha quitado de la lista de la formula y de la tabla en la base de datos correctamente!."})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}medicamentoEntegadoMenos30Dias(e,r){this.formulaService.getMedicamentoEntregadoPacienteMenosDe30Dias(e,r).subscribe(i=>{i&&i.length>0&&i[0].medicamento?z().fire({icon:"warning",title:"Entregado menos de 30 d\xedas",text:`El medicamento ${i[0].medicamento.nombre} que est\xe1 intentando dispensar, tiene un registro de entrega en menos de 30 d\xedas a este paciente. Por favor, verificar.`}):console.log("No se encontraron registros recientes de entrega para este medicamento.")},i=>{console.error("Error en la consulta de la base de datos:",i),z().fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al verificar el historial de entregas del medicamento. Por favor, int\xe9ntelo nuevamente m\xe1s tarde."})})}actualizarFormula(){if(this.facturaForm.valid)if(0==this.formula.items.length)this.facturaForm.get("medicamento")?.setErrors({invalid:!0});else if(this.formula.items.length>0){if(!this.validateItems())return;let e="Con estos items y cantidades <br>";for(let r=0;r<this.formula.items.length;r++)e+=r+1+` - ${this.formula.items[r].medicamento.nombre} - Cantidad - ${this.formula.items[r].cantidad}<br>`;z().fire({title:"Confirma editar la formula?",icon:"question",html:e,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar!"}).then(r=>{r.isConfirmed&&this.editFormula()})}else z().fire({icon:"warning",title:"Verificar!",text:"No se ha agregado ning\xfan medicamento a la formula que intenta actualizar!"});else z().fire({icon:"warning",title:"!Alerta",text:"Datos incompletos para actualizar la formula en la base de datos!"})}editFormula(){sessionStorage.getItem("nombre"),this.formula.ips=this.facturaForm.get("ips")?.value,this.formula.medico=this.facturaForm.get("medico")?.value,this.formula.nroFormula=this.facturaForm.get("nroFormula")?.value,this.formula.fecPrescribe=this.facturaForm.get("fecPrescribe")?.value,this.formula.observacion=this.facturaForm.get("observacion")?.value,this.formula.cobroCM=this.facturaForm.get("cobroCM")?.value,this.formula.valorCM=this.formula.cobroCM?this.pacienteActual.categoria.valor:0,this.formula.cieP=this.facturaForm.get("cieP")?.value,this.formula.cieR1=this.facturaForm.get("cieR1")?.value,this.formula.cieR2=this.facturaForm.get("cieR2")?.value,this.formula.origenurgencia=this.facturaForm.get("origenurgencia")?.value,this.formula.pgp=this.facturaForm.get("pgp")?.value,this.formula.programa=this.facturaForm.get("programa")?.value,this.formula.total=0;const r=this.formula;r.items=r.items.map(i=>({...i,itemsEntrega:[]})),this.formulaService.update(r).subscribe(i=>{z().fire({icon:"success",title:"Ok",text:"La formula ha sido actualizado correctamente!"})},i=>{z().fire({icon:"error",title:"Error...",text:"No se pudo guardar la formula en la base de datos!",footer:i.mensaje})})}ocultarComentario(){this.comentarioVisible=!1}actualizarComentario(e){const i=e.target.value;this.mensajeErrorDx="",4===i.length?this.formulaService.getDxFormula(i).subscribe(o=>{o?(this.dxValido=!1,console.log(o),this.mensajeComentario=o.nombre,"A"!=o.sexo&&o.sexo!=this.pacienteActual.sexo&&(this.mensajeErrorDx="Error de diagn\xf3stico diligenciado, no corresponde con el sexo del paciente por favor verificar!",this.dxValido=!0)):(this.mensajeComentario="El diagn\xf3stico no se encontr\xf3 en la tabla CIE10.",this.dxValido=!0)},o=>{this.mensajeComentario="Error al obtener el diagn\xf3stico."}):(this.mensajeComentario="El c\xf3digo debe tener 4 caracteres.",this.dxValido=!0),this.comentarioVisible=!0}calcularEdad(e){if(null!=e){const r=new Date(e),i=Math.abs(Date.now()-r.getTime());let o=Math.floor(i/864e5/365);if(o)return o.toString()}return"-"}validateItems(){return!this.formula.items.some(r=>0===Number(r.duracion))||(z().fire({icon:"error",title:"Error",text:"La duraci\xf3n de tratamiento del medicamento y/o insumo no puede ser cero (0), por favor corregirlo y continuar."}),!1)}ValidaPaciente(){if(!0===this.pacienteActual.estado)if("SISM DISPENSARIO"===this.pacienteActual.dispensario){this.facturaForm.get("cobroCM")?.setValue(this.cobroCuotaModeradora());const e=this.pacienteActual.municipio.codigo,r=this.pacienteActual.mpoportabilidad?.codigo,i=new Date(this.pacienteActual?.fecVencePortabilidad),o=new Date(this.fechaActual);this.bodegaActual.municipio===e||this.pacienteActual.portabilidad&&this.bodegaActual.municipio===r&&i>=o?(this.habilitarControles(),this.facturaForm.updateValueAndValidity()):z().fire({icon:"warning",title:"OTRO MUNICIPIO",text:"El paciente est\xe1 en otro municipio o portabilidad vencida."})}else z().fire({icon:"warning",title:"OTRO DISPENSARIO",text:"El paciente pertenece a otro dispensario."});else z().fire({icon:"info",title:"INACTIVO",text:"El paciente est\xe1 inactivo. No se puede generar la entrega de medicamentos."});this.bodegaActual.dispensa||z().fire({icon:"warning",title:"!Alerta",text:`La bodega ${this.bodegaActual.nombre} donde est\xe1 logueado el funcionario no est\xe1 habilitada para dispensar f\xf3rmulas a pacientes.`})}reporteEnConstruccion(){z().fire({icon:"info",title:"En construcci\xf3n!",text:"El proceso esta en construcci\xf3n, te estaremos informando cuando est\xe9 disponible!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(pm),X(Dd),X(l0),X(YD),X(qD),X(Ts),X(Ds),X(ea),X(Us),X(bx))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-editformula"]],decls:158,vars:32,consts:[[1,"card","bg-light"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"form-group","row"],["for","cliente",1,"col-sm-4","col-form-label"],[1,"col-sm-8"],[1,"input-group"],["type","text","formControlName","idFormula","placeholder","Digite formula",1,"form-control",3,"keyup.enter"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],["class","alert alert-danger mt-2",4,"ngIf"],[1,"form-group","row","align-items-center"],["for","ipsPrescribe",1,"col-sm-4","col-form-label"],[1,"w-100"],["type","text","matInput","","formControlName","ips",3,"matAutocomplete"],["mat-icon-button","","matSuffix","",3,"click"],[3,"displayWith","optionSelected"],["autoips","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["for","medicoPrescribe",1,"col-sm-4","col-form-label"],["type","text","matInput","","formControlName","medico",3,"matAutocomplete"],["automedico","matAutocomplete"],["for","fecPrescribe",1,"col-sm-4","col-form-label"],[1,"col-sm-4"],[1,"diagnosticos-group"],["type","date","formControlName","fecPrescribe",1,"form-control",2,"width","350px",3,"max"],["type","checkbox","formControlName","origenurgencia",1,"form-check-input"],["for","fecSolicitud",1,"col-sm-4","col-form-label"],["type","date","formControlName","fecSolicitud",1,"form-control",2,"width","350px",3,"max","min"],["type","checkbox","formControlName","pgp",1,"form-check-input"],["for","observacion",1,"col-sm-4","col-form-label"],["class","col-sm-8",4,"ngIf"],["class","card","class","col-md-7",4,"ngIf"],["class","card","class","col-md-5",4,"ngIf"],["for","diagnosticos",1,"col-sm-4","col-form-label"],["type","text","formControlName","cieP","placeholder","Dx principal *","maxlength","4",1,"form-control",3,"focus","input","blur"],["type","text","formControlName","cieR1","placeholder","Dx rel 1","maxlength","4",1,"form-control",3,"focus","input","blur"],["type","text","formControlName","cieR2","placeholder","Dx rel 2","maxlength","4",1,"form-control",3,"focus","input","blur"],["type","text","formControlName","cieR3","placeholder","Dx rel 3","maxlength","4",1,"form-control",3,"focus","input","blur"],["for","programa",1,"col-sm-4","col-form-label"],["formControlName","programa",1,"form-select"],["selected","","value",""],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],["value","8"],["value","9"],["value","10"],["value","11"],["value","12"],["value","13"],["value","14"],["value","15"],["value","16"],["value","17"],["value","18"],["value","19"],["formControlName","observacion",1,"form-control"],["class","blink",4,"ngIf"],["class","porta",4,"ngIf"],[1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["appearance","fill",1,"w-100"],["type","text","matInput","","formControlName","medicamento",3,"matAutocomplete"],[3,"optionSelected"],["automedicamento","matAutocomplete"],["class","alert alert-info",4,"ngIf"],["class","table table-striped table-hover table-sm",4,"ngIf"],[1,"form-group","row","mt-3","d-flex","align-items-center","justify-content-between"],["type","button","value","Actualizar F\xf3rmula",1,"btn","btn-secondary","w-100",3,"disabled","click"],[1,"col-sm-4","text-end"],[1,"fw-bold"],[1,"alert","alert-danger","mt-2"],[3,"value"],["formControlName","cobroCM","labelPosition","before",3,"checked"],[1,"float-right"],[1,"text-green"],[1,"col-md-7"],["mat-icon-button","",2,"width","24px","height","24px",3,"click"],[2,"font-size","16px","color","green"],["mat-icon-button","","matSuffix","",2,"width","24px","height","24px",3,"click"],[1,"col-md-5"],[1,"blink"],[1,"porta"],["class","form-text text-muted",4,"ngIf"],[1,"form-text","text-muted"],[1,"alert","alert-info"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[2,"width","180px"],[2,"width","80px"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[1,"form-select",3,"value","change"],[3,"value","selected",4,"ngFor","ngForOf"],["type","number",1,"form-control","col-sm-4",3,"value","min","change"],["type","number",1,"form-control","col-sm-4",3,"value","disabled","ngStyle","min","change"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[3,"value","selected"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"div",1)(2,"form",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),h(7,"ID Formula "),u(),d(8,"div",7)(9,"div",8)(10,"input",9),De("keyup.enter",function(){return i.buscarFormula()}),u(),d(11,"button",10),De("click",function(){return i.buscarFormula()}),h(12,"Buscar formula"),u()(),oe(13,eme,2,0,"div",11),u()(),d(14,"div",12)(15,"label",13),h(16,"IPS que prescribe *"),u(),d(17,"div",7)(18,"mat-form-field",14)(19,"mat-label"),h(20,"Buscar IPS"),u(),qe(21,"input",15),d(22,"button",16),De("click",function(){return i.openDialogIps()}),d(23,"mat-icon"),h(24,"add_circle"),u()(),d(25,"mat-autocomplete",17,18),De("optionSelected",function(a){return i.onOptionSelectedIps(a.option.value)}),oe(27,tme,2,2,"mat-option",19),u()()()(),d(28,"div",12)(29,"label",20),h(30,"M\xe9dico prescribe *"),u(),d(31,"div",7)(32,"mat-form-field",14)(33,"mat-label"),h(34,"Buscar m\xe9dico"),u(),qe(35,"input",21),d(36,"button",16),De("click",function(){return i.openDialogMedico()}),d(37,"mat-icon"),h(38,"add_circle"),u()(),d(39,"mat-autocomplete",17,22),De("optionSelected",function(a){return i.onOptionSelectedMedico(a.option.value)}),oe(41,nme,2,3,"mat-option",19),u()(),oe(42,rme,2,0,"div",11),u()(),d(43,"div",5)(44,"label",23),h(45,"Fecha de prescripci\xf3n *"),u(),d(46,"div",24)(47,"div",25),qe(48,"input",26),u(),oe(49,ime,2,0,"div",11),u(),qe(50,"input",27),h(51," \xbfFue por urgencia? "),u(),d(52,"div",5)(53,"label",28),h(54,"Fecha de entrega *"),u(),d(55,"div",24)(56,"div",25),qe(57,"input",29),u(),oe(58,ome,2,0,"div",11),u(),qe(59,"input",30),h(60," \xbfEs PGP? "),u(),d(61,"div",5)(62,"label",31),h(63,"Cuota Moderadora"),u(),oe(64,ame,7,8,"div",32),u()(),d(65,"div",4)(66,"div",3),oe(67,sme,34,12,"div",33),oe(68,ume,15,6,"div",34),u(),d(69,"div",5)(70,"label",35),h(71,"Diagn\xf3sticos *"),u(),d(72,"div",7)(73,"div",25)(74,"input",36),De("focus",function(a){return i.actualizarComentario(a)})("input",function(a){return i.convertirAMayusculasCieP(a)})("blur",function(){return i.ocultarComentario()})("input",function(a){return i.actualizarComentario(a)}),u(),d(75,"input",37),De("focus",function(a){return i.actualizarComentario(a)})("input",function(a){return i.convertirAMayusculasCieR1(a)})("blur",function(){return i.ocultarComentario()})("input",function(a){return i.actualizarComentario(a)}),u(),d(76,"input",38),De("focus",function(a){return i.actualizarComentario(a)})("input",function(a){return i.convertirAMayusculasCieR2(a)})("blur",function(){return i.ocultarComentario()})("input",function(a){return i.actualizarComentario(a)}),u(),d(77,"input",39),De("focus",function(a){return i.actualizarComentario(a)})("input",function(a){return i.convertirAMayusculasCieR3(a)})("blur",function(){return i.ocultarComentario()})("input",function(a){return i.actualizarComentario(a)}),u()(),oe(78,dme,2,0,"div",11),oe(79,hme,2,1,"div",11),oe(80,mme,2,1,"div",11),u()(),d(81,"div",5)(82,"label",40),h(83,"Programa *"),u(),d(84,"div",7)(85,"div",25)(86,"select",41)(87,"option",42),h(88,"Seleccionar el programa"),u(),d(89,"option",43),h(90,"Mayores de 70 a\xf1os no incluidos en cohortes"),u(),d(91,"option",44),h(92,"Menores de 70 a\xf1os no incluidos en cohortes"),u(),d(93,"option",45),h(94,"Hipertensi\xf3n arterial"),u(),d(95,"option",46),h(96,"Diabetes Mellitu"),u(),d(97,"option",47),h(98,"Cardiopatias y Enfermedades Cerebrovasculares"),u(),d(99,"option",48),h(100,"Terapia de remplazo renal"),u(),d(101,"option",49),h(102,"Artritis y otras autoinmunes"),u(),d(103,"option",50),h(104,"Epoc"),u(),d(105,"option",51),h(106,"Asma"),u(),d(107,"option",52),h(108,"Vih"),u(),d(109,"option",53),h(110,"TBC o Hepatitis C"),u(),d(111,"option",54),h(112,"Enfermedad neurologica"),u(),d(113,"option",55),h(114,"Salud Mental"),u(),d(115,"option",56),h(116,"Hemofilia"),u(),d(117,"option",57),h(118,"Discapacitados"),u(),d(119,"option",58),h(120,"Enfermedad Huerfana"),u(),d(121,"option",59),h(122,"Trasplantes"),u(),d(123,"option",60),h(124,"Desnutrici\xf3n"),u(),d(125,"option",61),h(126,"Gestantes"),u()()(),oe(127,gme,2,0,"div",11),u()(),d(128,"div",5)(129,"label",31),h(130,"Observaci\xf3n"),u(),d(131,"div",7),qe(132,"textarea",62),u()(),oe(133,_me,4,0,"div",63),oe(134,vme,4,0,"div",64),u(),d(135,"div",12)(136,"label",65),h(137,"Agregar lista de medicamentos "),u(),d(138,"div",66)(139,"mat-form-field",67)(140,"mat-label"),h(141,"Buscar medicamento a agregar "),u(),qe(142,"input",68),d(143,"mat-autocomplete",69,70),De("optionSelected",function(a){return i.seleccionarMedicamento(a)}),oe(145,bme,2,2,"mat-option",19),u()(),oe(146,yme,2,0,"div",11),u()(),oe(147,wme,2,0,"div",71),d(148,"div"),oe(149,Dme,23,1,"table",72),u(),d(150,"div",73)(151,"div",24)(152,"input",74),De("click",function(){return i.actualizarFormula()}),u()(),d(153,"div",75),h(154," Total formula: "),d(155,"span",76),h(156),Hi(157,"currency"),u()()()()()()()),2&r){const o=go(26),a=go(40),s=go(144);let l,c,f,v,E,D,k;w(2),N("formGroup",i.facturaForm),w(11),N("ngIf",(null==(l=i.facturaForm.get("paciente"))?null:l.invalid)&&(null==(l=i.facturaForm.get("paciente"))?null:l.touched)),w(8),N("matAutocomplete",o),w(4),N("displayWith",i.displayIps),w(2),N("ngForOf",i.ipsFiltrados),w(8),N("matAutocomplete",a),w(4),N("displayWith",i.displayMedico),w(2),N("ngForOf",i.medicosFiltrados),w(1),N("ngIf",(null==(c=i.facturaForm.get("medico"))?null:c.invalid)&&(null==(c=i.facturaForm.get("medico"))?null:c.touched)),w(6),N("max",i.hoy),w(1),N("ngIf",(null==(f=i.facturaForm.get("fecPrescribe"))?null:f.invalid)&&(null==(f=i.facturaForm.get("fecPrescribe"))?null:f.touched)),w(8),N("max",i.hoy)("min",i.minimohoy),w(1),N("ngIf",(null==(v=i.facturaForm.get("fecSolicitud"))?null:v.invalid)&&(null==(v=i.facturaForm.get("fecSolicitud"))?null:v.touched)),w(6),N("ngIf",i.mostrarComponente),w(3),N("ngIf",i.mostrarComponente),w(1),N("ngIf",i.mostrarComponente),w(10),N("ngIf",(null==(E=i.facturaForm.get("cieP"))?null:E.invalid)&&(null==(E=i.facturaForm.get("cieP"))?null:E.touched)),w(1),N("ngIf",i.comentarioVisible),w(1),N("ngIf",i.comentarioVisible),w(47),N("ngIf",(null==(D=i.facturaForm.get("programa"))?null:D.invalid)&&(null==(D=i.facturaForm.get("programa"))?null:D.touched)),w(6),N("ngIf",i.formula.estado),w(1),N("ngIf",!i.formula.estado),w(8),N("matAutocomplete",s),w(3),N("ngForOf",i.medicamentosFiltrados),w(1),N("ngIf",null==(k=i.facturaForm.get("autocompleteControl"))?null:k.invalid),w(1),N("ngIf",0==i.formula.items.length),w(2),N("ngIf",i.formula.items.length>0),w(3),N("disabled",!i.facturaForm.valid),w(4),_e(_h(157,30,i.formula.total))}},dependencies:[ho,Fi,Jo,mm,Wo,Vs,cl,ul,vo,sl,Ss,No,zo,Gy,bo,Ro,c0,_m,hm,b_,gm,V6,u0,eA,Ey,Sc],styles:[".card-body[_ngcontent-%COMP%]{padding:10px}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;font-size:14px;line-height:1.2}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}.card[_ngcontent-%COMP%]{margin:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;font-weight:700;padding:10px;border-radius:8px 8px 0 0}.form-group[_ngcontent-%COMP%]{margin-bottom:2px}.form-group.row[_ngcontent-%COMP%]{display:flex;align-items:center}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}.form-control[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{border-radius:5px}.alert[_ngcontent-%COMP%]{border-radius:5px;margin-top:5px}.float-right[_ngcontent-%COMP%]{margin-top:5px;font-weight:700}@media (max-width: 768px){.form-group[_ngcontent-%COMP%]{flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:5px}}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]{padding:0 2px}.mat-option[_ngcontent-%COMP%]{font-size:12px;line-height:1;padding:2px 12px;transition:background-color .2s}.mat-option[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.mat-autocomplete-panel[_ngcontent-%COMP%]{border-radius:4px;box-shadow:0 4px 8px #0000001a;max-height:300px;overflow-y:auto}.mat-input-element[_ngcontent-%COMP%]{padding:5px 10px}.input-container[_ngcontent-%COMP%]{margin-bottom:2px}@media (max-width: 768px){.mat-input-element[_ngcontent-%COMP%]{padding:5px 10px}.mat-option[_ngcontent-%COMP%]{font-size:13px;padding:5px 12px}}.diagnosticos-group[_ngcontent-%COMP%]{display:flex;gap:7px}.diagnosticos-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1;margin-bottom:0}.input-group[_ngcontent-%COMP%]{display:flex;align-items:center}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1;margin-right:10px}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex-shrink:0}.alert[_ngcontent-%COMP%]{margin-top:10px}.text-green[_ngcontent-%COMP%]{color:green}.thead-colored[_ngcontent-%COMP%]{background-color:#5d8ea4;color:#fff}.blink[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_glowing 1.5s ease-in-out infinite;background-color:#ff4d4d;border-radius:15px;padding:10px;color:#fff;box-shadow:0 0 5px #fff,0 0 10px #fff,0 0 15px #39548b,0 0 20px #39548b}.porta[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_glowing 1.5s ease-in-out infinite;background-color:#39548b;border-radius:15px;padding:10px;color:#fff;box-shadow:0 0 5px #fff,0 0 10px #fff,0 0 15px #39548b,0 0 20px #39548b}@keyframes _ngcontent-%COMP%_glowing{0%,to{box-shadow:0 0 5px #fff,0 0 10px #fff,0 0 15px #39548b,0 0 20px #f37053}50%{box-shadow:0 0 10px #fff,0 0 20px #fff,0 0 30px #39548b,0 0 40px #ec2828}}"]})}return t})();function Ame(t,n){if(1&t&&(d(0,"option",35),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),Qt(" ",e.nombre," ")}}function Tme(t,n){if(1&t&&(d(0,"mat-option",36),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function Mme(t,n){1&t&&(d(0,"div",37),h(1," No hay trazabilidad para el medicamentos en la fecha seleccionada! "),u())}const kme=function(){return{color:"orange","font-size":"20px"}};function Fme(t,n){1&t&&(d(0,"mat-icon",44),h(1,"input "),u()),2&t&&N("ngStyle",Nt(1,kme))}const Ime=function(){return{color:"green","font-size":"20px"}};function Pme(t,n){1&t&&(d(0,"mat-icon",45),h(1,"check_circle_outline "),u()),2&t&&N("ngStyle",Nt(1,Ime))}const Ome=function(t){return{"text-danger":t}};function Nme(t,n){if(1&t&&(d(0,"tr",41)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),u(),d(15,"td"),h(16),u(),d(17,"td"),oe(18,Fme,2,2,"mat-icon",42),oe(19,Pme,2,2,"mat-icon",43),u()()),2&t){const e=n.$implicit,r=n.index,i=ae(2);N("ngClass",Si(11,Ome,e.bodegaOrigen===i.bodegaSeleccionada)),w(2),Qt(" ",r+1," "),w(2),_e(e.fechaDespacho),w(2),_e(e.idDespacho),w(2),_e(e.bodegaOrigen),w(2),_e(e.bodegaDestino),w(2),_e(e.idMedicamento),w(2),_e(e.presentacion),w(2),_e(e.cantidad),w(2),N("ngIf","Env\xedo"===e.estado),w(1),N("ngIf","Recepci\xf3n"===e.estado)}}function Rme(t,n){if(1&t&&(d(0,"div")(1,"table",38)(2,"thead",39)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Fecha"),u(),d(8,"th"),h(9,"ID Orden"),u(),d(10,"th"),h(11,"Bodega Origen"),u(),d(12,"th"),h(13,"Bodega Destino"),u(),d(14,"th"),h(15,"ID Med"),u(),d(16,"th"),h(17,"Presentaci\xf3n"),u(),d(18,"th"),h(19,"Cantidad"),u(),d(20,"th"),h(21,"Estado"),u()()(),d(22,"tbody"),oe(23,Nme,20,13,"tr",40),u()()()),2&t){const e=ae();w(23),N("ngForOf",e.listaMedicamento)}}let Lme=(()=>{class t{constructor(e,r,i,o){this.servicio=e,this.ordenDespachoservicio=r,this.formulaService=i,this.fb=o,this.listaMedicamento=[],this.medicamentosFiltrados=[],this.medicamentoActual=NaN,this.bodegaSeleccionada="",this.totalCantidadIngreso=0,this.totalCantidadEgreso=0;const a=new Date,s=new Date(a);s.setDate(a.getDate()-90),this.generalForm=this.fb.group({idBodega:[""],fechainicial:[s.toISOString().split("T")[0]],fechafinal:[a.toISOString().split("T")[0]],medicamento:[""]})}ngOnInit(){this.parametro=parseInt(sessionStorage.getItem("bodega")||"0",10),this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e,this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);return 0===o?r.puntoEntrega.localeCompare(i.puntoEntrega):o}),this.parametro&&this.generalForm.patchValue({idBodega:+this.parametro})},e=>{console.error(e)}),this.generalForm.get("idBodega").valueChanges.subscribe(e=>{e&&(this.parametro=e,this.medicamentoActual&&this.buscarRegistro(this.medicamentoActual,this.parametro))}),this.generalForm.patchValue({idBodega:this.parametro}),this.generalForm.get("medicamento").valueChanges.pipe(xo(300),Di(e=>this.formulaService.filtrarMedicamentos(e))).subscribe(e=>{this.medicamentosFiltrados=e})}seleccionarMedicamento(e){this.medicamentoActual=e.option.value.idMedicamento,this.generalForm.get("medicamento")?.setValue(e.option.value.nombre),this.buscarRegistro(this.medicamentoActual,this.parametro)}buscarRegistro(e,r){const i=this.listaregistros.find(o=>o.idBodega===r);this.bodegaSeleccionada=i?i.nombre:"",e?(this.listaMedicamento=[],this.totalCantidadIngreso=0,this.totalCantidadEgreso=0,z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ordenDespachoservicio.getMedicamentoOrdenDespacho(e,r,this.generalForm.get("fechainicial")?.value,this.generalForm.get("fechafinal")?.value).subscribe(o=>{this.listaMedicamento=o,z().close();const a=this.listaMedicamento.reduce((s,l)=>(l.bodegaOrigen===this.bodegaSeleccionada?s.coincidente+=l.cantidad||0:s.noCoincidente+=l.cantidad||0,s),{coincidente:0,noCoincidente:0});this.totalCantidadIngreso=a.noCoincidente,this.totalCantidadEgreso=a.coincidente},o=>{console.error("\u274c Error cargando registros",o),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})):z().fire({icon:"error",title:"Verificar",text:"No ha seleccionado el medicamento sobre el cual va a realizar la busqueda!."})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(Ts),X(y_),X(Dd),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-trazamedicamento"]],decls:51,vars:8,consts:[[1,"container","mt-2"],[1,"px-2",3,"formGroup"],[1,"row","g-2"],[1,"col-md-12"],[1,"row","g-2","align-items-end"],[1,"col-md-4"],[1,"form-label","mb-1","fw-bold"],["formControlName","idBodega",1,"form-select","form-select-sm"],["selected","","value","0"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-md-5"],[1,"d-flex","gap-1"],["type","date","formControlName","fechainicial",1,"form-control","form-control-sm"],[1,"px-1"],["type","date","formControlName","fechafinal",1,"form-control","form-control-sm"],[1,"col-md-3","d-flex","gap-2"],[1,"card","shadow-sm","text-center","flex-fill","border-0","bg-success-subtle","d-flex","align-items-center","justify-content-center","py-2"],[1,"text-success"],[1,"fw-bold","text-success","fs-6"],[1,"card","shadow-sm","text-center","flex-fill","border-0","bg-danger-subtle","d-flex","align-items-center","justify-content-center","py-2"],[1,"text-danger"],[1,"fw-bold","text-danger","fs-6"],[1,"row","g-2","align-items-stretch"],[1,"col-md-9","d-flex","align-items-stretch"],[1,"w-100","d-flex","align-items-stretch"],["appearance","outline","floatLabel","always",1,"w-100","h-100"],["type","text","matInput","","formControlName","medicamento",3,"matAutocomplete"],[3,"optionSelected"],["automedicamento","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-3","d-flex","align-items-center"],["type","button",1,"btn","btn-info","btn-sm","w-100","d-flex","align-items-center","justify-content-center","mb-4",3,"click"],[1,"me-1"],["class","alert alert-info my-2",4,"ngIf"],[4,"ngIf"],[3,"ngValue"],[3,"value"],[1,"alert","alert-info","my-2"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["title","En env\xedo",3,"ngStyle",4,"ngIf"],["title","Recibido",3,"ngStyle",4,"ngIf"],["title","En env\xedo",3,"ngStyle"],["title","Recibido",3,"ngStyle"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),h(7,"Bodega"),u(),d(8,"select",7)(9,"option",8),h(10,"TODAS LAS BODEGAS"),u(),oe(11,Ame,2,2,"option",9),u()(),d(12,"div",10)(13,"label",6),h(14,"Rango de fechas"),u(),d(15,"div",11),qe(16,"input",12),d(17,"span",13),h(18,"al"),u(),qe(19,"input",14),u()(),d(20,"div",15)(21,"div",16)(22,"div")(23,"small",17),h(24,"Total ingreso"),u(),d(25,"div",18),h(26),u()()(),d(27,"div",19)(28,"div")(29,"small",20),h(30,"Total egreso"),u(),d(31,"div",21),h(32),u()()()()()(),d(33,"div",3)(34,"div",22)(35,"div",23)(36,"div",24)(37,"mat-form-field",25)(38,"mat-label"),h(39,"Buscar medicamento"),u(),qe(40,"input",26),d(41,"mat-autocomplete",27,28),De("optionSelected",function(a){return i.seleccionarMedicamento(a)}),oe(43,Tme,2,2,"mat-option",29),u()()()(),d(44,"div",30)(45,"button",31),De("click",function(){return i.buscarRegistro(i.medicamentoActual,i.parametro)}),d(46,"mat-icon",32),h(47,"search"),u(),h(48," Buscar "),u()()()()()(),oe(49,Mme,2,0,"div",33),oe(50,Rme,24,1,"div",34),u()),2&r){const o=go(42);w(1),N("formGroup",i.generalForm),w(10),N("ngForOf",i.listaregistros),w(15),_e(i.totalCantidadIngreso||0),w(6),_e(i.totalCantidadEgreso||0),w(8),N("matAutocomplete",o),w(3),N("ngForOf",i.medicamentosFiltrados),w(6),N("ngIf",0==(null==i.listaMedicamento?null:i.listaMedicamento.length)),w(1),N("ngIf",(null==i.listaMedicamento?null:i.listaMedicamento.length)>0)}},dependencies:[wf,ho,Fi,Jo,Wo,Vs,cl,ul,vo,Ss,No,zo,bo,Ro,c0,_m,hm,b_,gm,u0],styles:["button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.2rem;vertical-align:middle;display:inline-flex;align-items:center}.alert[_ngcontent-%COMP%]{min-height:60px;display:flex;align-items:center;justify-content:center}"]})}return t})();function Bme(t,n){1&t&&(d(0,"div",15),h(1," No hay registros para mostrar! "),u())}const b8=function(t){return{color:t}},cA=function(){return{color:"#009A94"}};function jme(t,n){if(1&t){const e=Fn();d(0,"tr",19)(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),Hi(13,"date"),u(),d(14,"td"),h(15),u(),d(16,"td"),h(17),u(),d(18,"td")(19,"mat-icon",20),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarformula(o))}),h(20,"list_alt"),u()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);N("ngStyle",Si(13,b8,e.estado?"black":"red")),w(2),_e(r+1),w(2),_e(e.idPaciente),w(2),_e(e.tipoDoc),w(2),_e(e.numDocumento),w(2),_e(i.primerasmayusculas(e.pNombre+" "+e.sNombre+" "+e.pApellido+" "+e.sApellido)),w(2),Qt("",Xo(13,10,e.fecNacimiento,"dd/MM/yyyy")," "),w(3),Qt("",e.municipio.nombre," "),w(2),_e(e.eps.codigo),w(2),N("ngStyle",Nt(15,cA))}}function Vme(t,n){if(1&t&&(d(0,"div")(1,"table",16)(2,"thead",17)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"ID"),u(),d(8,"th"),h(9,"Tipo"),u(),d(10,"th"),h(11,"Documento"),u(),d(12,"th"),h(13,"Nombres y apellidos"),u(),d(14,"th"),h(15,"Nacimiento"),u(),d(16,"th"),h(17,"Municipio"),u(),d(18,"th"),h(19,"EPS"),u(),d(20,"th"),h(21,"Ver f\xf3rmulas"),u()()(),d(22,"tbody"),oe(23,jme,21,16,"tr",18),u()()()),2&t){const e=ae();w(23),N("ngForOf",e.listaregistros)}}function Ume(t,n){1&t&&(d(0,"div",15),h(1," No hay formulas asociadas al registros para mostrar en este periodo! "),u())}const Hme=function(t){return{"selected-row":t}};function zme(t,n){if(1&t){const e=Fn();d(0,"tr",22),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarItemformula(o))}),d(1,"td"),h(2),u(),d(3,"td"),h(4),Hi(5,"date"),u(),d(6,"td"),h(7),u(),d(8,"td"),h(9),u(),d(10,"td"),h(11),u(),d(12,"td"),h(13),Hi(14,"date"),u(),d(15,"td"),h(16),u(),d(17,"td"),h(18),d(19,"mat-icon",23),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarItemformula(o))}),h(20,"visibility"),u()()()}if(2&t){const e=n.$implicit,r=n.index,i=ae(2);N("ngClass",Si(16,Hme,(null==i.ajusteActual?null:i.ajusteActual.idFormula)===e.idFormula)),w(2),_e(r+1),w(2),_e(Xo(5,10,e.fecPrescribe,"dd/MM/YYYY")),w(3),_e(e.idFormula),w(2),_e(e.ips.nombre),w(2),_e(e.medico.nombre),w(2),_e(Xo(14,13,e.fecSolicitud,"dd/MM/YYYY")),w(3),_e(e.continuidad),w(2),Qt("",e.items.length," "),w(1),N("ngStyle",Nt(18,cA))}}function $me(t,n){if(1&t&&(d(0,"div")(1,"table",16)(2,"thead",17)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Fecha Formula"),u(),d(8,"th"),h(9,"Nro Formula"),u(),d(10,"th"),h(11,"IPS"),u(),d(12,"th"),h(13,"M\xe9dico"),u(),d(14,"th"),h(15,"Fecha solicitud"),u(),d(16,"th"),h(17,"Continuidad"),u(),d(18,"th"),h(19,"Medicamentos"),u()()(),d(20,"tbody"),oe(21,zme,21,19,"tr",21),u()()()),2&t){const e=ae();w(21),N("ngForOf",e.listaformulas)}}function Wme(t,n){1&t&&(d(0,"mat-icon",32),h(1,"check_circle_outline"),u()),2&t&&N("ngStyle",Nt(1,cA))}const qme=function(){return{color:"red"}};function Gme(t,n){1&t&&(d(0,"mat-icon",33),h(1,"remove_circle_outline"),u()),2&t&&N("ngStyle",Nt(1,qme))}const Yme=function(){return{color:"orange"}};function Xme(t,n){1&t&&(d(0,"mat-icon",34),h(1,"remove_circle_outline"),u()),2&t&&N("ngStyle",Nt(1,Yme))}function Kme(t,n){if(1&t&&(d(0,"tr",19)(1,"td",28),h(2),u(),d(3,"td"),h(4),Hi(5,"date"),u(),d(6,"td"),h(7),u(),d(8,"td"),h(9),u()()),2&t){const e=n.$implicit,r=ae(3);N("ngStyle",Si(8,b8,e.estado?"black":"red")),w(2),_e(e.cantidadEntregada||0),w(2),_e(Xo(5,5,e.fecEntrega,"dd/MM/YYYY : hh:mm")),w(3),_e(e.medioEntrega||""),w(2),_e(r.primerasmayusculas(e.bodega.puntoEntrega)||"")}}function Zme(t,n){if(1&t&&(xc(0),d(1,"tr")(2,"td",27),h(3),u(),d(4,"td",27),h(5),u(),d(6,"td",27),h(7),u(),d(8,"td",28),h(9),u(),d(10,"td",28),h(11),u(),d(12,"td",28),oe(13,Wme,2,2,"mat-icon",29),oe(14,Gme,2,2,"mat-icon",30),oe(15,Xme,2,2,"mat-icon",31),u()(),oe(16,Kme,10,10,"tr",18),Cc()),2&t){const e=n.$implicit,r=ae(2);w(2),kr("rowspan",e.itemsEntrega.length+1),w(1),_e(e.medicamento.idMedicamento),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),_e(e.medicamento.nombre),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),_e(e.medicamento.forma.nombre),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),_e(e.cantidad),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),Qt("",r.calcularPendiente(e)," "),w(1),kr("rowspan",e.itemsEntrega.length+1),w(1),N("ngIf",e.cantidad==e.totalEntregado),w(1),N("ngIf",e.cantidad!=e.totalEntregado&&0==e.totalEntregado),w(1),N("ngIf",e.cantidad!=e.totalEntregado&&e.totalEntregado>0),w(1),N("ngForOf",e.itemsEntrega)}}function Qme(t,n){if(1&t&&(d(0,"div")(1,"div",24),h(2," MEDICAMENTOS PRESCRITOS EN LA FORMULA : "),d(3,"span",25),h(4),u()(),d(5,"table",16)(6,"thead",17)(7,"tr")(8,"th"),h(9,"ID"),u(),d(10,"th"),h(11,"Medicamento"),u(),d(12,"th"),h(13,"Presentaci\xf3n"),u(),d(14,"th"),h(15,"Cant. presc"),u(),d(16,"th"),h(17,"Pendientes"),u(),d(18,"th"),h(19,"Estado"),u(),d(20,"th"),h(21,"Entregados"),u(),d(22,"th"),h(23,"Fec entrega"),u(),d(24,"th"),h(25,"Med entrega"),u(),d(26,"th"),h(27,"Dispensario"),u()()(),d(28,"tbody"),oe(29,Zme,17,15,"ng-container",26),u()()()),2&t){const e=ae();w(4),_e(e.formulaActual),w(25),N("ngForOf",e.listaItemsFormula)}}let Jme=(()=>{class t{constructor(e,r,i){this.servicio=e,this.servicioformula=r,this.fb=i,this.tablavisible=!1,this.ajusteActual=null;const o=new Date,a=new Date(o);a.setDate(o.getDate()-90),this.generalForm=this.fb.group({fechainicial:[a.toISOString().split("T")[0]],fechafinal:[o.toISOString().split("T")[0]],documento:[""]})}buscarRegistro(){this.servicio.getRegistroDocumento(this.generalForm.get("documento")?.value).subscribe(e=>{if(this.listaregistros=e,e&&e.length>1)return z().fire({icon:"warning",title:"DOCUMENTO DUPLICADO",text:"Este documento est\xe1 duplicado en la base de datos. Identifique claramente al paciente para consultar el medicamento."}),void(this.listaformulas={});e&&1===e.length&&(this.buscarFormulas(e[0].idPaciente),this.listaItemsFormula={})})}buscarFormulas(e){this.servicioformula.getFormulaIdPaciente(e,this.generalForm.get("fechainicial")?.value,this.generalForm.get("fechafinal")?.value).subscribe(r=>{this.listaformulas=r,this.listaformulas.sort((i,o)=>o.idFormula-i.idFormula)})}calcularPendiente(e){return e.cantidad-e.totalEntregado}mostrarItemformula(e){this.listaItemsFormula=e.items,this.formulaActual=e.idFormula,this.ajusteActual=e}mostrarformula(e){e.formulas&&Array.isArray(e.formulas)&&e.formulas.length>0?this.listaformulas=e.formulas:z().fire({icon:"info",title:"Informaci\xf3n",text:"El paciente no tiene formulas prescritas de medicamentos en el periodo seleccionado!."})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(pm),X(Dd),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-historialentrega"]],decls:30,vars:6,consts:[[1,"container"],[1,"mb-3",3,"formGroup"],[1,"row","g-2","align-items-end"],[1,"col-md-3"],[1,"form-label","mb-1","fw-bold"],[1,"input-group","input-group-sm"],["type","text","formControlName","documento","placeholder","N\xfamero de documento",1,"form-control","border-end-0"],[1,"input-group-text","bg-white","border-start-0"],[1,"text-info"],["type","date","formControlName","fechainicial",1,"form-control","form-control-sm"],["type","date","formControlName","fechafinal",1,"form-control","form-control-sm"],["type","button",1,"btn","btn-info","btn-sm","btn-custom-gradient","w-100","d-flex","align-items-center","justify-content-center",3,"click"],[1,"me-1"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],["title","formulas paciente",1,"pointer-cursor",3,"ngStyle","click"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],["title","Ver medicamentos",1,"pointer-cursor",3,"ngStyle","click"],[1,"col-12","text-center"],[1,"fw-bold"],[4,"ngFor","ngForOf"],[1,"centercelda"],[1,"centered"],["title","Entrega completa",3,"ngStyle",4,"ngIf"],["title","Pendiente",3,"ngStyle",4,"ngIf"],["title","Pendiente parcial",3,"ngStyle",4,"ngIf"],["title","Entrega completa",3,"ngStyle"],["title","Pendiente",3,"ngStyle"],["title","Pendiente parcial",3,"ngStyle"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),h(5,"Documento"),u(),d(6,"div",5),qe(7,"input",6),d(8,"span",7)(9,"mat-icon",8),h(10,"zoom_in"),u()()()(),d(11,"div",3)(12,"label",4),h(13,"Fecha inicial"),u(),qe(14,"input",9),u(),d(15,"div",3)(16,"label",4),h(17,"Fecha final"),u(),qe(18,"input",10),u(),d(19,"div",3)(20,"button",11),De("click",function(){return i.buscarRegistro()}),d(21,"mat-icon",12),h(22,"search"),u(),d(23,"span"),h(24,"Buscar"),u()()()()(),oe(25,Bme,2,0,"div",13),oe(26,Vme,24,1,"div",14),oe(27,Ume,2,0,"div",13),oe(28,$me,22,1,"div",14),oe(29,Qme,30,2,"div",14),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(24),N("ngIf",0==(null==i.listaregistros?null:i.listaregistros.length)),w(1),N("ngIf",(null==i.listaregistros?null:i.listaregistros.length)>0),w(1),N("ngIf",0==(null==i.listaformulas?null:i.listaformulas.length)),w(1),N("ngIf",(null==i.listaformulas?null:i.listaformulas.length)>0),w(1),N("ngIf",(null==i.listaItemsFormula?null:i.listaItemsFormula.length)>0))},dependencies:[wf,ho,Fi,Jo,Wo,vo,No,zo,bo,Ro,Sc],styles:[".selected-row[_ngcontent-%COMP%]{background-color:#d1ecf1!important;font-weight:700}"]})}return t})();function ege(t,n){if(1&t&&(d(0,"option",28),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),Qt(" ",e.nombre," ")}}function tge(t,n){if(1&t&&(d(0,"div",29)(1,"div",30)(2,"small")(3,"strong"),h(4,"Total entregado:"),u(),h(5),u()()()),2&t){const e=ae();w(5),Qt(" ",e.totalCantidadEntregada||0," ")}}function nge(t,n){if(1&t&&(d(0,"mat-option",31),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function rge(t,n){1&t&&(d(0,"div",32),h(1," No hay trazabilidad en la entrega de este medicamento en la fecha y bodega seleccionada! "),u())}const ige=function(){return{color:"red"}};function oge(t,n){1&t&&(d(0,"mat-icon",39),h(1,"person_outline"),u()),2&t&&N("ngStyle",Nt(1,ige))}const age=function(){return{color:"#009A94"}},sge=function(t){return["/menu/entrega",t]};function lge(t,n){if(1&t&&(d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),oe(10,oge,2,2,"mat-icon",36),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),Hi(15,"date"),u(),d(16,"td"),h(17),Hi(18,"date"),u(),d(19,"td",37)(20,"mat-icon",38),h(21,"zoom_in"),u(),d(22,"strong"),h(23),u()()()),2&t){const e=n.$implicit,r=n.index;w(2),Qt(" ",r+1,""),w(2),fo("",e.tipoDoc||"","-",e.numDocumento||"",""),w(2),Up("",e.pNombre||""," ",e.sNombre||""," ",e.pApellido||""," ",e.sApellido||"",""),w(2),_e(e.eps),w(2),N("ngIf","SI"===e.pave),w(2),_e(e.idFormula||""),w(2),_e(Xo(15,15,e.fecSolicitud,"dd/MM/YYYY")),w(3),_e(Xo(18,18,e.fecEntrega,"dd/MM/YYYY : hh:mm")),w(3),N("ngStyle",Nt(21,age))("routerLink",Si(22,sge,e.idFormula)),w(3),_e(e.cantidadEntrega)}}function cge(t,n){if(1&t&&(d(0,"div")(1,"table",33)(2,"thead",34)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"Documento"),u(),d(8,"th"),h(9,"Nombres y apellidos paciente"),u(),d(10,"th"),h(11,"EPS "),u(),d(12,"th"),h(13,"PAVE "),u(),d(14,"th"),h(15,"Formula "),u(),d(16,"th"),h(17,"Fecha de solicitud"),u(),d(18,"th"),h(19,"Fecha de entrega"),u(),d(20,"th"),h(21,"Cantidad"),u()()(),d(22,"tbody"),oe(23,lge,24,24,"tr",35),u()()()),2&t){const e=ae();w(23),N("ngForOf",e.listaentregas)}}let uge=(()=>{class t{constructor(e,r,i){this.servicio=e,this.formulaService=r,this.fb=i,this.listaentregas=[],this.medicamentosFiltrados=[],this.medicamentoActual=NaN,this.totalCantidadEntregada=0;const o=new Date,a=new Date(o);a.setDate(o.getDate()-90),this.generalForm=this.fb.group({idBodega:[""],fechainicial:[a.toISOString().split("T")[0]],fechafinal:[o.toISOString().split("T")[0]],medicamento:[""]})}ngOnInit(){this.parametro=parseInt(sessionStorage.getItem("bodega")||"0",10),this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e.filter(r=>!0===r.dispensa),this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);return 0===o?r.puntoEntrega.localeCompare(i.puntoEntrega):o}),this.parametro&&this.generalForm.patchValue({idBodega:+this.parametro})},e=>{console.error(e)}),this.generalForm.get("idBodega").valueChanges.subscribe(e=>{e&&(this.parametro=e,this.medicamentoActual&&this.buscarRegistro(this.medicamentoActual,this.parametro))}),this.generalForm.patchValue({idBodega:this.parametro}),this.generalForm.get("medicamento").valueChanges.pipe(xo(300),Di(e=>this.formulaService.filtrarMedicamentos(e))).subscribe(e=>{this.medicamentosFiltrados=e})}seleccionarMedicamento(e){this.medicamentoActual=e.option.value.idMedicamento,this.generalForm.get("medicamento")?.setValue(e.option.value.nombre),this.buscarRegistro(this.medicamentoActual,this.parametro)}buscarRegistro(e,r){e?(this.listaentregas=[],this.totalCantidadEntregada=0,z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.formulaService.getMedicamentoentregadoPaciente(e,r,this.generalForm.get("fechainicial")?.value,this.generalForm.get("fechafinal")?.value).subscribe(i=>{this.listaentregas=i,z().close();const o=this.listaentregas.reduce((a,s)=>a+(s.cantidadEntrega||0),0);this.totalCantidadEntregada=o},i=>{console.error("\u274c Error cargando registros",i),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})):z().fire({icon:"error",title:"Verificar",text:"No ha seleccionado el medicamento sobre el cual va a realizar la busqueda!."})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}static#e=this.\u0275fac=function(r){return new(r||t)(X(Ts),X(Dd),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-medicamentosentregados"]],decls:38,vars:7,consts:[[1,"container","mt-2"],[1,"px-2",3,"formGroup"],[1,"row","align-items-end","g-2","mb-2"],[1,"col-md-3"],[1,"form-label","mb-1","fw-bold"],["formControlName","idBodega",1,"form-select","form-select-sm"],["selected","","value","0"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"d-flex","gap-1"],["type","date","formControlName","fechainicial",1,"form-control","form-control-sm"],[1,"px-1","text-muted"],["type","date","formControlName","fechafinal",1,"form-control","form-control-sm"],[1,"col-md-2","d-flex","align-items-end"],["type","button",1,"btn","btn-info","w-100","d-flex","align-items-center","justify-content-center",3,"click"],[1,"me-1"],["class","col-md-3 d-flex align-items-end",4,"ngIf"],[1,"row","mt-2"],[1,"col-md-12"],[1,"input-group"],[1,"input-group-text","bg-white","border-end-0"],[1,"text-info"],["type","text","matInput","","formControlName","medicamento","placeholder","Digite el nombre del medicamento",1,"form-control","form-control-sm","border-start-0",3,"matAutocomplete"],[3,"optionSelected"],["automedicamento","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["class","alert alert-info my-2",4,"ngIf"],[4,"ngIf"],[3,"ngValue"],[1,"col-md-3","d-flex","align-items-end"],[1,"alert","alert-success","w-100","text-center","mb-0","py-2"],[3,"value"],[1,"alert","alert-info","my-2"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[4,"ngFor","ngForOf"],["title","paciente PAVE",3,"ngStyle",4,"ngIf"],[2,"color","green","text-align","right"],["title","Ver la entrega",1,"pointer-cursor",3,"ngStyle","routerLink"],["title","paciente PAVE",3,"ngStyle"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"label",4),h(5,"Bodega"),u(),d(6,"select",5)(7,"option",6),h(8,"TODAS LAS BODEGAS"),u(),oe(9,ege,2,2,"option",7),u()(),d(10,"div",8)(11,"label",4),h(12,"Rango de fechas"),u(),d(13,"div",9),qe(14,"input",10),d(15,"span",11),h(16,"al"),u(),qe(17,"input",12),u()(),d(18,"div",13)(19,"button",14),De("click",function(){return i.buscarRegistro(i.medicamentoActual,i.parametro)}),d(20,"mat-icon",15),h(21,"search"),u(),h(22," Buscar "),u()(),oe(23,tge,6,1,"div",16),u(),d(24,"div",17)(25,"div",18)(26,"label",4),h(27,"Buscar medicamento"),u(),d(28,"div",19)(29,"span",20)(30,"mat-icon",21),h(31,"search"),u()(),qe(32,"input",22),d(33,"mat-autocomplete",23,24),De("optionSelected",function(a){return i.seleccionarMedicamento(a)}),oe(35,nge,2,2,"mat-option",25),u()()()()(),oe(36,rge,2,0,"div",26),oe(37,cge,24,1,"div",27),u()),2&r){const o=go(34);w(1),N("formGroup",i.generalForm),w(8),N("ngForOf",i.listaregistros),w(14),N("ngIf",(null==i.listaentregas?null:i.listaentregas.length)>0),w(9),N("matAutocomplete",o),w(3),N("ngForOf",i.medicamentosFiltrados),w(1),N("ngIf",0==(null==i.listaentregas?null:i.listaentregas.length)),w(1),N("ngIf",(null==i.listaentregas?null:i.listaentregas.length)>0)}},dependencies:[ho,Fi,Jo,Hs,Wo,Vs,cl,ul,vo,Ss,No,zo,bo,Ro,c0,_m,hm,u0,Sc],styles:["button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.2rem;vertical-align:middle;display:inline-flex;align-items:center}"]})}return t})();class y8{constructor(){this.itemsAjuste=[],this.idAjuste=NaN,this.fechaAjuste=new Date,this.fechaInventario=new Date,this.bodegaAjuste=NaN,this.observacionAjuste="",this.funcionarioAjuste="",this.funcionarioInventario="",this.estado="Pendiente"}}class w8{constructor(){this.idItem=NaN,this.medicamento=NaN,this.cantidadAjuste=NaN,this.cantidadFisica=NaN,this.cantidadSistema=NaN}}let x8=(()=>{class t{constructor(e){this.http=e,this.urlEndPoint=iu_apiUrl+"/ajusteinventario"}getAjusteInventarioId(e){const r=(new Pn).set("id",e);return this.http.get(`${this.urlEndPoint}/unica`,{params:r})}getAjusteInventarioBodega(e,r,i){const o=(new Pn).set("idBodega",e).set("fInicial",r).set("fFinal",i);return this.http.get(`${this.urlEndPoint}/bodega`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}delete(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}`,{params:r})}deleteItem(e){const r=(new Pn).set("id",e);return this.http.delete(`${this.urlEndPoint}/item`,{params:r})}create(e){return this.http.post(this.urlEndPoint,JSON.stringify(e),{headers:{"Content-Type":"application/json"}}).pipe(Pt(i=>It(i)))}update(e){return this.http.put(`${this.urlEndPoint}`,e).pipe(Pt(i=>(400==i.status||i.error.mensaje&&console.error(i.error.mensaje),It(i))))}ajustarInventarioBodega(e,r,i){const o=(new Pn).set("idAjuste",e).set("idBodega",r).set("funcionario",i);return this.http.get(`${this.urlEndPoint}/ajustar`,{params:o}).pipe(Pt(a=>(401!=a.status&&a.error.mensaje&&console.error(a.error.mensaje),It(a))))}static#e=this.\u0275fac=function(r){return new(r||t)(it(Fl))};static#t=this.\u0275prov=Gt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function dge(t,n){if(1&t&&(d(0,"option",32),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),fo(" ",e.nombre," - ",e.puntoEntrega," ")}}function fge(t,n){if(1&t){const e=Fn();d(0,"div",4)(1,"button",33),De("click",function(){return ht(e),pt(ae().create())}),qe(2,"i",34),h(3),u()()}if(2&t){const e=ae();w(3),Qt(" ",e.nombrebtn," ")}}function hge(t,n){if(1&t){const e=Fn();d(0,"div",4)(1,"button",35),De("click",function(){return ht(e),pt(ae().procesarAjusteInventario())}),h(2,"Procesar ajustes"),u()()}}function pge(t,n){if(1&t){const e=Fn();d(0,"div",36)(1,"input",37),De("change",function(i){return ht(e),pt(ae().onFileChange(i))}),u()()}}function mge(t,n){1&t&&(d(0,"div",38),h(1," No hay registros para mostrar!\n"),u())}function gge(t,n){if(1&t){const e=Fn();d(0,"div")(1,"input",48),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.cantidadSistema=i)}),u()()}if(2&t){const e=ae().$implicit;w(1),N("ngModel",e.cantidadSistema)}}function _ge(t,n){if(1&t&&(d(0,"div"),h(1),u()),2&t){const e=ae().$implicit;w(1),Qt(" ",e.cantidadSistema," ")}}function vge(t,n){if(1&t){const e=Fn();d(0,"div")(1,"input",49),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.cantidadFisica=i)}),u()()}if(2&t){const e=ae().$implicit;w(1),N("ngModel",e.cantidadFisica)}}function bge(t,n){if(1&t&&(d(0,"div"),h(1),u()),2&t){const e=ae().$implicit;w(1),Qt(" ",e.cantidadFisica," ")}}function yge(t,n){if(1&t){const e=Fn();d(0,"div")(1,"input",50),De("ngModelChange",function(i){return ht(e),pt(ae().$implicit.cantidadAjuste=i)}),u()()}if(2&t){const e=ae().$implicit;w(1),N("ngModel",e.cantidadAjuste)}}const wge=function(t,n){return{"text-danger":t,"text-success":n}};function xge(t,n){if(1&t&&(d(0,"div",51),h(1),u()),2&t){const e=ae().$implicit;N("ngClass",I1(2,wge,e.cantidadAjuste<0,e.cantidadAjuste>0)),w(1),Qt(" ",e.cantidadAjuste," ")}}const uA=function(){return{color:"#009A94"}};function Cge(t,n){if(1&t){const e=Fn();d(0,"mat-icon",52),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).editarMedicamentoAjusteInventario(i))}),h(1,"edit"),u()}2&t&&N("ngStyle",Nt(1,uA))}const Ege=function(){return{color:"red"}};function Sge(t,n){if(1&t){const e=Fn();d(0,"mat-icon",53),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).quitarMedicamentoAjusteInventario(i.idMedicamento))}),h(1,"delete_sweep"),u()}2&t&&N("ngStyle",Nt(1,Ege))}const Dge=function(){return{color:"orange"}};function Age(t,n){if(1&t){const e=Fn();d(0,"mat-icon",54),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).cancelEdicion(i))}),h(1,"clear"),u()}2&t&&N("ngStyle",Nt(1,Dge))}function Tge(t,n){if(1&t){const e=Fn();d(0,"mat-icon",55),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).guardarMedicamentoAjusteInventario(i))}),h(1,"check"),u()}2&t&&N("ngStyle",Nt(1,uA))}function Mge(t,n){if(1&t&&(d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td",42),h(10),u(),d(11,"td",42),oe(12,gge,2,1,"div",31),oe(13,_ge,2,1,"div",31),u(),d(14,"td",42),oe(15,vge,2,1,"div",31),oe(16,bge,2,1,"div",31),u(),d(17,"td",42),oe(18,yge,2,1,"div",31),oe(19,xge,2,5,"div",43),u(),d(20,"td"),oe(21,Cge,2,2,"mat-icon",44),oe(22,Sge,2,2,"mat-icon",45),oe(23,Age,2,2,"mat-icon",46),oe(24,Tge,2,2,"mat-icon",47),u()()),2&t){const e=n.$implicit,r=n.index,i=ae(2);w(2),_e(r+1),w(2),_e(e.idMedicamento),w(2),_e(i.primerasmayusculas(e.nombre)),w(2),_e(i.primerasmayusculas(e.forma)),w(2),_e(e.cantidad),w(2),N("ngIf",e.editing),w(1),N("ngIf",!e.editing),w(2),N("ngIf",e.editing),w(1),N("ngIf",!e.editing),w(2),N("ngIf",e.editing),w(1),N("ngIf",!e.editing),w(2),N("ngIf",!e.estado&&!e.editing),w(1),N("ngIf",!e.estado&&0!=e.cantidadAjuste),w(1),N("ngIf",!e.estado&&e.editing),w(1),N("ngIf",!e.estado&&e.editing)}}function kge(t,n){if(1&t&&(d(0,"div")(1,"table",39)(2,"thead",40)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"ID"),u(),d(8,"th"),h(9,"Nombre"),u(),d(10,"th"),h(11,"Forma Farmac\xe9utica"),u(),d(12,"th"),h(13,"Existencia en el sistema actual"),u(),d(14,"th"),h(15,"Existencia en el sistema durante el inventario"),u(),d(16,"th"),h(17,"Existencia fisica en el inventario"),u(),d(18,"th"),h(19,"Cantidad a ajustar +/- por inventario"),u(),d(20,"th"),h(21,"Gesti\xf3n"),u()()(),d(22,"tbody"),oe(23,Mge,25,15,"tr",41),u()()()),2&t){const e=ae();w(23),N("ngForOf",e.listaItemsFiltro)}}const Fge=function(){return["/menu/verajusteinventario"]};let C8=(()=>{class t{constructor(e,r,i,o){this.fb=e,this.servicio=r,this.ajustarInventarioServicio=i,this.activatedRoute=o,this.ajusteInventario=new y8,this.listaItems=[],this.listaItemsFiltro=[],this.data=[],this.importar=!1,this.smserror="",this.nombrebtn="Crear ajuste"}ngOnInit(){this.crearFormulario(),this.cargarRegistros(),this.activatedRoute.paramMap.subscribe(e=>{this.parametro=e.get("id"),this.parametro&&this.buscarRegistro(this.parametro)}),this.generalForm.get("listFilter").valueChanges.pipe(xo(300),Di(e=>this.buscarMedicamentos(e))).subscribe(e=>{this.listaItemsFiltro=e}),this.fechaActual=new Date,this.hoy=this.fechaActual.toISOString().split("T")[0]}buscarRegistro(e){this.ajustarInventarioServicio.getAjusteInventarioId(e).subscribe(r=>{this.registroUpdate=r,this.ajusteInventario=r,this.mostrarAjusteInventario()})}buscarMedicamentos(e){return e&&e.length>3?(e=e.toLocaleLowerCase(),On(this.listaItems.filter(i=>i.nombre.toLowerCase().includes(e)))):On(this.listaItems)}crearFormulario(){this.generalForm=this.fb.group({idAjuste:[""],bodegaAjuste:["0",[Zn.required]],fechaAjuste:["",[Zn.required]],observacionAjuste:["",[Zn.required]],fechaInventario:["",[Zn.required]],funcionarioInventario:[""],itemsAjuste:this.fb.array([]),listFilter:[""],soloajuste:[""]})}mostrarAjusteInventario(){this.nombrebtn="Actualizar ajuste",this.generalForm.patchValue({idAjuste:this.registroUpdate.idAjuste,bodegaAjuste:this.registroUpdate.bodegaAjuste.idBodega,fechaAjuste:this.registroUpdate.fechaAjuste,fechaInventario:this.registroUpdate.fechaInventario,observacionAjuste:this.registroUpdate.observacionAjuste,funcionarioInventario:this.registroUpdate.funcionarioInventario,itemsAjuste:this.registroUpdate.itemsAjuste}),this.servicio.getRegistrosMedicamentoBodega(this.registroUpdate.bodegaAjuste.idBodega).subscribe(e=>{this.listaItems=e.map(r=>({...r,estado:!1,editing:!1,cantidadAjuste:"",cantidadFisica:"",cantidadSistema:""})),this.listaItems.forEach(r=>{const i=this.registroUpdate.itemsAjuste.find(o=>o.medicamento.idMedicamento===r.idMedicamento);i&&(r.cantidadAjuste=i.cantidadAjuste,r.cantidadFisica=i.cantidadFisica,r.cantidadSistema=i.cantidadSistema)}),this.listaItems.sort((r,i)=>r.nombre.localeCompare(i.nombre)),this.listaItemsFiltro=this.listaItems.filter(r=>""!=r.cantidadAjuste),this.generalForm.get("soloajuste")?.patchValue(!0)},e=>{console.error(e)}),this.generalForm.get("bodegaAjuste")?.disable()}onBodegaChange(){const e=this.generalForm.get("bodegaAjuste")?.value;z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.servicio.getRegistrosMedicamentoBodega(e).subscribe(r=>{this.listaItems=r.map(i=>({...i,estado:!1,editing:!1,cantidadAjuste:"",cantidadFisica:"",cantidadSistema:""})),this.listaItems.sort((i,o)=>i.nombre.localeCompare(o.nombre)),this.listaItemsFiltro=this.listaItems,this.importar=!0,z().close()},r=>{console.error("\u274c Error cargando registros",r),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})}cargarRegistros(){this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistrosBodega=e.filter(r=>!0===r.salida),this.listaregistrosBodega.sort((r,i)=>r.nombre.localeCompare(i.nombre))},e=>{console.error(e)})}itemsDespachoFormArray(){return this.generalForm.get("itemsAjuste")}editarMedicamentoAjusteInventario(e){e.editing=!0}agregarItemAjusteInventario(e){this.itemsDespachoFormArray().push(this.fb.group({medicamento:[e.medicamento,Zn.required],cantidadAjuste:[e.cantidadAjuste,Zn.required],cantidadFisica:[e.cantidadFisica,Zn.required],cantidadSistema:[e.cantidadSistema,Zn.required]}))}cancelEdicion(e){e.editing=!1}guardarMedicamentoAjusteInventario(e){if(console.log(e),e.editing=!1,e&&e.idMedicamento)if(this.existeItem(e.idMedicamento))this.actualizarCantidad(e.idMedicamento,e.cantidadAjuste);else{let r=new w8;r.medicamento=e.idMedicamento,r.cantidadAjuste=e.cantidadAjuste,r.cantidadFisica=e.cantidadFisica,r.cantidadSistema=e.cantidadSistema,this.ajusteInventario.itemsAjuste.push(r)}else console.error("Item o idMedicamento no disponible:",e)}existeItem(e){let r=!1;return this.ajusteInventario.itemsAjuste.forEach(i=>{e===i.medicamento.idMedicamento&&(r=!0),e===i.medicamento&&(r=!0)}),r}actualizarCantidad(e,r){if(0==r||null==r)return this.eliminarItemAjusteInventario(e);this.ajusteInventario.itemsAjuste=this.ajusteInventario.itemsAjuste.map(i=>i.medicamento.idMedicamento===e?{...i,cantidad:r}:i)}eliminarItemAjusteInventario(e){if(this.itemParaEliminar=this.ajusteInventario.itemsAjuste.find(i=>i.medicamento.idMedicamento===e),!this.itemParaEliminar)return void console.error(`No se encontr\xf3 ning\xfan \xedtem con el ID: ${e}`);const r=this.itemParaEliminar.idItem;this.ajusteInventario.itemsAjuste=this.ajusteInventario.itemsAjuste.filter(i=>i.medicamento.idMedicamento!==e),r&&this.ajustarInventarioServicio.deleteItem(r).subscribe(i=>{alert(`El \xedtem "${r}" ha sido eliminado correctamente.`)},i=>{console.error(`Error al eliminar el \xedtem con ID ${r} de la base de datos:`,i)})}quitarMedicamentoAjusteInventario(e){if(this.itemParaEliminar=this.ajusteInventario.itemsAjuste.find(i=>i.medicamento.idMedicamento===e),!this.itemParaEliminar)return void console.error(`No se encontr\xf3 ning\xfan \xedtem con el ID: ${e}`);const r=this.itemParaEliminar.idItem;this.ajusteInventario.itemsAjuste=this.ajusteInventario.itemsAjuste.filter(i=>i.medicamento.idMedicamento!==e),r&&this.ajustarInventarioServicio.deleteItem(r).subscribe(i=>{z().fire({icon:"success",title:"Item eliminado!",text:"El item de la orden de ajuste de Inventario ha sido eleiminado correctamente!"})},i=>{console.error(`Error al eliminar el \xedtem con ID ${r} de la base de datos:`,i)})}procesarAjusteInventario(){let e=sessionStorage.getItem("nombre");this.listaItems.some(i=>{const o=Number(i.cantidad)||0,a=Number(i.cantidadAjuste)||0,s=o+a;return s<0&&(console.log("Cantidad actual:",o,"| Ajuste:",a),console.log("Diferencia calculada:",s),z().fire({icon:"error",title:"Cantidad insuficiente",text:"La orden de ajuste tiene items donde la cantidad a ajustar generaria un valor negativo e las existencias de la bodega que quiere ajustar."}),!0)})||z().fire({title:"\xbfConfirma?",icon:"question",text:"Ajustar las cantidades de los medicamentos de la orden de ajuste de inventario n\xfamero "+this.registroUpdate.idAjuste+" a la bodega "+this.registroUpdate.bodegaAjuste.nombre,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar!"}).then(i=>{i.isConfirmed&&this.ajustarInventarioServicio.ajustarInventarioBodega(this.ajusteInventario.idAjuste,this.registroUpdate.bodegaAjuste.idBodega,e).subscribe(o=>{this.nuevaAjusteInventario(),z().fire({icon:"success",title:"Ok",html:"Las cantidades de los medicamentos en la orden de ajuste seleccionada se han aplicado correctamente."})},o=>{z().fire({icon:"error",title:"Error",text:"No se pudo ajustar el inventario en la base de datos."})})})}create(){if(this.generalForm.valid)if(this.ajusteInventario.itemsAjuste.length>0){const e=this.generalForm.get("bodegaAjuste")?.value,r=this.listaregistrosBodega.find(s=>s.idBodega===e);let i=sessionStorage.getItem("nombre"),o="Bodega a ajustar:  <b>"+r.nombre+" </b> <br>";o=o+"N\xfamero de items de medicamentos que se afectaran en sus existencias:  <b>"+this.ajusteInventario.itemsAjuste.length+"</b>";let a="\xbfConfirma crear la orden de ajuste de inventario?";null!=this.parametro&&(a="\xbfConfirma actualizar la orden?"),z().fire({title:a,icon:"question",html:o,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar!"}).then(s=>{s.isConfirmed&&(null!=this.parametro?this.actualizarAjusteInventario(i):this.crearNuevaAjusteInventario(i))})}else z().fire({icon:"warning",title:"Verificar!",text:"No se ha agregado ning\xfan medicamento a la orden de ajuste de inventario que intenta guardar!"});else z().fire({icon:"error",title:"!Alerta",text:"Datos incompletos para crear la orden de ajuste de inventario en la base de datos!"})}crearNuevaAjusteInventario(e){this.ajusteInventario.bodegaAjuste=this.generalForm.get("bodegaAjuste")?.value,this.ajusteInventario.fechaAjuste=this.generalForm.get("fechaAjuste")?.value,this.ajusteInventario.funcionarioAjuste=e,this.ajusteInventario.observacionAjuste=this.generalForm.get("observacionAjuste")?.value,this.ajusteInventario.fechaInventario=this.generalForm.get("fechaInventario")?.value,this.ajusteInventario.funcionarioInventario=this.generalForm.get("funcionarioInventario")?.value,this.ajustarInventarioServicio.create(this.ajusteInventario).subscribe(r=>{this.buscarRegistro(r.idAjuste),this.generalForm.get("bodegaAjuste")?.enable(),this.parametro=r.idAjuste,z().fire({icon:"success",title:"Ok",text:"La orden de ajuste de inventario ha sido creada correctamente con el numero: "+r.idAjuste+" de fecha "+this.generalForm.get("fechaAjuste")?.value+" y afectara "+this.ajusteInventario.itemsAjuste.length+"medicamentos de la bodega seleccionada"})},r=>{z().fire({icon:"error",title:"Error",text:"No se pudo agregar la nueva orden de Ajuste de Inventario en la base de datos "+r.mensaje})})}nuevaAjusteInventario(){this.generalForm.reset({idAjuste:"",bodegaAjuste:"",fechaAjuste:"",observacionAjuste:"",fechaInventario:"",funcionarioInventario:"",itemsDespacho:this.fb.array([])}),this.listaItems=[],this.ajusteInventario=new y8,this.nombrebtn="Crear ajuste",this.generalForm.get("bodegaAjuste")?.enable(),this.parametro=null}actualizarAjusteInventario(e){this.ajusteInventario.fechaAjuste=this.generalForm.get("fechaAjuste")?.value,this.ajusteInventario.observacionAjuste=this.generalForm.get("observacionAjuste")?.value,this.ajusteInventario.fechaInventario=this.generalForm.get("fechaInventario")?.value,this.ajusteInventario.funcionarioInventario=this.generalForm.get("funcionarioInventario")?.value,this.ajustarInventarioServicio.update(this.ajusteInventario).subscribe(r=>{z().fire({icon:"success",title:"Ok",text:"La orden de ajuste de inventario ha sido actualizada correctamente."})},r=>{z().fire({icon:"error",title:"Error",text:"No se pudo actualizar la orden de ajuste de inventario en la base de datos."})})}onFileChange(e){const r=e.target;if(1!==r.files.length)return void console.error("No se puede cargar m\xfaltiples archivos");const i=new FileReader;i.onload=o=>{const s=Nb(o.target.result,{type:"binary",cellDates:!0});this.data=Gr.sheet_to_json(s.Sheets[s.SheetNames[0]],{header:1}),this.validateData(this.data)?(z().fire({icon:"success",title:"OK",text:"Ya le fueron asignados las cantidades a ajustar desde el archivo de excel, por favor verificar los datos antes de crear la orden de ajuste!"}),this.processData(this.data)):z().fire({icon:"error",title:"Error",text:"Hay una inconsistencia en el archivo de excel de cargue para crear la orden de ajuste de inventario; "+this.smserror}),e.target.value=""},i.readAsBinaryString(r.files[0])}validateData(e){this.smserror="";for(let r=1;r<e.length;r++){const i=e[r];if(8!==i.length)return this.smserror=`Error en la fila n\xfamero ${r} del archivo, la cantidad de columnas es incorrecta`,!1;const o=i[2],a=this.listaItems.find(l=>l.idMedicamento===o);if(!a)return this.smserror=`Error en la fila n\xfamero ${r} del archivo, el id del medicamento ${o} no existe en la base de datos de esa bodega.`,!1;if(a.cantidadAjuste=i[7],a.cantidadFisica=i[6],a.cantidadSistema=i[5],[i[5],i[6],i[7]].some(l=>Number.isNaN(Number(l))))return this.smserror=`Error en la fila n\xfamero ${r} del archivo, las columnas 6, 7 y 8 deben contener n\xfameros v\xe1lidos. Valores encontrados: [${i[5]}, ${i[6]}, ${i[7]}]`,!1;if(0===Number(i[7]))return this.smserror=`Error en la fila n\xfamero ${r} del archivo, la columna de ajuste (8) no puede ser 0, significa que no necesita ser ajustada`,!1;const s=Number(i[6])-Number(i[5]);if(Number(i[7])!==s)return this.smserror=`Error en la fila n\xfamero ${r} del archivo, el valor de ajuste (columna 8) no coincide con la diferencia entre la existencia f\xedsica (columna 7: ${i[6]}) y la existencia en el sistema (columna 6: ${i[5]}). Se esperaba: ${s}, pero se encontr\xf3: ${i[7]}`,!1}return!0}processData(e){const r=e.map(i=>({idMedicamento:i[2],cantidadAjuste:i[7],cantidadFisica:i[6],cantidadSistema:i[5]}));this.saveToDatabase(r)}saveToDatabase(e){for(let r=1;r<e.length;r++){let i=new w8;i.medicamento=e[r].idMedicamento,i.cantidadAjuste=e[r].cantidadAjuste,i.cantidadFisica=e[r].cantidadFisica,i.cantidadSistema=e[r].cantidadSistema,this.ajusteInventario.itemsAjuste.push(i)}}onAjuste(e){this.listaItemsFiltro=e.target.checked?this.listaItems.filter(r=>""!=r.cantidadAjuste):this.listaItems}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}reporteEnConstruccion(){z().fire({icon:"info",title:"En construcci\xf3n!",text:"El reporte esta en proceso de construcci\xf3n, te estaremos informando cuando est\xe9 disponible!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(Ts),X(x8),X(Us))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-ajusteinventario"]],decls:53,vars:13,consts:[[1,"container","mt-4"],[1,"w-100",3,"formGroup"],[1,"form-row"],[1,"row"],[1,"col-md-6"],[1,"form-group","row"],[1,"col-sm-4","col-form-label"],[1,"col-sm-8"],["type","date","formControlName","fechaAjuste",1,"form-control",3,"max"],["formControlName","bodegaAjuste","required","",1,"form-select",3,"change"],["selected","","value","0"],[3,"ngValue",4,"ngFor","ngForOf"],["type","date","formControlName","fechaInventario",1,"form-control",3,"max"],["type","text","formControlName","funcionarioInventario","placeholder","Ingrese nombre",1,"form-control"],[1,"form-row","mt-3"],["class","col-md-6",4,"ngIf"],[1,"btn","btn-outline-primary","w-50","mt-2",3,"routerLink"],["class","file-upload mt-2",4,"ngIf"],[1,"form-group","row","mt-2"],[1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["formControlName","observacionAjuste","placeholder","Ingrese un detalle completo que describa, el o los motivos del ajuste",1,"form-control"],[1,"text-container"],[1,"input-group","mb-2","align-center"],[1,"input-group-text","bg-transparent"],[3,"ngStyle"],["type","text","formControlName","listFilter","placeholder","Buscar por nombre del medicamento",1,"form-control","border-end-0","search-input"],[1,"form-group","d-flex","align-items-center","ms-3"],["id","portabilidad","type","checkbox","formControlName","soloajuste",1,"form-check-input","me-2",3,"change"],["for","portabilidad",1,"form-check-label"],["class","alert alert-info my-4",4,"ngIf"],[4,"ngIf"],[3,"ngValue"],[1,"btn","btn-outline-primary","w-50",3,"click"],[1,"far","fa-save"],[1,"btn","btn-outline-primary","w-50","mt-2",3,"click"],[1,"file-upload","mt-2"],["type","file","accept",".xlsx, .xls",3,"change"],[1,"alert","alert-info","my-4"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-colored"],[4,"ngFor","ngForOf"],[1,"text-center"],[3,"ngClass",4,"ngIf"],["title","Editar cantidad","class","pointer-cursor","title","Editar cantidad",3,"ngStyle","click",4,"ngIf"],["title","Eliminar cantidad","class","pointer-cursor","title","Eliminar cantidad a ajustar",3,"ngStyle","click",4,"ngIf"],["title","Cancelar","class","pointer-cursor","title","Cancelar edici\xf3n",3,"ngStyle","click",4,"ngIf"],["title","Guardar cantidad","class","pointer-cursor","title","Fijar cantidad",3,"ngStyle","click",4,"ngIf"],["type","number","placeholder","Cantidad en sistema inventario",1,"form-control","mb-1",3,"ngModel","ngModelChange"],["type","number","placeholder","Cantidad f\xedsica",1,"form-control","mb-1",3,"ngModel","ngModelChange"],["type","number","placeholder","Cantidad a ajustar +/-",1,"form-control","mb-1",3,"ngModel","ngModelChange"],[3,"ngClass"],["title","Editar cantidad","title","Editar cantidad",1,"pointer-cursor",3,"ngStyle","click"],["title","Eliminar cantidad","title","Eliminar cantidad a ajustar",1,"pointer-cursor",3,"ngStyle","click"],["title","Cancelar","title","Cancelar edici\xf3n",1,"pointer-cursor",3,"ngStyle","click"],["title","Guardar cantidad","title","Fijar cantidad",1,"pointer-cursor",3,"ngStyle","click"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),h(7,"Fecha del ajuste"),u(),d(8,"div",7),qe(9,"input",8),u()(),d(10,"div",5)(11,"label",6),h(12,"Bodega a ajustar"),u(),d(13,"div",7)(14,"select",9),De("change",function(){return i.onBodegaChange()}),d(15,"option",10),h(16,"Seleccione la bodega a ajustar"),u(),oe(17,dge,2,3,"option",11),u()()(),d(18,"div",5)(19,"label",6),h(20,"Fecha del inventario"),u(),d(21,"div",7),qe(22,"input",12),u()(),d(23,"div",5)(24,"label",6),h(25,"Funcionario que inventario"),u(),d(26,"div",7),qe(27,"input",13),u()()(),d(28,"div",4)(29,"div",14),oe(30,fge,4,1,"div",15),oe(31,hge,3,0,"div",15),d(32,"div",4)(33,"button",16),h(34,"Ver ajustes"),u()(),oe(35,pge,2,0,"div",17),u()(),d(36,"div",18)(37,"label",19),h(38,"Motivos del ajuste"),u(),d(39,"div",20),qe(40,"textarea",21),u()()()(),d(41,"div",22)(42,"div",23)(43,"span",24)(44,"mat-icon",25),h(45,"zoom_in"),u()(),qe(46,"input",26),d(47,"div",27)(48,"input",28),De("change",function(a){return i.onAjuste(a)}),u(),d(49,"label",29),h(50,"Ver solo los medicamentos en ajuste"),u()()()()(),oe(51,mge,2,0,"div",30),oe(52,kge,24,1,"div",31),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(8),N("max",i.hoy),w(8),N("ngForOf",i.listaregistrosBodega),w(5),N("max",i.hoy),w(8),N("ngIf",i.tieneAcceso(4)),w(1),N("ngIf",i.tieneAcceso(4)),w(2),N("routerLink",Nt(11,Fge)),w(2),N("ngIf",i.importar),w(9),N("ngStyle",Nt(12,uA)),w(7),N("ngIf",(null==i.listaregistrosBodega?null:i.listaregistrosBodega.length)<=0),w(1),N("ngIf",(null==i.listaregistrosBodega?null:i.listaregistrosBodega.length)>0))},dependencies:[wf,ho,Fi,Jo,Hs,Wo,Vs,cl,ul,vo,wd,sl,Ss,No,zo,Dc,bo,Ro,Ag],styles:[".text-danger[_ngcontent-%COMP%]{color:red;font-weight:700}.text-success[_ngcontent-%COMP%]{color:green;font-weight:700}"]})}return t})();function Ige(t,n){if(1&t&&(d(0,"option",17),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),fo("",e.nombre," - ",e.puntoEntrega,"")}}function Pge(t,n){if(1&t){const e=Fn();d(0,"button",12),De("click",function(){return ht(e),pt(ae().reporteEnConstruccion())}),h(1," Exportar Detalles"),u()}}function Oge(t,n){1&t&&(d(0,"div",18),h(1," No hay ordenes de ajuste por inventario a esta bodega para mostrar! "),u())}const dA=function(){return{color:"#009A94"}},Nge=function(t){return["/menu/ajusteinventario",t]};function Rge(t,n){if(1&t&&(d(0,"mat-icon",30),h(1,"edit"),u()),2&t){const e=ae().$implicit;N("ngStyle",Nt(2,dA))("routerLink",Si(3,Nge,e.idAjuste))}}const Lge=function(){return{color:"red"}};function Bge(t,n){if(1&t){const e=Fn();d(0,"mat-icon",31),De("click",function(){ht(e);const i=ae().$implicit;return pt(ae(2).eliminarAjusteInventario(i))}),h(1,"delete_sweep"),u()}2&t&&N("ngStyle",Nt(1,Lge))}function jge(t,n){if(1&t){const e=Fn();d(0,"button",28),De("click",function(){return ht(e),pt(ae(3).reporteEnConstruccion())}),d(1,"mat-icon",23),h(2,"print"),u(),d(3,"span"),h(4,"Relaci\xf3n de ajuste"),u()()}2&t&&(w(1),N("ngStyle",Nt(1,dA)))}const Vge=function(t){return{"selected-row":t}},Uge=function(t,n){return{color:t,"background-color":n}},Hge=function(){return{color:"#2BB6D7"}};function zge(t,n){if(1&t){const e=Fn();d(0,"tr",22),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).mostrarItemAjuste(o))}),d(1,"td"),h(2),u(),d(3,"td"),h(4),Hi(5,"date"),u(),d(6,"td"),h(7),u(),d(8,"td"),h(9),Hi(10,"date"),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),u(),d(15,"td",23),h(16),u(),d(17,"td")(18,"div")(19,"mat-icon",24),h(20,"print"),u(),oe(21,Rge,2,5,"mat-icon",25),oe(22,Bge,2,2,"mat-icon",26),u(),d(23,"mat-menu",null,27)(25,"button",28),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).actaAjustePDF(o))}),d(26,"mat-icon",23),h(27,"playlist_add_check"),u(),d(28,"span"),h(29,"Acta de ajuste"),u()(),oe(30,jge,5,2,"button",29),u()()()}if(2&t){const e=n.$implicit,r=go(24),i=ae(2);N("ngClass",Si(21,Vge,(null==i.ajusteActual?null:i.ajusteActual.idAjuste)===e.idAjuste)),w(2),Qt(" ",e.idAjuste,""),w(2),_e(Xo(5,15,e.fechaAjuste,"dd/MM/YYYY")),w(3),_e(e.funcionarioAjuste),w(2),_e(Xo(10,18,e.fechaInventario,"dd/MM/YYYY")),w(3),_e(e.funcionarioInventario),w(2),Qt("",e.itemsAjuste.length," "),w(1),N("ngStyle",I1(23,Uge,"Ajustado"===e.estado?"green":"red","Ajustado"===e.estado?"#d4edda":"#f8d7da")),w(1),_e(e.estado),w(3),N("ngStyle",Nt(26,dA))("matMenuTriggerFor",r),w(2),N("ngIf","Pendiente"===e.estado&&i.tieneAcceso(4)),w(1),N("ngIf","Pendiente"===e.estado&&i.tieneAcceso(4)),w(4),N("ngStyle",Nt(27,Hge)),w(4),N("ngIf",i.tieneAcceso(2)||"Ajustado"===e.estado)}}function $ge(t,n){if(1&t&&(d(0,"div")(1,"table",19)(2,"thead",20)(3,"tr")(4,"th"),h(5,"ID Ajuste"),u(),d(6,"th"),h(7,"Fecha ajuste"),u(),d(8,"th"),h(9,"Funcionario que realiza ajuste "),u(),d(10,"th"),h(11,"Fecha inventario"),u(),d(12,"th"),h(13,"Funcionario Inventario"),u(),d(14,"th"),h(15,"Items"),u(),d(16,"th"),h(17,"Estado"),u(),d(18,"th"),h(19,"Gesti\xf3n"),u()()(),d(20,"tbody"),oe(21,zge,31,28,"tr",21),u()()()),2&t){const e=ae();w(21),N("ngForOf",e.listaAjusteInventario)}}function Wge(t,n){if(1&t&&(d(0,"div",32)(1,"span",33),h(2,"OBSERVACI\xd3N DEL AJUSTE "),u(),qe(3,"br"),h(4),u()),2&t){const e=ae();w(4),Qt(" ",e.ajusteActual.observacionAjuste,"\n")}}const qge=function(t,n){return{"text-danger":t,"text-success":n}};function Gge(t,n){if(1&t&&(d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td",36),h(10),u(),d(11,"td",36),h(12),u(),d(13,"td",37),h(14),u()()),2&t){const e=n.$implicit,r=n.index;w(2),Qt(" ",r+1,""),w(2),Qt(" ",e.medicamento.idMedicamento,""),w(2),Qt(" ",e.medicamento.nombre,""),w(2),Qt(" ",e.medicamento.forma.nombre,""),w(2),Qt(" ",e.cantidadSistema,""),w(2),Qt(" ",e.cantidadFisica,""),w(1),N("ngClass",I1(8,qge,e.cantidadAjuste<0,e.cantidadAjuste>0)),w(1),Qt(" ",e.cantidadAjuste,"")}}function Yge(t,n){if(1&t&&(d(0,"div")(1,"div",32)(2,"span",33),h(3),u(),h(4," MEDICAMENTOS DE LA ORDEN DE AJUSTE POR INVENTARIO Nro. "),d(5,"span",33),h(6),u()(),d(7,"table",34)(8,"thead",20)(9,"tr")(10,"th"),h(11,"Item"),u(),d(12,"th"),h(13,"ID"),u(),d(14,"th"),h(15,"Medicamento"),u(),d(16,"th"),h(17,"Presentaci\xf3n"),u(),d(18,"th"),h(19,"Existencia en el sistema durante el inventario"),u(),d(20,"th"),h(21,"Existencia f\xedsica en el inventario"),u(),d(22,"th"),h(23,"Cantidad a ajustar +/-"),u()()(),d(24,"tbody"),oe(25,Gge,15,11,"tr",35),u()()()),2&t){const e=ae();w(3),_e(e.ajusteActual.itemsAjuste.length),w(3),_e(e.ajusteActual.idAjuste),w(19),N("ngForOf",e.listaItemAjuste)}}let Xge=(()=>{class t{constructor(e,r,i){this.fb=e,this.ajusteInventarioservicio=r,this.bodegaservicio=i,this.consultaSeleccionada="",this.idBodegaSeleccionada="",this.idBodegausuario=!1,this.contador=0,this.lista=[],this.ajusteActual=null,this.addJustifiedText=(s,l,c,f,v,E)=>{const D=s.splitTextToSize(l,v);let k=f;D.forEach((T,R)=>{let q=T.split(" "),Z=q.length-1;if(Z>0&&R!==D.length-1){let W=s.getTextWidth(T),Ee=(v-W)/Z,Le=q[0];for(let Pe=1;Pe<q.length;Pe++)Le+=" "+" ".repeat(Ee)+q[Pe];s.text(Le,c,k)}else s.text(T,c,k);k+=E})};const o=new Date,a=new Date(o);a.setDate(o.getDate()-90),this.generalForm=this.fb.group({idBodega:[""],fInicial:[a.toISOString().split("T")[0]],fFinal:[o.toISOString().split("T")[0]]})}ngOnInit(){this.parametro=parseInt(sessionStorage.getItem("bodega")||"0",10),this.bodegaservicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e,this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);return 0===o?r.puntoEntrega.localeCompare(i.puntoEntrega):o}),this.parametro&&this.generalForm.patchValue({idBodega:+this.parametro})},e=>{console.error(e)}),this.generalForm.get("idBodega").valueChanges.subscribe(e=>{e&&(this.parametro=e,this.consultarAjusteInventario(this.parametro))})}buscarAjusteInventario(){const e=this.generalForm.get("idBodega")?.value;this.idBodegaSeleccionada=e;const r=sessionStorage.getItem("bodega");this.idBodegausuario=r==e,this.consultarAjusteInventario(e)}consultarAjusteInventario(e){e&&!isNaN(e)&&0!==e?(this.ajusteActual=null,this.listaItemAjuste={},z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.ajusteInventarioservicio.getAjusteInventarioBodega(e,this.generalForm.get("fInicial")?.value,this.generalForm.get("fFinal")?.value).subscribe(r=>{this.listaAjusteInventario=r,this.listaAjusteInventario.sort((i,o)=>new Date(o.fechaDespacho).getTime()-new Date(i.fechaDespacho).getTime()),z().close()},r=>{console.error("\u274c Error cargando registros",r),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})):console.warn("\u274c ID inv\xe1lido para buscar registros:",e)}eliminarAjusteInventario(e){z().fire({title:"Desea eliminar?",text:"La orden de ajuste de existencias por inventario Nro. "+e.idAjuste+" a la bodega "+e.bodegaAjuste.nombre+" de la base de datos.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(r=>{r.isConfirmed&&this.ajusteInventarioservicio.delete(e.idAjuste).subscribe(i=>{this.listaAjusteInventario=this.listaAjusteInventario.filter(o=>o!==e),this.ajusteActual=null,this.listaItemAjuste={},z().fire({icon:"success",title:"Ok",text:"La orden de ajuste de existencias por inventario Nro. "+e.idAjuste+" a la bodega "+e.bodegaAjuste.nombre+" ha sido eliminado correctamente"})},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})})}salidasExcelDetalleAjuste(){var e=this;return(0,hi.Z)(function*(){const r=e.generalForm.get("fInicial")?.value,i=e.generalForm.get("fFinal")?.value,o=e.generalForm.get("idBodega")?.value;if(r&&i)if(o)if(new Date(r)>new Date(i))z().fire({icon:"error",title:"Invertidas!",text:"La fecha inicial del periodo no puede ser mayor que la fecha final!"});else try{Number(o);let c,f="";Array.isArray(c)?(e.lista=c,e.excelDetalleOrdenDespacho(f)):console.error("El formato de la respuesta no es v\xe1lido. Se esperaba un array.")}catch(l){console.error("Error al obtener los datos de detallados de las ordenes de despacho:",l)}else z().fire({icon:"error",title:"Orden Despacho!",text:"No ha seleccionado la bodega de la que desea generar el reporte!"});else z().fire({icon:"error",title:"Orden Despacho!",text:"Falta la informacion de las fechas del periodo que desea generar!"})})()}excelDetalleOrdenDespacho(e){const r=[];r.push(["ID MEDICAMENTO","CUM","NOMBRE MEDICAMENTO","PRESENTACION","CONTROLADO","CANTIDAD AJUSTE","ID ORDEN AJUSTE","FECHA AJUSTE","ESTADO","BODEGA","FUNCIONARIO AJUSTE","FUNCIONARIO INVENTARIO"]);let o="";this.lista.forEach(c=>{o=c.controlado?"SI":"NO",r.push([c.idMedicamento||"",c.codigoCum||"",c.nombreMedicamento||"",c.presentacion||"",o,c.cantidad||"",c.idDespacho||"",c.fechaDespacho||"",c.estado||"",c.bodegaOrigen||"",c.funcionarioDespacho||"",c.bodegaDestino||"",c.funcionarioEntradaDestino||"",c.tipo||""])});const a=Gr.aoa_to_sheet(r),s=Gr.decode_range(a["!ref"]);for(let c=s.s.c;c<=s.e.c;c++){const f=a[Gr.encode_cell({r:0,c})];f&&(f.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const l=Gr.book_new();Gr.book_append_sheet(l,a,e),Pf(l,"Relacion_Ajuste_"+e+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Su reporte de los ajustes fue exportado en su carpeta de descargas en formato xslx"})}calcularTotal(e){return this.listaItemAjuste.reduce((i,o)=>i+(o[e]?1:0),0).toString()}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}controlRespuesta(e){return null!=e?e.toString():""}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}mostrarItemAjuste(e){this.listaItemAjuste=e.itemsAjuste.sort((r,i)=>r.medicamento.nombre.localeCompare(i.medicamento.nombre)),this.ajusteActual=e}actaAjustePDF(e){this.datosActaAjuste(e).then(r=>{const i=new Kc.default({orientation:"p",unit:"mm",format:"letter",putOnlyUsedFonts:!0});let o="{total_pages_count_string}",a=1;const l=this;Zc()(i,{head:[["Nro","ID","Nombre del medicamento","F\xedsica","Plataforma","Diferencia +/-"]],body:r,startY:119,theme:"grid",willDrawPage:function(v){i.setFontSize(11),i.setDrawColor(0);let E=i.internal.pageSize.getWidth()/2-i.getTextWidth("ACTA DE AJUSTE DE INVENTARIO DE MEDICAMENTOS")/2,D=i.getTextWidth("ACTA DE AJUSTE DE INVENTARIO DE MEDICAMENTOS");i.setDrawColor("#D3E3FD"),i.setFillColor("#D3E3FD"),i.roundedRect(E-10,9,D+20,7,3,3,"FD"),i.addImage("/assets/logo.png","JPEG",180,16,25,20),i.text("ACTA DE AJUSTE DE INVENTARIO DE MEDICAMENTOS",E,14),E=i.internal.pageSize.getWidth()/2-i.getTextWidth("NUMERO: "+e.idAjuste+"-"+e.fechaAjuste)/2,D=i.getTextWidth("NUMERO: "+e.idAjuste+"-"+e.fechaAjuste),i.setDrawColor("#D3E3FD"),i.setFillColor("#D3E3FD"),i.roundedRect(E-10,17,D+20,7,3,3,"FD"),i.text("NUMERO: "+e.idAjuste+"-"+e.fechaAjuste,E,22),i.setTextColor("#000000"),i.text("Fecha de ajuste:",10,30),i.text(e.fechaAjuste,70,30),i.text("Responsable del ajuste:",10,35),i.text(e.funcionarioAjuste,70,35),i.text("Fecha del inventario:",10,40),i.text(e.fechaInventario,70,40),i.text("Responsable del inventario:",10,45),i.text(e.funcionarioInventario,70,45),i.text("Nombre de la bodega:",10,50),i.text(e.bodegaAjuste.nombre,70,50);let k="En la fecha indicada, se procede a la realizaci\xf3n del presente Acta de Ajuste de Inventario, con el prop\xf3sito de documentar las diferencias encontradas en los medicamentos entre la existencia f\xedsica y la existencia en la plataforma de dispensaci\xf3n de la IPS SERVICIOS INTEGRALES DE SALUD DEL MAGDALENA.",T=60,R=i.splitTextToSize(k,190);l.addJustifiedText(i,k,10,T,190,6),k="Durante el proceso de verificaci\xf3n llevado a cabo el d\xeda "+e.fechaInventario+", se identificaron discrepancias en las cantidades registradas, motivo por el cual se realiza el siguiente ajuste:",T=T+6*R.length+6,R=i.splitTextToSize(k,190),l.addJustifiedText(i,k,10,T,190,6),k="MOTIVOS DEL AJUSTE: "+e.observacionAjuste,T=T+6*R.length+6,R=i.splitTextToSize(k,190),l.addJustifiedText(i,k,10,T,190,6),T=T+6*R.length+6,E=i.internal.pageSize.getWidth()/2-i.getTextWidth("RELACI\xd3N DE MEDICAMENTOS AJUSTADOS")/2,D=i.getTextWidth("RELACI\xd3N DE MEDICAMENTOS AJUSTADOS"),i.setDrawColor("#D3E3FD"),i.setFillColor("#D3E3FD"),i.roundedRect(E-10,T-10,D+20,7,3,3,"FD"),i.text("RELACI\xd3N DE MEDICAMENTOS AJUSTADOS",E,T-5)},didDrawPage:function(v){i.setFontSize(10),i.text("P\xe1gina "+a+" de "+o,170,i.internal.pageSize.height-10),i.text("CALLE 24 #18A-101 Barrio Santa Catalina",12,i.internal.pageSize.height-12),i.text("Cel: 3004407974, Email: npizarro@sism.com.co",12,i.internal.pageSize.height-7),i.setLineWidth(1.3),i.setDrawColor(236,255,83),i.line(10,i.internal.pageSize.height-20,10,i.internal.pageSize.height-5);let E=v.cursor.y+30;l.addJustifiedText(i,"La presente acta se realiza con el fin de formalizar y documentar los ajustes necesarios para la correcta administraci\xf3n del inventario de los medicamentos.",10,E-25,190,6),i.setLineWidth(.3),i.setDrawColor(0,0,0),i.line(10,E,70,E),i.line(100,E,180,E),i.setFontSize(10),i.text("Responsable del Ajuste",15,E+5),i.text(e.funcionarioAjuste,15,E+10),i.text("Responsable del Inventario",105,E+5),i.text(e.funcionarioInventario,105,E+10),a++}}),"function"==typeof i.putTotalPages&&i.putTotalPages(o);var c=i.output("datauri"),f=window.open();f?f.document.write('<iframe src="'+c+'" width="100%" height="100%"></iframe>'):console.error("No se pudo abrir una nueva ventana.")})}datosActaAjuste(e){var r=this;return(0,hi.Z)(function*(){const i=[];try{r.lista=e.itemsAjuste.sort((o,a)=>o.medicamento.nombre.localeCompare(a.medicamento.nombre)),r.contador=0;for(let o=0;o<r.lista.length;o++){const a=[(o+1).toString(),`${r.lista[o].medicamento.idMedicamento??""}`,`${r.lista[o].medicamento.nombre??""}`,r.lista[o].cantidadFisica??"",r.lista[o].cantidadSistema??"",r.lista[o].cantidadAjuste??""];i.push(a)}return i.length>0?i:void 0}catch(o){return void console.error(o)}})()}reporteEnConstruccion(){z().fire({icon:"info",title:"En construcci\xf3n!",text:"El reporte esta en proceso de construcci\xf3n, te estaremos informando cuando est\xe9 disponible!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(ea),X(x8),X(Ts))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-verajusteinventario"]],decls:22,vars:7,consts:[[1,"container","mt-3",3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"input-group","mt-2"],["formControlName","idBodega",1,"form-select"],["selected","","value","0"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"date-inputs"],["type","date","formControlName","fInicial",1,"form-control","border-end-0"],[1,"date-label"],["type","date","formControlName","fFinal",1,"form-control","border-end-0"],["type","button",1,"btn","btn-info","btn-sm","btn-custom-gradient","buscar-button",3,"click"],["type","button","class","btn btn-info btn-sm btn-custom-gradient buscar-button",3,"click",4,"ngIf"],["class","alert alert-info my-2 mb-2",4,"ngIf"],[4,"ngIf"],["class","col-12 text-center",4,"ngIf"],[3,"ngValue"],[1,"alert","alert-info","my-2","mb-2"],[1,"table","table-striped","table-hover","table-sm","mt-2"],[1,"thead-colored"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[3,"ngStyle"],["title","Imprimir acta de ajuste",1,"puntero",3,"ngStyle","matMenuTriggerFor"],["class","puntero","title","Editar la orden de ajuste por inventario",3,"ngStyle","routerLink",4,"ngIf"],["class","puntero","title","Eliminar la orden de ajuste por inventario",3,"ngStyle","click",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["title","Editar la orden de ajuste por inventario",1,"puntero",3,"ngStyle","routerLink"],["title","Eliminar la orden de ajuste por inventario",1,"puntero",3,"ngStyle","click"],[1,"col-12","text-center"],[1,"fw-bold"],[1,"table","table-striped","table-hover","table-sm"],[4,"ngFor","ngForOf"],[1,"text-center"],[1,"text-center",3,"ngClass"]],template:function(r,i){1&r&&(d(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"select",4)(5,"option",5),h(6,"Seleccione la bodega a consultar"),u(),oe(7,Ige,2,3,"option",6),u()()(),d(8,"div",2)(9,"div",7)(10,"div",8),qe(11,"input",9),d(12,"div",10),h(13,"al"),u(),qe(14,"input",11),u(),d(15,"button",12),De("click",function(){return i.buscarAjusteInventario()}),h(16," Buscar"),u(),oe(17,Pge,2,0,"button",13),u()()(),oe(18,Oge,2,0,"div",14),oe(19,$ge,22,1,"div",15),oe(20,Wge,5,1,"div",16),oe(21,Yge,26,3,"div",15),u()),2&r&&(N("formGroup",i.generalForm),w(7),N("ngForOf",i.listaregistros),w(10),N("ngIf",i.tieneAcceso(3)||i.idBodegausuario),w(1),N("ngIf",0==(null==i.listaAjusteInventario?null:i.listaAjusteInventario.length)),w(1),N("ngIf",(null==i.listaAjusteInventario?null:i.listaAjusteInventario.length)>0),w(1),N("ngIf",null!=i.ajusteActual),w(1),N("ngIf",(null==i.listaItemAjuste?null:i.listaItemAjuste.length)>0))},dependencies:[wf,ho,Fi,Jo,Hs,n0,Of,r0,Wo,Vs,cl,ul,vo,Ss,No,zo,bo,Ro,Sc],styles:[".selected-row[_ngcontent-%COMP%]{background-color:#d1ecf1!important;font-weight:700}.puntero[_ngcontent-%COMP%]{cursor:pointer}.card-header[_ngcontent-%COMP%]{background:linear-gradient(to right,#71E0D2,#5D8FA5);color:#fff;border-radius:10px;display:flex;justify-content:space-between;align-items:center}.text-container[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]     .mat-tooltip{background-color:#f44336;color:#fff}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;flex-wrap:wrap}.card-title[_ngcontent-%COMP%]{margin-right:1rem;margin-left:10px;white-space:nowrap}.date-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;width:400px;padding:.15rem;font-size:.875rem}.input-group-text[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.form-control[_ngcontent-%COMP%]{flex:1;border-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:25px}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{border-top-left-radius:25px;border-bottom-left-radius:25px}.input-group[_ngcontent-%COMP%]   .form-control.border-end-0[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.btn-custom-gradient[_ngcontent-%COMP%]{background:linear-gradient(to right,#71E0D2,#67ACD6);color:#fff;border:none;transition:color .3s}.btn-custom-gradient[_ngcontent-%COMP%]:hover{color:#000}.buscar-button[_ngcontent-%COMP%]{margin:0 10px;border-radius:25px;width:140px}.btn-custom-gradient-d[_ngcontent-%COMP%]{background:linear-gradient(to right,#ff9966,#ff5e62);color:#fff;border:none;min-width:60px}.btn-custom-gradient-d[_ngcontent-%COMP%]:hover{color:#000}.text-danger[_ngcontent-%COMP%]{color:red;font-weight:700}.text-success[_ngcontent-%COMP%]{color:green;font-weight:700}"]})}return t})();function Kge(t,n){if(1&t&&(d(0,"mat-option",17),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function Zge(t,n){if(1&t){const e=Fn();d(0,"div")(1,"table",18)(2,"thead",19)(3,"tr")(4,"th"),h(5,"ID"),u(),d(6,"th"),h(7,"Medicamento"),u(),d(8,"th"),h(9,"Presentaci\xf3n"),u(),d(10,"th"),h(11,"Existencia"),u(),d(12,"th"),h(13,"Invima"),u(),d(14,"th"),h(15,"Laboratorio"),u(),d(16,"th"),h(17,"Lote"),u(),d(18,"th"),h(19,"Vencimiento"),u(),d(20,"th"),h(21,"Cantidad"),u(),qe(22,"th"),u()(),d(23,"tbody")(24,"tr")(25,"td"),h(26),u(),d(27,"td"),h(28),u(),d(29,"td"),h(30),u(),d(31,"td")(32,"strong"),h(33),u()(),d(34,"td"),qe(35,"input",20),u(),d(36,"td"),qe(37,"input",21),u(),d(38,"td"),qe(39,"input",22),u(),d(40,"td"),qe(41,"input",23),u(),d(42,"td"),qe(43,"input",24),u(),d(44,"td")(45,"button",25),De("click",function(){return ht(e),pt(ae().validarYGuardarMedicamento())}),h(46," Agregar"),u()()()()()()}if(2&t){const e=ae();w(26),_e(e.itemNuevo.id),w(2),_e(e.itemNuevo.medicamento),w(2),_e(e.itemNuevo.presentacion),w(3),_e(e.itemNuevo.existencia)}}const Qge=function(){return{color:"red"}};function Jge(t,n){if(1&t){const e=Fn();d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),u(),d(15,"td"),h(16),u(),d(17,"td"),h(18),u(),d(19,"td",28)(20,"strong"),h(21),u()(),d(22,"td")(23,"mat-icon",29),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).eliminarItemOrden(o))}),h(24," delete_sweep"),u()()()}if(2&t){const e=n.$implicit,r=n.index;w(2),_e(r+1),w(2),_e(e.medicamento.idMedicamento),w(2),_e(e.medicamento.nombre),w(2),_e(e.medicamento.forma.nombre),w(2),_e(e.medicamento.codigoCum),w(2),_e(e.invima),w(2),_e(e.laboratorio),w(2),_e(e.lote),w(2),_e(e.fechaVencimiento),w(3),_e(e.cantidad),w(2),N("ngStyle",Nt(11,Qge))}}function e0e(t,n){if(1&t&&(d(0,"div")(1,"table",18)(2,"thead",26)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"ID"),u(),d(8,"th"),h(9,"Medicamento"),u(),d(10,"th"),h(11,"Presentaci\xf3n"),u(),d(12,"th"),h(13,"CUM"),u(),d(14,"th"),h(15,"Invima"),u(),d(16,"th"),h(17,"Laboratorio"),u(),d(18,"th"),h(19,"Lote"),u(),d(20,"th"),h(21,"Vencimiento"),u(),d(22,"th"),h(23,"Cantidad"),u(),d(24,"th"),h(25,"Gesti\xf3n"),u()()(),d(26,"tbody"),oe(27,Jge,25,12,"tr",27),u()()()),2&t){const e=ae();w(27),N("ngForOf",e.listaItemsFormula)}}const t0e=function(){return["/menu/historialordendespacho"]};let n0e=(()=>{class t{constructor(e,r,i,o,a){this.ordenDespachoservicio=e,this.activatedRoute=r,this.formulaService=i,this.medicamentoService=o,this.fb=a,this.medicamentosFiltrados=[],this.verItem=!1,this.itemNuevo={id:"",medicamento:"",presentacion:"",existencia:0}}ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{this.parametro=e.get("id"),this.parametro&&this.buscarRegistro(this.parametro)}),this.generalForm=this.fb.group({medicamento:[""],invima:[""],laboratorio:[""],lote:[""],fechaVencimiento:[""],cantidad:[""]}),this.generalForm.get("medicamento").valueChanges.pipe(xo(300),Di(e=>this.formulaService.filtrarMedicamentos(e))).subscribe(e=>{this.medicamentosFiltrados=e})}buscarRegistro(e){this.ordenDespachoservicio.getOrdenDespachoId(e).subscribe(r=>{this.listaregistros=r,this.listaItemsFormula=r.itemsDespacho.map(i=>({...i,control:!1,cantidadDespacho:""})),this.listaItemsFormula.sort((i,o)=>i.medicamento.nombre.localeCompare(o.medicamento.nombre))})}seleccionarMedicamento(e){var r=this;return(0,hi.Z)(function*(){r.generalForm.get("medicamento")?.setValue(e.option.value.nombre),r.verItem=!1;try{if(!r.listaregistros?.bodegaOrigen?.idBodega)throw new Error("Bodega de origen no definida.");const i=e.option.value.idMedicamento;if(r.medicamentoSeleccionado=yield r.existenciaActual(i,r.listaregistros.bodegaOrigen.idBodega),!r.medicamentoSeleccionado)return void z().fire({icon:"error",title:"Error",text:"No se pudo obtener la cantidad disponible en la bodega de origen."});r.itemNuevo={id:i,medicamento:e.option.value.nombre,presentacion:e.option.value.forma?.nombre||"No especificado",existencia:r.medicamentoSeleccionado.cantidad||0},r.generalForm.patchValue({invima:r.medicamentoSeleccionado.invima||"",laboratorio:r.medicamentoSeleccionado.laboratorio||"",lote:r.medicamentoSeleccionado.lote||"",fechaVencimiento:r.medicamentoSeleccionado.fechaVencimiento||"",cantidad:""}),r.verItem=!0}catch(i){console.error("Error al seleccionar medicamento:",i);let o="Hubo un problema al validar el medicamento.";i instanceof Error?o=i.message:"string"==typeof i&&(o=i),z().fire({icon:"error",title:"Error",text:o})}})()}validarYGuardarMedicamento(){var e=this;return(0,hi.Z)(function*(){const r=e.generalForm.get("cantidad")?.value,i=Number(e.itemNuevo.id);if(e.existeItem(i))z().fire({icon:"error",title:"Error",text:"El medicamento "+e.itemNuevo.medicamento+" que esta intentando agregar, ya se encuentra en los item de la orden. por lo tanto no se puede adicionar!"});else{if(!(e.generalForm.get("invima")?.value&&e.generalForm.get("lote")?.value&&e.generalForm.get("laboratorio")?.value&&e.generalForm.get("fechaVencimiento")?.value&&r))return void z().fire({icon:"warning",title:"Campos obligatorios",text:"Por favor, complete todos los campos que se necesitan para agregar el item a la orden antes de continuar."});try{if(e.medicamentoSeleccionado=yield e.existenciaActual(i,e.listaregistros.bodegaOrigen.idBodega),!e.medicamentoSeleccionado)return void z().fire({icon:"error",title:"Error",text:"No se pudo obtener la cantidad disponible en la bodega de origen para comparar y agregar el medicamento a la orden ."});if(r>e.medicamentoSeleccionado.cantidad)return void z().fire({icon:"error",title:"Cantidad insuficiente",text:`No se puede agregar el medicamento a la orden por que la cantidad existente (${e.medicamentoSeleccionado.cantidad}) es insuficiente a la cantidad solicitada (${r}) de la bodega de origen.`});let o=new Cx;o.medicamento=i,o.cantidad=r,o.invima=e.generalForm.get("invima")?.value,o.laboratorio=e.generalForm.get("laboratorio")?.value,o.lote=e.generalForm.get("lote")?.value,o.fechaVencimiento=e.generalForm.get("fechaVencimiento")?.value,e.listaregistros.itemsDespacho.push(o),e.ordenDespachoservicio.agregarItemAOrden(e.listaregistros.idDespacho,o).subscribe({next:a=>{e.verItem=!1,e.buscarRegistro(e.parametro),z().fire({icon:"success",title:"Medicamento agregado",text:`Se agreg\xf3 ${r} unidad(es) del medicamento  ${e.itemNuevo.medicamento} a la orden de despacho correctamente.`})},error:a=>{z().fire({icon:"error",title:"Error",text:a.message})}})}catch{z().fire({icon:"error",title:"Error",text:"Hubo un problema al validar el medicamento."})}}})()}existenciaActual(e,r){return new Promise((i,o)=>{this.medicamentoService.getMedicamentoBodega(e,r).subscribe(a=>i(a),a=>{console.error("Error al obtener existencia:",a),o(a)})})}existeItem(e){let r=!1;return this.listaregistros.itemsDespacho.forEach(i=>{e===i.medicamento.idMedicamento&&(r=!0),e===i.medicamento&&(r=!0)}),r}eliminarItemOrden(e){this.tieneAcceso(3)?z().fire({title:"Desea eliminar?",text:"Esta seguro de quitar el medicamento "+e.medicamento.nombre+" de la orden de despacho, se devolvera al inventario de la bodega de origen "+this.listaregistros.bodegaOrigen.nombre+" la cantidad "+e.cantidad+" que se encontraban en cange.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, devolver y eliminar!"}).then(r=>{r.isConfirmed&&this.ordenDespachoservicio.regresarItemcangeBodegaorigen(this.listaregistros.idDespacho,e.id,e.medicamento.idMedicamento,e.cantidad).subscribe(i=>{z().fire({icon:"success",title:"Ok",text:"El item con el medicamento  "+e.medicamento.nombre+" de la orden se ha eliminado y devuelto a la bodega de origen "+this.listaregistros.bodegaOrigen.nombre+" la cantidad de "+e.cantidad+" correctamente! ya puede verificarlo en su existencia"}),this.buscarRegistro(this.parametro)},i=>{z().fire({icon:"error",title:"Error",text:i.mensaje})})}):z().fire({icon:"warning",title:"Falta de permisos",text:"No tienes permisos para realizar la modificaci\xf3n en la devoluci\xf3n del medicamento en la orden de despacho, comunicate con el funcionario encargado!"})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}tieneAcceso(e){const r=Number(sessionStorage.getItem("nivel"));return!isNaN(r)&&r>=e}static#e=this.\u0275fac=function(r){return new(r||t)(X(y_),X(Us),X(Dd),X(l0),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-ordendespachoedit"]],decls:59,vars:18,consts:[[1,"card-body"],[3,"formGroup"],[1,"col-12","text-center"],[1,"fw-bold"],[1,"row","mt-2"],[1,"col-md-6"],[1,"card-header"],[1,"col-sm-9"],["appearance","fill",1,"w-100"],["type","text","matInput","","formControlName","medicamento",3,"matAutocomplete"],[3,"optionSelected"],["automedicamento","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"row"],[1,"col-6"],[1,"btn","btn-outline-primary","w-50",3,"routerLink"],[3,"value"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-gradient-d"],["type","text","formControlName","invima","placeholder","Digite invima",1,"form-control","border-end-0","search-input"],["type","text","formControlName","laboratorio","placeholder","Digite laboratorio",1,"form-control","border-end-0","search-input"],["type","text","formControlName","lote","placeholder","Digite lote",1,"form-control","border-end-0","search-input"],["type","date","formControlName","fechaVencimiento",1,"form-control","border-end-0","input-anch"],["type","number","formControlName","cantidad","placeholder","Digite cantidad",1,"form-control","border-end-0","search-input"],["title","Agregar item de la orden",1,"btn","btn-outline-primary",3,"click"],[1,"thead-colored"],[4,"ngFor","ngForOf"],[2,"color","green","text-align","right"],["title","Eliminar item de la orden",3,"ngStyle","click"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),h(4),u()(),d(5,"div",4)(6,"div",5)(7,"div",6),h(8," Origen "),d(9,"strong"),h(10),u()(),d(11,"div",0)(12,"p")(13,"strong"),h(14,"Direcci\xf3n:"),u(),h(15),u(),d(16,"p")(17,"strong"),h(18,"Tel\xe9fono:"),u(),h(19),d(20,"strong"),h(21,"Funcionario despacho:"),u(),h(22),u(),d(23,"p")(24,"strong"),h(25,"Observaci\xf3n:"),u(),h(26),u()()(),d(27,"div",5)(28,"div",6),h(29," Destino "),d(30,"strong"),h(31),u()(),d(32,"div",0)(33,"p")(34,"strong"),h(35,"Direcci\xf3n:"),u(),h(36),u(),d(37,"p")(38,"strong"),h(39,"Tel\xe9fono:"),u(),h(40),d(41,"strong"),h(42,"Funcionario ingreso:"),u(),h(43),u()()()(),d(44,"div",7)(45,"mat-form-field",8)(46,"mat-label"),h(47,"Buscar medicamento a agregar "),u(),qe(48,"input",9),d(49,"mat-autocomplete",10,11),De("optionSelected",function(a){return i.seleccionarMedicamento(a)}),oe(51,Kge,2,2,"mat-option",12),u()()(),oe(52,Zge,47,4,"div",13),u(),oe(53,e0e,28,1,"div",13),qe(54,"hr"),d(55,"div",14)(56,"div",15)(57,"button",16),h(58," Regresar"),u()()()()),2&r){const o=go(50);w(1),N("formGroup",i.generalForm),w(3),fo("EDITANDO ORDEN DE DESPACHO Nro. ",null==i.listaregistros?null:i.listaregistros.idDespacho," DE FECHA ",null==i.listaregistros?null:i.listaregistros.fechaDespacho," "),w(6),Qt("(",null==i.listaregistros||null==i.listaregistros.bodegaOrigen?null:i.listaregistros.bodegaOrigen.nombre,")"),w(5),Qt(" ",null==i.listaregistros||null==i.listaregistros.bodegaOrigen?null:i.listaregistros.bodegaOrigen.direccion,""),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.bodegaOrigen?null:i.listaregistros.bodegaOrigen.telefono," "),w(3),Qt(" ",null==i.listaregistros?null:i.listaregistros.funcionarioDespacho,""),w(4),Qt(" ",null==i.listaregistros?null:i.listaregistros.observacion,""),w(5),Qt("(",null==i.listaregistros||null==i.listaregistros.bodegaDestino?null:i.listaregistros.bodegaDestino.nombre,")"),w(5),Qt(" ",null==i.listaregistros||null==i.listaregistros.bodegaDestino?null:i.listaregistros.bodegaDestino.direccion,""),w(4),Qt(" ",null==i.listaregistros||null==i.listaregistros.bodegaDestino?null:i.listaregistros.bodegaDestino.telefono," "),w(3),Qt(" ",null==i.listaregistros?null:i.listaregistros.funcionarioEntradaDestino,""),w(5),N("matAutocomplete",o),w(3),N("ngForOf",i.medicamentosFiltrados),w(1),N("ngIf",i.verItem),w(1),N("ngIf",(null==i.listaItemsFormula?null:i.listaItemsFormula.length)>0),w(4),N("routerLink",Nt(17,t0e))}},dependencies:[ho,Fi,Jo,Hs,Wo,vo,wd,No,zo,bo,Ro,c0,_m,hm,b_,gm,u0],styles:[".card-body[_ngcontent-%COMP%]{padding:10px}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:14px;line-height:1.3}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}.card[_ngcontent-%COMP%]{margin:15px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.card-header[_ngcontent-%COMP%]{background:linear-gradient(to right,#5D8FA5,#6CC5D4);color:#fff;font-weight:700;padding:8px;border-radius:8px 8px 0 0}.card-body[_ngcontent-%COMP%]{padding:15px}.form-group[_ngcontent-%COMP%]{margin-bottom:5px}.form-group.row[_ngcontent-%COMP%]{display:flex;align-items:center}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:0}.form-control[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{border-radius:4px}.btn-info[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;color:#fff}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;border-color:#dc3545;color:#fff}.alert[_ngcontent-%COMP%]{border-radius:4px;margin-top:5px}.float-right[_ngcontent-%COMP%]{margin-top:5px;font-weight:700}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]{padding:0 2px}.mat-option[_ngcontent-%COMP%]{font-size:12px;line-height:1.1;padding:2px 8px;transition:background-color .2s}.mat-option[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.mat-autocomplete-panel[_ngcontent-%COMP%]{border-radius:4px;box-shadow:0 4px 8px #0000001a;max-height:250px;overflow-y:auto}.mat-input-element[_ngcontent-%COMP%]{padding:5px 8px}.input-container[_ngcontent-%COMP%]{margin-bottom:2px}@media (max-width: 768px){.mat-input-element[_ngcontent-%COMP%]{padding:5px 8px}.mat-option[_ngcontent-%COMP%]{font-size:13px;padding:5px 10px}}.input-group[_ngcontent-%COMP%]{display:flex;align-items:center}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{flex:1;margin-right:8px}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin:0}"]})}return t})();function r0e(t,n){1&t&&Ri(0)}const E8=["*"];function i0e(t,n){}const o0e=function(t){return{animationDuration:t}},a0e=function(t,n){return{value:t,params:n}},s0e=["tabListContainer"],l0e=["tabList"],c0e=["nextPaginator"],u0e=["previousPaginator"],d0e=["tabBodyWrapper"],f0e=["tabHeader"];function h0e(t,n){}function p0e(t,n){1&t&&oe(0,h0e,0,0,"ng-template",9),2&t&&N("cdkPortalOutlet",ae().$implicit.templateLabel)}function m0e(t,n){1&t&&h(0),2&t&&_e(ae().$implicit.textLabel)}function g0e(t,n){if(1&t){const e=Fn();d(0,"div",6),De("click",function(){const i=ht(e),o=i.$implicit,a=i.index,s=ae(),l=go(1);return pt(s._handleClick(o,l,a))})("cdkFocusChange",function(i){const a=ht(e).index;return pt(ae()._tabFocusChanged(i,a))}),d(1,"div",7),oe(2,p0e,1,1,"ng-template",8),oe(3,m0e,1,1,"ng-template",8),u()()}if(2&t){const e=n.$implicit,r=n.index,i=ae();Ai("mat-tab-label-active",i.selectedIndex==r),N("id",i._getTabLabelId(r))("disabled",e.disabled)("matRippleDisabled",e.disabled||i.disableRipple),kr("tabIndex",i._getTabIndex(e,r))("aria-posinset",r+1)("aria-setsize",i._tabs.length)("aria-controls",i._getTabContentId(r))("aria-selected",i.selectedIndex==r)("aria-label",e.ariaLabel||null)("aria-labelledby",!e.ariaLabel&&e.ariaLabelledby?e.ariaLabelledby:null),w(2),N("ngIf",e.templateLabel),w(1),N("ngIf",!e.templateLabel)}}function _0e(t,n){if(1&t){const e=Fn();d(0,"mat-tab-body",10),De("_onCentered",function(){return ht(e),pt(ae()._removeTabBodyWrapperHeight())})("_onCentering",function(i){return ht(e),pt(ae()._setTabBodyWrapperHeight(i))}),u()}if(2&t){const e=n.$implicit,r=n.index,i=ae();Ai("mat-tab-body-active",i.selectedIndex===r),N("id",i._getTabContentId(r))("content",e.content)("position",e.position)("origin",e.origin)("animationDuration",i.animationDuration),kr("tabindex",null!=i.contentTabIndex&&i.selectedIndex===r?i.contentTabIndex:null)("aria-labelledby",i._getTabLabelId(r))}}const v0e=new U("MatInkBarPositioner",{providedIn:"root",factory:function b0e(){return n=>({left:n?(n.offsetLeft||0)+"px":"0",width:n?(n.offsetWidth||0)+"px":"0"})}});let S8=(()=>{class t{constructor(e,r,i,o){this._elementRef=e,this._ngZone=r,this._inkBarPositioner=i,this._animationMode=o}alignToElement(e){this.show(),typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._setStyles(e))}):this._setStyles(e)}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}_setStyles(e){const r=this._inkBarPositioner(e),i=this._elementRef.nativeElement;i.style.left=r.left,i.style.width=r.width}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Wr),X(v0e),X(kl,8))},t.\u0275dir=jn({type:t,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(e,r){2&e&&Ai("_mat-animation-noopable","NoopAnimations"===r._animationMode)}}),t})();const y0e=new U("MatTabContent"),w0e=new U("MatTabLabel"),x0e=new U("MAT_TAB"),C0e=m_(class{}),D8=new U("MAT_TAB_GROUP");let A8=(()=>{class t extends C0e{constructor(e,r){super(),this._viewContainerRef=e,this._closestTabGroup=r,this.textLabel="",this._contentPortal=null,this._stateChanges=new Bt,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(e){this._setTemplateLabelInput(e)}get content(){return this._contentPortal}ngOnChanges(e){(e.hasOwnProperty("textLabel")||e.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new p_(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(e){e&&e._closestTab===this&&(this._templateLabel=e)}}return t.\u0275fac=function(e){return new(e||t)(X(Ml),X(D8,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-tab"]],contentQueries:function(e,r,i){if(1&e&&(so(i,w0e,5),so(i,y0e,7,Zl)),2&e){let o;Er(o=Sr())&&(r.templateLabel=o.first),Er(o=Sr())&&(r._explicitContent=o.first)}},viewQuery:function(e,r){if(1&e&&Ko(Zl,7),2&e){let i;Er(i=Sr())&&(r._implicitContent=i.first)}},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"]},exportAs:["matTab"],features:[ki([{provide:x0e,useExisting:t}]),_r,gn],ngContentSelectors:E8,decls:1,vars:0,template:function(e,r){1&e&&(Fa(),oe(0,r0e,1,0,"ng-template"))},encapsulation:2}),t})();const E0e={translateTab:Zg("translateTab",[Gu("center, void, left-origin-center, right-origin-center",wa({transform:"none"})),Gu("left",wa({transform:"translate3d(-100%, 0, 0)",minHeight:"1px"})),Gu("right",wa({transform:"translate3d(100%, 0, 0)",minHeight:"1px"})),au("* => left, * => right, left => center, right => center",ou("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),au("void => left-origin-center",[wa({transform:"translate3d(-100%, 0, 0)"}),ou("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),au("void => right-origin-center",[wa({transform:"translate3d(100%, 0, 0)"}),ou("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let S0e=(()=>{class t extends Qg{constructor(e,r,i,o){super(e,r,o),this._host=i,this._centeringSub=br.EMPTY,this._leavingSub=br.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(ec(this._host._isCenterPosition(this._host._position))).subscribe(e=>{e&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(X(Bp),X(Ml),X(Ir(()=>T8)),X(si))},t.\u0275dir=jn({type:t,selectors:[["","matTabBodyHost",""]],features:[_r]}),t})(),D0e=(()=>{class t{constructor(e,r,i){this._elementRef=e,this._dir=r,this._dirChangeSubscription=br.EMPTY,this._translateTabComplete=new Bt,this._onCentering=new Vr,this._beforeCentering=new Vr,this._afterLeavingCenter=new Vr,this._onCentered=new Vr(!0),this.animationDuration="500ms",r&&(this._dirChangeSubscription=r.change.subscribe(o=>{this._computePositionAnimationState(o),i.markForCheck()})),this._translateTabComplete.pipe(_D((o,a)=>o.fromState===a.fromState&&o.toState===a.toState)).subscribe(o=>{this._isCenterPosition(o.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(o.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(e){this._positionIndex=e,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(e){const r=this._isCenterPosition(e.toState);this._beforeCentering.emit(r),r&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(e){return"center"==e||"left-origin-center"==e||"right-origin-center"==e}_computePositionAnimationState(e=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==e?"left":"right":this._positionIndex>0?"ltr"==e?"right":"left":"center"}_computePositionFromOrigin(e){const r=this._getLayoutDirection();return"ltr"==r&&e<=0||"rtl"==r&&e>0?"left-origin-center":"right-origin-center"}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(su,8),X(Zo))},t.\u0275dir=jn({type:t,inputs:{_content:["content","_content"],origin:"origin",animationDuration:"animationDuration",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),t})(),T8=(()=>{class t extends D0e{constructor(e,r,i){super(e,r,i)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(su,8),X(Zo))},t.\u0275cmp=pr({type:t,selectors:[["mat-tab-body"]],viewQuery:function(e,r){if(1&e&&Ko(Qg,5),2&e){let i;Er(i=Sr())&&(r._portalHost=i.first)}},hostAttrs:[1,"mat-tab-body"],features:[_r],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(e,r){1&e&&(d(0,"div",0,1),De("@translateTab.start",function(o){return r._onTranslateTabStarted(o)})("@translateTab.done",function(o){return r._translateTabComplete.next(o)}),oe(2,i0e,0,0,"ng-template",2),u()),2&e&&N("@translateTab",I1(3,a0e,r._position,Si(1,o0e,r.animationDuration)))},dependencies:[S0e],styles:[".mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}\n"],encapsulation:2,data:{animation:[E0e.translateTab]}}),t})();const M8=new U("MAT_TABS_CONFIG"),A0e=m_(class{});let k8=(()=>{class t extends A0e{constructor(e){super(),this.elementRef=e}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return t.\u0275fac=function(e){return new(e||t)(X($r))},t.\u0275dir=jn({type:t,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(e,r){2&e&&(kr("aria-disabled",!!r.disabled),Ai("mat-tab-disabled",r.disabled))},inputs:{disabled:"disabled"},features:[_r]}),t})();const F8=f_({passive:!0});let k0e=(()=>{class t{constructor(e,r,i,o,a,s,l){this._elementRef=e,this._changeDetectorRef=r,this._viewportRuler=i,this._dir=o,this._ngZone=a,this._platform=s,this._animationMode=l,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new Bt,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new Bt,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new Vr,this.indexFocused=new Vr,a.runOutsideAngular(()=>{lu(e.nativeElement,"mouseleave").pipe(Co(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){e=um(e),this._selectedIndex!=e&&(this._selectedIndexChanged=!0,this._selectedIndex=e,this._keyManager&&this._keyManager.updateActiveItem(e))}ngAfterViewInit(){lu(this._previousPaginator.nativeElement,"touchstart",F8).pipe(Co(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),lu(this._nextPaginator.nativeElement,"touchstart",F8).pipe(Co(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const e=this._dir?this._dir.change:On("ltr"),r=this._viewportRuler.change(150),i=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new CD(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap(),this._keyManager.updateActiveItem(this._selectedIndex),typeof requestAnimationFrame<"u"?requestAnimationFrame(i):i(),Ea(e,r,this._items.changes).pipe(Co(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>Promise.resolve().then(i)),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe(Co(this._destroyed)).subscribe(o=>{this.indexFocused.emit(o),this._setTabFocus(o)})}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(e){if(!Ad(e))switch(e.keyCode){case 13:case 32:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(e));break;default:this._keyManager.onKeydown(e)}}_onContentChanges(){const e=this._elementRef.nativeElement.textContent;e!==this._currentTextContent&&(this._currentTextContent=e||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(e){!this._isValidIndex(e)||this.focusIndex===e||!this._keyManager||this._keyManager.setActiveItem(e)}_isValidIndex(e){if(!this._items)return!0;const r=this._items?this._items.toArray()[e]:null;return!!r&&!r.disabled}_setTabFocus(e){if(this._showPaginationControls&&this._scrollToLabel(e),this._items&&this._items.length){this._items.toArray()[e].focus();const r=this._tabListContainer.nativeElement;r.scrollLeft="ltr"==this._getLayoutDirection()?0:r.scrollWidth-r.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const e=this.scrollDistance,r="ltr"===this._getLayoutDirection()?-e:e;this._tabList.nativeElement.style.transform=`translateX(${Math.round(r)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(e){this._scrollTo(e)}_scrollHeader(e){return this._scrollTo(this._scrollDistance+("before"==e?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(e){this._stopInterval(),this._scrollHeader(e)}_scrollToLabel(e){if(this.disablePagination)return;const r=this._items?this._items.toArray()[e]:null;if(!r)return;const i=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:o,offsetWidth:a}=r.elementRef.nativeElement;let s,l;"ltr"==this._getLayoutDirection()?(s=o,l=s+a):(l=this._tabList.nativeElement.offsetWidth-o,s=l-a);const c=this.scrollDistance,f=this.scrollDistance+i;s<c?this.scrollDistance-=c-s+60:l>f&&(this.scrollDistance+=l-f+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const e=this._tabList.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;e||(this.scrollDistance=0),e!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=e}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabList.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const e=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,r=e?e.elementRef.nativeElement:null;r?this._inkBar.alignToElement(r):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(e,r){r&&null!=r.button&&0!==r.button||(this._stopInterval(),kD(650,100).pipe(Co(Ea(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:i,distance:o}=this._scrollHeader(e);(0===o||o>=i)&&this._stopInterval()}))}_scrollTo(e){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const r=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(r,e)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:r,distance:this._scrollDistance}}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Zo),X(e0),X(su,8),X(Wr),X(Ka),X(kl,8))},t.\u0275dir=jn({type:t,inputs:{disablePagination:"disablePagination"}}),t})(),F0e=(()=>{class t extends k0e{constructor(e,r,i,o,a,s,l){super(e,r,i,o,a,s,l),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Bo(e)}_itemSelected(e){e.preventDefault()}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Zo),X(e0),X(su,8),X(Wr),X(Ka),X(kl,8))},t.\u0275dir=jn({type:t,inputs:{disableRipple:"disableRipple"},features:[_r]}),t})(),I0e=(()=>{class t extends F0e{constructor(e,r,i,o,a,s,l){super(e,r,i,o,a,s,l)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Zo),X(e0),X(su,8),X(Wr),X(Ka),X(kl,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-tab-header"]],contentQueries:function(e,r,i){if(1&e&&so(i,k8,4),2&e){let o;Er(o=Sr())&&(r._items=o)}},viewQuery:function(e,r){if(1&e&&(Ko(S8,7),Ko(s0e,7),Ko(l0e,7),Ko(c0e,5),Ko(u0e,5)),2&e){let i;Er(i=Sr())&&(r._inkBar=i.first),Er(i=Sr())&&(r._tabListContainer=i.first),Er(i=Sr())&&(r._tabList=i.first),Er(i=Sr())&&(r._nextPaginator=i.first),Er(i=Sr())&&(r._previousPaginator=i.first)}},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(e,r){2&e&&Ai("mat-tab-header-pagination-controls-enabled",r._showPaginationControls)("mat-tab-header-rtl","rtl"==r._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[_r],ngContentSelectors:E8,decls:13,vars:8,consts:[["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(e,r){1&e&&(Fa(),d(0,"div",0,1),De("click",function(){return r._handlePaginatorClick("before")})("mousedown",function(o){return r._handlePaginatorPress("before",o)})("touchend",function(){return r._stopInterval()}),qe(2,"div",2),u(),d(3,"div",3,4),De("keydown",function(o){return r._handleKeydown(o)}),d(5,"div",5,6),De("cdkObserveContent",function(){return r._onContentChanges()}),d(7,"div",7),Ri(8),u(),qe(9,"mat-ink-bar"),u()(),d(10,"div",8,9),De("mousedown",function(o){return r._handlePaginatorPress("after",o)})("click",function(){return r._handlePaginatorClick("after")})("touchend",function(){return r._stopInterval()}),qe(12,"div",2),u()),2&e&&(Ai("mat-tab-header-pagination-disabled",r._disableScrollBefore),N("matRippleDisabled",r._disableScrollBefore||r.disableRipple),w(5),Ai("_mat-animation-noopable","NoopAnimations"===r._animationMode),w(5),Ai("mat-tab-header-pagination-disabled",r._disableScrollAfter),N("matRippleDisabled",r._disableScrollAfter||r.disableRipple))},dependencies:[Nh,xD,S8],styles:['.mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;-moz-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:transparent;touch-action:none}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;content:"";height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-ink-bar{transition:none;animation:none}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}._mat-animation-noopable.mat-tab-list{transition:none;animation:none}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}\n'],encapsulation:2}),t})(),P0e=0;class O0e{}const N0e=Jg(Oh(class{constructor(t){this._elementRef=t}}),"primary");let R0e=(()=>{class t extends N0e{constructor(e,r,i,o){super(e),this._changeDetectorRef=r,this._animationMode=o,this._tabs=new Hp,this._indexToSelect=0,this._tabBodyWrapperHeight=0,this._tabsSubscription=br.EMPTY,this._tabLabelSubscription=br.EMPTY,this._selectedIndex=null,this.headerPosition="above",this.selectedIndexChange=new Vr,this.focusChange=new Vr,this.animationDone=new Vr,this.selectedTabChange=new Vr(!0),this._groupId=P0e++,this.animationDuration=i&&i.animationDuration?i.animationDuration:"500ms",this.disablePagination=!(!i||null==i.disablePagination)&&i.disablePagination,this.dynamicHeight=!(!i||null==i.dynamicHeight)&&i.dynamicHeight,this.contentTabIndex=i?.contentTabIndex??null}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(e){this._dynamicHeight=Bo(e)}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){this._indexToSelect=um(e,null)}get animationDuration(){return this._animationDuration}set animationDuration(e){this._animationDuration=/^\d+$/.test(e)?e+"ms":e}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(e){this._contentTabIndex=um(e,null)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){const r=this._elementRef.nativeElement;r.classList.remove(`mat-background-${this.backgroundColor}`),e&&r.classList.add(`mat-background-${e}`),this._backgroundColor=e}ngAfterContentChecked(){const e=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=e){const r=null==this._selectedIndex;if(!r){this.selectedTabChange.emit(this._createChangeEvent(e));const i=this._tabBodyWrapper.nativeElement;i.style.minHeight=i.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((i,o)=>i.isActive=o===e),r||(this.selectedIndexChange.emit(e),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((r,i)=>{r.position=i-e,null!=this._selectedIndex&&0==r.position&&!r.origin&&(r.origin=e-this._selectedIndex)}),this._selectedIndex!==e&&(this._selectedIndex=e,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{if(this._clampTabIndex(this._indexToSelect)===this._selectedIndex){const r=this._tabs.toArray();for(let i=0;i<r.length;i++)if(r[i].isActive){this._indexToSelect=this._selectedIndex=i;break}}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(ec(this._allTabs)).subscribe(e=>{this._tabs.reset(e.filter(r=>r._closestTabGroup===this||!r._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}focusTab(e){const r=this._tabHeader;r&&(r.focusIndex=e)}_focusChanged(e){this.focusChange.emit(this._createChangeEvent(e))}_createChangeEvent(e){const r=new O0e;return r.index=e,this._tabs&&this._tabs.length&&(r.tab=this._tabs.toArray()[e]),r}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=Ea(...this._tabs.map(e=>e._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(e){return Math.min(this._tabs.length-1,Math.max(e||0,0))}_getTabLabelId(e){return`mat-tab-label-${this._groupId}-${e}`}_getTabContentId(e){return`mat-tab-content-${this._groupId}-${e}`}_setTabBodyWrapperHeight(e){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const r=this._tabBodyWrapper.nativeElement;r.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(r.style.height=e+"px")}_removeTabBodyWrapperHeight(){const e=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=e.clientHeight,e.style.height="",this.animationDone.emit()}_handleClick(e,r,i){e.disabled||(this.selectedIndex=r.focusIndex=i)}_getTabIndex(e,r){return e.disabled?null:this.selectedIndex===r?0:-1}_tabFocusChanged(e,r){e&&"mouse"!==e&&"touch"!==e&&(this._tabHeader.focusIndex=r)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Zo),X(M8,8),X(kl,8))},t.\u0275dir=jn({type:t,inputs:{dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:"contentTabIndex",disablePagination:"disablePagination",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[_r]}),t})(),L0e=(()=>{class t extends R0e{constructor(e,r,i,o){super(e,r,i,o)}}return t.\u0275fac=function(e){return new(e||t)(X($r),X(Zo),X(M8,8),X(kl,8))},t.\u0275cmp=pr({type:t,selectors:[["mat-tab-group"]],contentQueries:function(e,r,i){if(1&e&&so(i,A8,5),2&e){let o;Er(o=Sr())&&(r._allTabs=o)}},viewQuery:function(e,r){if(1&e&&(Ko(d0e,5),Ko(f0e,5)),2&e){let i;Er(i=Sr())&&(r._tabBodyWrapper=i.first),Er(i=Sr())&&(r._tabHeader=i.first)}},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(e,r){2&e&&Ai("mat-tab-group-dynamic-height",r.dynamicHeight)("mat-tab-group-inverted-header","below"===r.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[ki([{provide:D8,useExisting:t}]),_r],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","disabled","matRippleDisabled","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","content","position","origin","animationDuration","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","disabled","matRippleDisabled","click","cdkFocusChange"],[1,"mat-tab-label-content"],[3,"ngIf"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","content","position","origin","animationDuration","_onCentered","_onCentering"]],template:function(e,r){1&e&&(d(0,"mat-tab-header",0,1),De("indexFocused",function(o){return r._focusChanged(o)})("selectFocusedIndex",function(o){return r.selectedIndex=o}),oe(2,g0e,4,14,"div",2),u(),d(3,"div",3,4),oe(5,_0e,1,9,"mat-tab-body",5),u()),2&e&&(N("selectedIndex",r.selectedIndex||0)("disableRipple",r.disableRipple)("disablePagination",r.disablePagination),w(2),N("ngForOf",r._tabs),w(1),Ai("_mat-animation-noopable","NoopAnimations"===r._animationMode),w(2),N("ngForOf",r._tabs))},dependencies:[I0e,T8,ho,k8,Nh,Qoe,Fi,Qg],styles:[".mat-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-tab-body-wrapper{transition:none;animation:none}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}\n"],encapsulation:2}),t})(),B0e=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({imports:[[xf,Wi,ux,g_,ox,Joe],Wi]}),t})();function j0e(t,n){if(1&t&&(d(0,"mat-option",35),h(1),u()),2&t){const e=n.$implicit;N("value",e),w(1),Qt(" ",e.nombre," ")}}function V0e(t,n){if(1&t&&(d(0,"option",43),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),Qt("",e.nombre," ")}}function U0e(t,n){if(1&t){const e=Fn();d(0,"div")(1,"table",36)(2,"thead",37)(3,"tr")(4,"th"),h(5,"ID"),u(),d(6,"th"),h(7,"CUM"),u(),d(8,"th"),h(9,"Medicamento"),u(),d(10,"th"),h(11,"Presentaci\xf3n"),u(),d(12,"th"),h(13,"Valor de Compra"),u(),d(14,"th"),h(15,"Contrato"),u(),d(16,"th"),h(17,"Valor Contratado"),u(),d(18,"th"),h(19,"Descuento"),u(),d(20,"th"),h(21,"Gesti\xf3n"),u()()(),d(22,"tbody")(23,"tr")(24,"td"),h(25),u(),d(26,"td"),h(27),u(),d(28,"td"),h(29),u(),d(30,"td"),h(31),u(),d(32,"td"),h(33),Hi(34,"number"),u(),d(35,"td")(36,"select",38)(37,"option",39),h(38,"Seleccionar contrato"),u(),oe(39,V0e,2,2,"option",21),u()(),d(40,"td"),qe(41,"input",40),u(),d(42,"td"),qe(43,"input",41),u(),d(44,"td")(45,"button",42),De("click",function(){return ht(e),pt(ae().validarYGuardarMedicamentoContratado())}),h(46," Agregar"),u()()()()()()}if(2&t){const e=ae();w(25),_e(null==e.medicamentoActual?null:e.medicamentoActual.idMedicamento),w(2),_e(null==e.medicamentoActual?null:e.medicamentoActual.codigoCum),w(2),_e(null==e.medicamentoActual?null:e.medicamentoActual.nombre),w(2),_e(null==e.medicamentoActual||null==e.medicamentoActual.forma?null:e.medicamentoActual.forma.nombre),w(2),_e("$ "+Xo(34,6,null==e.medicamentoActual?null:e.medicamentoActual.valor,"1.0-0")),w(6),N("ngForOf",e.listaEps)}}function H0e(t,n){1&t&&(d(0,"div",44),h(1," El medicamento no esta asociado a ningun contrato, recuerde solo se puede prescribir al paciente que tenga el contrato! "),u())}const P8=function(){return{color:"#009A94"}},O8=function(){return{color:"red"}};function z0e(t,n){if(1&t){const e=Fn();d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),Hi(15,"currency"),u(),d(16,"td"),h(17),u(),d(18,"td")(19,"mat-icon",49),h(20," edith"),u(),d(21,"mat-icon",50),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).quitarMedicamentoContrato(o))}),h(22," clear"),u()()()}if(2&t){const e=n.$implicit,r=n.index;let i,o;w(2),_e(r+1),w(2),_e(e.codigoCum),w(2),_e(e.nombre),w(2),_e(e.viaNombre),w(2),_e(e.concentracion),w(2),_e(e.principioActivo),w(2),_e(_h(15,10,null!==(i=e.valor)&&void 0!==i?i:0)),w(3),_e((null!==(o=e.descuento)&&void 0!==o?o:0)+" %"),w(2),N("ngStyle",Nt(12,P8)),w(2),N("ngStyle",Nt(13,O8))}}function $0e(t,n){if(1&t&&(d(0,"div")(1,"div",45)(2,"span",46),h(3,"LISTADO DE CONTRATOS DONDE ESTA ASIGNADO EL MEDICAMENTO "),u()(),d(4,"table",36)(5,"thead",47)(6,"tr")(7,"th"),h(8,"Item"),u(),d(9,"th"),h(10,"CUM"),u(),d(11,"th"),h(12,"Nombre"),u(),d(13,"th"),h(14,"Presentaci\xf3n"),u(),d(15,"th"),h(16,"Contrato"),u(),d(17,"th"),h(18,"Descripci\xf3n"),u(),d(19,"th"),h(20,"Valor Contratado"),u(),d(21,"th"),h(22,"Descuento"),u(),d(23,"th"),h(24,"Gesti\xf3n"),u()()(),d(25,"tbody"),oe(26,z0e,23,14,"tr",48),u()()()),2&t){const e=ae();w(26),N("ngForOf",e.listaItemEps)}}function W0e(t,n){if(1&t&&(d(0,"option",43),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.codigo),w(1),_e(e.nombre)}}function q0e(t,n){1&t&&(d(0,"div",44),h(1," No hay medicamentos, asociados a este contrato! "),u())}function G0e(t,n){if(1&t){const e=Fn();d(0,"tr")(1,"td"),h(2),u(),d(3,"td"),h(4),u(),d(5,"td"),h(6),u(),d(7,"td"),h(8),u(),d(9,"td"),h(10),u(),d(11,"td"),h(12),u(),d(13,"td"),h(14),Hi(15,"number"),u(),d(16,"td"),h(17),u(),d(18,"td")(19,"mat-icon",49),h(20," edith"),u(),d(21,"mat-icon",50),De("click",function(){const o=ht(e).$implicit;return pt(ae(2).quitarMedicamentoContrato(o))}),h(22," clear"),u()()()}if(2&t){const e=n.$implicit,r=n.index;let i,o;w(2),_e(r+1),w(2),_e(e.codigoCum),w(2),_e(e.idMedicamento),w(2),_e(e.nombre),w(2),_e(e.viaNombre),w(2),_e(e.concentracion),w(2),_e("$ "+Xo(15,10,null!==(i=e.valor)&&void 0!==i?i:0,"1.0-0")),w(3),_e((null!==(o=e.descuento)&&void 0!==o?o:0)+" %"),w(2),N("ngStyle",Nt(13,P8)),w(2),N("ngStyle",Nt(14,O8))}}function Y0e(t,n){if(1&t&&(d(0,"div")(1,"table",51)(2,"thead",47)(3,"tr")(4,"th"),h(5,"Item"),u(),d(6,"th"),h(7,"CUM"),u(),d(8,"th"),h(9,"ID"),u(),d(10,"th"),h(11,"Nombre"),u(),d(12,"th"),h(13,"Presentaci\xf3n"),u(),d(14,"th"),h(15,"Contrato"),u(),d(16,"th"),h(17,"Valor Contratado"),u(),d(18,"th"),h(19,"Descuento"),u(),d(20,"th"),h(21,"Gesti\xf3n"),u()()(),d(22,"tbody"),oe(23,G0e,23,15,"tr",48),u()()()),2&t){const e=ae();w(23),N("ngForOf",e.listaItemEpsFiltro)}}function K0e(t,n){if(1&t&&(d(0,"option",25),h(1),u()),2&t){const e=n.$implicit;N("ngValue",e.idBodega),w(1),Qt(" ",e.nombre," ")}}function Z0e(t,n){1&t&&(d(0,"div",26)(1,"label",27),qe(2,"input",28),h(3," Vista por bodega "),u()())}function Q0e(t,n){if(1&t&&(d(0,"div",29)(1,"div")(2,"small",30),h(3,"Total Mol\xe9culas Prescritas:"),u(),d(4,"div",31),h(5),u()()()),2&t){const e=ae();w(5),_e((null==e.listaentregas?null:e.listaentregas.length)||0)}}function J0e(t,n){1&t&&(d(0,"div",32),h(1," No hay prescripciones de estos medicamento en la fecha y bodega seleccionada! "),u())}function e1e(t,n){if(1&t&&(xc(0),d(1,"tr")(2,"td",38),h(3),u(),d(4,"td",36),h(5),u(),d(6,"td"),h(7),u(),d(8,"td"),h(9),u(),d(10,"td",39),h(11,"Prescritos"),u(),d(12,"td"),h(13),u(),d(14,"td"),h(15),u(),d(16,"td"),h(17),u(),d(18,"td"),h(19),u(),d(20,"td"),h(21),u(),d(22,"td"),h(23),u(),d(24,"td"),h(25),u(),d(26,"td"),h(27),u(),d(28,"td"),h(29),u(),d(30,"td"),h(31),u(),d(32,"td"),h(33),u(),d(34,"td"),h(35),u()(),d(36,"tr")(37,"td",40),h(38,"Entregados"),u(),d(39,"td"),h(40),u(),d(41,"td"),h(42),u(),d(43,"td"),h(44),u(),d(45,"td"),h(46),u(),d(47,"td"),h(48),u(),d(49,"td"),h(50),u(),d(51,"td"),h(52),u(),d(53,"td"),h(54),u(),d(55,"td"),h(56),u(),d(57,"td"),h(58),u(),d(59,"td"),h(60),u(),d(61,"td"),h(62),u()(),Cc()),2&t){const e=n.$implicit,r=n.index;w(2),kr("rowspan",2),w(1),_e(r+1),w(1),kr("rowspan",2),w(1),_e(e.nombre),w(1),kr("rowspan",2),w(1),_e(e.id),w(1),kr("rowspan",2),w(1),_e(e.formaFarmaceutica||"-"),w(4),_e(e.enero),w(2),_e(e.febrero),w(2),_e(e.marzo),w(2),_e(e.abril),w(2),_e(e.mayo),w(2),_e(e.junio),w(2),_e(e.julio),w(2),_e(e.agosto),w(2),_e(e.septiembre),w(2),_e(e.octubre),w(2),_e(e.noviembre),w(2),_e(e.diciembre),w(5),_e(e.eneroEntregado),w(2),_e(e.febreroEntregado),w(2),_e(e.marzoEntregado),w(2),_e(e.abrilEntregado),w(2),_e(e.mayoEntregado),w(2),_e(e.junioEntregado),w(2),_e(e.julioEntregado),w(2),_e(e.agostoEntregado),w(2),_e(e.septiembreEntregado),w(2),_e(e.octubreEntregado),w(2),_e(e.noviembreEntregado),w(2),_e(e.diciembreEntregado)}}function t1e(t,n){if(1&t&&(d(0,"div")(1,"div",33)(2,"table",34)(3,"thead",35)(4,"tr")(5,"th",36),h(6,"#"),u(),d(7,"th",36),h(8,"Medicamento"),u(),d(9,"th"),h(10,"ID"),u(),d(11,"th"),h(12,"Presentaci\xf3n"),u(),d(13,"th"),h(14,"P/E"),u(),d(15,"th"),h(16,"Ene"),u(),d(17,"th"),h(18,"Feb"),u(),d(19,"th"),h(20,"Mar"),u(),d(21,"th"),h(22,"Abr"),u(),d(23,"th"),h(24,"May"),u(),d(25,"th"),h(26,"Jun"),u(),d(27,"th"),h(28,"Jul"),u(),d(29,"th"),h(30,"Ago"),u(),d(31,"th"),h(32,"Sep"),u(),d(33,"th"),h(34,"Oct"),u(),d(35,"th"),h(36,"Nov"),u(),d(37,"th"),h(38,"Dic"),u()()(),d(39,"tbody"),oe(40,e1e,63,32,"ng-container",37),u()()()()),2&t){const e=ae();w(40),N("ngForOf",e.listaentregas)}}function n1e(t,n){if(1&t&&(xc(0),d(1,"tr")(2,"td",38),h(3),u(),d(4,"td",36),h(5),u(),d(6,"td",39),h(7,"Prescritos"),u(),d(8,"td"),h(9),u(),d(10,"td"),h(11),u(),d(12,"td"),h(13),u(),d(14,"td"),h(15),u(),d(16,"td"),h(17),u(),d(18,"td"),h(19),u(),d(20,"td"),h(21),u(),d(22,"td"),h(23),u(),d(24,"td"),h(25),u(),d(26,"td"),h(27),u(),d(28,"td"),h(29),u(),d(30,"td"),h(31),u()(),d(32,"tr")(33,"td",40),h(34,"Entregados"),u(),d(35,"td"),h(36),u(),d(37,"td"),h(38),u(),d(39,"td"),h(40),u(),d(41,"td"),h(42),u(),d(43,"td"),h(44),u(),d(45,"td"),h(46),u(),d(47,"td"),h(48),u(),d(49,"td"),h(50),u(),d(51,"td"),h(52),u(),d(53,"td"),h(54),u(),d(55,"td"),h(56),u(),d(57,"td"),h(58),u()(),Cc()),2&t){const e=n.$implicit,r=n.index;w(2),kr("rowspan",2),w(1),_e(r+1),w(1),kr("rowspan",2),w(1),_e(e.bodega),w(4),_e(e.enero),w(2),_e(e.febrero),w(2),_e(e.marzo),w(2),_e(e.abril),w(2),_e(e.mayo),w(2),_e(e.junio),w(2),_e(e.julio),w(2),_e(e.agosto),w(2),_e(e.septiembre),w(2),_e(e.octubre),w(2),_e(e.noviembre),w(2),_e(e.diciembre),w(5),_e(e.eneroEntregado),w(2),_e(e.febreroEntregado),w(2),_e(e.marzoEntregado),w(2),_e(e.abrilEntregado),w(2),_e(e.mayoEntregado),w(2),_e(e.junioEntregado),w(2),_e(e.julioEntregado),w(2),_e(e.agostoEntregado),w(2),_e(e.septiembreEntregado),w(2),_e(e.octubreEntregado),w(2),_e(e.noviembreEntregado),w(2),_e(e.diciembreEntregado)}}function r1e(t,n){if(1&t&&(d(0,"div")(1,"div",33)(2,"table",34)(3,"thead",35)(4,"tr")(5,"th",36),h(6,"#"),u(),d(7,"th",36),h(8,"Nombre de la bodega"),u(),d(9,"th"),h(10,"P/E"),u(),d(11,"th"),h(12,"Ene"),u(),d(13,"th"),h(14,"Feb"),u(),d(15,"th"),h(16,"Mar"),u(),d(17,"th"),h(18,"Abr"),u(),d(19,"th"),h(20,"May"),u(),d(21,"th"),h(22,"Jun"),u(),d(23,"th"),h(24,"Jul"),u(),d(25,"th"),h(26,"Ago"),u(),d(27,"th"),h(28,"Sep"),u(),d(29,"th"),h(30,"Oct"),u(),d(31,"th"),h(32,"Nov"),u(),d(33,"th"),h(34,"Dic"),u()()(),d(35,"tbody"),oe(36,n1e,59,28,"ng-container",37),u()()()()),2&t){const e=ae();w(36),N("ngForOf",e.listaentregas)}}const i1e=[{path:"login",component:ihe},{path:"menu",component:$he,canActivate:[Whe],children:[{path:"bodega",component:Yse},{path:"medicamento",component:Ole},{path:"ffarmaceutica",component:x6},{path:"vadministracion",component:E6},{path:"paciente/:id",component:R6},{path:"paciente",component:R6},{path:"formula/:id",component:Y6},{path:"formula",component:Y6},{path:"historialformula/:id",component:KD},{path:"entrega/:id",component:cfe},{path:"medico",component:XD},{path:"ips",component:GD},{path:"despacho/:id",component:Q6},{path:"despacho",component:Q6},{path:"medicamentobodega/:id",component:J6},{path:"medicamentobodega",component:J6},{path:"pendiente/:id",component:t8},{path:"pendiente",component:t8},{path:"estadistica",component:Ghe},{path:"historialordendespacho",component:upe},{path:"verordendespacho/:id",component:Cpe},{path:"existencias",component:Qpe},{path:"norotan",component:Jpe},{path:"entregados",component:uge},{path:"trazamedicamento",component:Lme},{path:"historialentrega",component:Jme},{path:"editformula/:id",component:v8},{path:"editformula",component:v8},{path:"ajusteinventario/:id",component:C8},{path:"medicamentoeps",component:(()=>{class t{constructor(e,r,i,o){this.medicamentoServicio=e,this.pacienteServicio=r,this.formulaService=i,this.fb=o,this.listaItemEps=[],this.listaItemEpsFiltro=[],this.medicamentosFiltrados=[],this.medicamentoActual=NaN,this.verItem=!1}ngOnInit(){this.generalForm=this.fb.group({medicamento:[""],contrato:[""],valor:[""],descuento:[""],listFilter:[""]}),this.cargarEps(),this.generalForm.get("medicamento").valueChanges.pipe(xo(300),Di(e=>this.formulaService.filtrarMedicamentos(e))).subscribe(e=>{this.medicamentosFiltrados=e}),this.generalForm.get("listFilter").valueChanges.pipe(xo(300),Di(e=>this.buscarMedicamentos(e))).subscribe(e=>{this.listaItemEpsFiltro=e})}buscarMedicamentos(e){return e&&e.length>3?(e=e.toLocaleLowerCase(),On(this.listaItemEps.filter(i=>i.nombre.toLowerCase().includes(e)))):On(this.listaItemEps)}cargarEps(){this.pacienteServicio.getEps().subscribe(e=>{this.listaEps=e},e=>{console.error(e)})}seleccionarMedicamento(e){this.medicamentoActual=e.option.value,this.generalForm.get("medicamento")?.setValue(e.option.value.nombre),console.log("Este es el medicamento seleccionado",this.medicamentoActual),this.buscarRegistro(this.medicamentoActual.idMedicamento),this.verItem=!1;try{if(!this.medicamentoActual)throw new Error("No seha seleccionado el medicamento.");this.verItem=!0}catch(r){console.error("Error al seleccionar medicamento:",r);let i="Hubo un problema al validar el medicamento.";r instanceof Error?i=r.message:"string"==typeof r&&(i=r),z().fire({icon:"error",title:"Error",text:i})}}buscarRegistro(e){return e?(this.medicamentoServicio.getMedicamentoContrato(e).subscribe(r=>{this.listaItemEps=r.sort((i,o)=>i.principioActivo.localeCompare(o.principioActivo))}),On(this.listaItemEps)):On([])}quitarMedicamentoContrato(e){z().fire({title:"Desea quitar?",text:"El medicamento "+e.nombre+" del contrato con "+e.concentracion+" "+e.principioActivo,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, quitar!"}).then(r=>{r.isConfirmed&&this.medicamentoServicio.quitarMedicamento(e.idMedicamento,e.concentracion).subscribe(i=>{this.listaItemEps=this.listaItemEps.filter(o=>!(o.idMedicamento===e.idMedicamento&&o.concentracion===e.concentracion)),z().fire({icon:"success",title:"Ok",text:"El medicamento ha sido quitado del contrato a partir de la fecha ya no se podra transcribir en la formula para un paciente aosociado a ese asegurador."})},i=>{z().fire({icon:"error",title:"Error",text:i.error.mensaje})})})}validarYGuardarMedicamentoContratado(){const e=this.generalForm.get("contrato")?.value,r=this.generalForm.get("valor")?.value,i=this.generalForm.get("descuento")?.value;if(console.log(this.generalForm.get("contrato")),console.log(e),this.existeItem(this.medicamentoActual.idMedicamento,this.generalForm.get("contrato")?.value))z().fire({icon:"error",title:"Error",text:`El medicamento ${this.medicamentoActual.nombre} que est\xe1 intentando agregar ya se encuentra asociado a ese contrato. Por lo tanto, no se puede adicionar.`});else{if(!e||""===r||null===r||""===i||null===i)return void z().fire({icon:"warning",title:"Campos obligatorios",text:"Por favor, complete todos los campos que se necesitan para agregar el medicamento al contrato antes de continuar."});if(r<0||i<0||i>100)return void z().fire({icon:"error",title:"Valores incorrectos",text:"No se puede agregar el medicamento al contrato con valores negativos."});z().fire({title:"\xbfDesea agregar?",text:`El medicamento ${this.medicamentoActual.nombre} al contrato seleccionado.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, agregar!"}).then(o=>{if(o.isConfirmed){const a=new S6;a.idMedicamento=this.medicamentoActual.idMedicamento,a.codEps=this.generalForm.get("contrato")?.value,a.valorVenta=r,a.descuento=i,this.medicamentoServicio.adicionarMedicamento(a).subscribe({next:s=>{this.buscarRegistro(this.medicamentoActual.idMedicamento),z().fire({icon:"success",title:"Medicamento agregado",text:`Se agreg\xf3 el medicamento ${this.medicamentoActual.nombre} al contrato ${a.codEps} correctamente.`})},error:s=>{z().fire({icon:"error",title:"Error",text:s.message})}})}})}}existeItem(e,r){let i=!1;return this.listaItemEps.forEach(o=>{e===o.idMedicamento&&r===o.concentracion&&(i=!0)}),i}consultarContratacion(){const e=this.generalForm.get("contrato")?.value;e?(this.listaItemEps=[],this.listaItemEpsFiltro=[],z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}}),this.medicamentoServicio.getMedicamentoContratoEps(e).subscribe({next:r=>{console.log(r),this.listaItemEps=r.sort((i,o)=>i.nombre.localeCompare(o.nombre)),this.listaItemEpsFiltro=this.listaItemEps,z().close()},error:r=>{console.error("\u274c Error cargando registros",r),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")}})):z().fire({icon:"info",title:"Seleccione contrato",text:"No ha seleccionado el asegurador para realizar la consulta!"})}exportarExcelContratacion(){const e=this.generalForm.get("contrato")?.value,r=[];r.push(["CONSECUTIVO","CUM","ID","NOMBRE DEL MEDICAMENTO","PRESENTACION","CONTRATO","EPS","VALOR CONTRATADO","DESCUENTO"]),this.listaItemEps.forEach((l,c)=>{r.push([c+1,l.codigoCum||"",l.idMedicamento||"",l.nombre||"",l.viaNombre||"",l.concentracion||"",l.principioActivo||"",l.valor||"0",l.descuento||"0"])});const o=Gr.aoa_to_sheet(r),a=Gr.decode_range(o["!ref"]);for(let l=a.s.c;l<=a.e.c;l++){const c=o[Gr.encode_cell({r:0,c:l})];c&&(c.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const s=Gr.book_new();Gr.book_append_sheet(s,o,e),Pf(s,"Contratacion_"+e+"_"+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Su reporte fue exportado en su carpeta de descargas en formato xlsx"})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}reporteEnConstruccion(){z().fire({icon:"info",title:"En construcci\xf3n!",text:"El reporte esta en proceso de construcci\xf3n, te estaremos informando cuando est\xe9 disponible!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(l0),X(pm),X(Dd),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-medicamentoeps"]],decls:55,vars:12,consts:[[1,"container","mt-2"],["mat-stretch-tabs","false","mat-align-tabs","start"],["label","Agregar o quitar"],[3,"formGroup"],[1,"mb-2"],[1,"text-container"],[1,"input-group","mb-2","align-center",3,"formGroup"],["appearance","fill",1,"w-100"],["type","text","matInput","","formControlName","medicamento",3,"matAutocomplete"],[3,"optionSelected"],["automedicamento","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","alert alert-info my-2",4,"ngIf"],["label","Consultar contrataci\xf3n"],[1,"container",3,"formGroup"],[1,"row","g-2","align-items-end","mb-2"],[1,"col-md-6"],[1,"form-label","mb-1","fw-bold"],["formControlName","contrato",1,"form-select","form-select-sm"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-md-3","d-flex","gap-2"],["type","button",1,"btn","btn-info","btn-sm","flex-fill","d-flex","align-items-center","justify-content-center",3,"click"],[1,"me-1"],["type","button",1,"btn","btn-outline-success","btn-sm","flex-fill","d-flex","align-items-center","justify-content-center",3,"click"],[1,"row","g-2","align-items-end"],[1,"col-md-8"],[1,"input-group","input-group-sm"],[1,"input-group-text","bg-white","border-end-0"],[1,"text-info"],["type","text","formControlName","listFilter","placeholder","Ingrese el nombre del medicamento",1,"form-control","border-start-0"],[1,"col-md-4"],[1,"alert","alert-info","text-center","py-2","mb-0"],["label","Importar contrataci\xf3n"],[3,"value"],[1,"table","table-striped","table-hover","table-sm"],[1,"thead-gradient-d"],["formControlName","contrato",1,"form-select","uniform-control"],["selected","","value",""],["type","text","formControlName","valor","placeholder","Digite valor contratado",1,"form-control","border-end-0","search-input"],["type","text","formControlName","descuento","placeholder","Digite descuento",1,"form-control","border-end-0","search-input"],["title","Agregar medicamento al contrato",1,"btn","btn-outline-primary",3,"click"],[3,"ngValue"],[1,"alert","alert-info","my-2"],[1,"col-12","text-center"],[1,"fw-bold"],[1,"thead-colored"],[4,"ngFor","ngForOf"],["title","Actualizar valores",1,"pointer-cursor",3,"ngStyle"],["title","Eliminar item del contrato",1,"pointer-cursor",3,"ngStyle","click"],[1,"table","table-striped","table-hover","table-sm","mt-2"]],template:function(r,i){if(1&r&&(d(0,"div",0)(1,"mat-tab-group",1)(2,"mat-tab",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"mat-form-field",7)(8,"mat-label"),h(9,"Digite y seleccione el nombre del medicamento a verificar "),u(),qe(10,"input",8),d(11,"mat-autocomplete",9,10),De("optionSelected",function(a){return i.seleccionarMedicamento(a)}),oe(13,j0e,2,2,"mat-option",11),u()()()()(),oe(14,U0e,47,9,"div",12),u(),oe(15,H0e,2,0,"div",13),oe(16,$0e,27,1,"div",12),u(),d(17,"mat-tab",14)(18,"div",15)(19,"div",16)(20,"div",17)(21,"label",18),h(22,"Seleccione la contrataci\xf3n"),u(),d(23,"select",19)(24,"option",20),h(25,"Seleccionar contrato"),u(),oe(26,W0e,2,2,"option",21),u()(),d(27,"div",22)(28,"button",23),De("click",function(){return i.consultarContratacion()}),d(29,"mat-icon",24),h(30,"search"),u(),h(31," Consultar "),u(),d(32,"button",25),De("click",function(){return i.exportarExcelContratacion()}),d(33,"mat-icon",24),h(34,"file_download"),u(),h(35," Exportar XLSX "),u()()(),d(36,"div",26)(37,"div",27)(38,"label",18),h(39,"Buscar medicamento"),u(),d(40,"div",28)(41,"span",29)(42,"mat-icon",30),h(43,"search"),u()(),qe(44,"input",31),u()(),d(45,"div",32)(46,"div",33)(47,"small")(48,"strong"),h(49,"Mol\xe9culas contratadas:"),u(),h(50),u()()()()(),oe(51,q0e,2,0,"div",13),oe(52,Y0e,24,1,"div",12),u(),d(53,"mat-tab",34),h(54," En proceso "),u()()()),2&r){const o=go(12);w(3),N("formGroup",i.generalForm),w(3),N("formGroup",i.generalForm),w(4),N("matAutocomplete",o),w(3),N("ngForOf",i.medicamentosFiltrados),w(1),N("ngIf",i.verItem),w(1),N("ngIf",0==(null==i.listaItemEps?null:i.listaItemEps.length)),w(1),N("ngIf",(null==i.listaItemEps?null:i.listaItemEps.length)>0),w(2),N("formGroup",i.generalForm),w(8),N("ngForOf",i.listaEps),w(24),Qt(" ",(null==i.listaItemEps?null:i.listaItemEps.length)||0,""),w(1),N("ngIf",0==(null==i.listaItemEps?null:i.listaItemEps.length)),w(1),N("ngIf",(null==i.listaItemEps?null:i.listaItemEps.length)>0)}},dependencies:[ho,Fi,Jo,Wo,cl,ul,vo,Ss,No,zo,bo,Ro,c0,_m,hm,b_,gm,u0,L0e,A8,jE,Ey]})}return t})()},{path:"ajusteinventario",component:C8},{path:"prescritos",component:(()=>{class t{constructor(e,r){this.servicio=e,this.fb=r,this.listaentregas=[],this.medicamentosFiltrados=[],this.totalCantidadEntregada=0,this.medicamentoIds=[],this.medicamentoIdsInput="",this.tableVista=!0;const i=new Date,o=new Date(i);o.setDate(i.getDate()-365),this.generalForm=this.fb.group({idBodega:[""],fInicial:[o.toISOString().split("T")[0]],fFinal:[i.toISOString().split("T")[0]],medicamento:[{value:"",disabled:!0}],todosMedicamentos:[!0],vista:[!1]})}ngOnInit(){this.parametro=parseInt(sessionStorage.getItem("bodega")||"0",10),this.servicio.getRegistrosActivos().subscribe(e=>{this.listaregistros=e.filter(r=>!0===r.dispensa),this.listaregistros.sort((r,i)=>{const o=r.nombre.localeCompare(i.nombre);return 0===o?r.puntoEntrega.localeCompare(i.puntoEntrega):o}),this.parametro&&this.generalForm.patchValue({idBodega:+this.parametro})},e=>{console.error(e)}),this.generalForm.get("idBodega").valueChanges.subscribe(e=>{e&&(this.parametro=e,this.buscarRegistro(this.parametro))}),this.generalForm.get("todosMedicamentos")?.valueChanges.subscribe(e=>{const r=this.generalForm.get("medicamento");e?r?.disable():r?.enable()})}buscarRegistro(e){if(e){this.listaentregas=[],this.totalCantidadEntregada=0,this.medicamentoIdsInput=this.generalForm.get("medicamento")?.value,this.medicamentoIds=this.medicamentoIdsInput?this.medicamentoIdsInput.split(",").map(i=>i.trim()).filter(i=>""!==i).map(i=>+i).filter(i=>!isNaN(i)):[],z().fire({title:"Cargando registros...",html:"Por favor espera un momento",allowOutsideClick:!1,didOpen:()=>{z().showLoading()}});const r={idBodega:e,fInicio:this.generalForm.get("fInicial")?.value,fFinal:this.generalForm.get("fFinal")?.value,medicamentoIds:this.medicamentoIds};if(1==this.medicamentoIds.length&&this.generalForm.get("vista")?.value&&0==e)return this.tableVista=!1,void this.servicio.obtenerMedicamentoPrescritosEntregaPorBodega(r).subscribe(i=>{this.listaentregas=i,z().close();const o=this.listaentregas.reduce((a,s)=>a+(s.cantidadEntrega||0),0);this.totalCantidadEntregada=o},i=>{console.error("\u274c Error cargando registros",i),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")});this.tableVista=!0,this.servicio.obtenerMedicamentoPrescritosEntrega(r).subscribe(i=>{this.listaentregas=i,z().close();const o=this.listaentregas.reduce((a,s)=>a+(s.cantidadEntrega||0),0);this.totalCantidadEntregada=o},i=>{console.error("\u274c Error cargando registros",i),z().close(),z().fire("Error","No se pudieron cargar los registros.","error")})}else z().fire({icon:"error",title:"Verificar",text:"No ha seleccionado ninguna bodega en donde se va a realizar la busqueda!."})}exportarExcelPrescritos(){const e=[];e.push(["ID","CUM","ATC","NOMBRE DEL MEDICAMENTO","CONCENTRACION","PRESENTACION","VIA","VALOR","BODEGA","PRESCRITOS ENERO","ENTREGADOS ENERO","PRESCRITOS FEBRERO","ENTREGADOS FEBRERO","PRESCRITOS MARZO","ENTREGADOS MARZO","PRESCRITOS ABRIL","ENTREGADOS ABRIL","PRESCRITOS MAYO","ENTREGADOS MAYO","PRESCRITOS JUNIO","ENTREGADOS JUNIO","PRESCRITOS JULIO","ENTREGADOS JULIO","PRESCRITOS AGOSTO","ENTREGADOS AGOSTO","PRESCRITOS SEPTIEMBRE","ENTREGADOS SEPTIEMBRE","PRESCRITOS OCTUBRE","ENTREGADOS OCTUBRE","PRESCRITOS NOVIEMBRE","ENTREGADOS NOVIEMBRE","PRESCRITOS DICIEMBRE","ENTREGADOS DICIEMBRE"]),this.listaentregas.forEach(s=>{e.push([s.id||"",s.codigoCum||"",s.codigoAtc||"",s.nombre||"",s.formaFarmaceutica||"",s.viaAdministracion||"",s.concentracion||"",s.valor||"",s.bodega||"",s.enero||"",s.eneroEntregado||"",s.febrero||"",s.febreroEntregado||"",s.marzo||"",s.marzoEntregado||"",s.abril||"",s.abrilEntregado||"",s.mayo||"",s.mayoEntregado||"",s.junio||"",s.junioEntregado||"",s.julio||"",s.julioEntregado||"",s.agosto||"",s.agostoEntregado||"",s.septiembre||"",s.septiembreEntregado||"",s.octubre||"",s.octubreEntregado||"",s.noviembre||"",s.noviembreEntregado||"",s.diciembre||"",s.diciembreEntregado||""])});const i=Gr.aoa_to_sheet(e),o=Gr.decode_range(i["!ref"]);for(let s=o.s.c;s<=o.e.c;s++){const l=i[Gr.encode_cell({r:0,c:s})];l&&(l.s={font:{bold:!0,color:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center"},fill:{fgColor:{rgb:"4F81BD"}}})}const a=Gr.book_new();Gr.book_append_sheet(a,i,"consolidado"),Pf(a,"Prescritos_Entregados"+(new Date).getTime()+".xlsx"),z().fire({icon:"success",title:"Ok",text:"Su reporte fue exportado en su carpeta de descargas en formato xlsx"})}primerasmayusculas(e){return e&&(e=e.toLowerCase()).replace(/\b\w/g,r=>r.toLocaleUpperCase())}reporteEnConstruccion(){z().fire({icon:"info",title:"En construcci\xf3n!",text:"El reporte esta en proceso de construcci\xf3n, te estaremos informando cuando est\xe9 disponible!"})}static#e=this.\u0275fac=function(r){return new(r||t)(X(Ts),X(ea))};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-prescritos"]],decls:40,vars:7,consts:[[1,"container","mt-2"],[1,"px-2",3,"formGroup"],[1,"row","g-3"],[1,"col-md-4"],[1,"mb-2"],[1,"form-label","d-flex","align-items-center","fw-bold"],["type","checkbox","formControlName","todosMedicamentos",1,"form-check-input","me-2"],["formControlName","medicamento","rows","6","placeholder","Ingrese lista de ID de medicamentos a consultar, separados por ','",1,"form-control","form-control-sm"],[1,"form-label","mb-1","fw-bold"],["formControlName","idBodega",1,"form-select","form-select-sm"],["selected","","value","0"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"d-flex","gap-1"],["type","date","formControlName","fInicial",1,"form-control","form-control-sm"],[1,"px-1","text-muted","d-flex","align-items-center"],["type","date","formControlName","fFinal",1,"form-control","form-control-sm"],["class","mt-2",4,"ngIf"],[1,"col-md-4","d-flex","flex-column","justify-content-between"],[1,"mb-3"],["type","button",1,"btn","btn-info","w-100","d-flex","align-items-center","justify-content-center","mb-2",3,"click"],[1,"me-1"],["type","button",1,"btn","w-100","d-flex","align-items-center","justify-content-center",3,"click"],["class","card shadow-sm text-center flex-fill border-0 bg-success-subtle d-flex align-items-center justify-content-center py-2",4,"ngIf"],["class","alert alert-info my-2",4,"ngIf"],[4,"ngIf"],[3,"ngValue"],[1,"mt-2"],[1,"form-label","d-flex","align-items-center"],["type","checkbox","formControlName","vista",1,"form-check-input","me-2"],[1,"card","shadow-sm","text-center","flex-fill","border-0","bg-success-subtle","d-flex","align-items-center","justify-content-center","py-2"],[1,"text-success"],[1,"fw-bold","text-success","fs-6"],[1,"alert","alert-info","my-2"],[1,"table-responsive"],[1,"table","table-sm","table-hover","mt-2","zebra-group"],[1,"thead-colored"],[1,"text-start"],[4,"ngFor","ngForOf"],[1,"fw-bold","text-start"],[1,"fw-bold","text-primary","text-start"],[1,"fw-bold","text-success","text-start"]],template:function(r,i){1&r&&(d(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),qe(6,"input",6),h(7," Todos los ID de Medicamentos "),u()(),qe(8,"textarea",7),u(),d(9,"div",3)(10,"div",4)(11,"label",8),h(12,"Bodega"),u(),d(13,"select",9)(14,"option",10),h(15,"TODAS LAS BODEGAS"),u(),oe(16,K0e,2,2,"option",11),u()(),d(17,"div")(18,"label",8),h(19,"Rango de fechas"),u(),d(20,"div",12),qe(21,"input",13),d(22,"span",14),h(23,"al"),u(),qe(24,"input",15),u()(),oe(25,Z0e,4,0,"div",16),u(),d(26,"div",17)(27,"div",18)(28,"button",19),De("click",function(){return i.buscarRegistro(i.parametro)}),d(29,"mat-icon",20),h(30,"search"),u(),h(31," Buscar "),u(),d(32,"button",21),De("click",function(){return i.exportarExcelPrescritos()}),d(33,"mat-icon",20),h(34,"file_download"),u(),h(35," Exportar a XLSX "),u()(),oe(36,Q0e,6,1,"div",22),u()()(),oe(37,J0e,2,0,"div",23),oe(38,t1e,41,1,"div",24),oe(39,r1e,37,1,"div",24),u()),2&r&&(w(1),N("formGroup",i.generalForm),w(15),N("ngForOf",i.listaregistros),w(9),N("ngIf",1==(null==i.medicamentoIds?null:i.medicamentoIds.length)),w(11),N("ngIf",(null==i.listaentregas?null:i.listaentregas.length)>0),w(1),N("ngIf",0==(null==i.listaentregas?null:i.listaentregas.length)),w(1),N("ngIf",(null==i.listaentregas?null:i.listaentregas.length)>0&&i.tableVista),w(1),N("ngIf",(null==i.listaentregas?null:i.listaentregas.length)>0&&!i.tableVista))},dependencies:[ho,Fi,Wo,Vs,cl,ul,vo,sl,Ss,No,zo,bo,Ro],styles:[".zebra-group[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(4n-3), .zebra-group[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(4n-2){background-color:#f0f3f5}.zebra-group[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(4n-1), .zebra-group[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(4n){background-color:#fff}"]})}return t})()},{path:"verajusteinventario",component:Xge},{path:"ordendespachoedit/:id",component:n0e},{path:"pacientependiente/:idBodega/:idMedicamento/:fInicial/:fFinal",component:qpe},{path:"",redirectTo:"/menu/formula",pathMatch:"full"}]},{path:"",redirectTo:"/login",pathMatch:"full"}];let o1e=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Kr({type:t});static#n=this.\u0275inj=hr({imports:[$I.forRoot(i1e),$I]})}return t})(),a1e=(()=>{class t{constructor(){this.title="dispensario"}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=pr({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(r,i){1&r&&qe(0,"router-outlet")},dependencies:[cw]})}return t})();function N8(t){return new Vt(3e3,!1)}function U1e(){return typeof window<"u"&&typeof window.document<"u"}function fA(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function vm(t){switch(t.length){case 0:return new $b;case 1:return t[0];default:return new RR(t)}}function R8(t,n,e,r,i=new Map,o=new Map){const a=[],s=[];let l=-1,c=null;if(r.forEach(f=>{const v=f.get("offset"),E=v==l,D=E&&c||new Map;f.forEach((k,T)=>{let R=T,q=k;if("offset"!==T)switch(R=n.normalizePropertyName(R,a),q){case ID:q=i.get(T);break;case Ph:q=o.get(T);break;default:q=n.normalizeStyleValue(T,R,q,a)}D.set(R,q)}),E||s.push(D),c=D,l=v}),a.length)throw function M1e(t){return new Vt(3502,!1)}();return s}function hA(t,n,e,r){switch(n){case"start":t.onStart(()=>r(e&&pA(e,"start",t)));break;case"done":t.onDone(()=>r(e&&pA(e,"done",t)));break;case"destroy":t.onDestroy(()=>r(e&&pA(e,"destroy",t)))}}function pA(t,n,e){const o=mA(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),a=t._data;return null!=a&&(o._data=a),o}function mA(t,n,e,r,i="",o=0,a){return{element:t,triggerName:n,fromState:e,toState:r,phaseName:i,totalTime:o,disabled:!!a}}function cu(t,n,e){let r=t.get(n);return r||t.set(n,r=e),r}function L8(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}let gA=(t,n)=>!1,B8=(t,n,e)=>[],j8=null;function _A(t){const n=t.parentNode||t.host;return n===j8?null:n}(fA()||typeof Element<"u")&&(U1e()?(j8=(()=>document.documentElement)(),gA=(t,n)=>{for(;n;){if(n===t)return!0;n=_A(n)}return!1}):gA=(t,n)=>t.contains(n),B8=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const r=t.querySelector(n);return r?[r]:[]});let d0=null,V8=!1;const U8=gA,H8=B8;let z8=(()=>{class t{validateStyleProperty(e){return function z1e(t){d0||(d0=function $1e(){return typeof document<"u"?document.body:null}()||{},V8=!!d0.style&&"WebkitAppearance"in d0.style);let n=!0;return d0.style&&!function H1e(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in d0.style,!n&&V8&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in d0.style)),n}(e)}matchesElement(e,r){return!1}containsElement(e,r){return U8(e,r)}getParentElement(e){return _A(e)}query(e,r,i){return H8(e,r,i)}computeStyle(e,r,i){return i||""}animate(e,r,i,o,a,s=[],l){return new $b(i,o)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})(),vA=(()=>{class t{}return t.NOOP=new z8,t})();const W1e=1e3,bA="ng-enter",Ax="ng-leave",Tx="ng-trigger",Mx=".ng-trigger",W8="ng-animating",yA=".ng-animating";function Lh(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:wA(parseFloat(n[1]),n[2])}function wA(t,n){return"s"===n?t*W1e:t}function kx(t,n,e){return t.hasOwnProperty("duration")?t:function G1e(t,n,e){let i,o=0,a="";if("string"==typeof t){const s=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===s)return n.push(N8()),{duration:0,delay:0,easing:""};i=wA(parseFloat(s[1]),s[2]);const l=s[3];null!=l&&(o=wA(parseFloat(l),s[4]));const c=s[5];c&&(a=c)}else i=t;if(!e){let s=!1,l=n.length;i<0&&(n.push(function s1e(){return new Vt(3100,!1)}()),s=!0),o<0&&(n.push(function l1e(){return new Vt(3101,!1)}()),s=!0),s&&n.splice(l,0,N8())}return{duration:i,delay:o,easing:a}}(t,n,e)}function t2(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function q8(t){const n=new Map;return Object.keys(t).forEach(e=>{n.set(e,t[e])}),n}function bm(t,n=new Map,e){if(e)for(let[r,i]of e)n.set(r,i);for(let[r,i]of t)n.set(r,i);return n}function Y8(t,n,e){return e?n+":"+e+";":""}function X8(t){let n="";for(let e=0;e<t.style.length;e++){const r=t.style.item(e);n+=Y8(0,r,t.style.getPropertyValue(r))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=Y8(0,Z1e(e),t.style[e]));t.setAttribute("style",n)}function Nf(t,n,e){t.style&&(n.forEach((r,i)=>{const o=CA(i);e&&!e.has(i)&&e.set(i,t.style[o]),t.style[o]=r}),fA()&&X8(t))}function f0(t,n){t.style&&(n.forEach((e,r)=>{const i=CA(r);t.style[i]=""}),fA()&&X8(t))}function n2(t){return Array.isArray(t)?1==t.length?t[0]:OR(t):t}const xA=new RegExp("{{\\s*(.+?)\\s*}}","g");function K8(t){let n=[];if("string"==typeof t){let e;for(;e=xA.exec(t);)n.push(e[1]);xA.lastIndex=0}return n}function r2(t,n,e){const r=t.toString(),i=r.replace(xA,(o,a)=>{let s=n[a];return null==s&&(e.push(function u1e(t){return new Vt(3003,!1)}()),s=""),s.toString()});return i==r?t:i}function Fx(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const K1e=/-+([a-z0-9])/g;function CA(t){return t.replace(K1e,(...n)=>n[1].toUpperCase())}function Z1e(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function uu(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function d1e(t){return new Vt(3004,!1)}()}}function Z8(t,n){return window.getComputedStyle(t)[n]}const Ox="*";function r_e(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(r=>function i_e(t,n,e){if(":"==t[0]){const l=function o_e(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return n.push(function S1e(t){return new Vt(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof l)return void n.push(l);t=l}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function E1e(t){return new Vt(3015,!1)}()),n;const i=r[1],o=r[2],a=r[3];n.push(Q8(i,a));"<"==o[0]&&!(i==Ox&&a==Ox)&&n.push(Q8(a,i))}(r,e,n)):e.push(t),e}const Nx=new Set(["true","1"]),Rx=new Set(["false","0"]);function Q8(t,n){const e=Nx.has(t)||Rx.has(t),r=Nx.has(n)||Rx.has(n);return(i,o)=>{let a=t==Ox||t==i,s=n==Ox||n==o;return!a&&e&&"boolean"==typeof i&&(a=i?Nx.has(t):Rx.has(t)),!s&&r&&"boolean"==typeof o&&(s=o?Nx.has(n):Rx.has(n)),a&&s}}const a_e=new RegExp("s*:selfs*,?","g");function EA(t,n,e,r){return new s_e(t).build(n,e,r)}class s_e{constructor(n){this._driver=n}build(n,e,r){const i=new u_e(e);return this._resetContextStyleTimingState(i),uu(this,n2(n),i)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let r=e.queryCount=0,i=e.depCount=0;const o=[],a=[];return"@"==n.name.charAt(0)&&e.errors.push(function h1e(){return new Vt(3006,!1)}()),n.definitions.forEach(s=>{if(this._resetContextStyleTimingState(e),0==s.type){const l=s,c=l.name;c.toString().split(/\s*,\s*/).forEach(f=>{l.name=f,o.push(this.visitState(l,e))}),l.name=c}else if(1==s.type){const l=this.visitTransition(s,e);r+=l.queryCount,i+=l.depCount,a.push(l)}else e.errors.push(function p1e(){return new Vt(3007,!1)}())}),{type:7,name:n.name,states:o,transitions:a,queryCount:r,depCount:i,options:null}}visitState(n,e){const r=this.visitStyle(n.styles,e),i=n.options&&n.options.params||null;if(r.containsDynamicStyles){const o=new Set,a=i||{};r.styles.forEach(s=>{s instanceof Map&&s.forEach(l=>{K8(l).forEach(c=>{a.hasOwnProperty(c)||o.add(c)})})}),o.size&&(Fx(o.values()),e.errors.push(function m1e(t,n){return new Vt(3008,!1)}()))}return{type:0,name:n.name,style:r,options:i?{params:i}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const r=uu(this,n2(n.animation),e);return{type:1,matchers:r_e(n.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:h0(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(r=>uu(this,r,e)),options:h0(n.options)}}visitGroup(n,e){const r=e.currentTime;let i=0;const o=n.steps.map(a=>{e.currentTime=r;const s=uu(this,a,e);return i=Math.max(i,e.currentTime),s});return e.currentTime=i,{type:3,steps:o,options:h0(n.options)}}visitAnimate(n,e){const r=function f_e(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return SA(kx(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=SA(0,0,"");return o.dynamic=!0,o.strValue=e,o}const i=kx(e,n);return SA(i.duration,i.delay,i.easing)}(n.timings,e.errors);e.currentAnimateTimings=r;let i,o=n.styles?n.styles:wa({});if(5==o.type)i=this.visitKeyframes(o,e);else{let a=n.styles,s=!1;if(!a){s=!0;const c={};r.easing&&(c.easing=r.easing),a=wa(c)}e.currentTime+=r.duration+r.delay;const l=this.visitStyle(a,e);l.isEmptyStep=s,i=l}return e.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(n,e){const r=this._makeStyleAst(n,e);return this._validateStyleAst(r,e),r}_makeStyleAst(n,e){const r=[],i=Array.isArray(n.styles)?n.styles:[n.styles];for(let s of i)"string"==typeof s?s===Ph?r.push(s):e.errors.push(new Vt(3002,!1)):r.push(q8(s));let o=!1,a=null;return r.forEach(s=>{if(s instanceof Map&&(s.has("easing")&&(a=s.get("easing"),s.delete("easing")),!o))for(let l of s.values())if(l.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:r,easing:a,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const r=e.currentAnimateTimings;let i=e.currentTime,o=e.currentTime;r&&o>0&&(o-=r.duration+r.delay),n.styles.forEach(a=>{"string"!=typeof a&&a.forEach((s,l)=>{const c=e.collectedStyles.get(e.currentQuerySelector),f=c.get(l);let v=!0;f&&(o!=i&&o>=f.startTime&&i<=f.endTime&&(e.errors.push(function _1e(t,n,e,r,i){return new Vt(3010,!1)}()),v=!1),o=f.startTime),v&&c.set(l,{startTime:o,endTime:i}),e.options&&function X1e(t,n,e){const r=n.params||{},i=K8(t);i.length&&i.forEach(o=>{r.hasOwnProperty(o)||e.push(function c1e(t){return new Vt(3001,!1)}())})}(s,e.options,e.errors)})})}visitKeyframes(n,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function v1e(){return new Vt(3011,!1)}()),r;let o=0;const a=[];let s=!1,l=!1,c=0;const f=n.steps.map(q=>{const Z=this._makeStyleAst(q,e);let W=null!=Z.offset?Z.offset:function d_e(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;n=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(Z.styles),Ee=0;return null!=W&&(o++,Ee=Z.offset=W),l=l||Ee<0||Ee>1,s=s||Ee<c,c=Ee,a.push(Ee),Z});l&&e.errors.push(function b1e(){return new Vt(3012,!1)}()),s&&e.errors.push(function y1e(){return new Vt(3200,!1)}());const v=n.steps.length;let E=0;o>0&&o<v?e.errors.push(function w1e(){return new Vt(3202,!1)}()):0==o&&(E=1/(v-1));const D=v-1,k=e.currentTime,T=e.currentAnimateTimings,R=T.duration;return f.forEach((q,Z)=>{const W=E>0?Z==D?1:E*Z:a[Z],Ee=W*R;e.currentTime=k+T.delay+Ee,T.duration=Ee,this._validateStyleAst(q,e),q.offset=W,r.styles.push(q)}),r}visitReference(n,e){return{type:8,animation:uu(this,n2(n.animation),e),options:h0(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:h0(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:h0(n.options)}}visitQuery(n,e){const r=e.currentQuerySelector,i=n.options||{};e.queryCount++,e.currentQuery=n;const[o,a]=function l_e(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(a_e,"")),t=t.replace(/@\*/g,Mx).replace(/@\w+/g,e=>Mx+"-"+e.slice(1)).replace(/:animating/g,yA),[t,n]}(n.selector);e.currentQuerySelector=r.length?r+" "+o:o,cu(e.collectedStyles,e.currentQuerySelector,new Map);const s=uu(this,n2(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:a,animation:s,originalSelector:n.selector,options:h0(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function x1e(){return new Vt(3013,!1)}());const r="full"===n.timings?{duration:0,delay:0,easing:"full"}:kx(n.timings,e.errors,!0);return{type:12,animation:uu(this,n2(n.animation),e),timings:r,options:null}}}class u_e{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function h0(t){return t?(t=t2(t)).params&&(t.params=function c_e(t){return t?t2(t):null}(t.params)):t={},t}function SA(t,n,e){return{duration:t,delay:n,easing:e}}function DA(t,n,e,r,i,o,a=null,s=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:a,subTimeline:s}}class Lx{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let r=this._map.get(n);r||this._map.set(n,r=[]),r.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const m_e=new RegExp(":enter","g"),__e=new RegExp(":leave","g");function AA(t,n,e,r,i,o=new Map,a=new Map,s,l,c=[]){return(new v_e).buildKeyframes(t,n,e,r,i,o,a,s,l,c)}class v_e{buildKeyframes(n,e,r,i,o,a,s,l,c,f=[]){c=c||new Lx;const v=new TA(n,e,c,i,o,f,[]);v.options=l;const E=l.delay?Lh(l.delay):0;v.currentTimeline.delayNextStep(E),v.currentTimeline.setStyles([a],null,v.errors,l),uu(this,r,v);const D=v.timelines.filter(k=>k.containsAnimation());if(D.length&&s.size){let k;for(let T=D.length-1;T>=0;T--){const R=D[T];if(R.element===e){k=R;break}}k&&!k.allowOnlyTimelineStyles()&&k.setStyles([s],null,v.errors,l)}return D.length?D.map(k=>k.buildKeyframes()):[DA(e,[],[],[],0,E,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const r=e.subInstructions.get(e.element);if(r){const i=e.createSubContext(n.options),o=e.currentTimeline.currentTime,a=this._visitSubInstructions(r,i,i.options);o!=a&&e.transformIntoNewTimeline(a)}e.previousNode=n}visitAnimateRef(n,e){const r=e.createSubContext(n.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,r),this.visitReference(n.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,r){for(const i of n){const o=i?.delay;if(o){const a="number"==typeof o?o:Lh(r2(o,i?.params??{},e.errors));r.delayNextStep(a)}}}_visitSubInstructions(n,e,r){let o=e.currentTimeline.currentTime;const a=null!=r.duration?Lh(r.duration):null,s=null!=r.delay?Lh(r.delay):null;return 0!==a&&n.forEach(l=>{const c=e.appendInstructionToTimeline(l,a,s);o=Math.max(o,c.duration+c.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),uu(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const r=e.subContextCount;let i=e;const o=n.options;if(o&&(o.params||o.delay)&&(i=e.createSubContext(o),i.transformIntoNewTimeline(),null!=o.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=Bx);const a=Lh(o.delay);i.delayNextStep(a)}n.steps.length&&(n.steps.forEach(a=>uu(this,a,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const r=[];let i=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?Lh(n.options.delay):0;n.steps.forEach(a=>{const s=e.createSubContext(n.options);o&&s.delayNextStep(o),uu(this,a,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(a=>e.currentTimeline.mergeTimelineCollectedStyles(a)),e.transformIntoNewTimeline(i),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const r=n.strValue;return kx(e.params?r2(r,e.params,e.errors):r,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const r=e.currentAnimateTimings=this._visitTiming(n.timings,e),i=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),i.snapshotCurrentStyles());const o=n.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(r.duration),this.visitStyle(o,e),i.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const r=e.currentTimeline,i=e.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const o=i&&i.easing||n.easing;n.isEmptyStep?r.applyEmptyStep(o):r.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const r=e.currentAnimateTimings,i=e.currentTimeline.duration,o=r.duration,s=e.createSubContext().currentTimeline;s.easing=r.easing,n.styles.forEach(l=>{s.forwardTime((l.offset||0)*o),s.setStyles(l.styles,l.easing,e.errors,e.options),s.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(s),e.transformIntoNewTimeline(i+o),e.previousNode=n}visitQuery(n,e){const r=e.currentTimeline.currentTime,i=n.options||{},o=i.delay?Lh(i.delay):0;o&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Bx);let a=r;const s=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=s.length;let l=null;s.forEach((c,f)=>{e.currentQueryIndex=f;const v=e.createSubContext(n.options,c);o&&v.delayNextStep(o),c===e.element&&(l=v.currentTimeline),uu(this,n.animation,v),v.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,v.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(a),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const r=e.parentContext,i=e.currentTimeline,o=n.timings,a=Math.abs(o.duration),s=a*(e.currentQueryTotal-1);let l=a*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=s-l;break;case"full":l=r.currentStaggerTime}const f=e.currentTimeline;l&&f.delayNextStep(l);const v=f.currentTime;uu(this,n.animation,e),e.previousNode=n,r.currentStaggerTime=i.currentTime-v+(i.startTime-r.currentTimeline.startTime)}}const Bx={};class TA{constructor(n,e,r,i,o,a,s,l){this._driver=n,this.element=e,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=a,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Bx,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new jx(this._driver,e,0),s.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const r=n;let i=this.options;null!=r.duration&&(i.duration=Lh(r.duration)),null!=r.delay&&(i.delay=Lh(r.delay));const o=r.params;if(o){let a=i.params;a||(a=this.options.params={}),Object.keys(o).forEach(s=>{(!e||!a.hasOwnProperty(s))&&(a[s]=r2(o[s],a,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const r=n.params={};Object.keys(e).forEach(i=>{r[i]=e[i]})}}return n}createSubContext(n=null,e,r){const i=e||this.element,o=new TA(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=Bx,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,r){const i={duration:e??n.duration,delay:this.currentTimeline.currentTime+(r??0)+n.delay,easing:""},o=new b_e(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,i,n.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,r,i,o,a){let s=[];if(i&&s.push(this.element),n.length>0){n=(n=n.replace(m_e,"."+this._enterClassName)).replace(__e,"."+this._leaveClassName);let c=this._driver.query(this.element,n,1!=r);0!==r&&(c=r<0?c.slice(c.length+r,c.length):c.slice(0,r)),s.push(...c)}return!o&&0==s.length&&a.push(function C1e(t){return new Vt(3014,!1)}()),s}}class jx{constructor(n,e,r,i){this._driver=n,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new jx(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Ph),this._currentKeyframe.set(e,Ph);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,r,i){e&&this._previousKeyframe.set("easing",e);const o=i&&i.params||{},a=function y_e(t,n){const e=new Map;let r;return t.forEach(i=>{if("*"===i){r=r||n.keys();for(let o of r)e.set(o,Ph)}else bm(i,e)}),e}(n,this._globalTimelineStyles);for(let[s,l]of a){const c=r2(l,o,r);this._pendingStyles.set(s,c),this._localTimelineStyles.has(s)||this._backFill.set(s,this._globalTimelineStyles.get(s)??Ph),this._updateStyle(s,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,r)=>{const i=this._styleSummary.get(r);(!i||e.time>i.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((s,l)=>{const c=bm(s,new Map,this._backFill);c.forEach((f,v)=>{f===ID?n.add(v):f===Ph&&e.add(v)}),r||c.set("offset",l/this.duration),i.push(c)});const o=n.size?Fx(n.values()):[],a=e.size?Fx(e.values()):[];if(r){const s=i[0],l=new Map(s);s.set("offset",0),l.set("offset",1),i=[s,l]}return DA(this.element,i,o,a,this.duration,this.startTime,this.easing,!1)}}class b_e extends jx{constructor(n,e,r,i,o,a,s=!1){super(n,e,a.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=s,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],a=r+e,s=e/a,l=bm(n[0]);l.set("offset",0),o.push(l);const c=bm(n[0]);c.set("offset",tL(s)),o.push(c);const f=n.length-1;for(let v=1;v<=f;v++){let E=bm(n[v]);const D=E.get("offset");E.set("offset",tL((e+D*r)/a)),o.push(E)}r=a,e=0,i="",n=o}return DA(this.element,n,this.preStyleProps,this.postStyleProps,r,e,i,!0)}}function tL(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class MA{}const w_e=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class x_e extends MA{normalizePropertyName(n,e){return CA(n)}normalizeStyleValue(n,e,r,i){let o="";const a=r.toString().trim();if(w_e.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)o="px";else{const s=r.match(/^[+-]?[\d\.]+([a-z]*)$/);s&&0==s[1].length&&i.push(function f1e(t,n){return new Vt(3005,!1)}())}return a+o}}function nL(t,n,e,r,i,o,a,s,l,c,f,v,E){return{type:0,element:t,triggerName:n,isRemovalTransition:i,fromState:e,fromStyles:o,toState:r,toStyles:a,timelines:s,queriedElements:l,preStyleProps:c,postStyleProps:f,totalTime:v,errors:E}}const kA={};class rL{constructor(n,e,r){this._triggerName=n,this.ast=e,this._stateStyles=r}match(n,e,r,i){return function C_e(t,n,e,r,i){return t.some(o=>o(n,e,r,i))}(this.ast.matchers,n,e,r,i)}buildStyles(n,e,r){let i=this._stateStyles.get("*");return void 0!==n&&(i=this._stateStyles.get(n?.toString())||i),i?i.buildStyles(e,r):new Map}build(n,e,r,i,o,a,s,l,c,f){const v=[],E=this.ast.options&&this.ast.options.params||kA,k=this.buildStyles(r,s&&s.params||kA,v),T=l&&l.params||kA,R=this.buildStyles(i,T,v),q=new Set,Z=new Map,W=new Map,Ee="void"===i,Le={params:E_e(T,E),delay:this.ast.options?.delay},Pe=f?[]:AA(n,e,this.ast.animation,o,a,k,R,Le,c,v);let ge=0;if(Pe.forEach(Ge=>{ge=Math.max(Ge.duration+Ge.delay,ge)}),v.length)return nL(e,this._triggerName,r,i,Ee,k,R,[],[],Z,W,ge,v);Pe.forEach(Ge=>{const wt=Ge.element,Mt=cu(Z,wt,new Set);Ge.preStyleProps.forEach(An=>Mt.add(An));const Qe=cu(W,wt,new Set);Ge.postStyleProps.forEach(An=>Qe.add(An)),wt!==e&&q.add(wt)});const Ye=Fx(q.values());return nL(e,this._triggerName,r,i,Ee,k,R,Pe,Ye,Z,W,ge)}}function E_e(t,n){const e=t2(n);for(const r in t)t.hasOwnProperty(r)&&null!=t[r]&&(e[r]=t[r]);return e}class S_e{constructor(n,e,r){this.styles=n,this.defaultParams=e,this.normalizer=r}buildStyles(n,e){const r=new Map,i=t2(this.defaultParams);return Object.keys(n).forEach(o=>{const a=n[o];null!==a&&(i[o]=a)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,s)=>{a&&(a=r2(a,i,e));const l=this.normalizer.normalizePropertyName(s,e);a=this.normalizer.normalizeStyleValue(s,l,a,e),r.set(s,a)})}),r}}class A_e{constructor(n,e,r){this.name=n,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(i=>{this.states.set(i.name,new S_e(i.style,i.options&&i.options.params||{},r))}),iL(this.states,"true","1"),iL(this.states,"false","0"),e.transitions.forEach(i=>{this.transitionFactories.push(new rL(n,i,this.states))}),this.fallbackTransition=function T_e(t,n,e){return new rL(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(a,s)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,r,i){return this.transitionFactories.find(a=>a.match(n,e,r,i))||null}matchStyles(n,e,r){return this.fallbackTransition.buildStyles(n,e,r)}}function iL(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const M_e=new Lx;class k_e{constructor(n,e,r){this.bodyNode=n,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const r=[],i=[],o=EA(this._driver,e,r,i);if(r.length)throw function k1e(t){return new Vt(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,r){const i=n.element,o=R8(0,this._normalizer,0,n.keyframes,e,r);return this._driver.animate(i,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,r={}){const i=[],o=this._animations.get(n);let a;const s=new Map;if(o?(a=AA(this._driver,e,o,bA,Ax,new Map,new Map,r,M_e,i),a.forEach(f=>{const v=cu(s,f.element,new Map);f.postStyleProps.forEach(E=>v.set(E,null))})):(i.push(function F1e(){return new Vt(3300,!1)}()),a=[]),i.length)throw function I1e(t){return new Vt(3504,!1)}();s.forEach((f,v)=>{f.forEach((E,D)=>{f.set(D,this._driver.computeStyle(v,D,Ph))})});const c=vm(a.map(f=>{const v=s.get(f.element);return this._buildPlayer(f,new Map,v)}));return this._playersById.set(n,c),c.onDestroy(()=>this.destroy(n)),this.players.push(c),c}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function P1e(t){return new Vt(3301,!1)}();return e}listen(n,e,r,i){const o=mA(e,"","","");return hA(this._getPlayer(n),r,o,i),()=>{}}command(n,e,r,i){if("register"==r)return void this.register(n,i[0]);if("create"==r)return void this.create(n,e,i[0]||{});const o=this._getPlayer(n);switch(r){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(n)}}}const oL="ng-animate-queued",FA="ng-animate-disabled",N_e=[],aL={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},R_e={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Yu="__ng_removed";class IA{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const r=n&&n.hasOwnProperty("value");if(this.value=function V_e(t){return t??null}(r?n.value:n),r){const o=t2(n);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const r=this.options.params;Object.keys(e).forEach(i=>{null==r[i]&&(r[i]=e[i])})}}}const o2="void",PA=new IA(o2);class L_e{constructor(n,e,r){this.id=n,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Xu(e,this._hostClassName)}listen(n,e,r,i){if(!this._triggers.has(e))throw function O1e(t,n){return new Vt(3302,!1)}();if(null==r||0==r.length)throw function N1e(t){return new Vt(3303,!1)}();if(!function U_e(t){return"start"==t||"done"==t}(r))throw function R1e(t,n){return new Vt(3400,!1)}();const o=cu(this._elementListeners,n,[]),a={name:e,phase:r,callback:i};o.push(a);const s=cu(this._engine.statesByElement,n,new Map);return s.has(e)||(Xu(n,Tx),Xu(n,Tx+"-"+e),s.set(e,PA)),()=>{this._engine.afterFlush(()=>{const l=o.indexOf(a);l>=0&&o.splice(l,1),this._triggers.has(e)||s.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function L1e(t){return new Vt(3401,!1)}();return e}trigger(n,e,r,i=!0){const o=this._getTrigger(e),a=new OA(this.id,e,n);let s=this._engine.statesByElement.get(n);s||(Xu(n,Tx),Xu(n,Tx+"-"+e),this._engine.statesByElement.set(n,s=new Map));let l=s.get(e);const c=new IA(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),s.set(e,c),l||(l=PA),c.value!==o2&&l.value===c.value){if(!function $_e(t,n){const e=Object.keys(t),r=Object.keys(n);if(e.length!=r.length)return!1;for(let i=0;i<e.length;i++){const o=e[i];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(l.params,c.params)){const T=[],R=o.matchStyles(l.value,l.params,T),q=o.matchStyles(c.value,c.params,T);T.length?this._engine.reportError(T):this._engine.afterFlush(()=>{f0(n,R),Nf(n,q)})}return}const E=cu(this._engine.playersByElement,n,[]);E.forEach(T=>{T.namespaceId==this.id&&T.triggerName==e&&T.queued&&T.destroy()});let D=o.matchTransition(l.value,c.value,n,c.params),k=!1;if(!D){if(!i)return;D=o.fallbackTransition,k=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:D,fromState:l,toState:c,player:a,isFallbackTransition:k}),k||(Xu(n,oL),a.onStart(()=>{w_(n,oL)})),a.onDone(()=>{let T=this.players.indexOf(a);T>=0&&this.players.splice(T,1);const R=this._engine.playersByElement.get(n);if(R){let q=R.indexOf(a);q>=0&&R.splice(q,1)}}),this.players.push(a),E.push(a),a}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(i=>i.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const r=this._engine.driver.query(n,Mx,!0);r.forEach(i=>{if(i[Yu])return;const o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(a=>a.triggerLeaveAnimation(i,e,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(n,e,r,i){const o=this._engine.statesByElement.get(n),a=new Map;if(o){const s=[];if(o.forEach((l,c)=>{if(a.set(c,l.value),this._triggers.has(c)){const f=this.trigger(n,c,o2,i);f&&s.push(f)}}),s.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,a),r&&vm(s).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),r=this._engine.statesByElement.get(n);if(e&&r){const i=new Set;e.forEach(o=>{const a=o.name;if(i.has(a))return;i.add(a);const l=this._triggers.get(a).fallbackTransition,c=r.get(a)||PA,f=new IA(o2),v=new OA(this.id,a,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:a,transition:l,fromState:c,toState:f,player:v,isFallbackTransition:!0})})}}removeNode(n,e){const r=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let i=!1;if(r.totalAnimations){const o=r.players.length?r.playersByQueriedElement.get(n):[];if(o&&o.length)i=!0;else{let a=n;for(;a=a.parentNode;)if(r.statesByElement.get(a)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(n),i)r.markElementAsRemoved(this.id,n,!1,e);else{const o=n[Yu];(!o||o===aL)&&(r.afterFlush(()=>this.clearElementCache(n)),r.destroyInnerAnimations(n),r._onRemovalComplete(n,e))}}insertNode(n,e){Xu(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const o=r.element,a=this._elementListeners.get(o);a&&a.forEach(s=>{if(s.name==r.triggerName){const l=mA(o,r.triggerName,r.fromState.value,r.toState.value);l._data=n,hA(r.player,s.phase,l,s.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):e.push(r)}),this._queue=[],e.sort((r,i)=>{const o=r.transition.ast.depCount,a=i.transition.ast.depCount;return 0==o||0==a?o-a:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(r=>r.element===n)||e,e}}class B_e{_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,r){this.bodyNode=n,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,o)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&n.push(r)})}),n}createNamespace(n,e){const r=new L_e(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[n]=r}_balanceNamespaceList(n,e){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let a=!1,s=this.driver.getParentElement(e);for(;s;){const l=i.get(s);if(l){const c=r.indexOf(l);r.splice(c+1,0,n),a=!0;break}s=this.driver.getParentElement(s)}a||r.unshift(n)}else r.push(n);return i.set(e,n),n}register(n,e){let r=this._namespaceLookup[n];return r||(r=this.createNamespace(n,e)),r}registerTrigger(n,e,r){let i=this._namespaceLookup[n];i&&i.register(e,r)&&this.totalAnimations++}destroy(n,e){if(!n)return;const r=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[n];const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,r=this.statesByElement.get(n);if(r)for(let i of r.values())if(i.namespaceId){const o=this._fetchNamespace(i.namespaceId);o&&e.add(o)}return e}trigger(n,e,r,i){if(Vx(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,r,i),!0}return!1}insertNode(n,e,r,i){if(!Vx(e))return;const o=e[Yu];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const a=this.collectedLeaveElements.indexOf(e);a>=0&&this.collectedLeaveElements.splice(a,1)}if(n){const a=this._fetchNamespace(n);a&&a.insertNode(e,r)}i&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Xu(n,FA)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),w_(n,FA))}removeNode(n,e,r,i){if(Vx(e)){const o=n?this._fetchNamespace(n):null;if(o?o.removeNode(e,i):this.markElementAsRemoved(n,e,!1,i),r){const a=this.namespacesByHostElement.get(e);a&&a.id!==n&&a.removeNode(e,i)}}else this._onRemovalComplete(e,i)}markElementAsRemoved(n,e,r,i,o){this.collectedLeaveElements.push(e),e[Yu]={namespaceId:n,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,r,i,o){return Vx(e)?this._fetchNamespace(n).listen(e,r,i,o):()=>{}}_buildInstruction(n,e,r,i,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,r,i,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,Mx,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,yA,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return vm(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[Yu];if(e&&e.setForRemoval){if(n[Yu]=aL,e.namespaceId){this.destroyInnerAnimations(n);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(FA)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Xu(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,n)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?vm(e).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(n){throw function B1e(t){return new Vt(3402,!1)}()}_flushAnimations(n,e){const r=new Lx,i=[],o=new Map,a=[],s=new Map,l=new Map,c=new Map,f=new Set;this.disabledNodes.forEach(rn=>{f.add(rn);const an=this.driver.query(rn,".ng-animate-queued",!0);for(let Ln=0;Ln<an.length;Ln++)f.add(an[Ln])});const v=this.bodyNode,E=Array.from(this.statesByElement.keys()),D=cL(E,this.collectedEnterElements),k=new Map;let T=0;D.forEach((rn,an)=>{const Ln=bA+T++;k.set(an,Ln),rn.forEach(mn=>Xu(mn,Ln))});const R=[],q=new Set,Z=new Set;for(let rn=0;rn<this.collectedLeaveElements.length;rn++){const an=this.collectedLeaveElements[rn],Ln=an[Yu];Ln&&Ln.setForRemoval&&(R.push(an),q.add(an),Ln.hasAnimation?this.driver.query(an,".ng-star-inserted",!0).forEach(mn=>q.add(mn)):Z.add(an))}const W=new Map,Ee=cL(E,Array.from(q));Ee.forEach((rn,an)=>{const Ln=Ax+T++;W.set(an,Ln),rn.forEach(mn=>Xu(mn,Ln))}),n.push(()=>{D.forEach((rn,an)=>{const Ln=k.get(an);rn.forEach(mn=>w_(mn,Ln))}),Ee.forEach((rn,an)=>{const Ln=W.get(an);rn.forEach(mn=>w_(mn,Ln))}),R.forEach(rn=>{this.processLeaveNode(rn)})});const Le=[],Pe=[];for(let rn=this._namespaceList.length-1;rn>=0;rn--)this._namespaceList[rn].drainQueuedTransitions(e).forEach(Ln=>{const mn=Ln.player,Wn=Ln.element;if(Le.push(mn),this.collectedEnterElements.length){const En=Wn[Yu];if(En&&En.setForMove){if(En.previousTriggersValues&&En.previousTriggersValues.has(Ln.triggerName)){const Sn=En.previousTriggersValues.get(Ln.triggerName),bn=this.statesByElement.get(Ln.element);if(bn&&bn.has(Ln.triggerName)){const dn=bn.get(Ln.triggerName);dn.value=Sn,bn.set(Ln.triggerName,dn)}}return void mn.destroy()}}const qt=!v||!this.driver.containsElement(v,Wn),Ae=W.get(Wn),dt=k.get(Wn),Fe=this._buildInstruction(Ln,r,dt,Ae,qt);if(Fe.errors&&Fe.errors.length)return void Pe.push(Fe);if(qt)return mn.onStart(()=>f0(Wn,Fe.fromStyles)),mn.onDestroy(()=>Nf(Wn,Fe.toStyles)),void i.push(mn);if(Ln.isFallbackTransition)return mn.onStart(()=>f0(Wn,Fe.fromStyles)),mn.onDestroy(()=>Nf(Wn,Fe.toStyles)),void i.push(mn);const Re=[];Fe.timelines.forEach(En=>{En.stretchStartingKeyframe=!0,this.disabledNodes.has(En.element)||Re.push(En)}),Fe.timelines=Re,r.append(Wn,Fe.timelines),a.push({instruction:Fe,player:mn,element:Wn}),Fe.queriedElements.forEach(En=>cu(s,En,[]).push(mn)),Fe.preStyleProps.forEach((En,Sn)=>{if(En.size){let bn=l.get(Sn);bn||l.set(Sn,bn=new Set),En.forEach((dn,li)=>bn.add(li))}}),Fe.postStyleProps.forEach((En,Sn)=>{let bn=c.get(Sn);bn||c.set(Sn,bn=new Set),En.forEach((dn,li)=>bn.add(li))})});if(Pe.length){const rn=[];Pe.forEach(an=>{rn.push(function j1e(t,n){return new Vt(3505,!1)}())}),Le.forEach(an=>an.destroy()),this.reportError(rn)}const ge=new Map,Ye=new Map;a.forEach(rn=>{const an=rn.element;r.has(an)&&(Ye.set(an,an),this._beforeAnimationBuild(rn.player.namespaceId,rn.instruction,ge))}),i.forEach(rn=>{const an=rn.element;this._getPreviousPlayers(an,!1,rn.namespaceId,rn.triggerName,null).forEach(mn=>{cu(ge,an,[]).push(mn),mn.destroy()})});const Ge=R.filter(rn=>dL(rn,l,c)),wt=new Map;lL(wt,this.driver,Z,c,Ph).forEach(rn=>{dL(rn,l,c)&&Ge.push(rn)});const Qe=new Map;D.forEach((rn,an)=>{lL(Qe,this.driver,new Set(rn),l,ID)}),Ge.forEach(rn=>{const an=wt.get(rn),Ln=Qe.get(rn);wt.set(rn,new Map([...Array.from(an?.entries()??[]),...Array.from(Ln?.entries()??[])]))});const An=[],rr=[],Nn={};a.forEach(rn=>{const{element:an,player:Ln,instruction:mn}=rn;if(r.has(an)){if(f.has(an))return Ln.onDestroy(()=>Nf(an,mn.toStyles)),Ln.disabled=!0,Ln.overrideTotalTime(mn.totalTime),void i.push(Ln);let Wn=Nn;if(Ye.size>1){let Ae=an;const dt=[];for(;Ae=Ae.parentNode;){const Fe=Ye.get(Ae);if(Fe){Wn=Fe;break}dt.push(Ae)}dt.forEach(Fe=>Ye.set(Fe,Wn))}const qt=this._buildAnimation(Ln.namespaceId,mn,ge,o,Qe,wt);if(Ln.setRealPlayer(qt),Wn===Nn)An.push(Ln);else{const Ae=this.playersByElement.get(Wn);Ae&&Ae.length&&(Ln.parentPlayer=vm(Ae)),i.push(Ln)}}else f0(an,mn.fromStyles),Ln.onDestroy(()=>Nf(an,mn.toStyles)),rr.push(Ln),f.has(an)&&i.push(Ln)}),rr.forEach(rn=>{const an=o.get(rn.element);if(an&&an.length){const Ln=vm(an);rn.setRealPlayer(Ln)}}),i.forEach(rn=>{rn.parentPlayer?rn.syncPlayerEvents(rn.parentPlayer):rn.destroy()});for(let rn=0;rn<R.length;rn++){const an=R[rn],Ln=an[Yu];if(w_(an,Ax),Ln&&Ln.hasAnimation)continue;let mn=[];if(s.size){let qt=s.get(an);qt&&qt.length&&mn.push(...qt);let Ae=this.driver.query(an,yA,!0);for(let dt=0;dt<Ae.length;dt++){let Fe=s.get(Ae[dt]);Fe&&Fe.length&&mn.push(...Fe)}}const Wn=mn.filter(qt=>!qt.destroyed);Wn.length?H_e(this,an,Wn):this.processLeaveNode(an)}return R.length=0,An.forEach(rn=>{this.players.push(rn),rn.onDone(()=>{rn.destroy();const an=this.players.indexOf(rn);this.players.splice(an,1)}),rn.play()}),An}elementContainsData(n,e){let r=!1;const i=e[Yu];return i&&i.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(n).elementContainsData(e)||r}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,r,i,o){let a=[];if(e){const s=this.playersByQueriedElement.get(n);s&&(a=s)}else{const s=this.playersByElement.get(n);if(s){const l=!o||o==o2;s.forEach(c=>{c.queued||!l&&c.triggerName!=i||a.push(c)})}}return(r||i)&&(a=a.filter(s=>!(r&&r!=s.namespaceId||i&&i!=s.triggerName))),a}_beforeAnimationBuild(n,e,r){const o=e.element,a=e.isRemovalTransition?void 0:n,s=e.isRemovalTransition?void 0:e.triggerName;for(const l of e.timelines){const c=l.element,f=c!==o,v=cu(r,c,[]);this._getPreviousPlayers(c,f,a,s,e.toState).forEach(D=>{const k=D.getRealPlayer();k.beforeDestroy&&k.beforeDestroy(),D.destroy(),v.push(D)})}f0(o,e.fromStyles)}_buildAnimation(n,e,r,i,o,a){const s=e.triggerName,l=e.element,c=[],f=new Set,v=new Set,E=e.timelines.map(k=>{const T=k.element;f.add(T);const R=T[Yu];if(R&&R.removedBeforeQueried)return new $b(k.duration,k.delay);const q=T!==l,Z=function z_e(t){const n=[];return uL(t,n),n}((r.get(T)||N_e).map(ge=>ge.getRealPlayer())).filter(ge=>!!ge.element&&ge.element===T),W=o.get(T),Ee=a.get(T),Le=R8(0,this._normalizer,0,k.keyframes,W,Ee),Pe=this._buildPlayer(k,Le,Z);if(k.subTimeline&&i&&v.add(T),q){const ge=new OA(n,s,T);ge.setRealPlayer(Pe),c.push(ge)}return Pe});c.forEach(k=>{cu(this.playersByQueriedElement,k.element,[]).push(k),k.onDone(()=>function j_e(t,n,e){let r=t.get(n);if(r){if(r.length){const i=r.indexOf(e);r.splice(i,1)}0==r.length&&t.delete(n)}return r}(this.playersByQueriedElement,k.element,k))}),f.forEach(k=>Xu(k,W8));const D=vm(E);return D.onDestroy(()=>{f.forEach(k=>w_(k,W8)),Nf(l,e.toStyles)}),v.forEach(k=>{cu(i,k,[]).push(D)}),D}_buildPlayer(n,e,r){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,r):new $b(n.duration,n.delay)}}class OA{constructor(n,e,r){this.namespaceId=n,this.triggerName=e,this.element=r,this._player=new $b,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,r)=>{e.forEach(i=>hA(n,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){cu(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function Vx(t){return t&&1===t.nodeType}function sL(t,n){const e=t.style.display;return t.style.display=n??"none",e}function lL(t,n,e,r,i){const o=[];e.forEach(l=>o.push(sL(l)));const a=[];r.forEach((l,c)=>{const f=new Map;l.forEach(v=>{const E=n.computeStyle(c,v,i);f.set(v,E),(!E||0==E.length)&&(c[Yu]=R_e,a.push(c))}),t.set(c,f)});let s=0;return e.forEach(l=>sL(l,o[s++])),a}function cL(t,n){const e=new Map;if(t.forEach(s=>e.set(s,[])),0==n.length)return e;const r=1,i=new Set(n),o=new Map;function a(s){if(!s)return r;let l=o.get(s);if(l)return l;const c=s.parentNode;return l=e.has(c)?c:i.has(c)?r:a(c),o.set(s,l),l}return n.forEach(s=>{const l=a(s);l!==r&&e.get(l).push(s)}),e}function Xu(t,n){t.classList?.add(n)}function w_(t,n){t.classList?.remove(n)}function H_e(t,n,e){vm(e).onDone(()=>t.processLeaveNode(n))}function uL(t,n){for(let e=0;e<t.length;e++){const r=t[e];r instanceof RR?uL(r.players,n):n.push(r)}}function dL(t,n,e){const r=e.get(t);if(!r)return!1;let i=n.get(t);return i?r.forEach(o=>i.add(o)):n.set(t,r),e.delete(t),!0}class Ux{constructor(n,e,r){this.bodyNode=n,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,o)=>{},this._transitionEngine=new B_e(n,e,r),this._timelineEngine=new k_e(n,e,r),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(n,e,r,i,o){const a=n+"-"+i;let s=this._triggerCache[a];if(!s){const l=[],c=[],f=EA(this._driver,o,l,c);if(l.length)throw function T1e(t,n){return new Vt(3404,!1)}();s=function D_e(t,n,e){return new A_e(t,n,e)}(i,f,this._normalizer),this._triggerCache[a]=s}this._transitionEngine.registerTrigger(e,i,s)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,r,i){this._transitionEngine.insertNode(n,e,r,i)}onRemove(n,e,r,i){this._transitionEngine.removeNode(n,e,i||!1,r)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,r,i){if("@"==r.charAt(0)){const[o,a]=L8(r);this._timelineEngine.command(o,e,a,i)}else this._transitionEngine.trigger(n,e,r,i)}listen(n,e,r,i,o){if("@"==r.charAt(0)){const[a,s]=L8(r);return this._timelineEngine.listen(a,e,s,o)}return this._transitionEngine.listen(n,e,r,i,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let q_e=(()=>{class t{constructor(e,r,i){this._element=e,this._startStyles=r,this._endStyles=i,this._state=0;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Nf(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Nf(this._element,this._initialStyles),this._endStyles&&(Nf(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(f0(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(f0(this._element,this._endStyles),this._endStyles=null),Nf(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function NA(t){let n=null;return t.forEach((e,r)=>{(function G_e(t){return"display"===t||"position"===t})(r)&&(n=n||new Map,n.set(r,e))}),n}class fL{constructor(n,e,r,i){this.element=n,this.keyframes=e,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(n,e,r){return n.animate(this._convertKeyframesToObject(e),r)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&n.set(i,this._finished?r:Z8(this.element,i))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Y_e{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return U8(n,e)}getParentElement(n){return _A(n)}query(n,e,r){return H8(n,e,r)}computeStyle(n,e,r){return window.getComputedStyle(n)[e]}animate(n,e,r,i,o,a=[]){const l={duration:r,delay:i,fill:0==i?"both":"forwards"};o&&(l.easing=o);const c=new Map,f=a.filter(D=>D instanceof fL);(function Q1e(t,n){return 0===t||0===n})(r,i)&&f.forEach(D=>{D.currentSnapshot.forEach((k,T)=>c.set(T,k))});let v=function Y1e(t){return t.length?t[0]instanceof Map?t:t.map(n=>q8(n)):[]}(e).map(D=>bm(D));v=function J1e(t,n,e){if(e.size&&n.length){let r=n[0],i=[];if(e.forEach((o,a)=>{r.has(a)||i.push(a),r.set(a,o)}),i.length)for(let o=1;o<n.length;o++){let a=n[o];i.forEach(s=>a.set(s,Z8(t,s)))}}return n}(n,v,c);const E=function W_e(t,n){let e=null,r=null;return Array.isArray(n)&&n.length?(e=NA(n[0]),n.length>1&&(r=NA(n[n.length-1]))):n instanceof Map&&(e=NA(n)),e||r?new q_e(t,e,r):null}(n,v);return new fL(n,v,l,E)}}let X_e=(()=>{class t extends PR{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:bl.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(e)?OR(e):e;return hL(this._renderer,null,r,"register",[i]),new K_e(r,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(it(nv),it(si))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();class K_e extends lae{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new Z_e(this._id,n,e||{},this._renderer)}}class Z_e{constructor(n,e,r,i){this.id=n,this.element=e,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return hL(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function hL(t,n,e,r,i){return t.setProperty(n,`@@${e}:${r}`,i)}const pL="@.disabled";let Q_e=(()=>{class t{constructor(e,r,i){this.delegate=e,this.engine=r,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(o,a)=>{const s=a?.parentNode(o);s&&a.removeChild(s,o)}}createRenderer(e,r){const o=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let f=this._rendererCache.get(o);return f||(f=new mL("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,f)),f}const a=r.id,s=r.id+"-"+this._currentId;this._currentId++,this.engine.register(s,e);const l=f=>{Array.isArray(f)?f.forEach(l):this.engine.registerTrigger(a,s,e,f.name,f)};return r.data.animation.forEach(l),new J_e(this,s,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,i){e>=0&&e<this._microtaskId?this._zone.run(()=>r(i)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[a,s]=o;a(s)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(it(nv),it(Ux),it(Wr))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})();class mL{constructor(n,e,r,i){this.namespaceId=n,this.delegate=e,this.engine=r,this._onDestroy=i,this.destroyNode=this.delegate.destroyNode?o=>e.destroyNode(o):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,r,i=!0){this.delegate.insertBefore(n,e,r),this.engine.onInsert(this.namespaceId,e,n,i)}removeChild(n,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,r,i){this.delegate.setAttribute(n,e,r,i)}removeAttribute(n,e,r){this.delegate.removeAttribute(n,e,r)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,r,i){this.delegate.setStyle(n,e,r,i)}removeStyle(n,e,r){this.delegate.removeStyle(n,e,r)}setProperty(n,e,r){"@"==e.charAt(0)&&e==pL?this.disableAnimations(n,!!r):this.delegate.setProperty(n,e,r)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,r){return this.delegate.listen(n,e,r)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class J_e extends mL{constructor(n,e,r,i,o){super(e,r,i,o),this.factory=n,this.namespaceId=e}setProperty(n,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==pL?this.disableAnimations(n,r=void 0===r||!!r):this.engine.process(this.namespaceId,n,e.slice(1),r):this.delegate.setProperty(n,e,r)}listen(n,e,r){if("@"==e.charAt(0)){const i=function eve(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.slice(1),a="";return"@"!=o.charAt(0)&&([o,a]=function tve(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(o)),this.engine.listen(this.namespaceId,i,o,a,s=>{this.factory.scheduleListenerCallback(s._data||-1,r,s)})}return this.delegate.listen(n,e,r)}}const gL=[{provide:PR,useClass:X_e},{provide:MA,useFactory:function rve(){return new x_e}},{provide:Ux,useClass:(()=>{class t extends Ux{constructor(e,r,i,o){super(e.body,r,i)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(it(si),it(vA),it(MA),it(N1))},t.\u0275prov=Gt({token:t,factory:t.\u0275fac}),t})()},{provide:nv,useFactory:function ive(t,n,e){return new Q_e(t,n,e)},deps:[ky,Ux,Wr]}],RA=[{provide:vA,useFactory:()=>new Y_e},{provide:kl,useValue:"BrowserAnimations"},...gL],_L=[{provide:vA,useClass:z8},{provide:kl,useValue:"NoopAnimations"},...gL];let ove=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?_L:RA}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Kr({type:t}),t.\u0275inj=hr({providers:RA,imports:[gk]}),t})();function ave(t){return()=>t.cargarPermisos()}let sve=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Kr({type:t,bootstrap:[a1e]});static#n=this.\u0275inj=hr({providers:[{provide:bv,useFactory:ave,deps:[U$],multi:!0}],imports:[gk,o1e,ove,che,_se,whe,D6,Tse,s8,Lhe,V$,Lz,j$,Yue,JD,ede,hde,ole,B0e,tce,P6]})}return t})();sz().bootstrapModule(sve).catch(t=>console.error(t))},2983:function(Md,Ys,qi){var zn;typeof globalThis<"u"?globalThis:typeof this<"u"||(typeof window<"u"?window:typeof self<"u"?self:global),Md.exports=(zn=function(){try{return qi(6166)}catch{}}(),function(){"use strict";var pl={172:function(yr,pn){var on,Tn=this&&this.__extends||(on=function(Dn,ut){return(on=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Cn,hn){Cn.__proto__=hn}||function(Cn,hn){for(var Ot in hn)Object.prototype.hasOwnProperty.call(hn,Ot)&&(Cn[Ot]=hn[Ot])})(Dn,ut)},function(Dn,ut){if("function"!=typeof ut&&null!==ut)throw new TypeError("Class extends value "+String(ut)+" is not a constructor or null");function Cn(){this.constructor=Dn}on(Dn,ut),Dn.prototype=null===ut?Object.create(ut):(Cn.prototype=ut.prototype,new Cn)});Object.defineProperty(pn,"__esModule",{value:!0}),pn.CellHookData=pn.HookData=void 0;var ir=function on(Dn,ut,Cn){this.table=ut,this.pageNumber=ut.pageNumber,this.pageCount=this.pageNumber,this.settings=ut.settings,this.cursor=Cn,this.doc=Dn.getDocument()};pn.HookData=ir;var yn=function(on){function Dn(ut,Cn,hn,Ot,lt,Ie){var Ze=on.call(this,ut,Cn,Ie)||this;return Ze.cell=hn,Ze.row=Ot,Ze.column=lt,Ze.section=Ot.section,Ze}return Tn(Dn,on),Dn}(ir);pn.CellHookData=yn},340:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0});var ir=Tn(4),yn=Tn(136),on=Tn(744),Dn=Tn(776),ut=Tn(664),Cn=Tn(972);pn.default=function hn(Ot){Ot.API.autoTable=function(){for(var lt=[],Ie=0;Ie<arguments.length;Ie++)lt[Ie]=arguments[Ie];var Ze;1===lt.length?Ze=lt[0]:(console.error("Use of deprecated autoTable initiation"),(Ze=lt[2]||{}).columns=lt[0],Ze.body=lt[1]);var _t=(0,Dn.parseInput)(this,Ze),Et=(0,Cn.createTable)(this,_t);return(0,ut.drawTable)(this,Et),this},Ot.API.lastAutoTable=!1,Ot.API.previousAutoTable=!1,Ot.API.autoTable.previous=!1,Ot.API.autoTableText=function(lt,Ie,Ze,_t){(0,yn.default)(lt,Ie,Ze,_t,this)},Ot.API.autoTableSetDefaults=function(lt){return on.DocHandler.setDefaults(lt,this),this},Ot.autoTableSetDefaults=function(lt,Ie){on.DocHandler.setDefaults(lt,Ie)},Ot.API.autoTableHtmlToJson=function(lt,Ie){var Ze;if(void 0===Ie&&(Ie=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var _t=new on.DocHandler(this),Et=(0,ir.parseHtml)(_t,lt,window,Ie,!1),Ft=Et.body;return{columns:(null===(Ze=Et.head[0])||void 0===Ze?void 0:Ze.map(function(tn){return tn.content}))||[],rows:Ft,data:Ft}},Ot.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var lt=this.lastAutoTable;return lt&&lt.finalY?lt.finalY:0},Ot.API.autoTableAddPageContent=function(lt){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),Ot.API.autoTable.globalDefaults||(Ot.API.autoTable.globalDefaults={}),Ot.API.autoTable.globalDefaults.addPageContent=lt,this},Ot.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}},136:function(yr,pn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.default=function Tn(ir,yn,on,Dn,ut){Dn=Dn||{};var hn=ut.internal.scaleFactor,Ot=ut.internal.getFontSize()/hn,Ie=Ot*(ut.getLineHeightFactor?ut.getLineHeightFactor():1.15),_t="",Et=1;if(("middle"===Dn.valign||"bottom"===Dn.valign||"center"===Dn.halign||"right"===Dn.halign)&&(Et=(_t="string"==typeof ir?ir.split(/\r\n|\r|\n/g):ir).length||1),on+=Ot*(2-1.15),"middle"===Dn.valign?on-=Et/2*Ie:"bottom"===Dn.valign&&(on-=Et*Ie),"center"===Dn.halign||"right"===Dn.halign){var Je=Ot;if("center"===Dn.halign&&(Je*=.5),_t&&Et>=1){for(var Ft=0;Ft<_t.length;Ft++)ut.text(_t[Ft],yn-ut.getStringUnitWidth(_t[Ft])*Je,on),on+=Ie;return ut}yn-=ut.getStringUnitWidth(ir)*Je}return"justify"===Dn.halign?ut.text(ir,yn,on,{maxWidth:Dn.maxWidth||100,align:"justify"}):ut.text(ir,yn,on),ut}},420:function(yr,pn){function yn(ut,Cn){var hn=ut>0,Ot=Cn||0===Cn;return hn&&Ot?"DF":hn?"S":Ot?"F":null}function on(ut,Cn){var hn,Ot,lt,Ie;if(ut=ut||Cn,Array.isArray(ut)){if(ut.length>=4)return{top:ut[0],right:ut[1],bottom:ut[2],left:ut[3]};if(3===ut.length)return{top:ut[0],right:ut[1],bottom:ut[2],left:ut[1]};if(2===ut.length)return{top:ut[0],right:ut[1],bottom:ut[0],left:ut[1]};ut=1===ut.length?ut[0]:Cn}return"object"==typeof ut?("number"==typeof ut.vertical&&(ut.top=ut.vertical,ut.bottom=ut.vertical),"number"==typeof ut.horizontal&&(ut.right=ut.horizontal,ut.left=ut.horizontal),{left:null!==(hn=ut.left)&&void 0!==hn?hn:Cn,top:null!==(Ot=ut.top)&&void 0!==Ot?Ot:Cn,right:null!==(lt=ut.right)&&void 0!==lt?lt:Cn,bottom:null!==(Ie=ut.bottom)&&void 0!==Ie?Ie:Cn}):("number"!=typeof ut&&(ut=Cn),{top:ut,right:ut,bottom:ut,left:ut})}Object.defineProperty(pn,"__esModule",{value:!0}),pn.getPageAvailableWidth=pn.parseSpacing=pn.getFillStyle=pn.addTableBorder=pn.getStringWidth=void 0,pn.getStringWidth=function Tn(ut,Cn,hn){return hn.applyStyles(Cn,!0),(Array.isArray(ut)?ut:[ut]).map(function(Ie){return hn.getTextWidth(Ie)}).reduce(function(Ie,Ze){return Math.max(Ie,Ze)},0)},pn.addTableBorder=function ir(ut,Cn,hn,Ot){var lt=Cn.settings.tableLineWidth;ut.applyStyles({lineWidth:lt,lineColor:Cn.settings.tableLineColor});var Ze=yn(lt,!1);Ze&&ut.rect(hn.x,hn.y,Cn.getWidth(ut.pageSize().width),Ot.y-hn.y,Ze)},pn.getFillStyle=yn,pn.parseSpacing=on,pn.getPageAvailableWidth=function Dn(ut,Cn){var hn=on(Cn.settings.margin,0);return ut.pageSize().width-(hn.left+hn.right)}},796:function(yr,pn){var Dn,Tn=this&&this.__extends||(Dn=function(ut,Cn){return(Dn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(hn,Ot){hn.__proto__=Ot}||function(hn,Ot){for(var lt in Ot)Object.prototype.hasOwnProperty.call(Ot,lt)&&(hn[lt]=Ot[lt])})(ut,Cn)},function(ut,Cn){if("function"!=typeof Cn&&null!==Cn)throw new TypeError("Class extends value "+String(Cn)+" is not a constructor or null");function hn(){this.constructor=ut}Dn(ut,Cn),ut.prototype=null===Cn?Object.create(Cn):(hn.prototype=Cn.prototype,new hn)});Object.defineProperty(pn,"__esModule",{value:!0}),pn.getTheme=pn.defaultStyles=pn.HtmlRowInput=void 0;var ir=function(Dn){function ut(Cn){var hn=Dn.call(this)||this;return hn._element=Cn,hn}return Tn(ut,Dn),ut}(Array);pn.HtmlRowInput=ir,pn.defaultStyles=function yn(Dn){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/Dn,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}},pn.getTheme=function on(Dn){return{striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[Dn]}},903:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.parseCss=void 0;var ir=Tn(420);function Dn(hn,Ot){var lt=ut(hn,Ot);if(!lt)return null;var Ie=lt.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!Ie||!Array.isArray(Ie))return null;var Ze=[parseInt(Ie[1]),parseInt(Ie[2]),parseInt(Ie[3])];return 0===parseInt(Ie[4])||isNaN(Ze[0])||isNaN(Ze[1])||isNaN(Ze[2])?null:Ze}function ut(hn,Ot){var lt=Ot(hn);return"rgba(0, 0, 0, 0)"===lt||"transparent"===lt||"initial"===lt||"inherit"===lt?null==hn.parentElement?null:ut(hn.parentElement,Ot):lt}pn.parseCss=function yn(hn,Ot,lt,Ie,Ze){var _t={},Et=1.3333333333333333,Je=Dn(Ot,function(Rt){return Ze.getComputedStyle(Rt).backgroundColor});null!=Je&&(_t.fillColor=Je);var Ft=Dn(Ot,function(Rt){return Ze.getComputedStyle(Rt).color});null!=Ft&&(_t.textColor=Ft);var Jt=function Cn(hn,Ot){var lt=[hn.paddingTop,hn.paddingRight,hn.paddingBottom,hn.paddingLeft],Ie=96/(72/Ot),Ze=(parseInt(hn.lineHeight)-parseInt(hn.fontSize))/Ot/2,_t=lt.map(function(Je){return parseInt(Je||"0")/Ie}),Et=(0,ir.parseSpacing)(_t,0);return Ze>Et.top&&(Et.top=Ze),Ze>Et.bottom&&(Et.bottom=Ze),Et}(Ie,lt);Jt&&(_t.cellPadding=Jt);var tn="borderTopColor",nn=Et*lt,vt=Ie.borderTopWidth;if(Ie.borderBottomWidth===vt&&Ie.borderRightWidth===vt&&Ie.borderLeftWidth===vt){var kn=(parseFloat(vt)||0)/nn;kn&&(_t.lineWidth=kn)}else _t.lineWidth={top:(parseFloat(Ie.borderTopWidth)||0)/nn,right:(parseFloat(Ie.borderRightWidth)||0)/nn,bottom:(parseFloat(Ie.borderBottomWidth)||0)/nn,left:(parseFloat(Ie.borderLeftWidth)||0)/nn},_t.lineWidth.top||(_t.lineWidth.right?tn="borderRightColor":_t.lineWidth.bottom?tn="borderBottomColor":_t.lineWidth.left&&(tn="borderLeftColor"));var ur=Dn(Ot,function(Rt){return Ze.getComputedStyle(Rt)[tn]});null!=ur&&(_t.lineColor=ur);var xr=["left","right","center","justify"];-1!==xr.indexOf(Ie.textAlign)&&(_t.halign=Ie.textAlign),-1!==(xr=["middle","bottom","top"]).indexOf(Ie.verticalAlign)&&(_t.valign=Ie.verticalAlign);var tt=parseInt(Ie.fontSize||"");isNaN(tt)||(_t.fontSize=tt/Et);var mt=function on(hn){var Ot="";return("bold"===hn.fontWeight||"bolder"===hn.fontWeight||parseInt(hn.fontWeight)>=700)&&(Ot="bold"),("italic"===hn.fontStyle||"oblique"===hn.fontStyle)&&(Ot+="italic"),Ot}(Ie);mt&&(_t.fontStyle=mt);var Ht=(Ie.fontFamily||"").toLowerCase();return-1!==hn.indexOf(Ht)&&(_t.font=Ht),_t}},744:function(yr,pn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.DocHandler=void 0;var Tn={},ir=function(){function yn(on){this.jsPDFDocument=on,this.userStyles={textColor:on.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:on.internal.getFontSize(),fontStyle:on.internal.getFont().fontStyle,font:on.internal.getFont().fontName,lineWidth:on.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:on.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return yn.setDefaults=function(on,Dn){void 0===Dn&&(Dn=null),Dn?Dn.__autoTableDocumentDefaults=on:Tn=on},yn.unifyColor=function(on){return Array.isArray(on)?on:"number"==typeof on?[on,on,on]:"string"==typeof on?[on]:null},yn.prototype.applyStyles=function(on,Dn){var ut,Cn,hn;void 0===Dn&&(Dn=!1),on.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(on.fontStyle);var Ot=this.jsPDFDocument.internal.getFont(),lt=Ot.fontStyle,Ie=Ot.fontName;if(on.font&&(Ie=on.font),on.fontStyle){lt=on.fontStyle;var Ze=this.getFontList()[Ie];Ze&&-1===Ze.indexOf(lt)&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(Ze[0]),lt=Ze[0])}if(this.jsPDFDocument.setFont(Ie,lt),on.fontSize&&this.jsPDFDocument.setFontSize(on.fontSize),!Dn){var _t=yn.unifyColor(on.fillColor);_t&&(ut=this.jsPDFDocument).setFillColor.apply(ut,_t),(_t=yn.unifyColor(on.textColor))&&(Cn=this.jsPDFDocument).setTextColor.apply(Cn,_t),(_t=yn.unifyColor(on.lineColor))&&(hn=this.jsPDFDocument).setDrawColor.apply(hn,_t),"number"==typeof on.lineWidth&&this.jsPDFDocument.setLineWidth(on.lineWidth)}},yn.prototype.splitTextToSize=function(on,Dn,ut){return this.jsPDFDocument.splitTextToSize(on,Dn,ut)},yn.prototype.rect=function(on,Dn,ut,Cn,hn){return this.jsPDFDocument.rect(on,Dn,ut,Cn,hn)},yn.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},yn.prototype.getTextWidth=function(on){return this.jsPDFDocument.getTextWidth(on)},yn.prototype.getDocument=function(){return this.jsPDFDocument},yn.prototype.setPage=function(on){this.jsPDFDocument.setPage(on)},yn.prototype.addPage=function(){return this.jsPDFDocument.addPage()},yn.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},yn.prototype.getGlobalOptions=function(){return Tn||{}},yn.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},yn.prototype.pageSize=function(){var on=this.jsPDFDocument.internal.pageSize;return null==on.width&&(on={width:on.getWidth(),height:on.getHeight()}),on},yn.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},yn.prototype.getLineHeightFactor=function(){var on=this.jsPDFDocument;return on.getLineHeightFactor?on.getLineHeightFactor():1.15},yn.prototype.getLineHeight=function(on){return on/this.scaleFactor()*this.getLineHeightFactor()},yn.prototype.pageNumber=function(){var on=this.jsPDFDocument.internal.getCurrentPageInfo();return on?on.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},yn}();pn.DocHandler=ir},4:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.parseHtml=void 0;var ir=Tn(903),yn=Tn(796);function Dn(Cn,hn,Ot,lt,Ie,Ze){for(var _t=new yn.HtmlRowInput(lt),Et=0;Et<lt.cells.length;Et++){var Je=lt.cells[Et],Ft=Ot.getComputedStyle(Je);if(Ie||"none"!==Ft.display){var Jt=void 0;Ze&&(Jt=(0,ir.parseCss)(Cn,Je,hn,Ft,Ot)),_t.push({rowSpan:Je.rowSpan,colSpan:Je.colSpan,styles:Jt,_element:Je,content:ut(Je)})}}var tn=Ot.getComputedStyle(lt);if(_t.length>0&&(Ie||"none"!==tn.display))return _t}function ut(Cn){var hn=Cn.cloneNode(!0);return hn.innerHTML=hn.innerHTML.replace(/\n/g,"").replace(/ +/g," "),hn.innerHTML=hn.innerHTML.split(/<br.*?>/).map(function(Ot){return Ot.trim()}).join("\n"),hn.innerText||hn.textContent||""}pn.parseHtml=function on(Cn,hn,Ot,lt,Ie){var Ze,_t,Et;void 0===lt&&(lt=!1),void 0===Ie&&(Ie=!1),Et="string"==typeof hn?Ot.document.querySelector(hn):hn;var Je=Object.keys(Cn.getFontList()),Ft=Cn.scaleFactor(),Jt=[],tn=[],nn=[];if(!Et)return console.error("Html table could not be found with input: ",hn),{head:Jt,body:tn,foot:nn};for(var vt=0;vt<Et.rows.length;vt++){var kn=Et.rows[vt],ur=null===(_t=null===(Ze=kn?.parentElement)||void 0===Ze?void 0:Ze.tagName)||void 0===_t?void 0:_t.toLowerCase(),xr=Dn(Je,Ft,Ot,kn,lt,Ie);xr&&("thead"===ur?Jt.push(xr):"tfoot"===ur?nn.push(xr):tn.push(xr))}return{head:Jt,body:tn,foot:nn}}},776:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.parseInput=void 0;var ir=Tn(4),yn=Tn(356),on=Tn(420),Dn=Tn(744),ut=Tn(792);function _t(Et,Je,Ft){var Jt=Et[0]||Je[0]||Ft[0]||[],tn=[];return Object.keys(Jt).filter(function(nn){return"_element"!==nn}).forEach(function(nn){var kn,vt=1;"object"==typeof(kn=Array.isArray(Jt)?Jt[parseInt(nn)]:Jt[nn])&&!Array.isArray(kn)&&(vt=kn?.colSpan||1);for(var ur=0;ur<vt;ur++){var xr;xr=Array.isArray(Jt)?tn.length:nn+(ur>0?"_".concat(ur):""),tn.push({dataKey:xr})}}),tn}pn.parseInput=function Cn(Et,Je){var Ft=new Dn.DocHandler(Et),Jt=Ft.getDocumentOptions(),tn=Ft.getGlobalOptions();(0,ut.default)(Ft,tn,Jt,Je);var vt,nn=(0,yn.assign)({},tn,Jt,Je);typeof window<"u"&&(vt=window);var kn=function hn(Et,Je,Ft){for(var Jt={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},tn=function(ur){if("columnStyles"===ur)Jt.columnStyles=(0,yn.assign)({},Et[ur],Je[ur],Ft[ur]);else{var Rt=[Et,Je,Ft].map(function(Qn){return Qn[ur]||{}});Jt[ur]=(0,yn.assign)({},Rt[0],Rt[1],Rt[2])}},nn=0,vt=Object.keys(Jt);nn<vt.length;nn++)tn(vt[nn]);return Jt}(tn,Jt,Je),ur=function Ot(Et,Je,Ft){for(var tn={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},nn=0,vt=[Et,Je,Ft];nn<vt.length;nn++){var kn=vt[nn];kn.didParseCell&&tn.didParseCell.push(kn.didParseCell),kn.willDrawCell&&tn.willDrawCell.push(kn.willDrawCell),kn.didDrawCell&&tn.didDrawCell.push(kn.didDrawCell),kn.willDrawPage&&tn.willDrawPage.push(kn.willDrawPage),kn.didDrawPage&&tn.didDrawPage.push(kn.didDrawPage)}return tn}(tn,Jt,Je),xr=function lt(Et,Je){var Ft,Jt,tn,nn,vt,kn,ur,xr,tt,mt,Ht,Rt,dr,Bt,Qn=(0,on.parseSpacing)(Je.margin,40/Et.scaleFactor()),Ve=null!==(Ft=function Ie(Et,Je){var Ft=Et.getLastAutoTable(),Jt=Et.scaleFactor(),tn=Et.pageNumber(),nn=!1;return Ft&&Ft.startPageNumber&&(nn=Ft.startPageNumber+Ft.pageNumber-1===tn),"number"==typeof Je?Je:null!=Je&&!1!==Je||!nn||null==Ft?.finalY?null:Ft.finalY+20/Jt}(Et,Je.startY))&&void 0!==Ft?Ft:Qn.top;dr=!0===Je.showFoot?"everyPage":!1===Je.showFoot?"never":null!==(Jt=Je.showFoot)&&void 0!==Jt?Jt:"everyPage",Bt=!0===Je.showHead?"everyPage":!1===Je.showHead?"never":null!==(tn=Je.showHead)&&void 0!==tn?tn:"everyPage";var Ar=null!==(nn=Je.useCss)&&void 0!==nn&&nn,Rr=null!==(vt=Je.horizontalPageBreakRepeat)&&void 0!==vt?vt:null;return{includeHiddenHtml:null!==(kn=Je.includeHiddenHtml)&&void 0!==kn&&kn,useCss:Ar,theme:Je.theme||(Ar?"plain":"striped"),startY:Ve,margin:Qn,pageBreak:null!==(ur=Je.pageBreak)&&void 0!==ur?ur:"auto",rowPageBreak:null!==(xr=Je.rowPageBreak)&&void 0!==xr?xr:"auto",tableWidth:null!==(tt=Je.tableWidth)&&void 0!==tt?tt:"auto",showHead:Bt,showFoot:dr,tableLineWidth:null!==(mt=Je.tableLineWidth)&&void 0!==mt?mt:0,tableLineColor:null!==(Ht=Je.tableLineColor)&&void 0!==Ht?Ht:200,horizontalPageBreak:!!Je.horizontalPageBreak,horizontalPageBreakRepeat:Rr,horizontalPageBreakBehaviour:null!==(Rt=Je.horizontalPageBreakBehaviour)&&void 0!==Rt?Rt:"afterAllRows"}}(Ft,nn),tt=function Ze(Et,Je,Ft){var Jt=Je.head||[],tn=Je.body||[],nn=Je.foot||[];if(Je.html)if(Ft){var kn=(0,ir.parseHtml)(Et,Je.html,Ft,Je.includeHiddenHtml,Je.useCss)||{};Jt=kn.head||Jt,tn=kn.body||Jt,nn=kn.foot||Jt}else console.error("Cannot parse html in non browser environment");return{columns:Je.columns||_t(Jt,tn,nn),head:Jt,body:tn,foot:nn}}(Ft,nn,vt);return{id:Je.tableId,content:tt,hooks:ur,styles:kn,settings:xr}}},792:function(yr,pn){function ir(yn){yn.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),yn.minCellHeight||(yn.minCellHeight=yn.rowHeight)):yn.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),yn.cellWidth||(yn.cellWidth=yn.columnWidth))}Object.defineProperty(pn,"__esModule",{value:!0}),pn.default=function Tn(yn,on,Dn,ut){for(var Cn=function(Ie){Ie&&"object"!=typeof Ie&&console.error("The options parameter should be of type object, is: "+typeof Ie),typeof Ie.extendWidth<"u"&&(Ie.tableWidth=Ie.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof Ie.margins<"u"&&(typeof Ie.margin>"u"&&(Ie.margin=Ie.margins),console.error("Use of deprecated option: margins, use margin instead.")),Ie.startY&&"number"!=typeof Ie.startY&&(console.error("Invalid value for startY option",Ie.startY),delete Ie.startY),!Ie.didDrawPage&&(Ie.afterPageContent||Ie.beforePageContent||Ie.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),Ie.didDrawPage=function(nn){yn.applyStyles(yn.userStyles),Ie.beforePageContent&&Ie.beforePageContent(nn),yn.applyStyles(yn.userStyles),Ie.afterPageContent&&Ie.afterPageContent(nn),yn.applyStyles(yn.userStyles),Ie.afterPageAdd&&nn.pageNumber>1&&nn.afterPageAdd(nn),yn.applyStyles(yn.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(nn){Ie[nn]&&console.error('The "'.concat(nn,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(nn){var vt=nn[0],kn=nn[1];Ie[kn]&&(console.error("Use of deprecated option ".concat(kn,". Use ").concat(vt," instead")),Ie[vt]=Ie[kn])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(nn){var vt="string"==typeof nn?nn:nn[0],kn="string"==typeof nn?nn:nn[1];typeof Ie[vt]<"u"&&(typeof Ie.styles[kn]>"u"&&(Ie.styles[kn]=Ie[vt]),console.error("Use of deprecated option: "+vt+", use the style "+kn+" instead."))});for(var Ze=0,_t=["styles","bodyStyles","headStyles","footStyles"];Ze<_t.length;Ze++)ir(Ie[_t[Ze]]||{});for(var Je=Ie.columnStyles||{},Ft=0,Jt=Object.keys(Je);Ft<Jt.length;Ft++)ir(Je[Jt[Ft]]||{})},hn=0,Ot=[on,Dn,ut];hn<Ot.length;hn++)Cn(Ot[hn])}},260:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.Column=pn.Cell=pn.Row=pn.Table=void 0;var ir=Tn(796),yn=Tn(172),on=Tn(420),Dn=function(){function Ot(lt,Ie){this.pageNumber=1,this.pageCount=1,this.id=lt.id,this.settings=lt.settings,this.styles=lt.styles,this.hooks=lt.hooks,this.columns=Ie.columns,this.head=Ie.head,this.body=Ie.body,this.foot=Ie.foot}return Ot.prototype.getHeadHeight=function(lt){return this.head.reduce(function(Ie,Ze){return Ie+Ze.getMaxCellHeight(lt)},0)},Ot.prototype.getFootHeight=function(lt){return this.foot.reduce(function(Ie,Ze){return Ie+Ze.getMaxCellHeight(lt)},0)},Ot.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},Ot.prototype.callCellHooks=function(lt,Ie,Ze,_t,Et,Je){for(var Ft=0,Jt=Ie;Ft<Jt.length;Ft++){var vt=!1===(0,Jt[Ft])(new yn.CellHookData(lt,this,Ze,_t,Et,Je));if(Ze.text=Array.isArray(Ze.text)?Ze.text:[Ze.text],vt)return!1}return!0},Ot.prototype.callEndPageHooks=function(lt,Ie){lt.applyStyles(lt.userStyles);for(var Ze=0,_t=this.hooks.didDrawPage;Ze<_t.length;Ze++)(0,_t[Ze])(new yn.HookData(lt,this,Ie))},Ot.prototype.callWillDrawPageHooks=function(lt,Ie){for(var Ze=0,_t=this.hooks.willDrawPage;Ze<_t.length;Ze++)(0,_t[Ze])(new yn.HookData(lt,this,Ie))},Ot.prototype.getWidth=function(lt){if("number"==typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce(function(_t,Et){return _t+Et.wrappedWidth},0);var Ze=this.settings.margin;return lt-Ze.left-Ze.right},Ot}();pn.Table=Dn;var ut=function(){function Ot(lt,Ie,Ze,_t,Et){void 0===Et&&(Et=!1),this.height=0,this.raw=lt,lt instanceof ir.HtmlRowInput&&(this.raw=lt._element,this.element=lt._element),this.index=Ie,this.section=Ze,this.cells=_t,this.spansMultiplePages=Et}return Ot.prototype.getMaxCellHeight=function(lt){var Ie=this;return lt.reduce(function(Ze,_t){var Et;return Math.max(Ze,(null===(Et=Ie.cells[_t.index])||void 0===Et?void 0:Et.height)||0)},0)},Ot.prototype.hasRowSpan=function(lt){var Ie=this;return lt.filter(function(Ze){var _t=Ie.cells[Ze.index];return!!_t&&_t.rowSpan>1}).length>0},Ot.prototype.canEntireRowFit=function(lt,Ie){return this.getMaxCellHeight(Ie)<=lt},Ot.prototype.getMinimumRowHeight=function(lt,Ie){var Ze=this;return lt.reduce(function(_t,Et){var Je=Ze.cells[Et.index];if(!Je)return 0;var Ft=Ie.getLineHeight(Je.styles.fontSize),tn=Je.padding("vertical")+Ft;return tn>_t?tn:_t},0)},Ot}();pn.Row=ut;var Cn=function(){function Ot(lt,Ie,Ze){var _t,Et;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=Ie,this.section=Ze,this.raw=lt;var Je=lt;null==lt||"object"!=typeof lt||Array.isArray(lt)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=lt.rowSpan||1,this.colSpan=lt.colSpan||1,Je=null!==(Et=null!==(_t=lt.content)&&void 0!==_t?_t:lt.title)&&void 0!==Et?Et:lt,lt._element&&(this.raw=lt._element)),this.text=(null!=Je?""+Je:"").split(/\r\n|\r|\n/g)}return Ot.prototype.getTextPos=function(){var lt,Ze;if("top"===this.styles.valign)lt=this.y+this.padding("top");else if("bottom"===this.styles.valign)lt=this.y+this.height-this.padding("bottom");else{var Ie=this.height-this.padding("vertical");lt=this.y+Ie/2+this.padding("top")}if("right"===this.styles.halign)Ze=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var _t=this.width-this.padding("horizontal");Ze=this.x+_t/2+this.padding("left")}else Ze=this.x+this.padding("left");return{x:Ze,y:lt}},Ot.prototype.getContentHeight=function(lt,Ie){void 0===Ie&&(Ie=1.15);var Et=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/lt*Ie)+this.padding("vertical");return Math.max(Et,this.styles.minCellHeight)},Ot.prototype.padding=function(lt){var Ie=(0,on.parseSpacing)(this.styles.cellPadding,0);return"vertical"===lt?Ie.top+Ie.bottom:"horizontal"===lt?Ie.left+Ie.right:Ie[lt]},Ot}();pn.Cell=Cn;var hn=function(){function Ot(lt,Ie,Ze){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=lt,this.raw=Ie,this.index=Ze}return Ot.prototype.getMaxCustomCellWidth=function(lt){for(var Ie=0,Ze=0,_t=lt.allRows();Ze<_t.length;Ze++){var Je=_t[Ze].cells[this.index];Je&&"number"==typeof Je.styles.cellWidth&&(Ie=Math.max(Ie,Je.styles.cellWidth))}return Ie},Ot}();pn.Column=hn},356:function(yr,pn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.assign=void 0,pn.assign=function Tn(ir,yn,on,Dn,ut){if(null==ir)throw new TypeError("Cannot convert undefined or null to object");for(var Cn=Object(ir),hn=1;hn<arguments.length;hn++){var Ot=arguments[hn];if(null!=Ot)for(var lt in Ot)Object.prototype.hasOwnProperty.call(Ot,lt)&&(Cn[lt]=Ot[lt])}return Cn}},972:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.createTable=void 0;var ir=Tn(744),yn=Tn(260),on=Tn(324),Dn=Tn(796),ut=Tn(356);function Ot(Et,Je,Ft,Jt,tn,nn){var vt={};return Je.map(function(ur,xr){for(var tt=0,mt={},Ht=0,Rt=0,Qn=0,Ve=Ft;Qn<Ve.length;Qn++){var dr=Ve[Qn];if(null==vt[dr.index]||0===vt[dr.index].left)if(0===Rt){var Bt,Ar={};"object"==typeof(Bt=Array.isArray(ur)?ur[dr.index-Ht-tt]:ur[dr.dataKey])&&!Array.isArray(Bt)&&(Ar=Bt?.styles||{});var Dr=_t(Et,dr,xr,tn,Jt,nn,Ar),wn=new yn.Cell(Bt,Dr,Et);mt[dr.dataKey]=wn,mt[dr.index]=wn,vt[dr.index]={left:wn.rowSpan-1,times:Rt=wn.colSpan-1}}else Rt--,Ht++;else vt[dr.index].left--,Rt=vt[dr.index].times,tt++}return new yn.Row(ur,xr,Et,mt)})}function lt(Et,Je){var Ft={};return Et.forEach(function(Jt){if(null!=Jt.raw){var tn=function Ie(Et,Je){if("head"===Et){if("object"==typeof Je)return Je.header||Je.title||null;if("string"==typeof Je||"number"==typeof Je)return Je}else if("foot"===Et&&"object"==typeof Je)return Je.footer;return null}(Je,Jt.raw);null!=tn&&(Ft[Jt.dataKey]=tn)}}),Object.keys(Ft).length>0?Ft:null}function _t(Et,Je,Ft,Jt,tn,nn,vt){var ur,kn=(0,Dn.getTheme)(Jt);"head"===Et?ur=tn.headStyles:"body"===Et?ur=tn.bodyStyles:"foot"===Et&&(ur=tn.footStyles);var xr=(0,ut.assign)({},kn.table,kn[Et],tn.styles,ur),mt="body"===Et&&(tn.columnStyles[Je.dataKey]||tn.columnStyles[Je.index])||{},Ht="body"===Et&&Ft%2==0?(0,ut.assign)({},kn.alternateRow,tn.alternateRowStyles):{},Rt=(0,Dn.defaultStyles)(nn),Qn=(0,ut.assign)({},Rt,xr,Ht,mt);return(0,ut.assign)(Qn,vt)}pn.createTable=function Cn(Et,Je){var Ft=new ir.DocHandler(Et),Jt=function hn(Et,Je){var tn,Ft=Et.content,Jt=function Ze(Et){return Et.map(function(Je,Ft){var Jt,tn,nn;return nn="object"==typeof Je&&null!==(tn=null!==(Jt=Je.dataKey)&&void 0!==Jt?Jt:Je.key)&&void 0!==tn?tn:Ft,new yn.Column(nn,Je,Ft)})}(Ft.columns);0===Ft.head.length&&(tn=lt(Jt,"head"))&&Ft.head.push(tn),0===Ft.foot.length&&(tn=lt(Jt,"foot"))&&Ft.foot.push(tn);var nn=Et.settings.theme,vt=Et.styles;return{columns:Jt,head:Ot("head",Ft.head,Jt,vt,nn,Je),body:Ot("body",Ft.body,Jt,vt,nn,Je),foot:Ot("foot",Ft.foot,Jt,vt,nn,Je)}}(Je,Ft.scaleFactor()),tn=new yn.Table(Je,Jt);return(0,on.calculateWidths)(Ft,tn),Ft.applyStyles(Ft.userStyles),tn}},664:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.addPage=pn.drawTable=void 0;var ir=Tn(420),yn=Tn(260),on=Tn(744),Dn=Tn(356),ut=Tn(136),Cn=Tn(224);function lt(tt,mt,Ht,Rt){var Qn=mt.settings;tt.applyStyles(tt.userStyles),("firstPage"===Qn.showHead||"everyPage"===Qn.showHead)&&mt.head.forEach(function(Ve){return tn(tt,mt,Ve,Ht,Rt)})}function Ze(tt,mt,Ht,Rt,Qn,Ve){tt.applyStyles(tt.userStyles),Ve=Ve??mt.body.length;var dr=Math.min(Ht+Ve,mt.body.length),Bt=-1;return mt.body.slice(Ht,dr).forEach(function(Ar,Dr){var Rr=kn(tt,mt,Ht+Dr===mt.body.length-1,Rt);Ar.canEntireRowFit(Rr,Qn)&&(tn(tt,mt,Ar,Rt,Qn),Bt=Ht+Dr)}),Bt}function _t(tt,mt,Ht,Rt){var Qn=mt.settings;tt.applyStyles(tt.userStyles),("lastPage"===Qn.showFoot||"everyPage"===Qn.showFoot)&&mt.foot.forEach(function(Ve){return tn(tt,mt,Ve,Ht,Rt)})}function Et(tt,mt,Ht){var Rt=Ht.getLineHeight(tt.styles.fontSize),Qn=tt.padding("vertical"),Ve=Math.floor((mt-Qn)/Rt);return Math.max(0,Ve)}function Jt(tt,mt,Ht,Rt,Qn,Ve,dr){var Bt=kn(tt,mt,Rt,Ve);if(Ht.canEntireRowFit(Bt,dr))tn(tt,mt,Ht,Ve,dr);else if(function Ft(tt,mt,Ht,Rt){var Qn=tt.pageSize().height,Ve=Rt.settings.margin,Bt=Qn-(Ve.top+Ve.bottom);"body"===mt.section&&(Bt-=Rt.getHeadHeight(Rt.columns)+Rt.getFootHeight(Rt.columns));var Ar=mt.getMinimumRowHeight(Rt.columns,tt),Dr=Ar<Ht;if(Ar>Bt)return console.error("Will not be able to print row ".concat(mt.index," correctly since it's minimum height is larger than page height")),!0;if(!Dr)return!1;var wn=mt.hasRowSpan(Rt.columns);return mt.getMaxCellHeight(Rt.columns)>Bt?(wn&&console.error("The content of row ".concat(mt.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(wn||"avoid"===Rt.settings.rowPageBreak)}(tt,Ht,Bt,mt)){var Ar=function Je(tt,mt,Ht,Rt){var Qn={};tt.spansMultiplePages=!0,tt.height=0;for(var Ve=0,dr=0,Bt=Ht.columns;dr<Bt.length;dr++)if(Dr=tt.cells[(Ar=Bt[dr]).index]){Array.isArray(Dr.text)||(Dr.text=[Dr.text]);var wn=new yn.Cell(Dr.raw,Dr.styles,Dr.section);(wn=(0,Dn.assign)(wn,Dr)).text=[];var Rr=Et(Dr,mt,Rt);Dr.text.length>Rr&&(wn.text=Dr.text.splice(Rr,Dr.text.length));var la=Rt.scaleFactor(),gr=Rt.getLineHeightFactor();Dr.contentHeight=Dr.getContentHeight(la,gr),Dr.contentHeight>=mt&&(Dr.contentHeight=mt,wn.styles.minCellHeight-=mt),Dr.contentHeight>tt.height&&(tt.height=Dr.contentHeight),wn.contentHeight=wn.getContentHeight(la,gr),wn.contentHeight>Ve&&(Ve=wn.contentHeight),Qn[Ar.index]=wn}var Xs=new yn.Row(tt.raw,-1,tt.section,Qn,!0);Xs.height=Ve;for(var Mc=0,Ul=Ht.columns;Mc<Ul.length;Mc++){var Ar,Dr;(wn=Xs.cells[(Ar=Ul[Mc]).index])&&(wn.height=Xs.height),(Dr=tt.cells[Ar.index])&&(Dr.height=tt.height)}return Xs}(Ht,Bt,mt,tt);tn(tt,mt,Ht,Ve,dr),ur(tt,mt,Qn,Ve,dr),Jt(tt,mt,Ar,Rt,Qn,Ve,dr)}else ur(tt,mt,Qn,Ve,dr),Jt(tt,mt,Ht,Rt,Qn,Ve,dr)}function tn(tt,mt,Ht,Rt,Qn){Rt.x=mt.settings.margin.left;for(var Ve=0,dr=Qn;Ve<dr.length;Ve++){var Bt=dr[Ve],Ar=Ht.cells[Bt.index];if(Ar)if(tt.applyStyles(Ar.styles),Ar.x=Rt.x,Ar.y=Rt.y,!1!==mt.callCellHooks(tt,mt.hooks.willDrawCell,Ar,Ht,Bt,Rt)){nn(tt,Ar,Rt);var wn=Ar.getTextPos();(0,ut.default)(Ar.text,wn.x,wn.y,{halign:Ar.styles.halign,valign:Ar.styles.valign,maxWidth:Math.ceil(Ar.width-Ar.padding("left")-Ar.padding("right"))},tt.getDocument()),mt.callCellHooks(tt,mt.hooks.didDrawCell,Ar,Ht,Bt,Rt),Rt.x+=Bt.width}else Rt.x+=Bt.width;else Rt.x+=Bt.width}Rt.y+=Ht.height}function nn(tt,mt,Ht){var Rt=mt.styles;if(tt.getDocument().setFillColor(tt.getDocument().getFillColor()),"number"==typeof Rt.lineWidth){var Qn=(0,ir.getFillStyle)(Rt.lineWidth,Rt.fillColor);Qn&&tt.rect(mt.x,Ht.y,mt.width,mt.height,Qn)}else"object"==typeof Rt.lineWidth&&(Rt.fillColor&&tt.rect(mt.x,Ht.y,mt.width,mt.height,"F"),function vt(tt,mt,Ht,Rt){var Qn,Ve,dr,Bt;function Ar(Dr,wn,Rr,la,gr){tt.getDocument().setLineWidth(Dr),tt.getDocument().line(wn,Rr,la,gr,"S")}Rt.top&&(Qn=Ht.x,dr=Ht.x+mt.width,Rt.right&&(dr+=.5*Rt.right),Rt.left&&(Qn-=.5*Rt.left),Ar(Rt.top,Qn,Ve=Ht.y,dr,Bt=Ht.y)),Rt.bottom&&(Qn=Ht.x,dr=Ht.x+mt.width,Rt.right&&(dr+=.5*Rt.right),Rt.left&&(Qn-=.5*Rt.left),Ar(Rt.bottom,Qn,Ve=Ht.y+mt.height,dr,Bt=Ht.y+mt.height)),Rt.left&&(Ve=Ht.y,Bt=Ht.y+mt.height,Rt.top&&(Ve-=.5*Rt.top),Rt.bottom&&(Bt+=.5*Rt.bottom),Ar(Rt.left,Qn=Ht.x,Ve,dr=Ht.x,Bt)),Rt.right&&(Ve=Ht.y,Bt=Ht.y+mt.height,Rt.top&&(Ve-=.5*Rt.top),Rt.bottom&&(Bt+=.5*Rt.bottom),Ar(Rt.right,Qn=Ht.x+mt.width,Ve,dr=Ht.x+mt.width,Bt))}(tt,mt,Ht,Rt.lineWidth))}function kn(tt,mt,Ht,Rt){var Qn=mt.settings.margin.bottom,Ve=mt.settings.showFoot;return("everyPage"===Ve||"lastPage"===Ve&&Ht)&&(Qn+=mt.getFootHeight(mt.columns)),tt.pageSize().height-Rt.y-Qn}function ur(tt,mt,Ht,Rt,Qn,Ve){void 0===Qn&&(Qn=[]),void 0===Ve&&(Ve=!1),tt.applyStyles(tt.userStyles),"everyPage"===mt.settings.showFoot&&!Ve&&mt.foot.forEach(function(Bt){return tn(tt,mt,Bt,Rt,Qn)}),mt.callEndPageHooks(tt,Rt);var dr=mt.settings.margin;(0,ir.addTableBorder)(tt,mt,Ht,Rt),xr(tt),mt.pageNumber++,mt.pageCount++,Rt.x=dr.left,Rt.y=dr.top,Ht.y=dr.top,mt.callWillDrawPageHooks(tt,Rt),"everyPage"===mt.settings.showHead&&(mt.head.forEach(function(Bt){return tn(tt,mt,Bt,Rt,Qn)}),tt.applyStyles(tt.userStyles))}function xr(tt){var mt=tt.pageNumber();return tt.setPage(mt+1),tt.pageNumber()===mt&&(tt.addPage(),!0)}pn.drawTable=function hn(tt,mt){var Ht=mt.settings,Rt=Ht.startY,Qn=Ht.margin,Ve={x:Qn.left,y:Rt},dr=mt.getHeadHeight(mt.columns)+mt.getFootHeight(mt.columns),Bt=Rt+Qn.bottom+dr;"avoid"===Ht.pageBreak&&(Bt+=mt.body.reduce(function(la,gr){return la+gr.height},0));var wn=new on.DocHandler(tt);("always"===Ht.pageBreak||null!=Ht.startY&&Bt>wn.pageSize().height)&&(xr(wn),Ve.y=Qn.top),mt.callWillDrawPageHooks(wn,Ve);var Rr=(0,Dn.assign)({},Ve);mt.startPageNumber=wn.pageNumber(),Ht.horizontalPageBreak?function Ot(tt,mt,Ht,Rt){var Qn=(0,Cn.calculateAllColumnsCanFitInPage)(tt,mt);if("afterAllRows"===mt.settings.horizontalPageBreakBehaviour)Qn.forEach(function(Dr,wn){tt.applyStyles(tt.userStyles),wn>0?ur(tt,mt,Ht,Rt,Dr.columns,!0):lt(tt,mt,Rt,Dr.columns),function Ie(tt,mt,Ht,Rt,Qn){tt.applyStyles(tt.userStyles),mt.body.forEach(function(Ve,dr){Jt(tt,mt,Ve,dr===mt.body.length-1,Ht,Rt,Qn)})}(tt,mt,Ht,Rt,Dr.columns),_t(tt,mt,Rt,Dr.columns)});else for(var dr=-1,Bt=Qn[0],Ar=function(){var Dr=dr;if(Bt){tt.applyStyles(tt.userStyles);var wn=Bt.columns;dr>=0?ur(tt,mt,Ht,Rt,wn,!0):lt(tt,mt,Rt,wn),Dr=Ze(tt,mt,dr+1,Rt,wn),_t(tt,mt,Rt,wn)}var Rr=Dr-dr;Qn.slice(1).forEach(function(la){tt.applyStyles(tt.userStyles),ur(tt,mt,Ht,Rt,la.columns,!0),Ze(tt,mt,dr+1,Rt,la.columns,Rr),_t(tt,mt,Rt,la.columns)}),dr=Dr};dr<mt.body.length-1;)Ar()}(wn,mt,Rr,Ve):(wn.applyStyles(wn.userStyles),("firstPage"===Ht.showHead||"everyPage"===Ht.showHead)&&mt.head.forEach(function(la){return tn(wn,mt,la,Ve,mt.columns)}),wn.applyStyles(wn.userStyles),mt.body.forEach(function(la,gr){Jt(wn,mt,la,gr===mt.body.length-1,Rr,Ve,mt.columns)}),wn.applyStyles(wn.userStyles),("lastPage"===Ht.showFoot||"everyPage"===Ht.showFoot)&&mt.foot.forEach(function(la){return tn(wn,mt,la,Ve,mt.columns)})),(0,ir.addTableBorder)(wn,mt,Rr,Ve),mt.callEndPageHooks(wn,Ve),mt.finalY=Ve.y,tt.lastAutoTable=mt,tt.previousAutoTable=mt,tt.autoTable&&(tt.autoTable.previous=mt),wn.applyStyles(wn.userStyles)},pn.addPage=ur},224:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.calculateAllColumnsCanFitInPage=void 0;var ir=Tn(420);function yn(Dn,ut,Cn){var hn;void 0===Cn&&(Cn={});var Ot=(0,ir.getPageAvailableWidth)(Dn,ut),lt=new Map,Ie=[],Ze=[],_t=[];Array.isArray(ut.settings.horizontalPageBreakRepeat)?_t=ut.settings.horizontalPageBreakRepeat:("string"==typeof ut.settings.horizontalPageBreakRepeat||"number"==typeof ut.settings.horizontalPageBreakRepeat)&&(_t=[ut.settings.horizontalPageBreakRepeat]),_t.forEach(function(Jt){var tn=ut.columns.find(function(nn){return nn.dataKey===Jt||nn.index===Jt});tn&&!lt.has(tn.index)&&(lt.set(tn.index,!0),Ie.push(tn.index),Ze.push(ut.columns[tn.index]),Ot-=tn.wrappedWidth)});for(var Et=!0,Je=null!==(hn=Cn?.start)&&void 0!==hn?hn:0;Je<ut.columns.length;)if(lt.has(Je))Je++;else{var Ft=ut.columns[Je].wrappedWidth;if(!(Et||Ot>=Ft))break;Et=!1,Ie.push(Je),Ze.push(ut.columns[Je]),Ot-=Ft,Je++}return{colIndexes:Ie,columns:Ze,lastIndex:Je-1}}pn.calculateAllColumnsCanFitInPage=function on(Dn,ut){for(var Cn=[],hn=0;hn<ut.columns.length;hn++){var Ot=yn(Dn,ut,{start:hn});Ot.columns.length&&(Cn.push(Ot),hn=Ot.lastIndex)}return Cn}},324:function(yr,pn,Tn){Object.defineProperty(pn,"__esModule",{value:!0}),pn.ellipsize=pn.resizeColumns=pn.calculateWidths=void 0;var ir=Tn(420);function Dn(Ie,Ze,_t){for(var Et=Ze,Je=Ie.reduce(function(tt,mt){return tt+mt.wrappedWidth},0),Ft=0;Ft<Ie.length;Ft++){var Jt=Ie[Ft],vt=Jt.width+Et*(Jt.wrappedWidth/Je),kn=_t(Jt),ur=vt<kn?kn:vt;Ze-=ur-Jt.width,Jt.width=ur}if(Ze=Math.round(1e10*Ze)/1e10){var xr=Ie.filter(function(tt){return!(Ze<0)||tt.width>_t(tt)});xr.length&&(Ze=Dn(xr,Ze,_t))}return Ze}function Ot(Ie,Ze,_t,Et,Je){return Ie.map(function(Ft){return function lt(Ie,Ze,_t,Et,Je){var Ft=1e4*Et.scaleFactor();if((Ze=Math.ceil(Ze*Ft)/Ft)>=(0,ir.getStringWidth)(Ie,_t,Et))return Ie;for(;Ze<(0,ir.getStringWidth)(Ie+Je,_t,Et)&&!(Ie.length<=1);)Ie=Ie.substring(0,Ie.length-1);return Ie.trim()+Je}(Ft,Ze,_t,Et,Je)})}pn.calculateWidths=function yn(Ie,Ze){!function on(Ie,Ze){var _t=Ie.scaleFactor(),Et=Ze.settings.horizontalPageBreak,Je=(0,ir.getPageAvailableWidth)(Ie,Ze);Ze.allRows().forEach(function(Ft){for(var Jt=0,tn=Ze.columns;Jt<tn.length;Jt++){var nn=tn[Jt],vt=Ft.cells[nn.index];if(vt){Ze.callCellHooks(Ie,Ze.hooks.didParseCell,vt,Ft,nn,null);var ur=vt.padding("horizontal");vt.contentWidth=(0,ir.getStringWidth)(vt.text,vt.styles,Ie)+ur;var xr=(0,ir.getStringWidth)(vt.text.join(" ").split(/\s+/),vt.styles,Ie);vt.minReadableWidth=xr+vt.padding("horizontal"),"number"==typeof vt.styles.cellWidth?(vt.minWidth=vt.styles.cellWidth,vt.wrappedWidth=vt.styles.cellWidth):"wrap"===vt.styles.cellWidth||!0===Et?vt.contentWidth>Je?(vt.minWidth=Je,vt.wrappedWidth=Je):(vt.minWidth=vt.contentWidth,vt.wrappedWidth=vt.contentWidth):(vt.minWidth=vt.styles.minCellWidth||10/_t,vt.wrappedWidth=vt.contentWidth,vt.minWidth>vt.wrappedWidth&&(vt.wrappedWidth=vt.minWidth))}}}),Ze.allRows().forEach(function(Ft){for(var Jt=0,tn=Ze.columns;Jt<tn.length;Jt++){var nn=tn[Jt],vt=Ft.cells[nn.index];if(vt&&1===vt.colSpan)nn.wrappedWidth=Math.max(nn.wrappedWidth,vt.wrappedWidth),nn.minWidth=Math.max(nn.minWidth,vt.minWidth),nn.minReadableWidth=Math.max(nn.minReadableWidth,vt.minReadableWidth);else{var kn=Ze.styles.columnStyles[nn.dataKey]||Ze.styles.columnStyles[nn.index]||{},ur=kn.cellWidth||kn.minCellWidth;ur&&"number"==typeof ur&&(nn.minWidth=ur,nn.wrappedWidth=ur)}vt&&(vt.colSpan>1&&!nn.minWidth&&(nn.minWidth=vt.minWidth),vt.colSpan>1&&!nn.wrappedWidth&&(nn.wrappedWidth=vt.minWidth))}})}(Ie,Ze);var _t=[],Et=0;Ze.columns.forEach(function(Ft){var Jt=Ft.getMaxCustomCellWidth(Ze);Jt?Ft.width=Jt:(Ft.width=Ft.wrappedWidth,_t.push(Ft)),Et+=Ft.width});var Je=Ze.getWidth(Ie.pageSize().width)-Et;Je&&(Je=Dn(_t,Je,function(Ft){return Math.max(Ft.minReadableWidth,Ft.minWidth)})),Je&&(Je=Dn(_t,Je,function(Ft){return Ft.minWidth})),Je=Math.abs(Je),!Ze.settings.horizontalPageBreak&&Je>.1/Ie.scaleFactor()&&(Je=Je<1?Je:Math.round(Je),console.warn("Of the table content, ".concat(Je," units width could not fit page"))),function Cn(Ie){for(var Ze=Ie.allRows(),_t=0;_t<Ze.length;_t++)for(var Et=Ze[_t],Je=null,Ft=0,Jt=0,tn=0;tn<Ie.columns.length;tn++){var nn=Ie.columns[tn];if((Jt-=1)>1&&Ie.columns[tn+1])Ft+=nn.width,delete Et.cells[nn.index];else if(Je){var vt=Je;delete Et.cells[nn.index],Je=null,vt.width=nn.width+Ft}else{if(!(vt=Et.cells[nn.index]))continue;if(Jt=vt.colSpan,Ft=0,vt.colSpan>1){Je=vt,Ft+=nn.width;continue}vt.width=nn.width+Ft}}}(Ze),function hn(Ie,Ze){for(var _t={count:0,height:0},Et=0,Je=Ie.allRows();Et<Je.length;Et++){for(var Ft=Je[Et],Jt=0,tn=Ie.columns;Jt<tn.length;Jt++){var vt=Ft.cells[tn[Jt].index];if(vt){Ze.applyStyles(vt.styles,!0);var kn=vt.width-vt.padding("horizontal");if("linebreak"===vt.styles.overflow)vt.text=Ze.splitTextToSize(vt.text,kn+1/Ze.scaleFactor(),{fontSize:vt.styles.fontSize});else if("ellipsize"===vt.styles.overflow)vt.text=Ot(vt.text,kn,vt.styles,Ze,"...");else if("hidden"===vt.styles.overflow)vt.text=Ot(vt.text,kn,vt.styles,Ze,"");else if("function"==typeof vt.styles.overflow){var ur=vt.styles.overflow(vt.text,kn);vt.text="string"==typeof ur?[ur]:ur}vt.contentHeight=vt.getContentHeight(Ze.scaleFactor(),Ze.getLineHeightFactor());var xr=vt.contentHeight/vt.rowSpan;vt.rowSpan>1&&_t.count*_t.height<xr*vt.rowSpan?_t={height:xr,count:vt.rowSpan}:_t&&_t.count>0&&_t.height>xr&&(xr=_t.height),xr>Ft.height&&(Ft.height=xr)}}_t.count--}}(Ze,Ie),function ut(Ie){for(var Ze={},_t=1,Et=Ie.allRows(),Je=0;Je<Et.length;Je++)for(var Ft=Et[Je],Jt=0,tn=Ie.columns;Jt<tn.length;Jt++){var nn=tn[Jt],vt=Ze[nn.index];if(_t>1)_t--,delete Ft.cells[nn.index];else if(vt)vt.cell.height+=Ft.height,_t=vt.cell.colSpan,delete Ft.cells[nn.index],vt.left--,vt.left<=1&&delete Ze[nn.index];else{var kn=Ft.cells[nn.index];if(!kn)continue;if(kn.height=Ft.height,kn.rowSpan>1){var ur=Et.length-Je;Ze[nn.index]={cell:kn,left:kn.rowSpan>ur?ur:kn.rowSpan,row:Ft}}}}}(Ze)},pn.resizeColumns=Dn,pn.ellipsize=Ot},964:function(yr){if(typeof zn>"u"){var pn=new Error("Cannot find module 'undefined'");throw pn.code="MODULE_NOT_FOUND",pn}yr.exports=zn}},ga={};function Ur(yr){var pn=ga[yr];if(void 0!==pn)return pn.exports;var Tn=ga[yr]={exports:{}};return pl[yr].call(Tn.exports,Tn,Tn.exports,Ur),Tn.exports}var br={};return function(){var yr=br;Object.defineProperty(yr,"__esModule",{value:!0}),yr.Cell=yr.Column=yr.Row=yr.Table=yr.CellHookData=yr.__drawTable=yr.__createTable=yr.applyPlugin=void 0;var pn=Ur(340),Tn=Ur(776),ir=Ur(664),yn=Ur(972),on=Ur(260);Object.defineProperty(yr,"Table",{enumerable:!0,get:function(){return on.Table}});var Dn=Ur(172);Object.defineProperty(yr,"CellHookData",{enumerable:!0,get:function(){return Dn.CellHookData}});var ut=Ur(260);function Cn(Ze){(0,pn.default)(Ze)}Object.defineProperty(yr,"Cell",{enumerable:!0,get:function(){return ut.Cell}}),Object.defineProperty(yr,"Column",{enumerable:!0,get:function(){return ut.Column}}),Object.defineProperty(yr,"Row",{enumerable:!0,get:function(){return ut.Row}}),yr.applyPlugin=Cn,yr.__createTable=function Ot(Ze,_t){var Et=(0,Tn.parseInput)(Ze,_t);return(0,yn.createTable)(Ze,Et)},yr.__drawTable=function lt(Ze,_t){(0,ir.drawTable)(Ze,_t)};try{var Ie=Ur(964);Ie.jsPDF&&(Ie=Ie.jsPDF),Cn(Ie)}catch{}yr.default=function hn(Ze,_t){var Et=(0,Tn.parseInput)(Ze,_t),Je=(0,yn.createTable)(Ze,Et);(0,ir.drawTable)(Ze,Je)}}(),br}())},6166:(Md,Ys,qi)=>{"use strict";qi.r(Ys),qi.d(Ys,{AcroForm:()=>Hd,AcroFormAppearance:()=>Kn,AcroFormButton:()=>Da,AcroFormCheckBox:()=>qf,AcroFormChoiceField:()=>jd,AcroFormComboBox:()=>Vd,AcroFormEditBox:()=>$l,AcroFormListBox:()=>Vi,AcroFormPasswordField:()=>Ud,AcroFormPushButton:()=>lc,AcroFormRadioButton:()=>el,AcroFormTextField:()=>bu,GState:()=>Zh,ShadingPattern:()=>ed,TilingPattern:()=>Fs,default:()=>Lm,jsPDF:()=>Pr});var zn=qi(1002),Ur=Uint8Array,br=Uint16Array,yr=Uint32Array,pn=new Ur([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tn=new Ur([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ir=new Ur([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yn=function(_,p){for(var g=new br(31),b=0;b<31;++b)g[b]=p+=1<<_[b-1];var S=new yr(g[30]);for(b=1;b<30;++b)for(var x=g[b];x<g[b+1];++x)S[x]=x-g[b]<<5|b;return[g,S]},on=yn(pn,2),Dn=on[0],ut=on[1];Dn[28]=258,ut[258]=28;for(var Cn=yn(Tn,0),hn=Cn[0],Ot=Cn[1],lt=new br(32768),Ie=0;Ie<32768;++Ie){var Ze=(43690&Ie)>>>1|(21845&Ie)<<1;lt[Ie]=((65280&(Ze=(61680&(Ze=(52428&Ze)>>>2|(13107&Ze)<<2))>>>4|(3855&Ze)<<4))>>>8|(255&Ze)<<8)>>>1}var _t=function(_,p,g){for(var b=_.length,S=0,x=new br(p);S<b;++S)++x[_[S]-1];var P,M=new br(p);for(S=0;S<p;++S)M[S]=M[S-1]+x[S-1]<<1;if(g){P=new br(1<<p);var O=15-p;for(S=0;S<b;++S)if(_[S])for(var H=S<<4|_[S],Y=p-_[S],Q=M[_[S]-1]++<<Y,re=Q|(1<<Y)-1;Q<=re;++Q)P[lt[Q]>>>O]=H}else for(P=new br(b),S=0;S<b;++S)P[S]=lt[M[_[S]-1]++]>>>15-_[S];return P},Et=new Ur(288);for(Ie=0;Ie<144;++Ie)Et[Ie]=8;for(Ie=144;Ie<256;++Ie)Et[Ie]=9;for(Ie=256;Ie<280;++Ie)Et[Ie]=7;for(Ie=280;Ie<288;++Ie)Et[Ie]=8;var Je=new Ur(32);for(Ie=0;Ie<32;++Ie)Je[Ie]=5;var Ft=_t(Et,9,0),Jt=_t(Et,9,1),tn=_t(Je,5,0),nn=_t(Je,5,1),vt=function(_){for(var p=_[0],g=1;g<_.length;++g)_[g]>p&&(p=_[g]);return p},kn=function(_,p,g){var b=p/8>>0;return(_[b]|_[b+1]<<8)>>>(7&p)&g},ur=function(_,p){var g=p/8>>0;return(_[g]|_[g+1]<<8|_[g+2]<<16)>>>(7&p)},xr=function(_){return(_/8>>0)+(7&_&&1)},tt=function(_,p,g){(null==p||p<0)&&(p=0),(null==g||g>_.length)&&(g=_.length);var b=new(_ instanceof br?br:_ instanceof yr?yr:Ur)(g-p);return b.set(_.subarray(p,g)),b},mt=function(_,p,g){var b=_.length,S=!p||g,x=!g||g.i;g||(g={}),p||(p=new Ur(3*b));var M=function(Xe){var ft=p.length;if(Xe>ft){var ot=new Ur(Math.max(2*ft,Xe));ot.set(p),p=ot}},P=g.f||0,O=g.p||0,H=g.b||0,Y=g.l,Q=g.d,re=g.m,V=g.n,ve=8*b;do{if(!Y){g.f=P=kn(_,O,1);var ce=kn(_,O+1,3);if(O+=3,!ce){var se=_[(be=xr(O)+4)-4]|_[be-3]<<8,me=be+se;if(me>b){if(x)throw"unexpected EOF";break}S&&M(H+se),p.set(_.subarray(be,me),H),g.b=H+=se,g.p=O=8*me;continue}if(1==ce)Y=Jt,Q=nn,re=9,V=5;else{if(2!=ce)throw"invalid block type";var Be=kn(_,O,31)+257,st=kn(_,O+10,15)+4,At=Be+kn(_,O+5,31)+1;O+=14;for(var ln=new Ur(At),nt=new Ur(19),Oe=0;Oe<st;++Oe)nt[ir[Oe]]=kn(_,O+3*Oe,7);O+=3*st;var Kt=vt(nt),Yt=(1<<Kt)-1;if(!x&&O+At*(Kt+7)>ve)break;var fe=_t(nt,Kt,1);for(Oe=0;Oe<At;){var be,de=fe[kn(_,O,Yt)];if(O+=15&de,(be=de>>>4)<16)ln[Oe++]=be;else{var He=0,Ne=0;for(16==be?(Ne=3+kn(_,O,3),O+=2,He=ln[Oe-1]):17==be?(Ne=3+kn(_,O,7),O+=3):18==be&&(Ne=11+kn(_,O,127),O+=7);Ne--;)ln[Oe++]=He}}var Tt=ln.subarray(0,Be),St=ln.subarray(Be);re=vt(Tt),V=vt(St),Y=_t(Tt,re,1),Q=_t(St,V,1)}if(O>ve)throw"unexpected EOF"}S&&M(H+131072);for(var zt=(1<<re)-1,gt=(1<<V)-1,Zt=re+V+18;x||O+Zt<ve;){var Wt=(He=Y[ur(_,O)&zt])>>>4;if((O+=15&He)>ve)throw"unexpected EOF";if(!He)throw"invalid length/literal";if(Wt<256)p[H++]=Wt;else{if(256==Wt){Y=null;break}var Yn=Wt-254;Wt>264&&(Yn=kn(_,O,(1<<(J=pn[Oe=Wt-257]))-1)+Dn[Oe],O+=J);var we=Q[ur(_,O)&gt],Te=we>>>4;if(!we)throw"invalid distance";if(O+=15&we,St=hn[Te],Te>3){var J=Tn[Te];St+=ur(_,O)&(1<<J)-1,O+=J}if(O>ve)throw"unexpected EOF";S&&M(H+131072);for(var $e=H+Yn;H<$e;H+=4)p[H]=p[H-St],p[H+1]=p[H+1-St],p[H+2]=p[H+2-St],p[H+3]=p[H+3-St];H=$e}}g.l=Y,g.p=O,g.b=H,Y&&(P=1,g.m=re,g.d=Q,g.n=V)}while(!P);return H==p.length?p:tt(p,0,H)},Ht=function(_,p,g){var b=p/8>>0;_[b]|=g<<=7&p,_[b+1]|=g>>>8},Rt=function(_,p,g){var b=p/8>>0;_[b]|=g<<=7&p,_[b+1]|=g>>>8,_[b+2]|=g>>>16},Qn=function(_,p){for(var g=[],b=0;b<_.length;++b)_[b]&&g.push({s:b,f:_[b]});var S=g.length,x=g.slice();if(!S)return[new Ur(0),0];if(1==S){var M=new Ur(g[0].s+1);return M[g[0].s]=1,[M,1]}g.sort(function(At,ln){return At.f-ln.f}),g.push({s:-1,f:25001});var P=g[0],O=g[1],H=0,Y=1,Q=2;for(g[0]={s:-1,f:P.f+O.f,l:P,r:O};Y!=S-1;)P=g[g[H].f<g[Q].f?H++:Q++],O=g[H!=Y&&g[H].f<g[Q].f?H++:Q++],g[Y++]={s:-1,f:P.f+O.f,l:P,r:O};var re=x[0].s;for(b=1;b<S;++b)x[b].s>re&&(re=x[b].s);var V=new br(re+1),ve=Ve(g[Y-1],V,0);if(ve>p){b=0;var ce=0,be=ve-p,se=1<<be;for(x.sort(function(ln,nt){return V[nt.s]-V[ln.s]||ln.f-nt.f});b<S;++b){var me=x[b].s;if(!(V[me]>p))break;ce+=se-(1<<ve-V[me]),V[me]=p}for(ce>>>=be;ce>0;){var Be=x[b].s;V[Be]<p?ce-=1<<p-V[Be]++-1:++b}for(;b>=0&&ce;--b){var st=x[b].s;V[st]==p&&(--V[st],++ce)}ve=p}return[new Ur(V),ve]},Ve=function(_,p,g){return-1==_.s?Math.max(Ve(_.l,p,g+1),Ve(_.r,p,g+1)):p[_.s]=g},dr=function(_){for(var p=_.length;p&&!_[--p];);for(var g=new br(++p),b=0,S=_[0],x=1,M=function(O){g[b++]=O},P=1;P<=p;++P)if(_[P]==S&&P!=p)++x;else{if(!S&&x>2){for(;x>138;x-=138)M(32754);x>2&&(M(x>10?x-11<<5|28690:x-3<<5|12305),x=0)}else if(x>3){for(M(S),--x;x>6;x-=6)M(8304);x>2&&(M(x-3<<5|8208),x=0)}for(;x--;)M(S);x=1,S=_[P]}return[g.subarray(0,b),p]},Bt=function(_,p){for(var g=0,b=0;b<p.length;++b)g+=_[b]*p[b];return g},Ar=function(_,p,g){var b=g.length,S=xr(p+2);_[S]=255&b,_[S+1]=b>>>8,_[S+2]=255^_[S],_[S+3]=255^_[S+1];for(var x=0;x<b;++x)_[S+x+4]=g[x];return 8*(S+4+b)},Dr=function(_,p,g,b,S,x,M,P,O,H,Y){Ht(p,Y++,g),++S[256];for(var Q=Qn(S,15),re=Q[0],V=Q[1],ve=Qn(x,15),ce=ve[0],be=ve[1],se=dr(re),me=se[0],Be=se[1],st=dr(ce),At=st[0],ln=st[1],nt=new br(19),Oe=0;Oe<me.length;++Oe)nt[31&me[Oe]]++;for(Oe=0;Oe<At.length;++Oe)nt[31&At[Oe]]++;for(var Kt=Qn(nt,7),Yt=Kt[0],fe=Kt[1],de=19;de>4&&!Yt[ir[de-1]];--de);var St,zt,gt,Zt,He=H+5<<3,Ne=Bt(S,Et)+Bt(x,Je)+M,Tt=Bt(S,re)+Bt(x,ce)+M+14+3*de+Bt(nt,Yt)+(2*nt[16]+3*nt[17]+7*nt[18]);if(He<=Ne&&He<=Tt)return Ar(p,Y,_.subarray(O,O+H));if(Ht(p,Y,1+(Tt<Ne)),Y+=2,Tt<Ne){St=_t(re,V,0),zt=re,gt=_t(ce,be,0),Zt=ce;var Wt=_t(Yt,fe,0);for(Ht(p,Y,Be-257),Ht(p,Y+5,ln-1),Ht(p,Y+10,de-4),Y+=14,Oe=0;Oe<de;++Oe)Ht(p,Y+3*Oe,Yt[ir[Oe]]);Y+=3*de;for(var Yn=[me,At],J=0;J<2;++J){var we=Yn[J];for(Oe=0;Oe<we.length;++Oe)Ht(p,Y,Wt[Te=31&we[Oe]]),Y+=Yt[Te],Te>15&&(Ht(p,Y,we[Oe]>>>5&127),Y+=we[Oe]>>>12)}}else St=Ft,zt=Et,gt=tn,Zt=Je;for(Oe=0;Oe<P;++Oe)if(b[Oe]>255){var Te;Rt(p,Y,St[257+(Te=b[Oe]>>>18&31)]),Y+=zt[Te+257],Te>7&&(Ht(p,Y,b[Oe]>>>23&31),Y+=pn[Te]);var $e=31&b[Oe];Rt(p,Y,gt[$e]),Y+=Zt[$e],$e>3&&(Rt(p,Y,b[Oe]>>>5&8191),Y+=Tn[$e])}else Rt(p,Y,St[b[Oe]]),Y+=zt[b[Oe]];return Rt(p,Y,St[256]),Y+zt[256]},wn=new yr([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Rr=new Ur(0),Mc=function(){var _=1,p=0;return{p:function(g){for(var b=_,S=p,x=g.length,M=0;M!=x;){for(var P=Math.min(M+5552,x);M<P;++M)S+=b+=g[M];b%=65521,S%=65521}_=b,p=S},d:function(){return(_>>>8<<16|(255&p)<<8|p>>>8)+2*((255&_)<<23)}}},Ul=function(_,p,g,b,S){return function(_,p,g,b,S,x){var M=_.length,P=new Ur(b+M+5*(1+Math.floor(M/7e3))+S),O=P.subarray(b,P.length-S),H=0;if(!p||M<8)for(var Y=0;Y<=M;Y+=65535){var Q=Y+65535;Q<M?H=Ar(O,H,_.subarray(Y,Q)):(O[Y]=x,H=Ar(O,H,_.subarray(Y,M)))}else{for(var re=wn[p-1],V=re>>>13,ve=8191&re,ce=(1<<g)-1,be=new br(32768),se=new br(ce+1),me=Math.ceil(g/3),Be=2*me,st=function(jr){return(_[jr]^_[jr+1]<<me^_[jr+2]<<Be)&ce},At=new yr(25e3),ln=new br(288),nt=new br(32),Oe=0,Kt=0,Yt=(Y=0,0),fe=0,de=0;Y<M;++Y){var He=st(Y),Ne=32767&Y,Tt=se[He];if(be[Ne]=Tt,se[He]=Ne,fe<=Y){var St=M-Y;if((Oe>7e3||Yt>24576)&&St>423){H=Dr(_,O,0,At,ln,nt,Kt,Yt,de,Y-de,H),Yt=Oe=Kt=0,de=Y;for(var zt=0;zt<286;++zt)ln[zt]=0;for(zt=0;zt<30;++zt)nt[zt]=0}var gt=2,Zt=0,Wt=ve,Yn=Ne-Tt&32767;if(St>2&&He==st(Y-Yn))for(var J=Math.min(V,St)-1,we=Math.min(32767,Y),Te=Math.min(258,St);Yn<=we&&--Wt&&Ne!=Tt;){if(_[Y+gt]==_[Y+gt-Yn]){for(var $e=0;$e<Te&&_[Y+$e]==_[Y+$e-Yn];++$e);if($e>gt){if(gt=$e,Zt=Yn,$e>J)break;var Xe=Math.min(Yn,$e-2),ft=0;for(zt=0;zt<Xe;++zt){var ot=Y-Yn+zt+32768&32767,Rn=ot-be[ot]+32768&32767;Rn>ft&&(ft=Rn,Tt=ot)}}}Yn+=(Ne=Tt)-(Tt=be[Ne])+32768&32767}if(Zt){At[Yt++]=268435456|ut[gt]<<18|Ot[Zt];var gn=31&ut[gt],Xn=31&Ot[Zt];Kt+=pn[gn]+Tn[Xn],++ln[257+gn],++nt[Xn],fe=Y+gt,++Oe}else At[Yt++]=_[Y],++ln[_[Y]]}}H=Dr(_,O,x,At,ln,nt,Kt,Yt,de,Y-de,H),x||(H=Ar(O,H,Rr))}return tt(P,0,b+xr(H)+S)}(_,null==p.level?6:p.level,null==p.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(_.length)))):12+p.mem,g,b,!S)},jo=function(_,p,g){for(;g;++p)_[p]=g,g>>>=8},$h=function(_,p){var g=p.level,b=0==g?0:g<6?1:9==g?3:2;_[0]=120,_[1]=b<<6|(b?32-2*b:1)},Wh=function(_){if(8!=(15&_[0])||_[0]>>>4>7||(_[0]<<8|_[1])%31)throw"invalid zlib data";if(32&_[1])throw"invalid zlib data: preset dictionaries not supported"};function Od(_,p){void 0===p&&(p={});var g=Mc();g.p(_);var b=Ul(_,p,2,4);return $h(b,p),jo(b,b.length-4,g.d()),b}var Lr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Tm(){Lr.console&&"function"==typeof Lr.console.log&&Lr.console.log.apply(Lr.console,arguments)}var io={log:Tm,warn:function(_){Lr.console&&("function"==typeof Lr.console.warn?Lr.console.warn.apply(Lr.console,arguments):Tm.call(null,arguments))},error:function(_){Lr.console&&("function"==typeof Lr.console.error?Lr.console.error.apply(Lr.console,arguments):Tm(_))}};function Mm(_,p,g){var b=new XMLHttpRequest;b.open("GET",_),b.responseType="blob",b.onload=function(){Fc(b.response,p,g)},b.onerror=function(){io.error("could not download file")},b.send()}function w0(_){var p=new XMLHttpRequest;p.open("HEAD",_,!1);try{p.send()}catch{}return p.status>=200&&p.status<=299}function Br(_){try{_.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),_.dispatchEvent(p)}}var Ea,Yh,Fc=Lr.saveAs||("object"!==(typeof window>"u"?"undefined":(0,zn.Z)(window))||window!==Lr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(_,p,g){var b=Lr.URL||Lr.webkitURL,S=document.createElement("a");S.download=p=p||_.name||"download",S.rel="noopener","string"==typeof _?(S.href=_,S.origin!==location.origin?w0(S.href)?Mm(_,p,g):Br(S,S.target="_blank"):Br(S)):(S.href=b.createObjectURL(_),setTimeout(function(){b.revokeObjectURL(S.href)},4e4),setTimeout(function(){Br(S)},0))}:"msSaveOrOpenBlob"in navigator?function(_,p,g){if(p=p||_.name||"download","string"==typeof _)if(w0(_))Mm(_,p,g);else{var b=document.createElement("a");b.href=_,b.target="_blank",setTimeout(function(){Br(b)})}else navigator.msSaveOrOpenBlob((S=_,void 0===(x=g)?x={autoBom:!1}:"object"!==(0,zn.Z)(x)&&(io.warn("Deprecated: Expected third argument to be a object"),x={autoBom:!x}),x.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(S.type)?new Blob([String.fromCharCode(65279),S],{type:S.type}):S),p);var S,x}:function(_,p,g,b){if((b=b||open("","_blank"))&&(b.document.title=b.document.body.innerText="downloading..."),"string"==typeof _)return Mm(_,p,g);var S="application/octet-stream"===_.type,x=/constructor/i.test(Lr.HTMLElement)||Lr.safari,M=/CriOS\/[\d]+/.test(navigator.userAgent);if((M||S&&x)&&"object"===(typeof FileReader>"u"?"undefined":(0,zn.Z)(FileReader))){var P=new FileReader;P.onloadend=function(){var Y=P.result;Y=M?Y:Y.replace(/^data:[^;]*;/,"data:attachment/file;"),b?b.location.href=Y:location=Y,b=null},P.readAsDataURL(_)}else{var O=Lr.URL||Lr.webkitURL,H=O.createObjectURL(_);b?b.location=H:location.href=H,b=null,setTimeout(function(){O.revokeObjectURL(H)},4e4)}});function oo(_){var p;_=_||"",this.ok=!1,"#"==_.charAt(0)&&(_=_.substr(1,6)),_={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[_=(_=_.replace(/ /g,"")).toLowerCase()]||_;for(var g=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(P){return[parseInt(P[1]),parseInt(P[2]),parseInt(P[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(P){return[parseInt(P[1],16),parseInt(P[2],16),parseInt(P[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(P){return[parseInt(P[1]+P[1],16),parseInt(P[2]+P[2],16),parseInt(P[3]+P[3],16)]}}],b=0;b<g.length;b++){var x=g[b].process,M=g[b].re.exec(_);M&&(p=x(M),this.r=p[0],this.g=p[1],this.b=p[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var P=this.r.toString(16),O=this.g.toString(16),H=this.b.toString(16);return 1==P.length&&(P="0"+P),1==O.length&&(O="0"+O),1==H.length&&(H="0"+H),"#"+P+O+H}}function $f(_,p){var g=_[0],b=_[1],S=_[2],x=_[3];g=ca(g,b,S,x,p[0],7,-680876936),x=ca(x,g,b,S,p[1],12,-389564586),S=ca(S,x,g,b,p[2],17,606105819),b=ca(b,S,x,g,p[3],22,-1044525330),g=ca(g,b,S,x,p[4],7,-176418897),x=ca(x,g,b,S,p[5],12,1200080426),S=ca(S,x,g,b,p[6],17,-1473231341),b=ca(b,S,x,g,p[7],22,-45705983),g=ca(g,b,S,x,p[8],7,1770035416),x=ca(x,g,b,S,p[9],12,-1958414417),S=ca(S,x,g,b,p[10],17,-42063),b=ca(b,S,x,g,p[11],22,-1990404162),g=ca(g,b,S,x,p[12],7,1804603682),x=ca(x,g,b,S,p[13],12,-40341101),S=ca(S,x,g,b,p[14],17,-1502002290),g=ua(g,b=ca(b,S,x,g,p[15],22,1236535329),S,x,p[1],5,-165796510),x=ua(x,g,b,S,p[6],9,-1069501632),S=ua(S,x,g,b,p[11],14,643717713),b=ua(b,S,x,g,p[0],20,-373897302),g=ua(g,b,S,x,p[5],5,-701558691),x=ua(x,g,b,S,p[10],9,38016083),S=ua(S,x,g,b,p[15],14,-660478335),b=ua(b,S,x,g,p[4],20,-405537848),g=ua(g,b,S,x,p[9],5,568446438),x=ua(x,g,b,S,p[14],9,-1019803690),S=ua(S,x,g,b,p[3],14,-187363961),b=ua(b,S,x,g,p[8],20,1163531501),g=ua(g,b,S,x,p[13],5,-1444681467),x=ua(x,g,b,S,p[2],9,-51403784),S=ua(S,x,g,b,p[7],14,1735328473),g=Ir(g,b=ua(b,S,x,g,p[12],20,-1926607734),S,x,p[5],4,-378558),x=Ir(x,g,b,S,p[8],11,-2022574463),S=Ir(S,x,g,b,p[11],16,1839030562),b=Ir(b,S,x,g,p[14],23,-35309556),g=Ir(g,b,S,x,p[1],4,-1530992060),x=Ir(x,g,b,S,p[4],11,1272893353),S=Ir(S,x,g,b,p[7],16,-155497632),b=Ir(b,S,x,g,p[10],23,-1094730640),g=Ir(g,b,S,x,p[13],4,681279174),x=Ir(x,g,b,S,p[0],11,-358537222),S=Ir(S,x,g,b,p[3],16,-722521979),b=Ir(b,S,x,g,p[6],23,76029189),g=Ir(g,b,S,x,p[9],4,-640364487),x=Ir(x,g,b,S,p[12],11,-421815835),S=Ir(S,x,g,b,p[15],16,530742520),g=or(g,b=Ir(b,S,x,g,p[2],23,-995338651),S,x,p[0],6,-198630844),x=or(x,g,b,S,p[7],10,1126891415),S=or(S,x,g,b,p[14],15,-1416354905),b=or(b,S,x,g,p[5],21,-57434055),g=or(g,b,S,x,p[12],6,1700485571),x=or(x,g,b,S,p[3],10,-1894986606),S=or(S,x,g,b,p[10],15,-1051523),b=or(b,S,x,g,p[1],21,-2054922799),g=or(g,b,S,x,p[8],6,1873313359),x=or(x,g,b,S,p[15],10,-30611744),S=or(S,x,g,b,p[6],15,-1560198380),b=or(b,S,x,g,p[13],21,1309151649),g=or(g,b,S,x,p[4],6,-145523070),x=or(x,g,b,S,p[11],10,-1120210379),S=or(S,x,g,b,p[2],15,718787259),b=or(b,S,x,g,p[9],21,-343485551),_[0]=wi(g,_[0]),_[1]=wi(b,_[1]),_[2]=wi(S,_[2]),_[3]=wi(x,_[3])}function to(_,p,g,b,S,x){return p=wi(wi(p,_),wi(b,x)),wi(p<<S|p>>>32-S,g)}function ca(_,p,g,b,S,x,M){return to(p&g|~p&b,_,p,S,x,M)}function ua(_,p,g,b,S,x,M){return to(p&b|g&~b,_,p,S,x,M)}function Ir(_,p,g,b,S,x,M){return to(p^g^b,_,p,S,x,M)}function or(_,p,g,b,S,x,M){return to(g^(p|~b),_,p,S,x,M)}function Fo(_){var p,g=_.length,b=[1732584193,-271733879,-1732584194,271733878];for(p=64;p<=_.length;p+=64)$f(b,km(_.substring(p-64,p)));_=_.substring(p-64);var S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(p=0;p<_.length;p++)S[p>>2]|=_.charCodeAt(p)<<(p%4<<3);if(S[p>>2]|=128<<(p%4<<3),p>55)for($f(b,S),p=0;p<16;p++)S[p]=0;return S[14]=8*g,$f(b,S),b}function km(_){var p,g=[];for(p=0;p<64;p+=4)g[p>>2]=_.charCodeAt(p)+(_.charCodeAt(p+1)<<8)+(_.charCodeAt(p+2)<<16)+(_.charCodeAt(p+3)<<24);return g}Ea=Lr.atob.bind(Lr),Yh=Lr.btoa.bind(Lr);var T_="0123456789abcdef".split("");function Xh(_){for(var p="",g=0;g<4;g++)p+=T_[_>>8*g+4&15]+T_[_>>8*g&15];return p}function Vt(_){return String.fromCharCode((255&_)>>0,(65280&_)>>8,(16711680&_)>>16,(4278190080&_)>>24)}function Rd(_){return Fo(_).map(Vt).join("")}var ei="5d41402abc4b2a76b9719d911017c592"!=function(_){for(var p=0;p<_.length;p++)_[p]=Xh(_[p]);return _.join("")}(Fo("hello"));function wi(_,p){if(ei){var g=(65535&_)+(65535&p);return(_>>16)+(p>>16)+(g>>16)<<16|65535&g}return _+p&4294967295}function Kh(_,p){var g,b,S;if(_!==g){for(var M=(S=_,new Array(1+(256/_.length>>0)+1).join(S)),P=[],O=0;O<256;O++)P[O]=O;var H=0;for(O=0;O<256;O++){var Y=P[O];H=(H+Y+M.charCodeAt(O))%256,P[O]=P[H],P[H]=Y}g=_,b=P}else P=b;var Q=p.length,re=0,V=0,ve="";for(O=0;O<Q;O++)V=(V+(Y=P[re=(re+1)%256]))%256,P[re]=P[V],P[V]=Y,M=P[(P[re]+P[V])%256],ve+=String.fromCharCode(p.charCodeAt(O)^M);return ve}var M_={print:4,modify:8,copy:16,"annot-forms":32};function Ju(_,p,g,b){this.v=1,this.r=2;var S=192;_.forEach(function(P){if(void 0!==M_.perm)throw new Error("Invalid permission: "+P);S+=M_[P]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var x=(p+this.padding).substr(0,32),M=(g+this.padding).substr(0,32);this.O=this.processOwnerPassword(x,M),this.P=-(1+(255^S)),this.encryptionKey=Rd(x+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(b)).substr(0,5),this.U=Kh(this.encryptionKey,this.padding)}function Ic(_){if(/[^\u0000-\u00ff]/.test(_))throw new Error("Invalid PDF Name Object: "+_+", Only accept ASCII characters.");for(var p="",g=_.length,b=0;b<g;b++){var S=_.charCodeAt(b);p+=S<33||35===S||37===S||40===S||41===S||47===S||60===S||62===S||91===S||93===S||123===S||125===S||S>126?"#"+("0"+S.toString(16)).slice(-2):_[b]}return p}function ks(_){if("object"!==(0,zn.Z)(_))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var p={};this.subscribe=function(g,b,S){if(S=S||!1,"string"!=typeof g||"function"!=typeof b||"boolean"!=typeof S)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");p.hasOwnProperty(g)||(p[g]={});var x=Math.random().toString(35);return p[g][x]=[b,!!S],x},this.unsubscribe=function(g){for(var b in p)if(p[b][g])return delete p[b][g],0===Object.keys(p[b]).length&&delete p[b],!0;return!1},this.publish=function(g){if(p.hasOwnProperty(g)){var b=Array.prototype.slice.call(arguments,1),S=[];for(var x in p[g]){var M=p[g][x];try{M[0].apply(_,b)}catch(P){Lr.console&&io.error("jsPDF PubSub Error",P.message,P)}M[1]&&S.push(x)}S.length&&S.forEach(this.unsubscribe)}},this.getTopics=function(){return p}}function Zh(_){if(!(this instanceof Zh))return new Zh(_);var p="opacity,stroke-opacity".split(",");for(var g in _)_.hasOwnProperty(g)&&p.indexOf(g)>=0&&(this[g]=_[g]);this.id="",this.objectNumber=-1}function x0(_,p){this.gState=_,this.matrix=p,this.id="",this.objectNumber=-1}function ed(_,p,g,b,S){if(!(this instanceof ed))return new ed(_,p,g,b,S);this.type="axial"===_?2:3,this.coords=p,this.colors=g,x0.call(this,b,S)}function Fs(_,p,g,b,S){if(!(this instanceof Fs))return new Fs(_,p,g,b,S);this.boundingBox=_,this.xStep=p,this.yStep=g,this.stream="",this.cloneIndex=0,x0.call(this,b,S)}function Pr(_){var p,g="string"==typeof arguments[0]?arguments[0]:"p",b=arguments[1],S=arguments[2],x=arguments[3],M=[],P=1,O=16,H="S",Y=null;"object"===(0,zn.Z)(_=_||{})&&(g=_.orientation,b=_.unit||b,S=_.format||S,x=_.compress||_.compressPdf||x,null!==(Y=_.encryption||null)&&(Y.userPassword=Y.userPassword||"",Y.ownerPassword=Y.ownerPassword||"",Y.userPermissions=Y.userPermissions||[]),P="number"==typeof _.userUnit?Math.abs(_.userUnit):1,void 0!==_.precision&&(p=_.precision),void 0!==_.floatPrecision&&(O=_.floatPrecision),H=_.defaultPathOperation||"S"),M=_.filters||(!0===x?["FlateEncode"]:M),b=b||"mm",g=(""+(g||"P")).toLowerCase();var Q=_.putOnlyUsedFonts||!1,re={},V={internal:{},__private__:{}};V.__private__.PubSub=ks;var ve="1.3",ce=V.__private__.getPdfVersion=function(){return ve};V.__private__.setPdfVersion=function(A){ve=A};var be={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};V.__private__.getPageFormats=function(){return be};var se=V.__private__.getPageFormat=function(A){return be[A]};S=S||"a4";var me={COMPAT:"compat",ADVANCED:"advanced"},Be=me.COMPAT;function st(){this.saveGraphicsState(),Me(new mr(Jn,0,0,-Jn,0,Yl()*Jn).toString()+" cm"),this.setFontSize(this.getFontSize()/Jn),H="n",Be=me.ADVANCED}function At(){this.restoreGraphicsState(),H="S",Be=me.COMPAT}var ln=V.__private__.combineFontStyleAndFontWeight=function(A,U){if("bold"==A&&"normal"==U||"bold"==A&&400==U||"normal"==A&&"italic"==U||"bold"==A&&"italic"==U)throw new Error("Invalid Combination of fontweight and fontstyle");return U&&(A=400==U||"normal"===U?"italic"===A?"italic":"normal":700!=U&&"bold"!==U||"normal"!==A?(700==U?"bold":U)+""+A:"bold"),A};V.advancedAPI=function(A){var U=Be===me.COMPAT;return U&&st.call(this),"function"!=typeof A||(A(this),U&&At.call(this)),this},V.compatAPI=function(A){var U=Be===me.ADVANCED;return U&&At.call(this),"function"!=typeof A||(A(this),U&&st.call(this)),this},V.isAdvancedAPI=function(){return Be===me.ADVANCED};var nt,Oe=function(A){if(Be!==me.ADVANCED)throw new Error(A+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Kt=V.roundToPrecision=V.__private__.roundToPrecision=function(A,U){var xe=p||U;if(isNaN(A)||isNaN(xe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return A.toFixed(xe).replace(/0+$/,"")};nt=V.hpf=V.__private__.hpf="number"==typeof O?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return Kt(A,O)}:"smart"===O?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return Kt(A,A>-1&&A<1?16:5)}:function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return Kt(A,16)};var Yt=V.f2=V.__private__.f2=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f2");return Kt(A,2)},fe=V.__private__.f3=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f3");return Kt(A,3)},de=V.scale=V.__private__.scale=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.scale");return Be===me.COMPAT?A*Jn:Be===me.ADVANCED?A:void 0},Ne=function(A){return de(function(A){return Be===me.COMPAT?Yl()-A:Be===me.ADVANCED?A:void 0}(A))};V.__private__.setPrecision=V.setPrecision=function(A){"number"==typeof parseInt(A,10)&&(p=parseInt(A,10))};var Tt,St="00000000000000000000000000000000",zt=V.__private__.getFileId=function(){return St},gt=V.__private__.setFileId=function(A){return St=void 0!==A&&/^[a-fA-F0-9]{32}$/.test(A)?A.toUpperCase():St.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==Y&&(il=new Ju(Y.userPermissions,Y.userPassword,Y.ownerPassword,St)),St};V.setFileId=function(A){return gt(A),this},V.getFileId=function(){return zt()};var Zt=V.__private__.convertDateToPDFDate=function(A){var U=A.getTimezoneOffset(),xe=U<0?"+":"-",je=Math.floor(Math.abs(U/60)),rt=Math.abs(U%60),jt=[xe,Te(je),"'",Te(rt),"'"].join("");return["D:",A.getFullYear(),Te(A.getMonth()+1),Te(A.getDate()),Te(A.getHours()),Te(A.getMinutes()),Te(A.getSeconds()),jt].join("")},Wt=V.__private__.convertPDFDateToDate=function(A){var U=parseInt(A.substr(2,4),10),xe=parseInt(A.substr(6,2),10)-1,je=parseInt(A.substr(8,2),10),rt=parseInt(A.substr(10,2),10),jt=parseInt(A.substr(12,2),10),xn=parseInt(A.substr(14,2),10);return new Date(U,xe,je,rt,jt,xn,0)},Yn=V.__private__.setCreationDate=function(A){var U;if(void 0===A&&(A=new Date),A instanceof Date)U=Zt(A);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(A))throw new Error("Invalid argument passed to jsPDF.setCreationDate");U=A}return Tt=U},J=V.__private__.getCreationDate=function(A){var U=Tt;return"jsDate"===A&&(U=Wt(Tt)),U};V.setCreationDate=function(A){return Yn(A),this},V.getCreationDate=function(A){return J(A)};var we,Te=V.__private__.padd2=function(A){return("0"+parseInt(A)).slice(-2)},$e=V.__private__.padd2Hex=function(A){return("00"+(A=A.toString())).substr(A.length)},Xe=0,ft=[],ot=[],bt=0,Rn=[],gn=[],Xn=!1,tr=ot;V.__private__.setCustomOutputDestination=function(A){Xn=!0,tr=A};var Lt=function(A){Xn||(tr=A)};V.__private__.resetCustomOutputDestination=function(){Xn=!1,tr=ot};var Me=V.__private__.out=function(A){return A=A.toString(),bt+=A.length+1,tr.push(A),tr},ti=V.__private__.write=function(A){return Me(1===arguments.length?A.toString():Array.prototype.join.call(arguments," "))},fr=V.__private__.getArrayBuffer=function(A){for(var U=A.length,xe=new ArrayBuffer(U),je=new Uint8Array(xe);U--;)je[U]=A.charCodeAt(U);return xe},B=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];V.__private__.getStandardFonts=function(){return B};var C=_.fontSize||16;V.__private__.setFontSize=V.setFontSize=function(A){return C=Be===me.ADVANCED?A/Jn:A,this};var F,j=V.__private__.getFontSize=V.getFontSize=function(){return Be===me.COMPAT?C:C*Jn},le=_.R2L||!1;V.__private__.setR2L=V.setR2L=function(A){return le=A,this},V.__private__.getR2L=V.getR2L=function(){return le};var et,cn=V.__private__.setZoomMode=function(A){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(A))F=A;else if(isNaN(A)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(A))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+A+'" is not recognized.');F=A}else F=parseInt(A,10)};V.__private__.getZoomMode=function(){return F};var In,nr=V.__private__.setPageMode=function(A){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(A))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+A+'" is not recognized.');et=A};V.__private__.getPageMode=function(){return et};var Or=V.__private__.setLayoutMode=function(A){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(A))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+A+'" is not recognized.');In=A};V.__private__.getLayoutMode=function(){return In},V.__private__.setDisplayMode=V.setDisplayMode=function(A,U,xe){return cn(A),Or(U),nr(xe),this};var wr={title:"",subject:"",author:"",keywords:"",creator:""};V.__private__.getDocumentProperty=function(A){if(-1===Object.keys(wr).indexOf(A))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return wr[A]},V.__private__.getDocumentProperties=function(){return wr},V.__private__.setDocumentProperties=V.setProperties=V.setDocumentProperties=function(A){for(var U in wr)wr.hasOwnProperty(U)&&A[U]&&(wr[U]=A[U]);return this},V.__private__.setDocumentProperty=function(A,U){if(-1===Object.keys(wr).indexOf(A))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return wr[A]=U};var Hr,Jn,Ua,Xi,rs,po={},Io={},Tr=[],no={},sp={},fa={},Nc={},ad=null,ta=0,ai=[],ao=new ks(V),fn=_.hotfixes||[],zr={},ht={},pt=[],mr=function A(U,xe,je,rt,jt,xn){if(!(this instanceof A))return new A(U,xe,je,rt,jt,xn);isNaN(U)&&(U=1),isNaN(xe)&&(xe=0),isNaN(je)&&(je=0),isNaN(rt)&&(rt=1),isNaN(jt)&&(jt=0),isNaN(xn)&&(xn=0),this._matrix=[U,xe,je,rt,jt,xn]};Object.defineProperty(mr.prototype,"sx",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(mr.prototype,"shy",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(mr.prototype,"shx",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(mr.prototype,"sy",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(mr.prototype,"tx",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(mr.prototype,"ty",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(mr.prototype,"a",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(mr.prototype,"b",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(mr.prototype,"c",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(mr.prototype,"d",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(mr.prototype,"e",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(mr.prototype,"f",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(mr.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mr.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mr.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mr.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),mr.prototype.join=function(A){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(nt).join(A)},mr.prototype.multiply=function(A){return new mr(A.sx*this.sx+A.shy*this.shx,A.sx*this.shy+A.shy*this.sy,A.shx*this.sx+A.sy*this.shx,A.shx*this.shy+A.sy*this.sy,A.tx*this.sx+A.ty*this.shx+this.tx,A.tx*this.shy+A.ty*this.sy+this.ty)},mr.prototype.decompose=function(){var A=this.sx,U=this.shy,xe=this.shx,je=this.sy,rt=this.tx,jt=this.ty,xn=Math.sqrt(A*A+U*U),sr=(A/=xn)*xe+(U/=xn)*je;xe-=A*sr,je-=U*sr;var Mr=Math.sqrt(xe*xe+je*je);return sr/=Mr,A*(je/=Mr)<U*(xe/=Mr)&&(A=-A,U=-U,sr=-sr,xn=-xn),{scale:new mr(xn,0,0,Mr,0,0),translate:new mr(1,0,0,1,rt,jt),rotate:new mr(A,U,-U,A,0,0),skew:new mr(1,0,sr,1,0,0)}},mr.prototype.toString=function(A){return this.join(" ")},mr.prototype.inversed=function(){var A=this.sx,U=this.shy,xe=this.shx,je=this.sy,rt=this.tx,jt=this.ty,xn=1/(A*je-U*xe),sr=je*xn,Mr=-U*xn,Zr=-xe*xn,xi=A*xn;return new mr(sr,Mr,Zr,xi,-sr*rt-Zr*jt,-Mr*rt-xi*jt)},mr.prototype.applyToPoint=function(A){return new Cp(A.x*this.sx+A.y*this.shx+this.tx,A.x*this.shy+A.y*this.sy+this.ty)},mr.prototype.applyToRectangle=function(A){var U=this.applyToPoint(A),xe=this.applyToPoint(new Cp(A.x+A.w,A.y+A.h));return new Ep(U.x,U.y,xe.x-U.x,xe.y-U.y)},mr.prototype.clone=function(){return new mr(this.sx,this.shy,this.shx,this.sy,this.tx,this.ty)},V.Matrix=mr;var uc=V.matrixMult=function(A,U){return U.multiply(A)},yl=new mr(1,0,0,1,0,0);V.unitMatrix=V.identityMatrix=yl;var na=function(A,U){if(!sp[A]){var xe=(U instanceof ed?"Sh":"P")+(Object.keys(no).length+1).toString(10);U.id=xe,sp[A]=xe,no[xe]=U,ao.publish("addPattern",U)}};V.ShadingPattern=ed,V.TilingPattern=Fs,V.addShadingPattern=function(A,U){return Oe("addShadingPattern()"),na(A,U),this},V.beginTilingPattern=function(A){Oe("beginTilingPattern()"),ud(A.boundingBox[0],A.boundingBox[1],A.boundingBox[2]-A.boundingBox[0],A.boundingBox[3]-A.boundingBox[1],A.matrix)},V.endTilingPattern=function(A,U){Oe("endTilingPattern()"),U.stream=gn[we].join("\n"),na(A,U),ao.publish("endTilingPattern",U),pt.pop().restore()};var A,_a=V.__private__.newObject=function(){var A=ha();return Gl(A,!0),A},ha=V.__private__.newObjectDeferred=function(){return Xe++,ft[Xe]=function(){return bt},Xe},Gl=function(A,U){return U="boolean"==typeof U&&U,ft[A]=bt,U&&Me(A+" 0 obj"),A},Bm=V.__private__.newAdditionalObject=function(){var A={objId:ha(),content:""};return Rn.push(A),A},wu=ha(),Ho=ha(),Ha=V.__private__.decodeColorString=function(A){var U=A.split(" ");if(2!==U.length||"g"!==U[1]&&"G"!==U[1])5===U.length&&("k"===U[4]||"K"===U[4])&&(U=[(1-U[0])*(1-U[3]),(1-U[1])*(1-U[3]),(1-U[2])*(1-U[3]),"r"]);else{var xe=parseFloat(U[0]);U=[xe,xe,xe,"r"]}for(var je="#",rt=0;rt<3;rt++)je+=("0"+Math.floor(255*parseFloat(U[rt])).toString(16)).slice(-2);return je},dc=V.__private__.encodeColorString=function(A){var U;"string"==typeof A&&(A={ch1:A});var xe=A.ch1,je=A.ch2,rt=A.ch3,jt=A.ch4,xn="draw"===A.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof xe&&"#"!==xe.charAt(0)){var sr=new oo(xe);if(sr.ok)xe=sr.toHex();else if(!/^\d*\.?\d*$/.test(xe))throw new Error('Invalid color "'+xe+'" passed to jsPDF.encodeColorString.')}if("string"==typeof xe&&/^#[0-9A-Fa-f]{3}$/.test(xe)&&(xe="#"+xe[1]+xe[1]+xe[2]+xe[2]+xe[3]+xe[3]),"string"==typeof xe&&/^#[0-9A-Fa-f]{6}$/.test(xe)){var Mr=parseInt(xe.substr(1),16);xe=Mr>>16&255,je=Mr>>8&255,rt=255&Mr}if(void 0===je||void 0===jt&&xe===je&&je===rt)U="string"==typeof xe?xe+" "+xn[0]:2===A.precision?Yt(xe/255)+" "+xn[0]:fe(xe/255)+" "+xn[0];else if(void 0===jt||"object"===(0,zn.Z)(jt)){if(jt&&!isNaN(jt.a)&&0===jt.a)return["1.","1.","1.",xn[1]].join(" ");U="string"==typeof xe?[xe,je,rt,xn[1]].join(" "):2===A.precision?[Yt(xe/255),Yt(je/255),Yt(rt/255),xn[1]].join(" "):[fe(xe/255),fe(je/255),fe(rt/255),xn[1]].join(" ")}else U="string"==typeof xe?[xe,je,rt,jt,xn[2]].join(" "):2===A.precision?[Yt(xe),Yt(je),Yt(rt),Yt(jt),xn[2]].join(" "):[fe(xe),fe(je),fe(rt),fe(jt),xn[2]].join(" ");return U},rl=V.__private__.getFilters=function(){return M},Aa=V.__private__.putStream=function(A){var U=(A=A||{}).data||"",xe=A.filters||rl(),je=A.alreadyAppliedFilters||[],rt=A.addLength1||!1,jt=U.length,xn=A.objectId,sr=function(Rs){return Rs};if(null!==Y&&void 0===xn)throw new Error("ObjectId must be passed to putStream for file encryption");null!==Y&&(sr=il.encryptor(xn,0));var Mr={};!0===xe&&(xe=["FlateEncode"]);var Zr=A.additionalKeyValues||[],xi=(Mr=void 0!==Pr.API.processDataByFilters?Pr.API.processDataByFilters(U,xe):{data:U,reverseChain:[]}).reverseChain+(Array.isArray(je)?je.join(" "):je.toString());if(0!==Mr.data.length&&(Zr.push({key:"Length",value:Mr.data.length}),!0===rt&&Zr.push({key:"Length1",value:jt})),0!=xi.length)if(xi.split("/").length-1==1)Zr.push({key:"Filter",value:xi});else{Zr.push({key:"Filter",value:"["+xi+"]"});for(var $i=0;$i<Zr.length;$i+=1)if("DecodeParms"===Zr[$i].key){for(var mi=[],Go=0;Go<Mr.reverseChain.split("/").length-1;Go+=1)mi.push("null");mi.push(Zr[$i].value),Zr[$i].value="["+mi.join(" ")+"]"}}Me("<<");for(var Yo=0;Yo<Zr.length;Yo++)Me("/"+Zr[Yo].key+" "+Zr[Yo].value);Me(">>"),0!==Mr.data.length&&(Me("stream"),Me(sr(Mr.data)),Me("endstream"))},xu=V.__private__.putPage=function(A){var U=A.number,xe=A.data,je=A.objId,rt=A.contentsObjId;Gl(je,!0),Me("<</Type /Page"),Me("/Parent "+A.rootDictionaryObjId+" 0 R"),Me("/Resources "+A.resourceDictionaryObjId+" 0 R"),Me("/MediaBox ["+parseFloat(nt(A.mediaBox.bottomLeftX))+" "+parseFloat(nt(A.mediaBox.bottomLeftY))+" "+nt(A.mediaBox.topRightX)+" "+nt(A.mediaBox.topRightY)+"]"),null!==A.cropBox&&Me("/CropBox ["+nt(A.cropBox.bottomLeftX)+" "+nt(A.cropBox.bottomLeftY)+" "+nt(A.cropBox.topRightX)+" "+nt(A.cropBox.topRightY)+"]"),null!==A.bleedBox&&Me("/BleedBox ["+nt(A.bleedBox.bottomLeftX)+" "+nt(A.bleedBox.bottomLeftY)+" "+nt(A.bleedBox.topRightX)+" "+nt(A.bleedBox.topRightY)+"]"),null!==A.trimBox&&Me("/TrimBox ["+nt(A.trimBox.bottomLeftX)+" "+nt(A.trimBox.bottomLeftY)+" "+nt(A.trimBox.topRightX)+" "+nt(A.trimBox.topRightY)+"]"),null!==A.artBox&&Me("/ArtBox ["+nt(A.artBox.bottomLeftX)+" "+nt(A.artBox.bottomLeftY)+" "+nt(A.artBox.topRightX)+" "+nt(A.artBox.topRightY)+"]"),"number"==typeof A.userUnit&&1!==A.userUnit&&Me("/UserUnit "+A.userUnit),ao.publish("putPage",{objId:je,pageContext:ai[U],pageNumber:U,page:xe}),Me("/Contents "+rt+" 0 R"),Me(">>"),Me("endobj");var jt=xe.join("\n");return Be===me.ADVANCED&&(jt+="\nQ"),Gl(rt,!0),Aa({data:jt,filters:rl(),objectId:rt}),Me("endobj"),je},$d=V.__private__.putPages=function(){var A,U,xe=[];for(A=1;A<=ta;A++)ai[A].objId=ha(),ai[A].contentsObjId=ha();for(A=1;A<=ta;A++)xe.push(xu({number:A,data:gn[A],objId:ai[A].objId,contentsObjId:ai[A].contentsObjId,mediaBox:ai[A].mediaBox,cropBox:ai[A].cropBox,bleedBox:ai[A].bleedBox,trimBox:ai[A].trimBox,artBox:ai[A].artBox,userUnit:ai[A].userUnit,rootDictionaryObjId:wu,resourceDictionaryObjId:Ho}));Gl(wu,!0),Me("<</Type /Pages");var je="/Kids [";for(U=0;U<ta;U++)je+=xe[U]+" 0 R ";Me(je+"]"),Me("/Count "+ta),Me(">>"),Me("endobj"),ao.publish("postPutPages")},lp=function(A){ao.publish("putFont",{font:A,out:Me,newObject:_a,putStream:Aa}),!0!==A.isAlreadyPutted&&(A.objectNumber=_a(),Me("<<"),Me("/Type /Font"),Me("/BaseFont /"+Ic(A.postScriptName)),Me("/Subtype /Type1"),"string"==typeof A.encoding&&Me("/Encoding /"+A.encoding),Me("/FirstChar 32"),Me("/LastChar 255"),Me(">>"),Me("endobj"))},Wd=function(A){A.objectNumber=_a();var U=[];U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Form"}),U.push({key:"BBox",value:"["+[nt(A.x),nt(A.y),nt(A.x+A.width),nt(A.y+A.height)].join(" ")+"]"}),U.push({key:"Matrix",value:"["+A.matrix.toString()+"]"});var xe=A.pages[1].join("\n");Aa({data:xe,additionalKeyValues:U,objectId:A.objectNumber}),Me("endobj")},Vm=function(A,U){U||(U=21);var xe=_a(),je=function(A,U){var xe,je=[],rt=1/(U-1);for(xe=0;xe<1;xe+=rt)je.push(xe);je.push(1),0!=A[0].offset&&A.unshift({offset:0,color:A[0].color}),1!=A[A.length-1].offset&&A.push({offset:1,color:A[A.length-1].color});for(var sr="",Mr=0,Zr=0;Zr<je.length;Zr++){for(xe=je[Zr];xe>A[Mr+1].offset;)Mr++;var xi=A[Mr].offset,$i=(xe-xi)/(A[Mr+1].offset-xi),mi=A[Mr].color,Go=A[Mr+1].color;sr+=$e(Math.round((1-$i)*mi[0]+$i*Go[0]).toString(16))+$e(Math.round((1-$i)*mi[1]+$i*Go[1]).toString(16))+$e(Math.round((1-$i)*mi[2]+$i*Go[2]).toString(16))}return sr.trim()}(A.colors,U),rt=[];rt.push({key:"FunctionType",value:"0"}),rt.push({key:"Domain",value:"[0.0 1.0]"}),rt.push({key:"Size",value:"["+U+"]"}),rt.push({key:"BitsPerSample",value:"8"}),rt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Aa({data:je,additionalKeyValues:rt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:xe}),Me("endobj"),A.objectNumber=_a(),Me("<< /ShadingType "+A.type),Me("/ColorSpace /DeviceRGB");var jt="/Coords ["+nt(parseFloat(A.coords[0]))+" "+nt(parseFloat(A.coords[1]))+" ";jt+=2===A.type?nt(parseFloat(A.coords[2]))+" "+nt(parseFloat(A.coords[3])):nt(parseFloat(A.coords[2]))+" "+nt(parseFloat(A.coords[3]))+" "+nt(parseFloat(A.coords[4]))+" "+nt(parseFloat(A.coords[5])),Me(jt+="]"),A.matrix&&Me("/Matrix ["+A.matrix.toString()+"]"),Me("/Function "+xe+" 0 R"),Me("/Extend [true true]"),Me(">>"),Me("endobj")},F_=function(A,U){var xe=ha(),je=_a();U.push({resourcesOid:xe,objectOid:je}),A.objectNumber=je;var rt=[];rt.push({key:"Type",value:"/Pattern"}),rt.push({key:"PatternType",value:"1"}),rt.push({key:"PaintType",value:"1"}),rt.push({key:"TilingType",value:"1"}),rt.push({key:"BBox",value:"["+A.boundingBox.map(nt).join(" ")+"]"}),rt.push({key:"XStep",value:nt(A.xStep)}),rt.push({key:"YStep",value:nt(A.yStep)}),rt.push({key:"Resources",value:xe+" 0 R"}),A.matrix&&rt.push({key:"Matrix",value:"["+A.matrix.toString()+"]"}),Aa({data:A.stream,additionalKeyValues:rt,objectId:A.objectNumber}),Me("endobj")},up=function(A){for(var U in A.objectNumber=_a(),Me("<<"),A)switch(U){case"opacity":Me("/ca "+Yt(A[U]));break;case"stroke-opacity":Me("/CA "+Yt(A[U]))}Me(">>"),Me("endobj")},Oi=function(A){Gl(A.resourcesOid,!0),Me("<<"),Me("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var A in Me("/Font <<"),po)po.hasOwnProperty(A)&&(!1===Q||!0===Q&&re.hasOwnProperty(A))&&Me("/"+A+" "+po[A].objectNumber+" 0 R");Me(">>")}(),function(){if(Object.keys(no).length>0){for(var A in Me("/Shading <<"),no)no.hasOwnProperty(A)&&no[A]instanceof ed&&no[A].objectNumber>=0&&Me("/"+A+" "+no[A].objectNumber+" 0 R");ao.publish("putShadingPatternDict"),Me(">>")}}(),function(A){if(Object.keys(no).length>0){for(var U in Me("/Pattern <<"),no)no.hasOwnProperty(U)&&no[U]instanceof V.TilingPattern&&no[U].objectNumber>=0&&no[U].objectNumber<A&&Me("/"+U+" "+no[U].objectNumber+" 0 R");ao.publish("putTilingPatternDict"),Me(">>")}}(A.objectOid),function(){if(Object.keys(fa).length>0){var A;for(A in Me("/ExtGState <<"),fa)fa.hasOwnProperty(A)&&fa[A].objectNumber>=0&&Me("/"+A+" "+fa[A].objectNumber+" 0 R");ao.publish("putGStateDict"),Me(">>")}}(),function(){for(var A in Me("/XObject <<"),zr)zr.hasOwnProperty(A)&&zr[A].objectNumber>=0&&Me("/"+A+" "+zr[A].objectNumber+" 0 R");ao.publish("putXobjectDict"),Me(">>")}(),Me(">>"),Me("endobj")},Ns=function(A){Io[A.fontName]=Io[A.fontName]||{},Io[A.fontName][A.fontStyle]=A.id},zm=function(A,U,xe,je,rt){var jt={id:"F"+(Object.keys(po).length+1).toString(10),postScriptName:A,fontName:U,fontStyle:xe,encoding:je,isStandardFont:rt||!1,metadata:{}};return ao.publish("addFont",{font:jt,instance:this}),po[jt.id]=jt,Ns(jt),jt.id},wl=V.__private__.pdfEscape=V.pdfEscape=function(A,U){return function(A,U){var xe,je,rt,jt,xn,sr,Mr,Zr,xi;if(rt=(U=U||{}).sourceEncoding||"Unicode",xn=U.outputEncoding,(U.autoencode||xn)&&po[Hr].metadata&&po[Hr].metadata[rt]&&po[Hr].metadata[rt].encoding&&(jt=po[Hr].metadata[rt].encoding,!xn&&po[Hr].encoding&&(xn=po[Hr].encoding),!xn&&jt.codePages&&(xn=jt.codePages[0]),"string"==typeof xn&&(xn=jt[xn]),xn)){for(Mr=!1,sr=[],xe=0,je=A.length;xe<je;xe++)(Zr=xn[A.charCodeAt(xe)])?sr.push(String.fromCharCode(Zr)):sr.push(A[xe]),sr[xe].charCodeAt(0)>>8&&(Mr=!0);A=sr.join("")}for(xe=A.length;void 0===Mr&&0!==xe;)A.charCodeAt(xe-1)>>8&&(Mr=!0),xe--;if(!Mr)return A;for(sr=U.noBOM?[]:[254,255],xe=0,je=A.length;xe<je;xe++){if((xi=(Zr=A.charCodeAt(xe))>>8)>>8)throw new Error("Character at position "+xe+" of string '"+A+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");sr.push(xi),sr.push(Zr-(xi<<8))}return String.fromCharCode.apply(void 0,sr)}(A,U).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Gd=V.__private__.beginPage=function(A){gn[++ta]=[],ai[ta]={objId:0,contentsObjId:0,userUnit:Number(P),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(A[0]),topRightY:Number(A[1])}},mp(ta),Lt(gn[we])},Qf=function(A,U){var xe,je,rt;switch(g=U||g,"string"==typeof A&&(xe=se(A.toLowerCase()),Array.isArray(xe)&&(je=xe[0],rt=xe[1])),Array.isArray(A)&&(je=A[0]*Jn,rt=A[1]*Jn),isNaN(je)&&(je=S[0],rt=S[1]),(je>14400||rt>14400)&&(io.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),je=Math.min(14400,je),rt=Math.min(14400,rt)),S=[je,rt],g.substr(0,1)){case"l":rt>je&&(S=[rt,je]);break;case"p":je>rt&&(S=[rt,je])}Gd(S),yp(rh),Me(xl),0!==Ym&&Me(Ym+" J"),0!==co&&Me(co+" j"),ao.publish("addPage",{pageNumber:ta})},pp=function(A){A>0&&A<=ta&&(gn.splice(A,1),ai.splice(A,1),ta--,we>ta&&(we=ta),this.setPage(we))},mp=function(A){A>0&&A<=ta&&(we=A)},N0=V.__private__.getNumberOfPages=V.getNumberOfPages=function(){return gn.length-1},R0=function(A,U,xe){var je,rt=void 0;return xe=xe||{},U=void 0!==U?U:po[Hr].fontStyle,je=(A=void 0!==A?A:po[Hr].fontName).toLowerCase(),void 0!==Io[je]&&void 0!==Io[je][U]?rt=Io[je][U]:void 0!==Io[A]&&void 0!==Io[A][U]?rt=Io[A][U]:!1===xe.disableWarning&&io.warn("Unable to look up font label for font '"+A+"', '"+U+"'. Refer to getFontList() for available fonts."),rt||xe.noFallback||null==(rt=Io.times[U])&&(rt=Io.times.normal),rt},Yd=V.__private__.putInfo=function(){var A=_a(),U=function(je){return je};for(var xe in null!==Y&&(U=il.encryptor(A,0)),Me("<<"),Me("/Producer ("+wl(U("jsPDF "+Pr.version))+")"),wr)wr.hasOwnProperty(xe)&&wr[xe]&&Me("/"+xe.substr(0,1).toUpperCase()+xe.substr(1)+" ("+wl(U(wr[xe]))+")");Me("/CreationDate ("+wl(U(Tt))+")"),Me(">>"),Me("endobj")},sd=V.__private__.putCatalog=function(A){var U=(A=A||{}).rootDictionaryObjId||wu;switch(_a(),Me("<<"),Me("/Type /Catalog"),Me("/Pages "+U+" 0 R"),F||(F="fullwidth"),F){case"fullwidth":Me("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Me("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Me("/OpenAction [3 0 R /Fit]");break;case"original":Me("/OpenAction [3 0 R /XYZ null null 1]");break;default:var xe=""+F;"%"===xe.substr(xe.length-1)&&(F=parseInt(F)/100),"number"==typeof F&&Me("/OpenAction [3 0 R /XYZ null null "+Yt(F)+"]")}switch(In||(In="continuous"),In){case"continuous":Me("/PageLayout /OneColumn");break;case"single":Me("/PageLayout /SinglePage");break;case"two":case"twoleft":Me("/PageLayout /TwoColumnLeft");break;case"tworight":Me("/PageLayout /TwoColumnRight")}et&&Me("/PageMode /"+et),ao.publish("putCatalog"),Me(">>"),Me("endobj")},P_=V.__private__.putTrailer=function(){Me("trailer"),Me("<<"),Me("/Size "+(Xe+1)),Me("/Root "+Xe+" 0 R"),Me("/Info "+(Xe-1)+" 0 R"),null!==Y&&Me("/Encrypt "+il.oid+" 0 R"),Me("/ID [ <"+St+"> <"+St+"> ]"),Me(">>")},g2=V.__private__.putHeader=function(){Me("%PDF-"+ve),Me("%\xba\xdf\xac\xe0")},$m=V.__private__.putXRef=function(){var A="0000000000";Me("xref"),Me("0 "+(Xe+1)),Me("0000000000 65535 f ");for(var U=1;U<=Xe;U++)Me("function"==typeof ft[U]?(A+ft[U]()).slice(-10)+" 00000 n ":void 0!==ft[U]?(A+ft[U]).slice(-10)+" 00000 n ":"0000000000 00000 n ")},Xd=V.__private__.buildDocument=function(){Xe=0,bt=0,ot=[],ft=[],Rn=[],wu=ha(),Ho=ha(),Lt(ot),ao.publish("buildDocument"),g2(),$d(),function(){ao.publish("putAdditionalObjects");for(var A=0;A<Rn.length;A++){var U=Rn[A];Gl(U.objId,!0),Me(U.content),Me("endobj")}ao.publish("postPutAdditionalObjects")}(),function(){var A=[];(function(){for(var A in po)po.hasOwnProperty(A)&&(!1===Q||!0===Q&&re.hasOwnProperty(A))&&lp(po[A])})(),function(){var A;for(A in fa)fa.hasOwnProperty(A)&&up(fa[A])}(),function(){for(var A in zr)zr.hasOwnProperty(A)&&Wd(zr[A])}(),function(A){var U;for(U in no)no.hasOwnProperty(U)&&(no[U]instanceof ed?Vm(no[U]):no[U]instanceof Fs&&F_(no[U],A))}(A),ao.publish("putResources"),A.forEach(Oi),Oi({resourcesOid:Ho,objectOid:Number.MAX_SAFE_INTEGER}),ao.publish("postPutResources")}(),null!==Y&&(il.oid=_a(),Me("<<"),Me("/Filter /Standard"),Me("/V "+il.v),Me("/R "+il.r),Me("/U <"+il.toHexString(il.U)+">"),Me("/O <"+il.toHexString(il.O)+">"),Me("/P "+il.P),Me(">>"),Me("endobj")),Yd(),sd();var A=bt;return $m(),P_(),Me("startxref"),Me(""+A),Me("%%EOF"),Lt(gn[we]),ot.join("\n")},gp=V.__private__.getBlob=function(A){return new Blob([fr(A)],{type:"application/pdf"})},_p=V.output=V.__private__.output=((A=function(A,U){switch("string"==typeof(U=U||{})?U={filename:U}:U.filename=U.filename||"generated.pdf",A){case void 0:return Xd();case"save":V.save(U.filename);break;case"arraybuffer":return fr(Xd());case"blob":return gp(Xd());case"bloburi":case"bloburl":if(void 0!==Lr.URL&&"function"==typeof Lr.URL.createObjectURL)return Lr.URL&&Lr.URL.createObjectURL(gp(Xd()))||void 0;io.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var xe="",je=Xd();try{xe=Yh(je)}catch{xe=Yh(unescape(encodeURIComponent(je)))}return"data:application/pdf;filename="+U.filename+";base64,"+xe;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(Lr)){var rt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",jt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';U.pdfObjectUrl&&(rt=U.pdfObjectUrl,jt="");var xn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+rt+'"'+jt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(U)+");<\/script></body></html>",sr=Lr.open();return null!==sr&&sr.document.write(xn),sr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(Lr)){var Mr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(U.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+U.filename+'" width="500px" height="400px" /></body></html>',Zr=Lr.open();if(null!==Zr){Zr.document.write(Mr);var xi=this;Zr.document.documentElement.querySelector("#pdfViewer").onload=function(){Zr.document.title=U.filename,Zr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(xi.output("bloburl"))}}return Zr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(Lr))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var $i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",U)+'"></iframe></body></html>',mi=Lr.open();if(null!==mi&&(mi.document.write($i),mi.document.title=U.filename),mi||typeof safari>"u")return mi;break;case"datauri":case"dataurl":return Lr.document.location.href=this.output("datauristring",U);default:return null}}).foo=function(){try{return A.apply(this,arguments)}catch(je){var U=je.stack||"";~U.indexOf(" at ")&&(U=U.split(" at ")[1]);var xe="Error in function "+U.split("\n")[0].split("<")[0]+": "+je.message;if(!Lr.console)throw new Error(xe);Lr.console.error(xe,je),Lr.alert&&alert(xe)}},A.foo.bar=A,A.foo),O_=function(A){return!0===Array.isArray(fn)&&fn.indexOf(A)>-1};switch(b){case"pt":Jn=1;break;case"mm":Jn=72/25.4;break;case"cm":Jn=72/2.54;break;case"in":Jn=72;break;case"px":Jn=1==O_("px_scaling")?.75:96/72;break;case"pc":case"em":Jn=12;break;case"ex":Jn=6;break;default:if("number"!=typeof b)throw new Error("Invalid unit: "+b);Jn=b}var il=null;Yn(),gt();var qm=V.__private__.getPageInfo=V.getPageInfo=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ai[A].objId,pageNumber:A,pageContext:ai[A]}},ni=V.__private__.getPageInfoByObjId=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var U in ai)if(ai[U].objId===A)break;return qm(U)},Jf=V.__private__.getCurrentPageInfo=V.getCurrentPageInfo=function(){return{objId:ai[we].objId,pageNumber:we,pageContext:ai[we]}};V.addPage=function(){return Qf.apply(this,arguments),this},V.setPage=function(){return mp.apply(this,arguments),Lt.call(this,gn[we]),this},V.insertPage=function(A){return this.addPage(),this.movePage(we,A),this},V.movePage=function(A,U){var xe,je;if(A>U){xe=gn[A],je=ai[A];for(var rt=A;rt>U;rt--)gn[rt]=gn[rt-1],ai[rt]=ai[rt-1];gn[U]=xe,ai[U]=je,this.setPage(U)}else if(A<U){xe=gn[A],je=ai[A];for(var jt=A;jt<U;jt++)gn[jt]=gn[jt+1],ai[jt]=ai[jt+1];gn[U]=xe,ai[U]=je,this.setPage(U)}return this},V.deletePage=function(){return pp.apply(this,arguments),this},V.__private__.text=V.text=function(A,U,xe,je,rt){var jt,xn,sr,Mr,Zr,xi,$i,mi,Go,Yo=(je=je||{}).scope||this;if("number"==typeof A&&"number"==typeof U&&("string"==typeof xe||Array.isArray(xe))){var Rs=xe;xe=U,U=A,A=Rs}if(arguments[3]instanceof mr?(Oe("The transform parameter of text() with a Matrix value"),Go=rt):(sr=arguments[4],Mr=arguments[5],"object"===(0,zn.Z)($i=arguments[3])&&null!==$i||("string"==typeof sr&&(Mr=sr,sr=null),"string"==typeof $i&&(Mr=$i,$i=null),"number"==typeof $i&&(sr=$i,$i=null),je={flags:$i,angle:sr,align:Mr})),isNaN(U)||isNaN(xe)||null==A)throw new Error("Invalid arguments passed to jsPDF.text");if(0===A.length)return Yo;var bs,uo="",Cl="number"==typeof je.lineHeightFactor?je.lineHeightFactor:Su,fc=Yo.internal.scaleFactor;function ef(So){return So=So.split("\t").join(Array(je.TabLen||9).join(" ")),wl(So,$i)}function Xm(So){for(var Oo,pa=So.concat(),is=[],Tu=pa.length;Tu--;)"string"==typeof(Oo=pa.shift())?is.push(Oo):Array.isArray(So)&&(1===Oo.length||void 0===Oo[1]&&void 0===Oo[2])?is.push(Oo[0]):is.push([Oo[0],Oo[1],Oo[2]]);return is}function $0(So,Oo){var pa;if("string"==typeof So)pa=Oo(So)[0];else if(Array.isArray(So)){for(var is,Tu,uh=So.concat(),kp=[],G0=uh.length;G0--;)"string"==typeof(is=uh.shift())?kp.push(Oo(is)[0]):Array.isArray(is)&&"string"==typeof is[0]&&(Tu=Oo(is[0],is[1],is[2]),kp.push([Tu[0],Tu[1],Tu[2]]));pa=kp}return pa}var Sp=!1,W0=!0;if("string"==typeof A)Sp=!0;else if(Array.isArray(A)){var ys=A.concat();xn=[];for(var tf,za=ys.length;za--;)("string"!=typeof(tf=ys.shift())||Array.isArray(tf)&&"string"!=typeof tf[0])&&(W0=!1);Sp=W0}if(!1===Sp)throw new Error('Type of text must be string or Array. "'+A+'" is not recognized.');"string"==typeof A&&(A=A.match(/[\r?\n]/)?A.split(/\r\n|\r|\n/g):[A]);var Km=C/Yo.internal.scaleFactor,lh=Km*(Cl-1);switch(je.baseline){case"bottom":xe-=lh;break;case"top":xe+=Km-lh;break;case"hanging":xe+=Km-2*lh;break;case"middle":xe+=Km/2-lh}if((xi=je.maxWidth||0)>0&&("string"==typeof A?A=Yo.splitTextToSize(A,xi):"[object Array]"===Object.prototype.toString.call(A)&&(A=A.reduce(function(So,Oo){return So.concat(Yo.splitTextToSize(Oo,xi))},[]))),ao.publish("preProcessText",jt={text:A,x:U,y:xe,options:je,mutex:{pdfEscape:wl,activeFontKey:Hr,fonts:po,activeFontSize:C}}),A=jt.text,sr=(je=jt.options).angle,Go instanceof mr||!sr||"number"!=typeof sr)sr&&sr instanceof mr&&(Go=sr);else{sr*=Math.PI/180,0===je.rotationDirection&&(sr=-sr),Be===me.ADVANCED&&(sr=-sr);var Dp=Math.cos(sr),Zm=Math.sin(sr);Go=new mr(Dp,Zm,-Zm,Dp,0,0)}Be!==me.ADVANCED||Go||(Go=yl),void 0!==(Zr=je.charSpace||ah)&&(uo+=nt(de(Zr))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(mi=je.horizontalScale)&&(uo+=nt(100*mi)+" Tz\n");var El=-1,R_=void 0!==je.renderingMode?je.renderingMode:je.stroke,Qm=Yo.internal.getCurrentPageInfo().pageContext;switch(R_){case 0:case!1:case"fill":El=0;break;case 1:case!0:case"stroke":El=1;break;case 2:case"fillThenStroke":El=2;break;case 3:case"invisible":El=3;break;case 4:case"fillAndAddForClipping":El=4;break;case 5:case"strokeAndAddPathForClipping":El=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":El=6;break;case 7:case"addToPathForClipping":El=7}-1!==El?uo+=El+" Tr\n":-1!==(void 0!==Qm.usedRenderingMode?Qm.usedRenderingMode:-1)&&(uo+="0 Tr\n"),-1!==El&&(Qm.usedRenderingMode=El),Mr=je.align||"left";var Xl,nf=C*Cl,Jm=Yo.internal.pageSize.getWidth(),Uc=po[Hr];Zr=je.charSpace||ah,xi=je.maxWidth||0,$i=Object.assign({autoencode:!0,noBOM:!0},je.flags);var dd=[];if("[object Array]"===Object.prototype.toString.call(A)){var ws;xn=Xm(A),"left"!==Mr&&(Xl=xn.map(function(So){return Yo.getStringUnitWidth(So,{font:Uc,charSpace:Zr,fontSize:C,doKerning:!1})*C/fc}));var Hc,fd=0;if("right"===Mr){U-=Xl[0],A=[],za=xn.length;for(var Sl=0;Sl<za;Sl++)0===Sl?(Hc=Du(U),ws=cd(xe)):(Hc=de(fd-Xl[Sl]),ws=-nf),A.push([xn[Sl],Hc,ws]),fd=Xl[Sl]}else if("center"===Mr){U-=Xl[0]/2,A=[],za=xn.length;for(var hc=0;hc<za;hc++)0===hc?(Hc=Du(U),ws=cd(xe)):(Hc=de((fd-Xl[hc])/2),ws=-nf),A.push([xn[hc],Hc,ws]),fd=Xl[hc]}else if("left"===Mr){A=[],za=xn.length;for(var ch=0;ch<za;ch++)A.push(xn[ch])}else{if("justify"!==Mr)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');A=[],za=xn.length,xi=0!==xi?xi:Jm;for(var zc=0;zc<za;zc++)ws=0===zc?cd(xe):-nf,Hc=0===zc?Du(U):0,dd.push(zc<za-1?nt(de((xi-Xl[zc])/(xn[zc].split(" ").length-1))):0),A.push([xn[zc],Hc,ws])}}!0===("boolean"==typeof je.R2L?je.R2L:le)&&(A=$0(A,function(So,Oo,pa){return[So.split("").reverse().join(""),Oo,pa]})),ao.publish("postProcessText",jt={text:A,x:U,y:xe,options:je,mutex:{pdfEscape:wl,activeFontKey:Hr,fonts:po,activeFontSize:C}}),A=jt.text,bs=jt.mutex.isHex||!1;var Au=po[Hr].encoding;"WinAnsiEncoding"!==Au&&"StandardEncoding"!==Au||(A=$0(A,function(So,Oo,pa){return[ef(So),Oo,pa]})),xn=Xm(A),A=[];for(var pc,$c,rf,Mp=Array.isArray(xn[0])?1:0,sf="",eg=function(So,Oo,pa){var is="";return pa instanceof mr?(pa="number"==typeof je.angle?uc(pa,new mr(1,0,0,1,So,Oo)):uc(new mr(1,0,0,1,So,Oo),pa),Be===me.ADVANCED&&(pa=uc(new mr(1,0,0,-1,0,0),pa)),is=pa.join(" ")+" Tm\n"):is=nt(So)+" "+nt(Oo)+" Td\n",is},mc=0;mc<xn.length;mc++){switch(sf="",Mp){case 1:rf=(bs?"<":"(")+xn[mc][0]+(bs?">":")"),pc=parseFloat(xn[mc][1]),$c=parseFloat(xn[mc][2]);break;case 0:rf=(bs?"<":"(")+xn[mc]+(bs?">":")"),pc=Du(U),$c=cd(xe)}void 0!==dd&&void 0!==dd[mc]&&(sf=dd[mc]+" Tw\n"),0===mc?A.push(sf+eg(pc,$c,Go)+rf):0===Mp?A.push(sf+rf):1===Mp&&A.push(sf+eg(pc,$c,Go)+rf)}A=A.join(0===Mp?" Tj\nT* ":" Tj\n"),A+=" Tj\n";var gc="BT\n/";return gc+=Hr+" "+C+" Tf\n",gc+=nt(C*Cl)+" TL\n",gc+=oh+"\n",gc+=uo,gc+=A,Me(gc+="ET"),re[Hr]=!0,Yo};var L0=V.__private__.clip=V.clip=function(A){return Me("evenodd"===A?"W*":"W"),this};V.clipEvenOdd=function(){return L0("evenodd")},V.__private__.discardPath=V.discardPath=function(){return Me("n"),this};var Lc=V.__private__.isValidStyle=function(A){var U=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(A)&&(U=!0),U};V.__private__.setDefaultPathOperation=V.setDefaultPathOperation=function(A){return Lc(A)&&(H=A),this};var eh=V.__private__.getStyle=V.getStyle=function(A){var U=H;switch(A){case"D":case"S":U="S";break;case"F":U="f";break;case"FD":case"DF":U="B";break;case"f":case"f*":case"B":case"B*":U=A}return U},B0=V.close=function(){return Me("h"),this};V.stroke=function(){return Me("S"),this},V.fill=function(A){return ld("f",A),this},V.fillEvenOdd=function(A){return ld("f*",A),this},V.fillStroke=function(A){return ld("B",A),this},V.fillStrokeEvenOdd=function(A){return ld("B*",A),this};var ld=function(A,U){"object"===(0,zn.Z)(U)?_2(U,A):Me(A)},th=function(A){null===A||Be===me.ADVANCED&&void 0===A||(A=eh(A),Me(A))};function vp(A,U,xe,je,rt){var jt=new Fs(U||this.boundingBox,xe||this.xStep,je||this.yStep,this.gState,rt||this.matrix);jt.stream=this.stream;var xn=A+"$$"+this.cloneIndex+++"$$";return na(xn,jt),jt}var _2=function(A,U){var xe=sp[A.key],je=no[xe];if(je instanceof ed)Me("q"),Me(j0(U)),je.gState&&V.setGState(je.gState),Me(A.matrix.toString()+" cm"),Me("/"+xe+" sh"),Me("Q");else if(je instanceof Fs){var rt=new mr(1,0,0,-1,0,Yl());A.matrix&&(rt=rt.multiply(A.matrix||yl),xe=vp.call(je,A.key,A.boundingBox,A.xStep,A.yStep,rt).id),Me("q"),Me("/Pattern cs"),Me("/"+xe+" scn"),je.gState&&V.setGState(je.gState),Me(U),Me("Q")}},j0=function(A){switch(A){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},bp=V.moveTo=function(A,U){return Me(nt(de(A))+" "+nt(Ne(U))+" m"),this},nh=V.lineTo=function(A,U){return Me(nt(de(A))+" "+nt(Ne(U))+" l"),this},vs=V.curveTo=function(A,U,xe,je,rt,jt){return Me([nt(de(A)),nt(Ne(U)),nt(de(xe)),nt(Ne(je)),nt(de(rt)),nt(Ne(jt)),"c"].join(" ")),this};V.__private__.line=V.line=function(A,U,xe,je,rt){if(isNaN(A)||isNaN(U)||isNaN(xe)||isNaN(je)||!Lc(rt))throw new Error("Invalid arguments passed to jsPDF.line");return Be===me.COMPAT?this.lines([[xe-A,je-U]],A,U,[1,1],rt||"S"):this.lines([[xe-A,je-U]],A,U,[1,1]).stroke()},V.__private__.lines=V.lines=function(A,U,xe,je,rt,jt){var xn,sr,Mr,Zr,xi,Rs,uo,bs;if("number"==typeof A&&(bs=xe,xe=U,U=A,A=bs),je=je||[1,1],jt=jt||!1,isNaN(U)||isNaN(xe)||!Array.isArray(A)||!Array.isArray(je)||!Lc(rt)||"boolean"!=typeof jt)throw new Error("Invalid arguments passed to jsPDF.lines");for(bp(U,xe),xn=je[0],sr=je[1],Zr=A.length,Rs=U,uo=xe,Mr=0;Mr<Zr;Mr++)2===(xi=A[Mr]).length?nh(Rs=xi[0]*xn+Rs,uo=xi[1]*sr+uo):vs(xi[0]*xn+Rs,xi[1]*sr+uo,xi[2]*xn+Rs,xi[3]*sr+uo,Rs=xi[4]*xn+Rs,uo=xi[5]*sr+uo);return jt&&B0(),th(rt),this},V.path=function(A){for(var U=0;U<A.length;U++){var xe=A[U],je=xe.c;switch(xe.op){case"m":bp(je[0],je[1]);break;case"l":nh(je[0],je[1]);break;case"c":vs.apply(this,je);break;case"h":B0()}}return this},V.__private__.rect=V.rect=function(A,U,xe,je,rt){if(isNaN(A)||isNaN(U)||isNaN(xe)||isNaN(je)||!Lc(rt))throw new Error("Invalid arguments passed to jsPDF.rect");return Be===me.COMPAT&&(je=-je),Me([nt(de(A)),nt(Ne(U)),nt(de(xe)),nt(de(je)),"re"].join(" ")),th(rt),this},V.__private__.triangle=V.triangle=function(A,U,xe,je,rt,jt,xn){if(isNaN(A)||isNaN(U)||isNaN(xe)||isNaN(je)||isNaN(rt)||isNaN(jt)||!Lc(xn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[xe-A,je-U],[rt-xe,jt-je],[A-rt,U-jt]],A,U,[1,1],xn,!0),this},V.__private__.roundedRect=V.roundedRect=function(A,U,xe,je,rt,jt,xn){if(isNaN(A)||isNaN(U)||isNaN(xe)||isNaN(je)||isNaN(rt)||isNaN(jt)||!Lc(xn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var sr=4/3*(Math.SQRT2-1);return rt=Math.min(rt,.5*xe),jt=Math.min(jt,.5*je),this.lines([[xe-2*rt,0],[rt*sr,0,rt,jt-jt*sr,rt,jt],[0,je-2*jt],[0,jt*sr,-rt*sr,jt,-rt,jt],[2*rt-xe,0],[-rt*sr,0,-rt,-jt*sr,-rt,-jt],[0,2*jt-je],[0,-jt*sr,rt*sr,-jt,rt,-jt]],A+rt,U,[1,1],xn,!0),this},V.__private__.ellipse=V.ellipse=function(A,U,xe,je,rt){if(isNaN(A)||isNaN(U)||isNaN(xe)||isNaN(je)||!Lc(rt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var jt=4/3*(Math.SQRT2-1)*xe,xn=4/3*(Math.SQRT2-1)*je;return bp(A+xe,U),vs(A+xe,U-xn,A+jt,U-je,A,U-je),vs(A-jt,U-je,A-xe,U-xn,A-xe,U),vs(A-xe,U+xn,A-jt,U+je,A,U+je),vs(A+jt,U+je,A+xe,U+xn,A+xe,U),th(rt),this},V.__private__.circle=V.circle=function(A,U,xe,je){if(isNaN(A)||isNaN(U)||isNaN(xe)||!Lc(je))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(A,U,xe,xe,je)},V.setFont=function(A,U,xe){return xe&&(U=ln(U,xe)),Hr=R0(A,U,{disableWarning:!1}),this};var N_=V.__private__.getFont=V.getFont=function(){return po[R0.apply(V,arguments)]};V.__private__.getFontList=V.getFontList=function(){var A,U,xe={};for(A in Io)if(Io.hasOwnProperty(A))for(U in xe[A]=[],Io[A])Io[A].hasOwnProperty(U)&&xe[A].push(U);return xe},V.addFont=function(A,U,xe,je,rt){var jt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==jt.indexOf(arguments[3])?rt=arguments[3]:arguments[3]&&-1==jt.indexOf(arguments[3])&&(xe=ln(xe,je)),zm.call(this,A,U,xe,rt=rt||"Identity-H")};var Su,rh=_.lineWidth||.200025,ih=V.__private__.getLineWidth=V.getLineWidth=function(){return rh},yp=V.__private__.setLineWidth=V.setLineWidth=function(A){return rh=A,Me(nt(de(A))+" w"),this};V.__private__.setLineDash=Pr.API.setLineDash=Pr.API.setLineDashPattern=function(A,U){if(A=A||[],U=U||0,isNaN(U)||!Array.isArray(A))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return A=A.map(function(xe){return nt(de(xe))}).join(" "),U=nt(de(U)),Me("["+A+"] "+U+" d"),this};var wp=V.__private__.getLineHeight=V.getLineHeight=function(){return C*Su};V.__private__.getLineHeight=V.getLineHeight=function(){return C*Su};var V0=V.__private__.setLineHeightFactor=V.setLineHeightFactor=function(A){return"number"==typeof(A=A||1.15)&&(Su=A),this},Gm=V.__private__.getLineHeightFactor=V.getLineHeightFactor=function(){return Su};V0(_.lineHeight);var Du=V.__private__.getHorizontalCoordinate=function(A){return de(A)},cd=V.__private__.getVerticalCoordinate=function(A){return Be===me.ADVANCED?A:ai[we].mediaBox.topRightY-ai[we].mediaBox.bottomLeftY-de(A)},U0=V.__private__.getHorizontalCoordinateString=V.getHorizontalCoordinateString=function(A){return nt(Du(A))},Kd=V.__private__.getVerticalCoordinateString=V.getVerticalCoordinateString=function(A){return nt(cd(A))},xl=_.strokeColor||"0 G";V.__private__.getStrokeColor=V.getDrawColor=function(){return Ha(xl)},V.__private__.setStrokeColor=V.setDrawColor=function(A,U,xe,je){return xl=dc({ch1:A,ch2:U,ch3:xe,ch4:je,pdfColorType:"draw",precision:2}),Me(xl),this};var Bc=_.fillColor||"0 g";V.__private__.getFillColor=V.getFillColor=function(){return Ha(Bc)},V.__private__.setFillColor=V.setFillColor=function(A,U,xe,je){return Bc=dc({ch1:A,ch2:U,ch3:xe,ch4:je,pdfColorType:"fill",precision:2}),Me(Bc),this};var oh=_.textColor||"0 g",H0=V.__private__.getTextColor=V.getTextColor=function(){return Ha(oh)};V.__private__.setTextColor=V.setTextColor=function(A,U,xe,je){return oh=dc({ch1:A,ch2:U,ch3:xe,ch4:je,pdfColorType:"text",precision:3}),this};var ah=_.charSpace,Zd=V.__private__.getCharSpace=V.getCharSpace=function(){return parseFloat(ah||0)};V.__private__.setCharSpace=V.setCharSpace=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ah=A,this};var Ym=0;V.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},V.__private__.setLineCap=V.setLineCap=function(A){var U=V.CapJoinStyles[A];if(void 0===U)throw new Error("Line cap style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ym=U,Me(U+" J"),this};var co=0;V.__private__.setLineJoin=V.setLineJoin=function(A){var U=V.CapJoinStyles[A];if(void 0===U)throw new Error("Line join style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return co=U,Me(U+" j"),this},V.__private__.setLineMiterLimit=V.__private__.setMiterLimit=V.setLineMiterLimit=V.setMiterLimit=function(A){if(A=A||0,isNaN(A))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Me(nt(de(A))+" M"),this},V.GState=Zh,V.setGState=function(A){(A="string"==typeof A?fa[Nc[A]]:xp(null,A)).equals(ad)||(Me("/"+A.id+" gs"),ad=A)};var xp=function(A,U){if(!A||!Nc[A]){var xe=!1;for(var je in fa)if(fa.hasOwnProperty(je)&&fa[je].equals(U)){xe=!0;break}if(xe)U=fa[je];else{var rt="GS"+(Object.keys(fa).length+1).toString(10);fa[rt]=U,U.id=rt}return A&&(Nc[A]=U.id),ao.publish("addGState",U),U}};V.addGState=function(A,U){return xp(A,U),this},V.saveGraphicsState=function(){return Me("q"),Tr.push({key:Hr,size:C,color:oh}),this},V.restoreGraphicsState=function(){Me("Q");var A=Tr.pop();return Hr=A.key,C=A.size,oh=A.color,ad=null,this},V.setCurrentTransformationMatrix=function(A){return Me(A.toString()+" cm"),this},V.comment=function(A){return Me("#"+A),this};var Cp=function(A,U){var xe=A||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return xe},set:function(jt){isNaN(jt)||(xe=parseFloat(jt))}});var je=U||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return je},set:function(jt){isNaN(jt)||(je=parseFloat(jt))}});var rt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return rt},set:function(jt){rt=jt.toString()}}),this},Ep=function(A,U,xe,je){Cp.call(this,A,U),this.type="rect";var rt=xe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return rt},set:function(xn){isNaN(xn)||(rt=parseFloat(xn))}});var jt=je||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return jt},set:function(xn){isNaN(xn)||(jt=parseFloat(xn))}}),this},jc=function(){this.page=ta,this.currentPage=we,this.pages=gn.slice(0),this.pagesContext=ai.slice(0),this.x=Ua,this.y=Xi,this.matrix=rs,this.width=Jd(we),this.height=Yl(we),this.outputDestination=tr,this.id="",this.objectNumber=-1};jc.prototype.restore=function(){ta=this.page,ai=this.pagesContext,gn=this.pages,Ua=this.x,Xi=this.y,rs=this.matrix,sh(we=this.currentPage,this.width),z0(we,this.height),tr=this.outputDestination};var ud=function(A,U,xe,je,rt){pt.push(new jc),ta=we=0,gn=[],Ua=A,Xi=U,rs=rt,Gd([xe,je])};for(var Vc in V.beginFormObject=function(A,U,xe,je,rt){return ud(A,U,xe,je,rt),this},V.endFormObject=function(A){return function(A){if(ht[A])pt.pop().restore();else{var U=new jc,xe="Xo"+(Object.keys(zr).length+1).toString(10);U.id=xe,ht[A]=xe,zr[xe]=U,ao.publish("addFormObject",U),pt.pop().restore()}}(A),this},V.doFormObject=function(A,U){var xe=zr[ht[A]];return Me("q"),Me(U.toString()+" cm"),Me("/"+xe.id+" Do"),Me("Q"),this},V.getFormObject=function(A){var U=zr[ht[A]];return{x:U.x,y:U.y,width:U.width,height:U.height,matrix:U.matrix}},V.save=function(A,U){return A=A||"generated.pdf",(U=U||{}).returnPromise=U.returnPromise||!1,!1===U.returnPromise?(Fc(gp(Xd()),A),"function"==typeof Fc.unload&&Lr.setTimeout&&setTimeout(Fc.unload,911),this):new Promise(function(xe,je){try{var rt=Fc(gp(Xd()),A);"function"==typeof Fc.unload&&Lr.setTimeout&&setTimeout(Fc.unload,911),xe(rt)}catch(jt){je(jt.message)}})},Pr.API)Pr.API.hasOwnProperty(Vc)&&("events"===Vc&&Pr.API.events.length?function(A,U){var je,rt;for(rt=U.length-1;-1!==rt;rt--)A.subscribe.apply(A,[U[rt][0]].concat("function"==typeof(je=U[rt][1])?[je]:je))}(ao,Pr.API.events):V[Vc]=Pr.API[Vc]);var Jd=V.getPageWidth=function(A){return(ai[A=A||we].mediaBox.topRightX-ai[A].mediaBox.bottomLeftX)/Jn},sh=V.setPageWidth=function(A,U){ai[A].mediaBox.topRightX=U*Jn+ai[A].mediaBox.bottomLeftX},Yl=V.getPageHeight=function(A){return(ai[A=A||we].mediaBox.topRightY-ai[A].mediaBox.bottomLeftY)/Jn},z0=V.setPageHeight=function(A,U){ai[A].mediaBox.topRightY=U*Jn+ai[A].mediaBox.bottomLeftY};return V.internal={pdfEscape:wl,getStyle:eh,getFont:N_,getFontSize:j,getCharSpace:Zd,getTextColor:H0,getLineHeight:wp,getLineHeightFactor:Gm,getLineWidth:ih,write:ti,getHorizontalCoordinate:Du,getVerticalCoordinate:cd,getCoordinateString:U0,getVerticalCoordinateString:Kd,collections:{},newObject:_a,newAdditionalObject:Bm,newObjectDeferred:ha,newObjectDeferredBegin:Gl,getFilters:rl,putStream:Aa,events:ao,scaleFactor:Jn,pageSize:{getWidth:function(){return Jd(we)},setWidth:function(A){sh(we,A)},getHeight:function(){return Yl(we)},setHeight:function(A){z0(we,A)}},encryptionOptions:Y,encryption:il,getEncryptor:function(A){return null!==Y?il.encryptor(A,0):function(U){return U}},output:_p,getNumberOfPages:N0,pages:gn,out:Me,f2:Yt,f3:fe,getPageInfo:qm,getPageInfoByObjId:ni,getCurrentPageInfo:Jf,getPDFVersion:ce,Point:Cp,Rectangle:Ep,Matrix:mr,hasHotfix:O_},Object.defineProperty(V.internal.pageSize,"width",{get:function(){return Jd(we)},set:function(A){sh(we,A)},enumerable:!0,configurable:!0}),Object.defineProperty(V.internal.pageSize,"height",{get:function(){return Yl(we)},set:function(A){z0(we,A)},enumerable:!0,configurable:!0}),function(A){for(var U=0,xe=B.length;U<xe;U++){var je=zm.call(this,A[U][0],A[U][1],A[U][2],B[U][3],!0);!1===Q&&(re[je]=!0);var rt=A[U][0].split("-");Ns({id:je,fontName:rt[0],fontStyle:rt[1]||""})}ao.publish("addFonts",{fonts:po,dictionary:Io})}.call(V,B),Hr="F1",Qf(S,g),ao.publish("initialized"),V}Ju.prototype.lsbFirstWord=function(_){return String.fromCharCode(_>>0&255,_>>8&255,_>>16&255,_>>24&255)},Ju.prototype.toHexString=function(_){return _.split("").map(function(p){return("0"+(255&p.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ju.prototype.hexToBytes=function(_){for(var p=[],g=0;g<_.length;g+=2)p.push(String.fromCharCode(parseInt(_.substr(g,2),16)));return p.join("")},Ju.prototype.processOwnerPassword=function(_,p){return Kh(Rd(p).substr(0,5),_)},Ju.prototype.encryptor=function(_,p){var g=Rd(this.encryptionKey+String.fromCharCode(255&_,_>>8&255,_>>16&255,255&p,p>>8&255)).substr(0,10);return function(b){return Kh(g,b)}},Zh.prototype.equals=function(_){var p,g="id,objectNumber,equals";if(!_||(0,zn.Z)(_)!==(0,zn.Z)(this))return!1;var b=0;for(p in this)if(!(g.indexOf(p)>=0)){if(this.hasOwnProperty(p)&&!_.hasOwnProperty(p)||this[p]!==_[p])return!1;b++}for(p in _)_.hasOwnProperty(p)&&g.indexOf(p)<0&&b--;return 0===b},Pr.API={events:[]},Pr.version="2.5.1";var qo=Pr.API,C0=1,td=function(_){return _.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ld=function(_){return _.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ii=function(_){return _.toFixed(2)},Qs=function(_){return _.toFixed(5)};qo.__acroform__={};var Is=function(_,p){_.prototype=Object.create(p.prototype),_.prototype.constructor=_},Js=function(_){return _*C0},ci=function(_){var p=new D0,g=Kn.internal.getHeight(_)||0,b=Kn.internal.getWidth(_)||0;return p.BBox=[0,0,Number(ii(b)),Number(ii(g))],p},k_=qo.__acroform__.setBit=function(_,p){if(_=_||0,p=p||0,isNaN(_)||isNaN(p))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return _|1<<p},p2=qo.__acroform__.clearBit=function(_,p){if(_=_||0,p=p||0,isNaN(_)||isNaN(p))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return _&~(1<<p)},m2=qo.__acroform__.getBit=function(_,p){if(isNaN(_)||isNaN(p))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return _&1<<p?1:0},Gt=qo.__acroform__.getBitForPdf=function(_,p){if(isNaN(_)||isNaN(p))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return m2(_,p-1)},da=qo.__acroform__.setBitForPdf=function(_,p){if(isNaN(_)||isNaN(p))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return k_(_,p-1)},hr=qo.__acroform__.clearBitForPdf=function(_,p){if(isNaN(_)||isNaN(p))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return p2(_,p-1)},Qh=qo.__acroform__.calculateCoordinates=function(_,p){var g=p.internal.getHorizontalCoordinate,b=p.internal.getVerticalCoordinate,S=_[0],x=_[1],M=_[2],P=_[3],O={};return O.lowerLeft_X=g(S)||0,O.lowerLeft_Y=b(x+P)||0,O.upperRight_X=g(S+M)||0,O.upperRight_Y=b(x)||0,[Number(ii(O.lowerLeft_X)),Number(ii(O.lowerLeft_Y)),Number(ii(O.upperRight_X)),Number(ii(O.upperRight_Y))]},Bd=function(_){if(_.appearanceStreamContent)return _.appearanceStreamContent;if(_.V||_.DV){var p=[],b=Jh(_,_._V||_.DV),S=_.scope.internal.getFont(_.fontName,_.fontStyle).id;p.push("/Tx BMC"),p.push("q"),p.push("BT"),p.push(_.scope.__private__.encodeColorString(_.color)),p.push("/"+S+" "+ii(b.fontSize)+" Tf"),p.push("1 0 0 1 0 0 Tm"),p.push(b.text),p.push("ET"),p.push("Q"),p.push("EMC");var x=ci(_);return x.scope=_.scope,x.stream=p.join("\n"),x}},Jh=function(_,p){var g=0===_.fontSize?_.maxFontSize:_.fontSize,b={text:"",fontSize:""},S=(p=")"==(p="("==p.substr(0,1)?p.substr(1):p).substr(p.length-1)?p.substr(0,p.length-1):p).split(" ");S=S.map(_.multiline?function(fe){return fe.split("\n")}:function(fe){return[fe]});var x=g,M=Kn.internal.getHeight(_)||0;M=M<0?-M:M;var fe,P=Kn.internal.getWidth(_)||0;P=P<0?-P:P,x++;e:for(;x>0;){p="",x--;var H,Y,Q=Wf("3",_,x).height,re=_.multiline?M-x:(M-Q)/2,V=re+=2,ve=0,ce=0,be=0;if(x<=0){p="(...) Tj\n",p+="% Width of Text: "+Wf(p,_,x=12).width+", FieldWidth:"+P+"\n";break}for(var se="",me=0,Be=0;Be<S.length;Be++)if(S.hasOwnProperty(Be)){var st=!1;if(1!==S[Be].length&&be!==S[Be].length-1){if((Q+2)*(me+2)+2>M)continue e;se+=S[Be][be],st=!0,ce=Be,Be--}else{se=" "==(se+=S[Be][be]+" ").substr(se.length-1)?se.substr(0,se.length-1):se;var At=parseInt(Be),ln=(fe=At)+1<S.length&&Wf(se+" "+S[fe+1][0],_,x).width<=P-4,nt=Be>=S.length-1;if(ln&&!nt){se+=" ",be=0;continue}if(ln||nt){if(nt)ce=At;else if(_.multiline&&(Q+2)*(me+2)+2>M)continue e}else{if(!_.multiline||(Q+2)*(me+2)+2>M)continue e;ce=At}}for(var Oe="",Kt=ve;Kt<=ce;Kt++){var Yt=S[Kt];if(_.multiline){if(Kt===ce){Oe+=Yt[be]+" ",be=(be+1)%Yt.length;continue}if(Kt===ve){Oe+=Yt[Yt.length-1]+" ";continue}}Oe+=Yt[0]+" "}switch(Oe=" "==Oe.substr(Oe.length-1)?Oe.substr(0,Oe.length-1):Oe,Y=Wf(Oe,_,x).width,_.textAlign){case"right":H=P-Y-2;break;case"center":H=(P-Y)/2;break;default:H=2}p+=ii(H)+" "+ii(V)+" Td\n",p+="("+td(Oe)+") Tj\n",p+=-ii(H)+" 0 Td\n",V=-(x+2),Y=0,ve=st?ce:ce+1,me++,se=""}break}return b.text=p,b.fontSize=x,b},Wf=function(_,p,g){var b=p.scope.internal.getFont(p.fontName,p.fontStyle),S=p.scope.getStringUnitWidth(_,{font:b,fontSize:parseFloat(g),charSpace:0})*parseFloat(g);return{height:p.scope.getStringUnitWidth("3",{font:b,fontSize:parseFloat(g),charSpace:0})*parseFloat(g)*1.5,width:S}},Fm={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},ep=function(_,p){var g={type:"reference",object:_};void 0===p.internal.getPageInfo(_.page).pageContext.annotations.find(function(b){return b.type===g.type&&b.object===g.object})&&p.internal.getPageInfo(_.page).pageContext.annotations.push(g)},S0=qo.__acroform__.arrayToPdfArray=function(_,p,g){var b=function(M){return M};if(Array.isArray(_)){for(var S="[",x=0;x<_.length;x++)switch(0!==x&&(S+=" "),(0,zn.Z)(_[x])){case"boolean":case"number":case"object":S+=_[x].toString();break;case"string":"/"!==_[x].substr(0,1)?(void 0!==p&&g&&(b=g.internal.getEncryptor(p)),S+="("+td(b(_[x].toString()))+")"):S+=_[x].toString()}return S+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Cr=function(_,p,g){var b=function(S){return S};return void 0!==p&&g&&(b=g.internal.getEncryptor(p)),(_=_||"").toString(),"("+td(b(_))+")"},_l=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(_){this._objId=_}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};_l.prototype.toString=function(){return this.objId+" 0 R"},_l.prototype.putStream=function(){var _=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:_,objectId:this.objId}),this.scope.internal.out("endobj")},_l.prototype.getKeyValueListForStream=function(){var _=[],p=Object.getOwnPropertyNames(this).filter(function(x){return"content"!=x&&"appearanceStreamContent"!=x&&"scope"!=x&&"objId"!=x&&"_"!=x.substring(0,1)});for(var g in p)if(!1===Object.getOwnPropertyDescriptor(this,p[g]).configurable){var b=p[g],S=this[b];S&&(Array.isArray(S)?_.push({key:b,value:S0(S,this.objId,this.scope)}):S instanceof _l?(S.scope=this.scope,_.push({key:b,value:S.objId+" 0 R"})):"function"!=typeof S&&_.push({key:b,value:S}))}return _};var D0=function(){_l.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var _,p=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return p},set:function(g){p=g}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(g){_=g.trim()},get:function(){return _||null}})};Is(D0,_l);var Sa=function(){_l.call(this);var _,p=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return p.length>0?p:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return p}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(_){var g=function(b){return b};return this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),"("+td(g(_))+")"}},set:function(g){_=g}})};Is(Sa,_l);var vl=function _(){_l.call(this);var p=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return p},set:function(se){if(isNaN(se))throw new Error('Invalid value "'+se+'" for attribute F supplied.');p=se}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(p,3))},set:function(se){this.F=!0===Boolean(se)?da(p,3):hr(p,3)}});var g=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return g},set:function(se){if(isNaN(se))throw new Error('Invalid value "'+se+'" for attribute Ff supplied.');g=se}});var b=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==b.length)return b},set:function(se){b=void 0!==se?se:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!b||isNaN(b[0])?0:b[0]},set:function(se){b[0]=se}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!b||isNaN(b[1])?0:b[1]},set:function(se){b[1]=se}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!b||isNaN(b[2])?0:b[2]},set:function(se){b[2]=se}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!b||isNaN(b[3])?0:b[3]},set:function(se){b[3]=se}});var S="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return S},set:function(se){switch(se){case"/Btn":case"/Tx":case"/Ch":case"/Sig":S=se;break;default:throw new Error('Invalid value "'+se+'" for attribute FT supplied.')}}});var x=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!x||x.length<1){if(this instanceof nd)return;x="FieldObject"+_.FieldNum++}var se=function(me){return me};return this.scope&&(se=this.scope.internal.getEncryptor(this.objId)),"("+td(se(x))+")"},set:function(se){x=se.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return x},set:function(se){x=se}});var M="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return M},set:function(se){M=se}});var P="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return P},set:function(se){P=se}});var O=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return O},set:function(se){O=se}});var H=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===H?50/C0:H},set:function(se){H=se}});var Y="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return Y},set:function(se){Y=se}});var Q="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!Q||this instanceof nd||this instanceof bu))return Cr(Q,this.objId,this.scope)},set:function(se){se=se.toString(),Q=se}});var re=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(re)return this instanceof Da?re:Cr(re,this.objId,this.scope)},set:function(se){se=se.toString(),re=this instanceof Da?se:"("===se.substr(0,1)?Ld(se.substr(1,se.length-2)):Ld(se)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Da?Ld(re.substr(1,re.length-1)):re},set:function(se){se=se.toString(),re=this instanceof Da?"/"+se:se}});var V=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(V)return V},set:function(se){this.V=se}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(V)return this instanceof Da?V:Cr(V,this.objId,this.scope)},set:function(se){se=se.toString(),V=this instanceof Da?se:"("===se.substr(0,1)?Ld(se.substr(1,se.length-2)):Ld(se)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Da?Ld(V.substr(1,V.length-1)):V},set:function(se){se=se.toString(),V=this instanceof Da?"/"+se:se}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var ve,ce=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return ce},set:function(se){se=Boolean(se),ce=se}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(ve)return ve},set:function(se){ve=se}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,1))},set:function(se){this.Ff=!0===Boolean(se)?da(this.Ff,1):hr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,2))},set:function(se){this.Ff=!0===Boolean(se)?da(this.Ff,2):hr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,3))},set:function(se){this.Ff=!0===Boolean(se)?da(this.Ff,3):hr(this.Ff,3)}});var be=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==be)return be},set:function(se){if(-1===[0,1,2].indexOf(se))throw new Error('Invalid value "'+se+'" for attribute Q supplied.');be=se}}),Object.defineProperty(this,"textAlign",{get:function(){var se;switch(be){case 0:default:se="left";break;case 1:se="center";break;case 2:se="right"}return se},configurable:!0,enumerable:!0,set:function(se){switch(se){case"right":case 2:be=2;break;case"center":case 1:be=1;break;default:be=0}}})};Is(vl,_l);var jd=function(){vl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var _=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return _},set:function(g){_=g}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return _},set:function(g){_=g}});var p=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return S0(p,this.objId,this.scope)},set:function(g){var b,S;S=[],"string"==typeof(b=g)&&(S=function(x,M,P){P||(P=1);for(var O,H=[];O=M.exec(x);)H.push(O[P]);return H}(b,/\((.*?)\)/g)),p=S}}),this.getOptions=function(){return p},this.setOptions=function(g){p=g,this.sort&&p.sort()},this.addOption=function(g){g=(g=g||"").toString(),p.push(g),this.sort&&p.sort()},this.removeOption=function(g,b){for(b=b||!1,g=(g=g||"").toString();-1!==p.indexOf(g)&&(p.splice(p.indexOf(g),1),!1!==b););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,18))},set:function(g){this.Ff=!0===Boolean(g)?da(this.Ff,18):hr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,19))},set:function(g){!0===this.combo&&(this.Ff=!0===Boolean(g)?da(this.Ff,19):hr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,20))},set:function(g){!0===Boolean(g)?(this.Ff=da(this.Ff,20),p.sort()):this.Ff=hr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,22))},set:function(g){this.Ff=!0===Boolean(g)?da(this.Ff,22):hr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,23))},set:function(g){this.Ff=!0===Boolean(g)?da(this.Ff,23):hr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,27))},set:function(g){this.Ff=!0===Boolean(g)?da(this.Ff,27):hr(this.Ff,27)}}),this.hasAppearanceStream=!1};Is(jd,vl);var Vi=function(){jd.call(this),this.fontName="helvetica",this.combo=!1};Is(Vi,jd);var Vd=function(){Vi.call(this),this.combo=!0};Is(Vd,Vi);var $l=function(){Vd.call(this),this.edit=!0};Is($l,Vd);var Da=function(){vl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,15))},set:function(g){this.Ff=!0===Boolean(g)?da(this.Ff,15):hr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,16))},set:function(g){this.Ff=!0===Boolean(g)?da(this.Ff,16):hr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,17))},set:function(g){this.Ff=!0===Boolean(g)?da(this.Ff,17):hr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,26))},set:function(g){this.Ff=!0===Boolean(g)?da(this.Ff,26):hr(this.Ff,26)}});var _,p={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var g=function(x){return x};if(this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(p).length){var b,S=[];for(b in S.push("<<"),p)S.push("/"+b+" ("+td(g(p[b]))+")");return S.push(">>"),S.join("\n")}},set:function(g){"object"===(0,zn.Z)(g)&&(p=g)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return p.CA||""},set:function(g){"string"==typeof g&&(p.CA=g)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return _},set:function(g){_=g}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return _.substr(1,_.length-1)},set:function(g){_="/"+g}})};Is(Da,vl);var lc=function(){Da.call(this),this.pushButton=!0};Is(lc,Da);var el=function(){Da.call(this),this.radio=!0,this.pushButton=!1;var _=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return _},set:function(p){_=void 0!==p?p:[]}})};Is(el,Da);var nd=function(){var _,p;vl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return _},set:function(S){_=S}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return p},set:function(S){p=S}});var g,b={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var S=function(P){return P};this.scope&&(S=this.scope.internal.getEncryptor(this.objId));var x,M=[];for(x in M.push("<<"),b)M.push("/"+x+" ("+td(S(b[x]))+")");return M.push(">>"),M.join("\n")},set:function(S){"object"===(0,zn.Z)(S)&&(b=S)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return b.CA||""},set:function(S){"string"==typeof S&&(b.CA=S)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return g},set:function(S){g=S}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return g.substr(1,g.length-1)},set:function(S){g="/"+S}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Kn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Is(nd,vl),el.prototype.setAppearance=function(_){if(!("createAppearanceStream"in _)||!("getCA"in _))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var p in this.Kids)if(this.Kids.hasOwnProperty(p)){var g=this.Kids[p];g.appearanceStreamContent=_.createAppearanceStream(g.optionName),g.caption=_.getCA()}},el.prototype.createOption=function(_){var p=new nd;return p.Parent=this,p.optionName=_,this.Kids.push(p),Gf.call(this.scope,p),p};var qf=function(){Da.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Kn.CheckBox.createAppearanceStream()};Is(qf,Da);var bu=function(){vl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,13))},set:function(p){this.Ff=!0===Boolean(p)?da(this.Ff,13):hr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,21))},set:function(p){this.Ff=!0===Boolean(p)?da(this.Ff,21):hr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,23))},set:function(p){this.Ff=!0===Boolean(p)?da(this.Ff,23):hr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,24))},set:function(p){this.Ff=!0===Boolean(p)?da(this.Ff,24):hr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,25))},set:function(p){this.Ff=!0===Boolean(p)?da(this.Ff,25):hr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,26))},set:function(p){this.Ff=!0===Boolean(p)?da(this.Ff,26):hr(this.Ff,26)}});var _=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return _},set:function(p){_=p}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return _},set:function(p){Number.isInteger(p)&&(_=p)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Is(bu,vl);var Ud=function(){bu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(Gt(this.Ff,14))},set:function(_){this.Ff=!0===Boolean(_)?da(this.Ff,14):hr(this.Ff,14)}}),this.password=!0};Is(Ud,bu);var Kn={CheckBox:{createAppearanceStream:function(){return{N:{On:Kn.CheckBox.YesNormal},D:{On:Kn.CheckBox.YesPushDown,Off:Kn.CheckBox.OffPushDown}}},YesPushDown:function(_){var p=ci(_);p.scope=_.scope;var g=[],b=_.scope.internal.getFont(_.fontName,_.fontStyle).id,S=_.scope.__private__.encodeColorString(_.color),x=Jh(_,_.caption);return g.push("0.749023 g"),g.push("0 0 "+ii(Kn.internal.getWidth(_))+" "+ii(Kn.internal.getHeight(_))+" re"),g.push("f"),g.push("BMC"),g.push("q"),g.push("0 0 1 rg"),g.push("/"+b+" "+ii(x.fontSize)+" Tf "+S),g.push("BT"),g.push(x.text),g.push("ET"),g.push("Q"),g.push("EMC"),p.stream=g.join("\n"),p},YesNormal:function(_){var p=ci(_);p.scope=_.scope;var g=_.scope.internal.getFont(_.fontName,_.fontStyle).id,b=_.scope.__private__.encodeColorString(_.color),S=[],x=Kn.internal.getHeight(_),M=Kn.internal.getWidth(_),P=Jh(_,_.caption);return S.push("1 g"),S.push("0 0 "+ii(M)+" "+ii(x)+" re"),S.push("f"),S.push("q"),S.push("0 0 1 rg"),S.push("0 0 "+ii(M-1)+" "+ii(x-1)+" re"),S.push("W"),S.push("n"),S.push("0 g"),S.push("BT"),S.push("/"+g+" "+ii(P.fontSize)+" Tf "+b),S.push(P.text),S.push("ET"),S.push("Q"),p.stream=S.join("\n"),p},OffPushDown:function(_){var p=ci(_);p.scope=_.scope;var g=[];return g.push("0.749023 g"),g.push("0 0 "+ii(Kn.internal.getWidth(_))+" "+ii(Kn.internal.getHeight(_))+" re"),g.push("f"),p.stream=g.join("\n"),p}},RadioButton:{Circle:{createAppearanceStream:function(_){var p={D:{Off:Kn.RadioButton.Circle.OffPushDown},N:{}};return p.N[_]=Kn.RadioButton.Circle.YesNormal,p.D[_]=Kn.RadioButton.Circle.YesPushDown,p},getCA:function(){return"l"},YesNormal:function(_){var p=ci(_);p.scope=_.scope;var g=[],b=Kn.internal.getWidth(_)<=Kn.internal.getHeight(_)?Kn.internal.getWidth(_)/4:Kn.internal.getHeight(_)/4;b=Number((.9*b).toFixed(5));var x=Number((b*Kn.internal.Bezier_C).toFixed(5));return g.push("q"),g.push("1 0 0 1 "+Qs(Kn.internal.getWidth(_)/2)+" "+Qs(Kn.internal.getHeight(_)/2)+" cm"),g.push(b+" 0 m"),g.push(b+" "+x+" "+x+" "+b+" 0 "+b+" c"),g.push("-"+x+" "+b+" -"+b+" "+x+" -"+b+" 0 c"),g.push("-"+b+" -"+x+" -"+x+" -"+b+" 0 -"+b+" c"),g.push(x+" -"+b+" "+b+" -"+x+" "+b+" 0 c"),g.push("f"),g.push("Q"),p.stream=g.join("\n"),p},YesPushDown:function(_){var p=ci(_);p.scope=_.scope;var g=[],b=Kn.internal.getWidth(_)<=Kn.internal.getHeight(_)?Kn.internal.getWidth(_)/4:Kn.internal.getHeight(_)/4;b=Number((.9*b).toFixed(5));var S=Number((2*b).toFixed(5)),x=Number((S*Kn.internal.Bezier_C).toFixed(5)),M=Number((b*Kn.internal.Bezier_C).toFixed(5));return g.push("0.749023 g"),g.push("q"),g.push("1 0 0 1 "+Qs(Kn.internal.getWidth(_)/2)+" "+Qs(Kn.internal.getHeight(_)/2)+" cm"),g.push(S+" 0 m"),g.push(S+" "+x+" "+x+" "+S+" 0 "+S+" c"),g.push("-"+x+" "+S+" -"+S+" "+x+" -"+S+" 0 c"),g.push("-"+S+" -"+x+" -"+x+" -"+S+" 0 -"+S+" c"),g.push(x+" -"+S+" "+S+" -"+x+" "+S+" 0 c"),g.push("f"),g.push("Q"),g.push("0 g"),g.push("q"),g.push("1 0 0 1 "+Qs(Kn.internal.getWidth(_)/2)+" "+Qs(Kn.internal.getHeight(_)/2)+" cm"),g.push(b+" 0 m"),g.push(b+" "+M+" "+M+" "+b+" 0 "+b+" c"),g.push("-"+M+" "+b+" -"+b+" "+M+" -"+b+" 0 c"),g.push("-"+b+" -"+M+" -"+M+" -"+b+" 0 -"+b+" c"),g.push(M+" -"+b+" "+b+" -"+M+" "+b+" 0 c"),g.push("f"),g.push("Q"),p.stream=g.join("\n"),p},OffPushDown:function(_){var p=ci(_);p.scope=_.scope;var g=[],b=Kn.internal.getWidth(_)<=Kn.internal.getHeight(_)?Kn.internal.getWidth(_)/4:Kn.internal.getHeight(_)/4;b=Number((.9*b).toFixed(5));var S=Number((2*b).toFixed(5)),x=Number((S*Kn.internal.Bezier_C).toFixed(5));return g.push("0.749023 g"),g.push("q"),g.push("1 0 0 1 "+Qs(Kn.internal.getWidth(_)/2)+" "+Qs(Kn.internal.getHeight(_)/2)+" cm"),g.push(S+" 0 m"),g.push(S+" "+x+" "+x+" "+S+" 0 "+S+" c"),g.push("-"+x+" "+S+" -"+S+" "+x+" -"+S+" 0 c"),g.push("-"+S+" -"+x+" -"+x+" -"+S+" 0 -"+S+" c"),g.push(x+" -"+S+" "+S+" -"+x+" "+S+" 0 c"),g.push("f"),g.push("Q"),p.stream=g.join("\n"),p}},Cross:{createAppearanceStream:function(_){var p={D:{Off:Kn.RadioButton.Cross.OffPushDown},N:{}};return p.N[_]=Kn.RadioButton.Cross.YesNormal,p.D[_]=Kn.RadioButton.Cross.YesPushDown,p},getCA:function(){return"8"},YesNormal:function(_){var p=ci(_);p.scope=_.scope;var g=[],b=Kn.internal.calculateCross(_);return g.push("q"),g.push("1 1 "+ii(Kn.internal.getWidth(_)-2)+" "+ii(Kn.internal.getHeight(_)-2)+" re"),g.push("W"),g.push("n"),g.push(ii(b.x1.x)+" "+ii(b.x1.y)+" m"),g.push(ii(b.x2.x)+" "+ii(b.x2.y)+" l"),g.push(ii(b.x4.x)+" "+ii(b.x4.y)+" m"),g.push(ii(b.x3.x)+" "+ii(b.x3.y)+" l"),g.push("s"),g.push("Q"),p.stream=g.join("\n"),p},YesPushDown:function(_){var p=ci(_);p.scope=_.scope;var g=Kn.internal.calculateCross(_),b=[];return b.push("0.749023 g"),b.push("0 0 "+ii(Kn.internal.getWidth(_))+" "+ii(Kn.internal.getHeight(_))+" re"),b.push("f"),b.push("q"),b.push("1 1 "+ii(Kn.internal.getWidth(_)-2)+" "+ii(Kn.internal.getHeight(_)-2)+" re"),b.push("W"),b.push("n"),b.push(ii(g.x1.x)+" "+ii(g.x1.y)+" m"),b.push(ii(g.x2.x)+" "+ii(g.x2.y)+" l"),b.push(ii(g.x4.x)+" "+ii(g.x4.y)+" m"),b.push(ii(g.x3.x)+" "+ii(g.x3.y)+" l"),b.push("s"),b.push("Q"),p.stream=b.join("\n"),p},OffPushDown:function(_){var p=ci(_);p.scope=_.scope;var g=[];return g.push("0.749023 g"),g.push("0 0 "+ii(Kn.internal.getWidth(_))+" "+ii(Kn.internal.getHeight(_))+" re"),g.push("f"),p.stream=g.join("\n"),p}}},createDefaultAppearanceStream:function(_){var p=_.scope.internal.getFont(_.fontName,_.fontStyle).id,g=_.scope.__private__.encodeColorString(_.color);return"/"+p+" "+_.fontSize+" Tf "+g}};Kn.internal={Bezier_C:.551915024494,calculateCross:function(_){var p=Kn.internal.getWidth(_),g=Kn.internal.getHeight(_),b=Math.min(p,g);return{x1:{x:(p-b)/2,y:(g-b)/2+b},x2:{x:(p-b)/2+b,y:(g-b)/2},x3:{x:(p-b)/2,y:(g-b)/2},x4:{x:(p-b)/2+b,y:(g-b)/2+b}}}},Kn.internal.getWidth=function(_){var p=0;return"object"===(0,zn.Z)(_)&&(p=Js(_.Rect[2])),p},Kn.internal.getHeight=function(_){var p=0;return"object"===(0,zn.Z)(_)&&(p=Js(_.Rect[3])),p};var Gf=qo.addField=function(_){if(function(_,p){if(p.scope=_,void 0!==_.internal&&(void 0===_.internal.acroformPlugin||!1===_.internal.acroformPlugin.isInitialized)){if(vl.FieldNum=0,_.internal.acroformPlugin=JSON.parse(JSON.stringify(Fm)),_.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");C0=_.internal.scaleFactor,_.internal.acroformPlugin.acroFormDictionaryRoot=new Sa,_.internal.acroformPlugin.acroFormDictionaryRoot.scope=_,_.internal.acroformPlugin.acroFormDictionaryRoot._eventID=_.internal.events.subscribe("postPutResources",function(){var g;(g=_).internal.events.unsubscribe(g.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete g.internal.acroformPlugin.acroFormDictionaryRoot._eventID,g.internal.acroformPlugin.printedOut=!0}),_.internal.events.subscribe("buildDocument",function(){!function(g){g.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var b=g.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var S in b)if(b.hasOwnProperty(S)){var x=b[S];x.objId=void 0,x.hasAnnotation&&ep(x,g)}}(_)}),_.internal.events.subscribe("putCatalog",function(){!function(g){if(void 0===g.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");g.internal.write("/AcroForm "+g.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(_)}),_.internal.events.subscribe("postPutPages",function(g){!function(b,S){var x=!b;for(var M in b||(S.internal.newObjectDeferredBegin(S.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),S.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),b=b||S.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(b.hasOwnProperty(M)){var P=b[M],O=[],H=P.Rect;if(P.Rect&&(P.Rect=Qh(P.Rect,S)),S.internal.newObjectDeferredBegin(P.objId,!0),P.DA=Kn.createDefaultAppearanceStream(P),"object"===(0,zn.Z)(P)&&"function"==typeof P.getKeyValueListForStream&&(O=P.getKeyValueListForStream()),P.Rect=H,P.hasAppearanceStream&&!P.appearanceStreamContent){var Y=Bd(P);O.push({key:"AP",value:"<</N "+Y+">>"}),S.internal.acroformPlugin.xForms.push(Y)}if(P.appearanceStreamContent){var Q="";for(var re in P.appearanceStreamContent)if(P.appearanceStreamContent.hasOwnProperty(re)){var V=P.appearanceStreamContent[re];if(Q+="/"+re+" ",Q+="<<",Object.keys(V).length>=1||Array.isArray(V)){for(var M in V)if(V.hasOwnProperty(M)){var ve=V[M];"function"==typeof ve&&(ve=ve.call(S,P)),Q+="/"+M+" "+ve+" ",S.internal.acroformPlugin.xForms.indexOf(ve)>=0||S.internal.acroformPlugin.xForms.push(ve)}}else"function"==typeof(ve=V)&&(ve=ve.call(S,P)),Q+="/"+M+" "+ve,S.internal.acroformPlugin.xForms.indexOf(ve)>=0||S.internal.acroformPlugin.xForms.push(ve);Q+=">>"}O.push({key:"AP",value:"<<\n"+Q+">>"})}S.internal.putStream({additionalKeyValues:O,objectId:P.objId}),S.internal.out("endobj")}x&&function(_,p){for(var g in _)if(_.hasOwnProperty(g)){var b=g,S=_[g];p.internal.newObjectDeferredBegin(S.objId,!0),"object"===(0,zn.Z)(S)&&"function"==typeof S.putStream&&S.putStream(),delete _[b]}}(S.internal.acroformPlugin.xForms,S)}(g,_)}),_.internal.acroformPlugin.isInitialized=!0}}(this,_),!(_ instanceof vl))throw new Error("Invalid argument passed to jsPDF.addField.");var p;return(p=_).scope.internal.acroformPlugin.printedOut&&(p.scope.internal.acroformPlugin.printedOut=!1,p.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),p.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(p),_.page=_.scope.internal.getCurrentPageInfo().pageNumber,this};qo.AcroFormChoiceField=jd,qo.AcroFormListBox=Vi,qo.AcroFormComboBox=Vd,qo.AcroFormEditBox=$l,qo.AcroFormButton=Da,qo.AcroFormPushButton=lc,qo.AcroFormRadioButton=el,qo.AcroFormCheckBox=qf,qo.AcroFormTextField=bu,qo.AcroFormPasswordField=Ud,qo.AcroFormAppearance=Kn,qo.AcroForm={ChoiceField:jd,ListBox:Vi,ComboBox:Vd,EditBox:$l,Button:Da,PushButton:lc,RadioButton:el,CheckBox:qf,TextField:bu,PasswordField:Ud,Appearance:Kn};var _,p,Hd=Pr.AcroForm={ChoiceField:jd,ListBox:Vi,ComboBox:Vd,EditBox:$l,Button:Da,PushButton:lc,RadioButton:el,CheckBox:qf,TextField:bu,PasswordField:Ud,Appearance:Kn};function A0(_){return _.reduce(function(p,g,b){return p[g]=b,p},{})}(function(_){_.__addimage__={};var p="UNKNOWN",g={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},b=_.__addimage__.getImageFileTypeByImageData=function(fe,de){var He,Ne,Tt,St,zt,gt=p;if("RGBA"===(de=de||p)||void 0!==fe.data&&fe.data instanceof Uint8ClampedArray&&"height"in fe&&"width"in fe)return"RGBA";if(ln(fe))for(zt in g)for(Tt=g[zt],He=0;He<Tt.length;He+=1){for(St=!0,Ne=0;Ne<Tt[He].length;Ne+=1)if(void 0!==Tt[He][Ne]&&Tt[He][Ne]!==fe[Ne]){St=!1;break}if(!0===St){gt=zt;break}}else for(zt in g)for(Tt=g[zt],He=0;He<Tt.length;He+=1){for(St=!0,Ne=0;Ne<Tt[He].length;Ne+=1)if(void 0!==Tt[He][Ne]&&Tt[He][Ne]!==fe.charCodeAt(Ne)){St=!1;break}if(!0===St){gt=zt;break}}return gt===p&&de!==p&&(gt=de),gt},S=function fe(de){for(var He=this.internal.write,Ne=this.internal.putStream,Tt=(0,this.internal.getFilters)();-1!==Tt.indexOf("FlateEncode");)Tt.splice(Tt.indexOf("FlateEncode"),1);de.objectId=this.internal.newObject();var St=[];if(St.push({key:"Type",value:"/XObject"}),St.push({key:"Subtype",value:"/Image"}),St.push({key:"Width",value:de.width}),St.push({key:"Height",value:de.height}),de.colorSpace===be.INDEXED?St.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(de.palette.length/3-1)+" "+("sMask"in de&&void 0!==de.sMask?de.objectId+2:de.objectId+1)+" 0 R]"}):(St.push({key:"ColorSpace",value:"/"+de.colorSpace}),de.colorSpace===be.DEVICE_CMYK&&St.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),St.push({key:"BitsPerComponent",value:de.bitsPerComponent}),"decodeParameters"in de&&void 0!==de.decodeParameters&&St.push({key:"DecodeParms",value:"<<"+de.decodeParameters+">>"}),"transparency"in de&&Array.isArray(de.transparency)){for(var zt="",gt=0,Zt=de.transparency.length;gt<Zt;gt++)zt+=de.transparency[gt]+" "+de.transparency[gt]+" ";St.push({key:"Mask",value:"["+zt+"]"})}if(void 0!==de.sMask&&St.push({key:"SMask",value:de.objectId+1+" 0 R"}),Ne({data:de.data,additionalKeyValues:St,alreadyAppliedFilters:void 0!==de.filter?["/"+de.filter]:void 0,objectId:de.objectId}),He("endobj"),"sMask"in de&&void 0!==de.sMask){var J={width:de.width,height:de.height,colorSpace:"DeviceGray",bitsPerComponent:de.bitsPerComponent,decodeParameters:"/Predictor "+de.predictor+" /Colors 1 /BitsPerComponent "+de.bitsPerComponent+" /Columns "+de.width,data:de.sMask};"filter"in de&&(J.filter=de.filter),fe.call(this,J)}if(de.colorSpace===be.INDEXED){var we=this.internal.newObject();Ne({data:Oe(new Uint8Array(de.palette)),objectId:we}),He("endobj")}},x=function(){var fe=this.internal.collections.addImage_images;for(var de in fe)S.call(this,fe[de])},M=function(){var fe,de=this.internal.collections.addImage_images,He=this.internal.write;for(var Ne in de)He("/I"+(fe=de[Ne]).index,fe.objectId,"0","R")},P=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",x),this.internal.events.subscribe("putXobjectDict",M))},O=function(){var fe=this.internal.collections.addImage_images;return P.call(this),fe},H=function(){return Object.keys(this.internal.collections.addImage_images).length},Y=function(fe){return"function"==typeof _["process"+fe.toUpperCase()]},Q=function(fe){return"object"===(0,zn.Z)(fe)&&1===fe.nodeType},re=function(fe,de){if("IMG"===fe.nodeName&&fe.hasAttribute("src")){var He=""+fe.getAttribute("src");if(0===He.indexOf("data:image/"))return Ea(unescape(He).split("base64,").pop());var Ne=_.loadFile(He,!0);if(void 0!==Ne)return Ne}if("CANVAS"===fe.nodeName){if(0===fe.width||0===fe.height)throw new Error("Given canvas must have data. Canvas width: "+fe.width+", height: "+fe.height);var Tt;switch(de){case"PNG":Tt="image/png";break;case"WEBP":Tt="image/webp";break;default:Tt="image/jpeg"}return Ea(fe.toDataURL(Tt,1).split("base64,").pop())}},V=function(fe){var de=this.internal.collections.addImage_images;if(de)for(var He in de)if(fe===de[He].alias)return de[He]},ve=function(fe,de,He){return fe||de||(fe=-96,de=-96),fe<0&&(fe=-1*He.width*72/fe/this.internal.scaleFactor),de<0&&(de=-1*He.height*72/de/this.internal.scaleFactor),0===fe&&(fe=de*He.width/He.height),0===de&&(de=fe*He.height/He.width),[fe,de]},ce=function(fe,de,He,Ne,Tt,St){var zt=ve.call(this,He,Ne,Tt),gt=this.internal.getCoordinateString,Zt=this.internal.getVerticalCoordinateString,Wt=O.call(this);if(He=zt[0],Ne=zt[1],Wt[Tt.index]=Tt,St){St*=Math.PI/180;var Yn=Math.cos(St),J=Math.sin(St),we=function($e){return $e.toFixed(4)},Te=[we(Yn),we(J),we(-1*J),we(Yn),0,0,"cm"]}this.internal.write("q"),St?(this.internal.write([1,"0","0",1,gt(fe),Zt(de+Ne),"cm"].join(" ")),this.internal.write(Te.join(" ")),this.internal.write([gt(He),"0","0",gt(Ne),"0","0","cm"].join(" "))):this.internal.write([gt(He),"0","0",gt(Ne),gt(fe),Zt(de+Ne),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Tt.index+" Do"),this.internal.write("Q")},be=_.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};_.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var se=_.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},me=_.__addimage__.sHashCode=function(fe){var de,He,Ne=0;if("string"==typeof fe)for(He=fe.length,de=0;de<He;de++)Ne=(Ne<<5)-Ne+fe.charCodeAt(de),Ne|=0;else if(ln(fe))for(He=fe.byteLength/2,de=0;de<He;de++)Ne=(Ne<<5)-Ne+fe[de],Ne|=0;return Ne},Be=_.__addimage__.validateStringAsBase64=function(fe){(fe=fe||"").toString().trim();var de=!0;return 0===fe.length&&(de=!1),fe.length%4!=0&&(de=!1),!1===/^[A-Za-z0-9+/]+$/.test(fe.substr(0,fe.length-2))&&(de=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(fe.substr(-2))&&(de=!1),de},st=_.__addimage__.extractImageFromDataUrl=function(fe){var de=(fe=fe||"").split("base64,"),He=null;if(2===de.length){var Ne=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(de[0]);Array.isArray(Ne)&&(He={mimeType:Ne[1],charset:Ne[2],data:de[1]})}return He},At=_.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};_.__addimage__.isArrayBuffer=function(fe){return At()&&fe instanceof ArrayBuffer};var ln=_.__addimage__.isArrayBufferView=function(fe){return At()&&typeof Uint32Array<"u"&&(fe instanceof Int8Array||fe instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&fe instanceof Uint8ClampedArray||fe instanceof Int16Array||fe instanceof Uint16Array||fe instanceof Int32Array||fe instanceof Uint32Array||fe instanceof Float32Array||fe instanceof Float64Array)},nt=_.__addimage__.binaryStringToUint8Array=function(fe){for(var de=fe.length,He=new Uint8Array(de),Ne=0;Ne<de;Ne++)He[Ne]=fe.charCodeAt(Ne);return He},Oe=_.__addimage__.arrayBufferToBinaryString=function(fe){for(var de="",He=ln(fe)?fe:new Uint8Array(fe),Ne=0;Ne<He.length;Ne+=8192)de+=String.fromCharCode.apply(null,He.subarray(Ne,Ne+8192));return de};_.addImage=function(){var fe,de,He,Ne,Tt,St,zt,gt,Zt;if("number"==typeof arguments[1]?(de=p,He=arguments[1],Ne=arguments[2],Tt=arguments[3],St=arguments[4],zt=arguments[5],gt=arguments[6],Zt=arguments[7]):(de=arguments[1],He=arguments[2],Ne=arguments[3],Tt=arguments[4],St=arguments[5],zt=arguments[6],gt=arguments[7],Zt=arguments[8]),"object"===(0,zn.Z)(fe=arguments[0])&&!Q(fe)&&"imageData"in fe){var Wt=fe;fe=Wt.imageData,de=Wt.format||de||p,He=Wt.x||He||0,Ne=Wt.y||Ne||0,Tt=Wt.w||Wt.width||Tt,St=Wt.h||Wt.height||St,zt=Wt.alias||zt,gt=Wt.compression||gt,Zt=Wt.rotation||Wt.angle||Zt}var Yn=this.internal.getFilters();if(void 0===gt&&-1!==Yn.indexOf("FlateEncode")&&(gt="SLOW"),isNaN(He)||isNaN(Ne))throw new Error("Invalid coordinates passed to jsPDF.addImage");P.call(this);var J=Kt.call(this,fe,de,zt,gt);return ce.call(this,He,Ne,Tt,St,J,Zt),this};var Kt=function(fe,de,He,Ne){var Tt,St,zt,Zt;if("string"==typeof fe&&b(fe)===p){fe=unescape(fe);var gt=Yt(fe,!1);(""!==gt||void 0!==(gt=_.loadFile(fe,!0)))&&(fe=gt)}if(Q(fe)&&(fe=re(fe,de)),de=b(fe,de),!Y(de))throw new Error("addImage does not support files of type '"+de+"', please ensure that a plugin for '"+de+"' support is added.");if((null==(zt=He)||0===zt.length)&&(He="string"==typeof(Zt=fe)||ln(Zt)?me(Zt):ln(Zt.data)?me(Zt.data):null),(Tt=V.call(this,He))||(At()&&(fe instanceof Uint8Array||"RGBA"===de||(St=fe,fe=nt(fe))),Tt=this["process"+de.toUpperCase()](fe,H.call(this),He,function(Zt){return Zt&&"string"==typeof Zt&&(Zt=Zt.toUpperCase()),Zt in _.image_compression?Zt:se.NONE}(Ne),St)),!Tt)throw new Error("An unknown error occurred whilst processing the image.");return Tt},Yt=_.__addimage__.convertBase64ToBinaryString=function(fe,de){var He;de="boolean"!=typeof de||de;var Ne,Tt="";if("string"==typeof fe){Ne=null!==(He=st(fe))?He.data:fe;try{Tt=Ea(Ne)}catch(St){if(de)throw Be(Ne)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+St.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Tt};_.getImageProperties=function(fe){var de,He,Ne="";if(Q(fe)&&(fe=re(fe)),"string"==typeof fe&&b(fe)===p&&(""===(Ne=Yt(fe,!1))&&(Ne=_.loadFile(fe)||""),fe=Ne),He=b(fe),!Y(He))throw new Error("addImage does not support files of type '"+He+"', please ensure that a plugin for '"+He+"' support is added.");if(!At()||fe instanceof Uint8Array||(fe=nt(fe)),!(de=this["process"+He.toUpperCase()](fe)))throw new Error("An unknown error occurred whilst processing the image");return de.fileType=He,de}})(Pr.API),
/**
         * @license
         * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
_=Pr.API,p=function(g){if(void 0!==g&&""!=g)return!0},Pr.API.events.push(["addPage",function(g){this.internal.getPageInfo(g.pageNumber).pageContext.annotations=[]}]),_.events.push(["putPage",function(g){for(var b,S,x,M=this.internal.getCoordinateString,P=this.internal.getVerticalCoordinateString,O=this.internal.getPageInfoByObjId(g.objId),H=g.pageContext.annotations,Y=!1,Q=0;Q<H.length&&!Y;Q++)switch((b=H[Q]).type){case"link":(p(b.options.url)||p(b.options.pageNumber))&&(Y=!0);break;case"reference":case"text":case"freetext":Y=!0}if(0!=Y){this.internal.write("/Annots [");for(var re=0;re<H.length;re++){b=H[re];var V=this.internal.pdfEscape,ve=this.internal.getEncryptor(g.objId);switch(b.type){case"reference":this.internal.write(" "+b.object.objId+" 0 R ");break;case"text":var ce=this.internal.newAdditionalObject(),be=this.internal.newAdditionalObject(),se=this.internal.getEncryptor(ce.objId),me=b.title||"Note";x="<</Type /Annot /Subtype /Text "+(S="/Rect ["+M(b.bounds.x)+" "+P(b.bounds.y+b.bounds.h)+" "+M(b.bounds.x+b.bounds.w)+" "+P(b.bounds.y)+"] ")+"/Contents ("+V(se(b.contents))+")",x+=" /Popup "+be.objId+" 0 R",x+=" /P "+O.objId+" 0 R",x+=" /T ("+V(se(me))+") >>",ce.content=x;var Be=ce.objId+" 0 R";x="<</Type /Annot /Subtype /Popup "+(S="/Rect ["+M(b.bounds.x+30)+" "+P(b.bounds.y+b.bounds.h)+" "+M(b.bounds.x+b.bounds.w+30)+" "+P(b.bounds.y)+"] ")+" /Parent "+Be,b.open&&(x+=" /Open true"),be.content=x+=" >>",this.internal.write(ce.objId,"0 R",be.objId,"0 R");break;case"freetext":S="/Rect ["+M(b.bounds.x)+" "+P(b.bounds.y)+" "+M(b.bounds.x+b.bounds.w)+" "+P(b.bounds.y+b.bounds.h)+"] ";var st=b.color||"#000000";x="<</Type /Annot /Subtype /FreeText "+S+"/Contents ("+V(ve(b.contents))+")",x+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+st+")",x+=" /Border [0 0 0]",this.internal.write(x+=" >>");break;case"link":if(b.options.name){var At=this.annotations._nameMap[b.options.name];b.options.pageNumber=At.page,b.options.top=At.y}else b.options.top||(b.options.top=0);if(S="/Rect ["+b.finalBounds.x+" "+b.finalBounds.y+" "+b.finalBounds.w+" "+b.finalBounds.h+"] ",x="",b.options.url)x="<</Type /Annot /Subtype /Link "+S+"/Border [0 0 0] /A <</S /URI /URI ("+V(ve(b.options.url))+") >>";else if(b.options.pageNumber)switch(x="<</Type /Annot /Subtype /Link "+S+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(b.options.pageNumber).objId+" 0 R",b.options.magFactor=b.options.magFactor||"XYZ",b.options.magFactor){case"Fit":x+=" /Fit]";break;case"FitH":x+=" /FitH "+b.options.top+"]";break;case"FitV":b.options.left=b.options.left||0,x+=" /FitV "+b.options.left+"]";break;default:var ln=P(b.options.top);b.options.left=b.options.left||0,void 0===b.options.zoom&&(b.options.zoom=0),x+=" /XYZ "+b.options.left+" "+ln+" "+b.options.zoom+"]"}""!=x&&this.internal.write(x+=" >>")}}this.internal.write("]")}}]),_.createAnnotation=function(g){var b=this.internal.getCurrentPageInfo();switch(g.type){case"link":this.link(g.bounds.x,g.bounds.y,g.bounds.w,g.bounds.h,g);break;case"text":case"freetext":b.pageContext.annotations.push(g)}},_.link=function(g,b,S,x,M){var P=this.internal.getCurrentPageInfo(),O=this.internal.getCoordinateString,H=this.internal.getVerticalCoordinateString;P.pageContext.annotations.push({finalBounds:{x:O(g),y:H(b),w:O(g+S),h:H(b+x)},options:M,type:"link"})},_.textWithLink=function(g,b,S,x){var M,P,O=this.getTextWidth(g),H=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==x.maxWidth){var Y=this.splitTextToSize(g,P=x.maxWidth).length;M=Math.ceil(H*Y)}else P=O,M=H;return this.text(g,b,S,x),"center"===x.align&&(b-=O/2),"right"===x.align&&(b-=O),this.link(b,(S+=.2*H)-H,P,M,x),O},_.getTextWidth=function(g){var b=this.internal.getFontSize();return this.getStringUnitWidth(g)*b/this.internal.scaleFactor},
/**
         * @license
         * Copyright (c) 2017 Aras Abbasi
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){var p={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},g={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},b={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},S=[1570,1571,1573,1575];_.__arabicParser__={};var x=_.__arabicParser__.isInArabicSubstitutionA=function(ce){return void 0!==p[ce.charCodeAt(0)]},M=_.__arabicParser__.isArabicLetter=function(ce){return"string"==typeof ce&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(ce)},P=_.__arabicParser__.isArabicEndLetter=function(ce){return M(ce)&&x(ce)&&p[ce.charCodeAt(0)].length<=2},O=_.__arabicParser__.isArabicAlfLetter=function(ce){return M(ce)&&S.indexOf(ce.charCodeAt(0))>=0};_.__arabicParser__.arabicLetterHasIsolatedForm=function(ce){return M(ce)&&x(ce)&&p[ce.charCodeAt(0)].length>=1};var H=_.__arabicParser__.arabicLetterHasFinalForm=function(ce){return M(ce)&&x(ce)&&p[ce.charCodeAt(0)].length>=2};_.__arabicParser__.arabicLetterHasInitialForm=function(ce){return M(ce)&&x(ce)&&p[ce.charCodeAt(0)].length>=3};var Y=_.__arabicParser__.arabicLetterHasMedialForm=function(ce){return M(ce)&&x(ce)&&4==p[ce.charCodeAt(0)].length},Q=_.__arabicParser__.resolveLigatures=function(ce){var be=0,se=g,me="",Be=0;for(be=0;be<ce.length;be+=1)void 0!==se[ce.charCodeAt(be)]?(Be++,"number"==typeof(se=se[ce.charCodeAt(be)])&&(me+=String.fromCharCode(se),se=g,Be=0),be===ce.length-1&&(se=g,me+=ce.charAt(be-(Be-1)),be-=Be-1,Be=0)):(se=g,me+=ce.charAt(be-Be),be-=Be,Be=0);return me};_.__arabicParser__.isArabicDiacritic=function(ce){return void 0!==ce&&void 0!==b[ce.charCodeAt(0)]};var re=_.__arabicParser__.getCorrectForm=function(ce,be,se){return M(ce)?!1===x(ce)?-1:!H(ce)||!M(be)&&!M(se)||!M(se)&&P(be)||P(ce)&&!M(be)||P(ce)&&O(be)||P(ce)&&P(be)?0:Y(ce)&&M(be)&&!P(be)&&M(se)&&H(se)?3:P(ce)||!M(se)?1:2:-1},V=function(ce){var be=0,se=0,me=0,Be="",st="",At="",ln=(ce=ce||"").split("\\s+"),nt=[];for(be=0;be<ln.length;be+=1){for(nt.push(""),se=0;se<ln[be].length;se+=1)st=ln[be][se-1],At=ln[be][se+1],M(Be=ln[be][se])?(me=re(Be,st,At),nt[be]+=-1!==me?String.fromCharCode(p[Be.charCodeAt(0)][me]):Be):nt[be]+=Be;nt[be]=Q(nt[be])}return nt.join(" ")},ve=_.__arabicParser__.processArabic=_.processArabic=function(){var ce,be="string"==typeof arguments[0]?arguments[0]:arguments[0].text,se=[];if(Array.isArray(be)){var me=0;for(se=[],me=0;me<be.length;me+=1)Array.isArray(be[me])?se.push([V(be[me][0]),be[me][1],be[me][2]]):se.push([V(be[me])]);ce=se}else ce=V(be);return"string"==typeof arguments[0]?ce:(arguments[0].text=ce,arguments[0])};_.events.push(["preProcessText",ve])}(Pr.API),Pr.API.autoPrint=function(_){var p;return"javascript"===((_=_||{}).variant=_.variant||"non-conform",_.variant)?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){p=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+p+" 0 R")})),this},
/**
         * @license
         * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){var p=function(){var g=void 0;Object.defineProperty(this,"pdf",{get:function(){return g},set:function(P){g=P}});var b=150;Object.defineProperty(this,"width",{get:function(){return b},set:function(P){b=isNaN(P)||!1===Number.isInteger(P)||P<0?150:P,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=b+1)}});var S=300;Object.defineProperty(this,"height",{get:function(){return S},set:function(P){S=isNaN(P)||!1===Number.isInteger(P)||P<0?300:P,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=S+1)}});var x=[];Object.defineProperty(this,"childNodes",{get:function(){return x},set:function(P){x=P}});var M={};Object.defineProperty(this,"style",{get:function(){return M},set:function(P){M=P}}),Object.defineProperty(this,"parentNode",{})};p.prototype.getContext=function(g,b){var S;if("2d"!==(g=g||"2d"))return null;for(S in b)this.pdf.context2d.hasOwnProperty(S)&&(this.pdf.context2d[S]=b[S]);return this.pdf.context2d._canvas=this,this.pdf.context2d},p.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},_.events.push(["initialized",function(){this.canvas=new p,this.canvas.pdf=this}])}(Pr.API),function(_){var p={left:0,top:0,bottom:0,right:0},g=!1,b=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},p),this.internal.__cell__.margins.width=this.getPageWidth(),S.call(this))},S=function(){this.internal.__cell__.lastCell=new x,this.internal.__cell__.pages=1},x=function(){var O=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return O},set:function(ce){O=ce}});var H=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return H},set:function(ce){H=ce}});var Y=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return Y},set:function(ce){Y=ce}});var Q=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return Q},set:function(ce){Q=ce}});var re=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return re},set:function(ce){re=ce}});var V=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return V},set:function(ce){V=ce}});var ve=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return ve},set:function(ce){ve=ce}}),this};x.prototype.clone=function(){return new x(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},x.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},_.setHeaderFunction=function(O){return b.call(this),this.internal.__cell__.headerFunction="function"==typeof O?O:void 0,this},_.getTextDimensions=function(O,H){b.call(this);var Y=(H=H||{}).fontSize||this.getFontSize(),Q=H.font||this.getFont(),re=H.scaleFactor||this.internal.scaleFactor,V=0,ve=0,ce=0,be=this;if(!Array.isArray(O)&&"string"!=typeof O){if("number"!=typeof O)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");O=String(O)}var se=H.maxWidth;se>0?"string"==typeof O?O=this.splitTextToSize(O,se):"[object Array]"===Object.prototype.toString.call(O)&&(O=O.reduce(function(Be,st){return Be.concat(be.splitTextToSize(st,se))},[])):O=Array.isArray(O)?O:[O];for(var me=0;me<O.length;me++)V<(ce=this.getStringUnitWidth(O[me],{font:Q})*Y)&&(V=ce);return 0!==V&&(ve=O.length),{w:V/=re,h:Math.max((ve*Y*this.getLineHeightFactor()-Y*(this.getLineHeightFactor()-1))/re,0)}},_.cellAddPage=function(){b.call(this),this.addPage();var O=this.internal.__cell__.margins||p;return this.internal.__cell__.lastCell=new x(O.left,O.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var M=_.cell=function(){var O;O=arguments[0]instanceof x?arguments[0]:new x(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),b.call(this);var H=this.internal.__cell__.lastCell,Y=this.internal.__cell__.padding,Q=this.internal.__cell__.margins||p,re=this.internal.__cell__.tableHeaderRow,V=this.internal.__cell__.printHeaders;return void 0!==H.lineNumber&&(H.lineNumber===O.lineNumber?(O.x=(H.x||0)+(H.width||0),O.y=H.y||0):H.y+H.height+O.height+Q.bottom>this.getPageHeight()?(this.cellAddPage(),O.y=Q.top,V&&re&&(this.printHeaderRow(O.lineNumber,!0),O.y+=re[0].height)):O.y=H.y+H.height||O.y),void 0!==O.text[0]&&(this.rect(O.x,O.y,O.width,O.height,!0===g?"FD":void 0),"right"===O.align?this.text(O.text,O.x+O.width-Y,O.y+Y,{align:"right",baseline:"top"}):"center"===O.align?this.text(O.text,O.x+O.width/2,O.y+Y,{align:"center",baseline:"top",maxWidth:O.width-Y-Y}):this.text(O.text,O.x+Y,O.y+Y,{align:"left",baseline:"top",maxWidth:O.width-Y-Y})),this.internal.__cell__.lastCell=O,this};_.table=function(O,H,Y,Q,re){if(b.call(this),!Y)throw new Error("No data for PDF table.");var V,ve,ce,be,se=[],me=[],Be=[],st={},At={},ln=[],nt=[],Oe=(re=re||{}).autoSize||!1,Kt=!1!==re.printHeaders,Yt=re.css&&void 0!==re.css["font-size"]?16*re.css["font-size"]:re.fontSize||12,fe=re.margins||Object.assign({width:this.getPageWidth()},p),de="number"==typeof re.padding?re.padding:3,He=re.headerBackgroundColor||"#c8c8c8",Ne=re.headerTextColor||"#000";if(S.call(this),this.internal.__cell__.printHeaders=Kt,this.internal.__cell__.margins=fe,this.internal.__cell__.table_font_size=Yt,this.internal.__cell__.padding=de,this.internal.__cell__.headerBackgroundColor=He,this.internal.__cell__.headerTextColor=Ne,this.setFontSize(Yt),null==Q)me=se=Object.keys(Y[0]),Be=se.map(function(){return"left"});else if(Array.isArray(Q)&&"object"===(0,zn.Z)(Q[0]))for(se=Q.map(function(Wt){return Wt.name}),me=Q.map(function(Wt){return Wt.prompt||Wt.name||""}),Be=Q.map(function(Wt){return Wt.align||"left"}),V=0;V<Q.length;V+=1)At[Q[V].name]=Q[V].width*(19.049976/25.4);else Array.isArray(Q)&&"string"==typeof Q[0]&&(me=se=Q,Be=se.map(function(){return"left"}));if(Oe||Array.isArray(Q)&&"string"==typeof Q[0])for(V=0;V<se.length;V+=1){for(st[be=se[V]]=Y.map(function(Wt){return Wt[be]}),this.setFont(void 0,"bold"),ln.push(this.getTextDimensions(me[V],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),ve=st[be],this.setFont(void 0,"normal"),ce=0;ce<ve.length;ce+=1)ln.push(this.getTextDimensions(ve[ce],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);At[be]=Math.max.apply(null,ln)+de+de,ln=[]}if(Kt){var Tt={};for(V=0;V<se.length;V+=1)Tt[se[V]]={},Tt[se[V]].text=me[V],Tt[se[V]].align=Be[V];var St=P.call(this,Tt,At);nt=se.map(function(Wt){return new x(O,H,At[Wt],St,Tt[Wt].text,void 0,Tt[Wt].align)}),this.setTableHeaderRow(nt),this.printHeaderRow(1,!1)}var zt=Q.reduce(function(Wt,Yn){return Wt[Yn.name]=Yn.align,Wt},{});for(V=0;V<Y.length;V+=1){"rowStart"in re&&re.rowStart instanceof Function&&re.rowStart({row:V,data:Y[V]},this);var gt=P.call(this,Y[V],At);for(ce=0;ce<se.length;ce+=1){var Zt=Y[V][se[ce]];"cellStart"in re&&re.cellStart instanceof Function&&re.cellStart({row:V,col:ce,data:Zt},this),M.call(this,new x(O,H,At[se[ce]],gt,Zt,V+2,zt[se[ce]]))}}return this.internal.__cell__.table_x=O,this.internal.__cell__.table_y=H,this};var P=function(O,H){var Y=this.internal.__cell__.padding,Q=this.internal.__cell__.table_font_size,re=this.internal.scaleFactor;return Object.keys(O).map(function(V){var ve=O[V];return this.splitTextToSize(ve.hasOwnProperty("text")?ve.text:ve,H[V]-Y-Y)},this).map(function(V){return this.getLineHeightFactor()*V.length*Q/re+Y+Y},this).reduce(function(V,ve){return Math.max(V,ve)},0)};_.setTableHeaderRow=function(O){b.call(this),this.internal.__cell__.tableHeaderRow=O},_.printHeaderRow=function(O,H){if(b.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var Y;if(g=!0,"function"==typeof this.internal.__cell__.headerFunction){var Q=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new x(Q[0],Q[1],Q[2],Q[3],void 0,-1)}this.setFont(void 0,"bold");for(var re=[],V=0;V<this.internal.__cell__.tableHeaderRow.length;V+=1){Y=this.internal.__cell__.tableHeaderRow[V].clone(),H&&(Y.y=this.internal.__cell__.margins.top||0,re.push(Y)),Y.lineNumber=O;var ve=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),M.call(this,Y),this.setTextColor(ve)}re.length>0&&this.setTableHeaderRow(re),this.setFont(void 0,"normal"),g=!1}}(Pr.API);var it={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Pm=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Xr=A0(Pm),Yf=[100,200,300,400,500,600,700,800,900],Om=A0(Yf);function rd(_){var x,p=_.family.replace(/"|'/g,"").toLowerCase(),g=it[x=(x=_.style)||"normal"]?x:"normal",b=function(x){return x?"number"==typeof x?x>=100&&x<=900&&x%100==0?x:400:/^\d00$/.test(x)?parseInt(x):"bold"===x?700:400:400}(_.weight),S=function(x){return"number"==typeof Xr[x=x||"normal"]?x:"normal"}(_.stretch);return{family:p,style:g,weight:b,stretch:S,src:_.src||[],ref:_.ref||{name:p,style:[S,g,b].join(" ")}}}function T0(_,p,g,b){var S;for(S=g;S>=0&&S<p.length;S+=b)if(_[p[S]])return _[p[S]];for(S=g;S>=0&&S<p.length;S-=b)if(_[p[S]])return _[p[S]]}var M0={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Nm={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function tl(_){return[_.stretch,_.style,_.weight,_.family].join(" ")}function bl(_){return _.trimLeft()}function Pc(_,p){for(var g=0;g<_.length;){if(_.charAt(g)===p)return[_.substring(0,g),_.substring(g+1)];g+=1}return null}function Ui(_){var p=_.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===p?null:[p[0],_.substring(p[0].length)]}var id,zd,Xf,Kf=["times"];(function(_){var p,g,b,S,x,M,P,O,H,Y=function(J){return this.isStrokeTransparent=(J=J||{}).isStrokeTransparent||!1,this.strokeOpacity=J.strokeOpacity||1,this.strokeStyle=J.strokeStyle||"#000000",this.fillStyle=J.fillStyle||"#000000",this.isFillTransparent=J.isFillTransparent||!1,this.fillOpacity=J.fillOpacity||1,this.font=J.font||"10px sans-serif",this.textBaseline=J.textBaseline||"alphabetic",this.textAlign=J.textAlign||"left",this.lineWidth=J.lineWidth||1,this.lineJoin=J.lineJoin||"miter",this.lineCap=J.lineCap||"butt",this.path=J.path||[],this.transform=void 0!==J.transform?J.transform.clone():new O,this.globalCompositeOperation=J.globalCompositeOperation||"normal",this.globalAlpha=J.globalAlpha||1,this.clip_path=J.clip_path||[],this.currentPoint=J.currentPoint||new M,this.miterLimit=J.miterLimit||10,this.lastPoint=J.lastPoint||new M,this.lineDashOffset=J.lineDashOffset||0,this.lineDash=J.lineDash||[],this.margin=J.margin||[0,0,0,0],this.prevPageLastElemOffset=J.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof J.ignoreClearRect||J.ignoreClearRect,this};_.events.push(["initialized",function(){this.context2d=new Q(this),p=this.internal.f2,g=this.internal.getCoordinateString,b=this.internal.getVerticalCoordinateString,S=this.internal.getHorizontalCoordinate,x=this.internal.getVerticalCoordinate,M=this.internal.Point,P=this.internal.Rectangle,O=this.internal.Matrix,H=new Y}]);var Q=function(J){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var we=J;Object.defineProperty(this,"pdf",{get:function(){return we}});var Te=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Te},set:function(Lt){Te=Boolean(Lt)}});var $e=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return $e},set:function(Lt){$e=Boolean(Lt)}});var Xe=0;Object.defineProperty(this,"posX",{get:function(){return Xe},set:function(Lt){isNaN(Lt)||(Xe=Lt)}});var ft=0;Object.defineProperty(this,"posY",{get:function(){return ft},set:function(Lt){isNaN(Lt)||(ft=Lt)}}),Object.defineProperty(this,"margin",{get:function(){return H.margin},set:function(Lt){var Me;"number"==typeof Lt?Me=[Lt,Lt,Lt,Lt]:((Me=new Array(4))[0]=Lt[0],Me[1]=Lt.length>=2?Lt[1]:Me[0],Me[2]=Lt.length>=3?Lt[2]:Me[0],Me[3]=Lt.length>=4?Lt[3]:Me[1]),H.margin=Me}});var ot=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ot},set:function(Lt){ot=Lt}});var bt=0;Object.defineProperty(this,"lastBreak",{get:function(){return bt},set:function(Lt){bt=Lt}});var Rn=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Rn},set:function(Lt){Rn=Lt}}),Object.defineProperty(this,"ctx",{get:function(){return H},set:function(Lt){Lt instanceof Y&&(H=Lt)}}),Object.defineProperty(this,"path",{get:function(){return H.path},set:function(Lt){H.path=Lt}});var gn=[];Object.defineProperty(this,"ctxStack",{get:function(){return gn},set:function(Lt){gn=Lt}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Lt){var Me;Me=re(Lt),this.ctx.fillStyle=Me.style,this.ctx.isFillTransparent=0===Me.a,this.ctx.fillOpacity=Me.a,this.pdf.setFillColor(Me.r,Me.g,Me.b,{a:Me.a}),this.pdf.setTextColor(Me.r,Me.g,Me.b,{a:Me.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Lt){var Me=re(Lt);this.ctx.strokeStyle=Me.style,this.ctx.isStrokeTransparent=0===Me.a,this.ctx.strokeOpacity=Me.a,0===Me.a?this.pdf.setDrawColor(255,255,255):this.pdf.setDrawColor(Me.r,Me.g,Me.b)}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Lt){-1!==["butt","round","square"].indexOf(Lt)&&(this.ctx.lineCap=Lt,this.pdf.setLineCap(Lt))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Lt){isNaN(Lt)||(this.ctx.lineWidth=Lt,this.pdf.setLineWidth(Lt))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Lt){-1!==["bevel","round","miter"].indexOf(Lt)&&(this.ctx.lineJoin=Lt,this.pdf.setLineJoin(Lt))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Lt){isNaN(Lt)||(this.ctx.miterLimit=Lt,this.pdf.setMiterLimit(Lt))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Lt){this.ctx.textBaseline=Lt}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Lt){-1!==["right","end","center","left","start"].indexOf(Lt)&&(this.ctx.textAlign=Lt)}});var Xn=null,jr=null;Object.defineProperty(this,"fontFaces",{get:function(){return jr},set:function(Lt){Xn=null,jr=Lt}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Lt){var Me;if(this.ctx.font=Lt,null!==(Me=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Lt))){var ti=Me[1],fr=Me[3],B=Me[4],C=Me[6],F=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(B)[2];B=Math.floor("px"===F?parseFloat(B)*this.pdf.internal.scaleFactor:"em"===F?parseFloat(B)*this.pdf.getFontSize():parseFloat(B)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(B);var j=function(wr){var Hr,Jn,Ua=[],Xi=wr.trim();if(""===Xi)return Kf;if(Xi in Nm)return[Nm[Xi]];for(;""!==Xi;){switch(Jn=null,Hr=(Xi=bl(Xi)).charAt(0)){case'"':case"'":Jn=Pc(Xi.substring(1),Hr);break;default:Jn=Ui(Xi)}if(null===Jn||(Ua.push(Jn[0]),""!==(Xi=bl(Jn[1]))&&","!==Xi.charAt(0)))return Kf;Xi=Xi.replace(/^,/,"")}return Ua}(C);if(this.fontFaces){var le=function cc(_,p,g){for(var b=(g=g||{}).defaultFontFamily||"times",S=Object.assign({},M0,g.genericFontFamilies||{}),x=null,M=null,P=0;P<p.length;++P)if(S[(x=rd(p[P])).family]&&(x.family=S[x.family]),_.hasOwnProperty(x.family)){M=_[x.family];break}if(!(M=M||_[b]))throw new Error("Could not find a font-family for the rule '"+tl(x)+"' and default family '"+b+"'.");if(M=function(O,H){if(H[O])return H[O];var Y=Xr[O],re=T0(H,Pm,Y,Y<=Xr.normal?-1:1);if(!re)throw new Error("Could not find a matching font-stretch value for "+O);return re}(x.stretch,M),M=function(O,H){if(H[O])return H[O];for(var Y=it[O],Q=0;Q<Y.length;++Q)if(H[Y[Q]])return H[Y[Q]];throw new Error("Could not find a matching font-style for "+O)}(x.style,M),!(M=function(O,H){if(H[O])return H[O];if(400===O&&H[500])return H[500];if(500===O&&H[400])return H[400];var Q=T0(H,Yf,Om[O],O<400?-1:1);if(!Q)throw new Error("Could not find a matching font-weight for value "+O);return Q}(x.weight,M)))throw new Error("Failed to resolve a font for the rule '"+tl(x)+"'.");return M}(function tr(Lt,Me){if(null===Xn){var ti=(fr=Lt.getFontList(),B=[],Object.keys(fr).forEach(function(C){fr[C].forEach(function(F){var j=null;switch(F){case"bold":j={family:C,weight:"bold"};break;case"italic":j={family:C,style:"italic"};break;case"bolditalic":j={family:C,weight:"bold",style:"italic"};break;case"":case"normal":j={family:C}}null!==j&&(j.ref={name:C,style:F},B.push(j))})}),B);Xn=function(fr){for(var B={},C=0;C<fr.length;++C){var F=rd(fr[C]),j=F.family,le=F.stretch,et=F.style,cn=F.weight;B[j]=B[j]||{},B[j][le]=B[j][le]||{},B[j][le][et]=B[j][le][et]||{},B[j][le][et][cn]=F}return B}(ti.concat(Me))}var fr,B;return Xn}(this.pdf,this.fontFaces),j.map(function(wr){return{family:wr,stretch:"normal",weight:fr,style:ti}}));this.pdf.setFont(le.ref.name,le.ref.style)}else{var et="";("bold"===fr||parseInt(fr,10)>=700||"bold"===ti)&&(et="bold"),"italic"===ti&&(et+="italic"),0===et.length&&(et="normal");for(var cn="",In={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},nr=0;nr<j.length;nr++){if(void 0!==this.pdf.internal.getFont(j[nr],et,{noFallback:!0,disableWarning:!0})){cn=j[nr];break}if("bolditalic"===et&&void 0!==this.pdf.internal.getFont(j[nr],"bold",{noFallback:!0,disableWarning:!0}))cn=j[nr],et="bold";else if(void 0!==this.pdf.internal.getFont(j[nr],"normal",{noFallback:!0,disableWarning:!0})){cn=j[nr],et="normal";break}}if(""===cn)for(var Or=0;Or<j.length;Or++)if(In[j[Or]]){cn=In[j[Or]];break}this.pdf.setFont(cn=""===cn?"Times":cn,et)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Lt){this.ctx.globalCompositeOperation=Lt}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Lt){this.ctx.globalAlpha=Lt}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Lt){this.ctx.lineDashOffset=Lt,Yn.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Lt){this.ctx.lineDash=Lt,Yn.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Lt){this.ctx.ignoreClearRect=Boolean(Lt)}})};Q.prototype.setLineDash=function(J){this.lineDash=J},Q.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},Q.prototype.fill=function(){st.call(this,"fill",!1)},Q.prototype.stroke=function(){st.call(this,"stroke",!1)},Q.prototype.beginPath=function(){this.path=[{type:"begin"}]},Q.prototype.moveTo=function(J,we){if(isNaN(J)||isNaN(we))throw io.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Te=this.ctx.transform.applyToPoint(new M(J,we));this.path.push({type:"mt",x:Te.x,y:Te.y}),this.ctx.lastPoint=new M(J,we)},Q.prototype.closePath=function(){var J=new M(0,0),we=0;for(we=this.path.length-1;-1!==we;we--)if("begin"===this.path[we].type&&"object"===(0,zn.Z)(this.path[we+1])&&"number"==typeof this.path[we+1].x){J=new M(this.path[we+1].x,this.path[we+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new M(J.x,J.y)},Q.prototype.lineTo=function(J,we){if(isNaN(J)||isNaN(we))throw io.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Te=this.ctx.transform.applyToPoint(new M(J,we));this.path.push({type:"lt",x:Te.x,y:Te.y}),this.ctx.lastPoint=new M(Te.x,Te.y)},Q.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),st.call(this,null,!0)},Q.prototype.quadraticCurveTo=function(J,we,Te,$e){if(isNaN(Te)||isNaN($e)||isNaN(J)||isNaN(we))throw io.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Xe=this.ctx.transform.applyToPoint(new M(Te,$e)),ft=this.ctx.transform.applyToPoint(new M(J,we));this.path.push({type:"qct",x1:ft.x,y1:ft.y,x:Xe.x,y:Xe.y}),this.ctx.lastPoint=new M(Xe.x,Xe.y)},Q.prototype.bezierCurveTo=function(J,we,Te,$e,Xe,ft){if(isNaN(Xe)||isNaN(ft)||isNaN(J)||isNaN(we)||isNaN(Te)||isNaN($e))throw io.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ot=this.ctx.transform.applyToPoint(new M(Xe,ft)),bt=this.ctx.transform.applyToPoint(new M(J,we)),Rn=this.ctx.transform.applyToPoint(new M(Te,$e));this.path.push({type:"bct",x1:bt.x,y1:bt.y,x2:Rn.x,y2:Rn.y,x:ot.x,y:ot.y}),this.ctx.lastPoint=new M(ot.x,ot.y)},Q.prototype.arc=function(J,we,Te,$e,Xe,ft){if(isNaN(J)||isNaN(we)||isNaN(Te)||isNaN($e)||isNaN(Xe))throw io.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ft=Boolean(ft),!this.ctx.transform.isIdentity){var ot=this.ctx.transform.applyToPoint(new M(J,we));J=ot.x,we=ot.y;var bt=this.ctx.transform.applyToPoint(new M(0,Te)),Rn=this.ctx.transform.applyToPoint(new M(0,0));Te=Math.sqrt(Math.pow(bt.x-Rn.x,2)+Math.pow(bt.y-Rn.y,2))}Math.abs(Xe-$e)>=2*Math.PI&&($e=0,Xe=2*Math.PI),this.path.push({type:"arc",x:J,y:we,radius:Te,startAngle:$e,endAngle:Xe,counterclockwise:ft})},Q.prototype.arcTo=function(J,we,Te,$e,Xe){throw new Error("arcTo not implemented.")},Q.prototype.rect=function(J,we,Te,$e){if(isNaN(J)||isNaN(we)||isNaN(Te)||isNaN($e))throw io.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(J,we),this.lineTo(J+Te,we),this.lineTo(J+Te,we+$e),this.lineTo(J,we+$e),this.lineTo(J,we),this.lineTo(J+Te,we),this.lineTo(J,we)},Q.prototype.fillRect=function(J,we,Te,$e){if(isNaN(J)||isNaN(we)||isNaN(Te)||isNaN($e))throw io.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!V.call(this)){var Xe={};"butt"!==this.lineCap&&(Xe.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(Xe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(J,we,Te,$e),this.fill(),Xe.hasOwnProperty("lineCap")&&(this.lineCap=Xe.lineCap),Xe.hasOwnProperty("lineJoin")&&(this.lineJoin=Xe.lineJoin)}},Q.prototype.strokeRect=function(J,we,Te,$e){if(isNaN(J)||isNaN(we)||isNaN(Te)||isNaN($e))throw io.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");ve.call(this)||(this.beginPath(),this.rect(J,we,Te,$e),this.stroke())},Q.prototype.clearRect=function(J,we,Te,$e){if(isNaN(J)||isNaN(we)||isNaN(Te)||isNaN($e))throw io.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(J,we,Te,$e))},Q.prototype.save=function(J){J="boolean"!=typeof J||J;for(var we=this.pdf.internal.getCurrentPageInfo().pageNumber,Te=0;Te<this.pdf.internal.getNumberOfPages();Te++)this.pdf.setPage(Te+1),this.pdf.internal.out("q");if(this.pdf.setPage(we),J){this.ctx.fontSize=this.pdf.internal.getFontSize();var $e=new Y(this.ctx);this.ctxStack.push(this.ctx),this.ctx=$e}},Q.prototype.restore=function(J){J="boolean"!=typeof J||J;for(var we=this.pdf.internal.getCurrentPageInfo().pageNumber,Te=0;Te<this.pdf.internal.getNumberOfPages();Te++)this.pdf.setPage(Te+1),this.pdf.internal.out("Q");this.pdf.setPage(we),J&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},Q.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var re=function(J){var we,Te,$e,Xe;if(!0===J.isCanvasGradient&&(J=J.getColor()),!J)return{r:0,g:0,b:0,a:0,style:J};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(J))we=0,Te=0,$e=0,Xe=0;else{var ft=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(J);if(null!==ft)we=parseInt(ft[1]),Te=parseInt(ft[2]),$e=parseInt(ft[3]),Xe=1;else if(null!==(ft=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(J)))we=parseInt(ft[1]),Te=parseInt(ft[2]),$e=parseInt(ft[3]),Xe=parseFloat(ft[4]);else{if(Xe=1,"string"==typeof J&&"#"!==J.charAt(0)){var ot=new oo(J);J=ot.ok?ot.toHex():"#000000"}4===J.length?(we=J.substring(1,2),we+=we,Te=J.substring(2,3),Te+=Te,$e=J.substring(3,4),$e+=$e):(we=J.substring(1,3),Te=J.substring(3,5),$e=J.substring(5,7)),we=parseInt(we,16),Te=parseInt(Te,16),$e=parseInt($e,16)}}return{r:we,g:Te,b:$e,a:Xe,style:J}},V=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},ve=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};Q.prototype.fillText=function(J,we,Te,$e){if(isNaN(we)||isNaN(Te)||"string"!=typeof J)throw io.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if($e=isNaN($e)?void 0:$e,!V.call(this)){var Xe=gt(this.ctx.transform.rotation);de.call(this,{text:J,x:we,y:Te,scale:this.ctx.transform.scaleX,angle:Xe,align:this.textAlign,maxWidth:$e})}},Q.prototype.strokeText=function(J,we,Te,$e){if(isNaN(we)||isNaN(Te)||"string"!=typeof J)throw io.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!ve.call(this)){$e=isNaN($e)?void 0:$e;var Xe=gt(this.ctx.transform.rotation);de.call(this,{text:J,x:we,y:Te,scale:this.ctx.transform.scaleX,renderingMode:"stroke",angle:Xe,align:this.textAlign,maxWidth:$e})}},Q.prototype.measureText=function(J){if("string"!=typeof J)throw io.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var we=this.pdf,Te=this.pdf.internal.scaleFactor,$e=we.internal.getFontSize(),Xe=we.getStringUnitWidth(J)*$e/we.internal.scaleFactor;return new function(ot){var bt=(ot=ot||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return bt}}),this}({width:Xe*=Math.round(96*Te/72*1e4)/1e4})},Q.prototype.scale=function(J,we){if(isNaN(J)||isNaN(we))throw io.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Te=new O(J,0,0,we,0,0);this.ctx.transform=this.ctx.transform.multiply(Te)},Q.prototype.rotate=function(J){if(isNaN(J))throw io.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var we=new O(Math.cos(J),Math.sin(J),-Math.sin(J),Math.cos(J),0,0);this.ctx.transform=this.ctx.transform.multiply(we)},Q.prototype.translate=function(J,we){if(isNaN(J)||isNaN(we))throw io.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Te=new O(1,0,0,1,J,we);this.ctx.transform=this.ctx.transform.multiply(Te)},Q.prototype.transform=function(J,we,Te,$e,Xe,ft){if(isNaN(J)||isNaN(we)||isNaN(Te)||isNaN($e)||isNaN(Xe)||isNaN(ft))throw io.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ot=new O(J,we,Te,$e,Xe,ft);this.ctx.transform=this.ctx.transform.multiply(ot)},Q.prototype.setTransform=function(J,we,Te,$e,Xe,ft){J=isNaN(J)?1:J,we=isNaN(we)?0:we,Te=isNaN(Te)?0:Te,$e=isNaN($e)?1:$e,Xe=isNaN(Xe)?0:Xe,ft=isNaN(ft)?0:ft,this.ctx.transform=new O(J,we,Te,$e,Xe,ft)};var ce=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};Q.prototype.drawImage=function(J,we,Te,$e,Xe,ft,ot,bt,Rn){var gn=this.pdf.getImageProperties(J),Xn=1,tr=1,jr=1,Lt=1;void 0!==$e&&void 0!==bt&&(jr=bt/$e,Lt=Rn/Xe,Xn=gn.width/$e*bt/$e,tr=gn.height/Xe*Rn/Xe),void 0===ft&&(ft=we,ot=Te,we=0,Te=0),void 0!==$e&&void 0===bt&&(bt=$e,Rn=Xe),void 0===$e&&void 0===bt&&(bt=gn.width,Rn=gn.height);for(var Me,ti=this.ctx.transform.decompose(),fr=gt(ti.rotate.shx),B=new O,C=(B=(B=(B=B.multiply(ti.translate)).multiply(ti.skew)).multiply(ti.scale)).applyToRectangle(new P(ft-we*jr,ot-Te*Lt,$e*Xn,Xe*tr)),F=be.call(this,C),j=[],le=0;le<F.length;le+=1)-1===j.indexOf(F[le])&&j.push(F[le]);if(Be(j),this.autoPaging)for(var et=j[0],cn=j[j.length-1],In=et;In<cn+1;In++){this.pdf.setPage(In);var nr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Or=1===In?this.posY+this.margin[0]:this.margin[0],Hr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Jn=1===In?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(In-2)*Hr;if(0!==this.ctx.clip_path.length){var Ua=this.path;Me=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=me(Me,this.posX+this.margin[3],-Jn+Or+this.ctx.prevPageLastElemOffset),At.call(this,"fill",!0),this.path=Ua}var Xi=JSON.parse(JSON.stringify(C));Xi=me([Xi],this.posX+this.margin[3],-Jn+Or+this.ctx.prevPageLastElemOffset)[0];var rs=(In>et||In<cn)&&ce.call(this);rs&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],nr,Hr,null).clip().discardPath()),this.pdf.addImage(J,"JPEG",Xi.x,Xi.y,Xi.w,Xi.h,null,null,fr),rs&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(J,"JPEG",C.x,C.y,C.w,C.h,null,null,fr)};var be=function(J,we,Te){var $e=[];we=we||this.pdf.internal.pageSize.width,Te=Te||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Xe=this.posY+this.ctx.prevPageLastElemOffset;switch(J.type){default:case"mt":case"lt":$e.push(Math.floor((J.y+Xe)/Te)+1);break;case"arc":$e.push(Math.floor((J.y+Xe-J.radius)/Te)+1),$e.push(Math.floor((J.y+Xe+J.radius)/Te)+1);break;case"qct":var ft=Zt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,J.x1,J.y1,J.x,J.y);$e.push(Math.floor((ft.y+Xe)/Te)+1),$e.push(Math.floor((ft.y+ft.h+Xe)/Te)+1);break;case"bct":var ot=Wt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,J.x1,J.y1,J.x2,J.y2,J.x,J.y);$e.push(Math.floor((ot.y+Xe)/Te)+1),$e.push(Math.floor((ot.y+ot.h+Xe)/Te)+1);break;case"rect":$e.push(Math.floor((J.y+Xe)/Te)+1),$e.push(Math.floor((J.y+J.h+Xe)/Te)+1)}for(var bt=0;bt<$e.length;bt+=1)for(;this.pdf.internal.getNumberOfPages()<$e[bt];)se.call(this);return $e},se=function(){var J=this.fillStyle,we=this.strokeStyle,Te=this.font,$e=this.lineCap,Xe=this.lineWidth,ft=this.lineJoin;this.pdf.addPage(),this.fillStyle=J,this.strokeStyle=we,this.font=Te,this.lineCap=$e,this.lineWidth=Xe,this.lineJoin=ft},me=function(J,we,Te){for(var $e=0;$e<J.length;$e++)switch(J[$e].type){case"bct":J[$e].x2+=we,J[$e].y2+=Te;case"qct":J[$e].x1+=we,J[$e].y1+=Te;default:J[$e].x+=we,J[$e].y+=Te}return J},Be=function(J){return J.sort(function(we,Te){return we-Te})},st=function(J,we){for(var Te,$e,Xe=this.fillStyle,ft=this.strokeStyle,ot=this.lineCap,bt=this.lineWidth,Rn=Math.abs(bt*this.ctx.transform.scaleX),gn=this.lineJoin,Xn=JSON.parse(JSON.stringify(this.path)),tr=JSON.parse(JSON.stringify(this.path)),jr=[],Lt=0;Lt<tr.length;Lt++)if(void 0!==tr[Lt].x)for(var Me=be.call(this,tr[Lt]),ti=0;ti<Me.length;ti+=1)-1===jr.indexOf(Me[ti])&&jr.push(Me[ti]);for(var fr=0;fr<jr.length;fr++)for(;this.pdf.internal.getNumberOfPages()<jr[fr];)se.call(this);if(Be(jr),this.autoPaging)for(var B=jr[0],C=jr[jr.length-1],F=B;F<C+1;F++){this.pdf.setPage(F),this.fillStyle=Xe,this.strokeStyle=ft,this.lineCap=ot,this.lineWidth=Rn,this.lineJoin=gn;var j=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],le=1===F?this.posY+this.margin[0]:this.margin[0],cn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],In=1===F?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(F-2)*cn;if(0!==this.ctx.clip_path.length){var nr=this.path;Te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=me(Te,this.posX+this.margin[3],-In+le+this.ctx.prevPageLastElemOffset),At.call(this,J,!0),this.path=nr}if($e=JSON.parse(JSON.stringify(Xn)),this.path=me($e,this.posX+this.margin[3],-In+le+this.ctx.prevPageLastElemOffset),!1===we||0===F){var Or=(F>B||F<C)&&ce.call(this);Or&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],j,cn,null).clip().discardPath()),At.call(this,J,we),Or&&this.pdf.restoreGraphicsState()}this.lineWidth=bt}else this.lineWidth=Rn,At.call(this,J,we),this.lineWidth=bt;this.path=Xn},At=function(J,we){if(("stroke"!==J||we||!ve.call(this))&&("stroke"===J||we||!V.call(this))){for(var Te,$e,Xe=[],ft=this.path,ot=0;ot<ft.length;ot++){var bt=ft[ot];switch(bt.type){case"begin":Xe.push({begin:!0});break;case"close":Xe.push({close:!0});break;case"mt":Xe.push({start:bt,deltas:[],abs:[]});break;case"lt":var Rn=Xe.length;if(ft[ot-1]&&!isNaN(ft[ot-1].x)&&(Te=[bt.x-ft[ot-1].x,bt.y-ft[ot-1].y],Rn>0))for(;Rn>=0;Rn--)if(!0!==Xe[Rn-1].close&&!0!==Xe[Rn-1].begin){Xe[Rn-1].deltas.push(Te),Xe[Rn-1].abs.push(bt);break}break;case"bct":Xe[Xe.length-1].deltas.push(Te=[bt.x1-ft[ot-1].x,bt.y1-ft[ot-1].y,bt.x2-ft[ot-1].x,bt.y2-ft[ot-1].y,bt.x-ft[ot-1].x,bt.y-ft[ot-1].y]);break;case"qct":Xe[Xe.length-1].deltas.push(Te=[ft[ot-1].x+2/3*(bt.x1-ft[ot-1].x)-ft[ot-1].x,ft[ot-1].y+2/3*(bt.y1-ft[ot-1].y)-ft[ot-1].y,bt.x+2/3*(bt.x1-bt.x)-ft[ot-1].x,bt.y+2/3*(bt.y1-bt.y)-ft[ot-1].y,bt.x-ft[ot-1].x,bt.y-ft[ot-1].y]);break;case"arc":Xe.push({deltas:[],abs:[],arc:!0}),Array.isArray(Xe[Xe.length-1].abs)&&Xe[Xe.length-1].abs.push(bt)}}$e=we?null:"stroke"===J?"stroke":"fill";for(var ti=!1,fr=0;fr<Xe.length;fr++)if(Xe[fr].arc)for(var B=Xe[fr].abs,C=0;C<B.length;C++){var F=B[C];"arc"===F.type?Oe.call(this,F.x,F.y,F.radius,F.startAngle,F.endAngle,F.counterclockwise,void 0,we,!ti):He.call(this,F.x,F.y),ti=!0}else!0===Xe[fr].close?(this.pdf.internal.out("h"),ti=!1):!0!==Xe[fr].begin&&(Ne.call(this,Xe[fr].deltas,Xe[fr].start.x,Xe[fr].start.y),ti=!0);$e&&Kt.call(this,$e),we&&Yt.call(this)}},ln=function(J){var we=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Te=we*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return J-Te;case"top":return J+we-Te;case"hanging":return J+we-2*Te;case"middle":return J+we/2-Te;default:return J}},nt=function(J){return J+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};Q.prototype.createLinearGradient=function(){var J=function(){};return J.colorStops=[],J.addColorStop=function(we,Te){this.colorStops.push([we,Te])},J.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},J.isCanvasGradient=!0,J},Q.prototype.createPattern=function(){return this.createLinearGradient()},Q.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Oe=function(J,we,Te,$e,Xe,ft,ot,bt,Rn){for(var gn=St.call(this,Te,$e,Xe,ft),Xn=0;Xn<gn.length;Xn++){var tr=gn[Xn];0===Xn&&(Rn?fe.call(this,tr.x1+J,tr.y1+we):He.call(this,tr.x1+J,tr.y1+we)),Tt.call(this,J,we,tr.x2,tr.y2,tr.x3,tr.y3,tr.x4,tr.y4)}bt?Yt.call(this):Kt.call(this,ot)},Kt=function(J){switch(J){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Yt=function(){this.pdf.clip(),this.pdf.discardPath()},fe=function(J,we){this.pdf.internal.out(g(J)+" "+b(we)+" m")},de=function(J){var we;switch(J.align){case"right":case"end":we="right";break;case"center":we="center";break;default:we="left"}var Te=this.pdf.getTextDimensions(J.text),$e=ln.call(this,J.y),Xe=nt.call(this,$e)-Te.h,ft=this.ctx.transform.applyToPoint(new M(J.x,$e)),ot=this.ctx.transform.decompose(),bt=new O;bt=(bt=(bt=bt.multiply(ot.translate)).multiply(ot.skew)).multiply(ot.scale);for(var Rn,gn,Xn,tr=this.ctx.transform.applyToRectangle(new P(J.x,$e,Te.w,Te.h)),jr=bt.applyToRectangle(new P(J.x,Xe,Te.w,Te.h)),Lt=be.call(this,jr),Me=[],ti=0;ti<Lt.length;ti+=1)-1===Me.indexOf(Lt[ti])&&Me.push(Lt[ti]);if(Be(Me),this.autoPaging)for(var fr=Me[0],B=Me[Me.length-1],C=fr;C<B+1;C++){this.pdf.setPage(C);var F=1===C?this.posY+this.margin[0]:this.margin[0],le=this.pdf.internal.pageSize.height-this.margin[2],et=le-this.margin[0],cn=this.pdf.internal.pageSize.width-this.margin[1],In=cn-this.margin[3],nr=1===C?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(C-2)*et;if(0!==this.ctx.clip_path.length){var Or=this.path;Rn=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=me(Rn,this.posX+this.margin[3],-1*nr+F),At.call(this,"fill",!0),this.path=Or}var wr=me([JSON.parse(JSON.stringify(jr))],this.posX+this.margin[3],-nr+F+this.ctx.prevPageLastElemOffset)[0];J.scale>=.01&&(gn=this.pdf.internal.getFontSize(),this.pdf.setFontSize(gn*J.scale),this.lineWidth=(Xn=this.lineWidth)*J.scale);var Hr="text"!==this.autoPaging;if(Hr||wr.y+wr.h<=le){if(Hr||wr.y>=F&&wr.x<=cn){var Jn=Hr?J.text:this.pdf.splitTextToSize(J.text,J.maxWidth||cn-wr.x)[0],Ua=me([JSON.parse(JSON.stringify(tr))],this.posX+this.margin[3],-nr+F+this.ctx.prevPageLastElemOffset)[0],Xi=Hr&&(C>fr||C<B)&&ce.call(this);Xi&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],In,et,null).clip().discardPath()),this.pdf.text(Jn,Ua.x,Ua.y,{angle:J.angle,align:we,renderingMode:J.renderingMode}),Xi&&this.pdf.restoreGraphicsState()}}else wr.y<le&&(this.ctx.prevPageLastElemOffset+=le-wr.y);J.scale>=.01&&(this.pdf.setFontSize(gn),this.lineWidth=Xn)}else J.scale>=.01&&(gn=this.pdf.internal.getFontSize(),this.pdf.setFontSize(gn*J.scale),this.lineWidth=(Xn=this.lineWidth)*J.scale),this.pdf.text(J.text,ft.x+this.posX,ft.y+this.posY,{angle:J.angle,align:we,renderingMode:J.renderingMode,maxWidth:J.maxWidth}),J.scale>=.01&&(this.pdf.setFontSize(gn),this.lineWidth=Xn)},He=function(J,we,Te,$e){$e=$e||0,this.pdf.internal.out(g(J+(Te=Te||0))+" "+b(we+$e)+" l")},Ne=function(J,we,Te){return this.pdf.lines(J,we,Te,null,null)},Tt=function(J,we,Te,$e,Xe,ft,ot,bt){this.pdf.internal.out([p(S(Te+J)),p(x($e+we)),p(S(Xe+J)),p(x(ft+we)),p(S(ot+J)),p(x(bt+we)),"c"].join(" "))},St=function(J,we,Te,$e){for(var Xe=2*Math.PI,ft=Math.PI/2;we>Te;)we-=Xe;var ot=Math.abs(Te-we);ot<Xe&&$e&&(ot=Xe-ot);for(var bt=[],Rn=$e?-1:1,gn=we;ot>1e-5;){var Xn=gn+Rn*Math.min(ot,ft);bt.push(zt.call(this,J,gn,Xn)),ot-=Math.abs(Xn-gn),gn=Xn}return bt},zt=function(J,we,Te){var $e=(Te-we)/2,Xe=J*Math.cos($e),ft=J*Math.sin($e),ot=Xe,bt=-ft,Rn=ot*ot+bt*bt,gn=Rn+ot*Xe+bt*ft,Xn=4/3*(Math.sqrt(2*Rn*gn)-gn)/(ot*ft-bt*Xe),tr=ot-Xn*bt,jr=bt+Xn*ot,Lt=tr,Me=-jr,ti=$e+we,fr=Math.cos(ti),B=Math.sin(ti);return{x1:J*Math.cos(we),y1:J*Math.sin(we),x2:tr*fr-jr*B,y2:tr*B+jr*fr,x3:Lt*fr-Me*B,y3:Lt*B+Me*fr,x4:J*Math.cos(Te),y4:J*Math.sin(Te)}},gt=function(J){return 180*J/Math.PI},Zt=function(J,we,Te,$e,Xe,ft){var ot=J+.5*(Te-J),bt=we+.5*($e-we),Rn=Xe+.5*(Te-Xe),gn=ft+.5*($e-ft),Xn=Math.min(J,Xe,ot,Rn),tr=Math.max(J,Xe,ot,Rn),jr=Math.min(we,ft,bt,gn),Lt=Math.max(we,ft,bt,gn);return new P(Xn,jr,tr-Xn,Lt-jr)},Wt=function(J,we,Te,$e,Xe,ft,ot,bt){var Rn,gn,Xn,tr,jr,Lt,Me,ti,fr,B,C,F,j,le,et=Te-J,cn=$e-we,In=Xe-Te,nr=ft-$e,Or=ot-Xe,wr=bt-ft;for(gn=0;gn<41;gn++)fr=(Me=(Xn=J+(Rn=gn/40)*et)+Rn*((jr=Te+Rn*In)-Xn))+Rn*(jr+Rn*(Xe+Rn*Or-jr)-Me),B=(ti=(tr=we+Rn*cn)+Rn*((Lt=$e+Rn*nr)-tr))+Rn*(Lt+Rn*(ft+Rn*wr-Lt)-ti),0==gn?(C=fr,F=B,j=fr,le=B):(C=Math.min(C,fr),F=Math.min(F,B),j=Math.max(j,fr),le=Math.max(le,B));return new P(Math.round(C),Math.round(F),Math.round(j-C),Math.round(le-F))},Yn=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Te=JSON.stringify({lineDash:this.ctx.lineDash,lineDashOffset:this.ctx.lineDashOffset});this.prevLineDash!==Te&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Te)}}})(Pr.API),
/**
         * @license
         * jsPDF filters PlugIn
         * Copyright (c) 2014 Aras Abbasi
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){var p=function(x){var M,P,O,H,Y,Q,re,V,ve,ce;for(/[^\x00-\xFF]/.test(x),P=[],O=0,H=(x+=M="\0\0\0\0".slice(x.length%4||4)).length;H>O;O+=4)0!==(Y=(x.charCodeAt(O)<<24)+(x.charCodeAt(O+1)<<16)+(x.charCodeAt(O+2)<<8)+x.charCodeAt(O+3))?(Q=(Y=((Y=((Y=((Y=(Y-(ce=Y%85))/85)-(ve=Y%85))/85)-(V=Y%85))/85)-(re=Y%85))/85)%85,P.push(Q+33,re+33,V+33,ve+33,ce+33)):P.push(122);return function(be,se){for(var me=se;me>0;me--)be.pop()}(P,M.length),String.fromCharCode.apply(String,P)+"~>"},g=function(x){var M,P,O,H,Y,Q=String,re="length",V=255,ve="charCodeAt",ce="slice",be="replace";for(x[ce](-2),x=x[ce](0,-2)[be](/\s/g,"")[be]("z","!!!!!"),O=[],H=0,Y=(x+=M="uuuuu"[ce](x[re]%5||5))[re];Y>H;H+=5)P=52200625*(x[ve](H)-33)+614125*(x[ve](H+1)-33)+7225*(x[ve](H+2)-33)+85*(x[ve](H+3)-33)+(x[ve](H+4)-33),O.push(V&P>>24,V&P>>16,V&P>>8,V&P);return function(se,me){for(var Be=me;Be>0;Be--)se.pop()}(O,M[re]),Q.fromCharCode.apply(Q,O)},b=function(x){var M=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(x=x.replace(/\s/g,"")).indexOf(">")&&(x=x.substr(0,x.indexOf(">"))),x.length%2&&(x+="0"),!1===M.test(x))return"";for(var P="",O=0;O<x.length;O+=2)P+=String.fromCharCode("0x"+(x[O]+x[O+1]));return P},S=function(x){for(var M=new Uint8Array(x.length),P=x.length;P--;)M[P]=x.charCodeAt(P);return(M=Od(M)).reduce(function(O,H){return O+String.fromCharCode(H)},"")};_.processDataByFilters=function(x,M){var P=0,O=x||"",H=[];for("string"==typeof(M=M||[])&&(M=[M]),P=0;P<M.length;P+=1)switch(M[P]){case"ASCII85Decode":case"/ASCII85Decode":O=g(O),H.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":O=p(O),H.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":O=b(O),H.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":O=O.split("").map(function(Y){return("0"+Y.charCodeAt().toString(16)).slice(-2)}).join("")+">",H.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":O=S(O),H.push("/FlateDecode");break;default:throw new Error('The filter: "'+M[P]+'" is not implemented')}return{data:O,reverseChain:H.reverse().join(" ")}}}(Pr.API),
/**
         * @license
         * jsPDF fileloading PlugIn
         * Copyright (c) 2018 Aras Abbasi (aras.abbasi@gmail.com)
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){_.loadFile=function(p,g,b){return function(S,x,M){x=!1!==x,M="function"==typeof M?M:function(){};var P=void 0;try{P=function(O,H,Y){var Q=new XMLHttpRequest,re=0,V=function(ve){var ce=ve.length,be=[],se=String.fromCharCode;for(re=0;re<ce;re+=1)be.push(se(255&ve.charCodeAt(re)));return be.join("")};if(Q.open("GET",O,!H),Q.overrideMimeType("text/plain; charset=x-user-defined"),!1===H&&(Q.onload=function(){Y(200===Q.status?V(this.responseText):void 0)}),Q.send(null),H&&200===Q.status)return V(Q.responseText)}(S,x,M)}catch{}return P}(p,g,b)},_.loadImageFile=_.loadFile}(Pr.API),function(_){function p(){return(Lr.html2canvas?Promise.resolve(Lr.html2canvas):qi.e(159).then(qi.t.bind(qi,4159,23))).catch(function(M){return Promise.reject(new Error("Could not load html2canvas: "+M))}).then(function(M){return M.default?M.default:M})}function g(){return(Lr.DOMPurify?Promise.resolve(Lr.DOMPurify):qi.e(735).then(qi.t.bind(qi,2735,23))).catch(function(M){return Promise.reject(new Error("Could not load dompurify: "+M))}).then(function(M){return M.default?M.default:M})}var b=function(M){var P=(0,zn.Z)(M);return"undefined"===P?"undefined":"string"===P||M instanceof String?"string":"number"===P||M instanceof Number?"number":"function"===P||M instanceof Function?"function":M&&M.constructor===Array?"array":M&&1===M.nodeType?"element":"object"===P?"object":"unknown"},S=function(M,P){var O=document.createElement(M);for(var H in P.className&&(O.className=P.className),P.innerHTML&&P.dompurify&&(O.innerHTML=P.dompurify.sanitize(P.innerHTML)),P.style)O.style[H]=P.style[H];return O},x=function M(P){var O=Object.assign(M.convert(Promise.resolve()),JSON.parse(JSON.stringify(M.template))),H=M.convert(Promise.resolve(),O);return(H=H.setProgress(1,M,1,[M])).set(P)};(x.prototype=Object.create(Promise.prototype)).constructor=x,x.convert=function(M,P){return M.__proto__=P||x.prototype,M},x.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},x.prototype.from=function(M,P){return this.then(function(){switch(P=P||function(O){switch(b(O)){case"string":return"string";case"element":return"canvas"===O.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(M)){case"string":return this.then(g).then(function(O){return this.set({src:S("div",{innerHTML:M,dompurify:O})})});case"element":return this.set({src:M});case"canvas":return this.set({canvas:M});case"img":return this.set({img:M});default:return this.error("Unknown source type.")}})},x.prototype.to=function(M){switch(M){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},x.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var M={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},P=function O(H,Y){for(var Q=3===H.nodeType?document.createTextNode(H.nodeValue):H.cloneNode(!1),re=H.firstChild;re;re=re.nextSibling)!0!==Y&&1===re.nodeType&&"SCRIPT"===re.nodeName||Q.appendChild(O(re,Y));return 1===H.nodeType&&("CANVAS"===H.nodeName?(Q.width=H.width,Q.height=H.height,Q.getContext("2d").drawImage(H,0,0)):"TEXTAREA"!==H.nodeName&&"SELECT"!==H.nodeName||(Q.value=H.value),Q.addEventListener("load",function(){Q.scrollTop=H.scrollTop,Q.scrollLeft=H.scrollLeft},!0)),Q}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===P.tagName&&(M.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=S("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=S("div",{className:"html2pdf__container",style:M}),this.prop.container.appendChild(P),this.prop.container.firstChild.appendChild(S("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},x.prototype.toCanvas=function(){return this.thenList([function(){return document.body.contains(this.prop.container)||this.toContainer()}]).then(p).then(function(P){var O=Object.assign({},this.opt.html2canvas);return delete O.onrendered,P(this.prop.container,O)}).then(function(P){(this.opt.html2canvas.onrendered||function(){})(P),this.prop.canvas=P,document.body.removeChild(this.prop.overlay)})},x.prototype.toContext2d=function(){return this.thenList([function(){return document.body.contains(this.prop.container)||this.toContainer()}]).then(p).then(function(P){var O=this.opt.jsPDF,H=this.opt.fontFaces,Y="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,Q=Object.assign({async:!0,allowTaint:!0,scale:Y,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete Q.onrendered,O.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,O.context2d.posX=this.opt.x,O.context2d.posY=this.opt.y,O.context2d.margin=this.opt.margin,O.context2d.fontFaces=H,H)for(var re=0;re<H.length;++re){var V=H[re],ve=V.src.find(function(ce){return"truetype"===ce.format});ve&&O.addFont(ve.url,V.ref.name,V.ref.style)}return Q.windowHeight=Q.windowHeight||0,Q.windowHeight=0==Q.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):Q.windowHeight,O.context2d.save(!0),P(this.prop.container,Q)}).then(function(P){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(P),this.prop.canvas=P,document.body.removeChild(this.prop.overlay)})},x.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var M=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=M})},x.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},x.prototype.output=function(M,P,O){return"img"===(O=O||"pdf").toLowerCase()||"image"===O.toLowerCase()?this.outputImg(M,P):this.outputPdf(M,P)},x.prototype.outputPdf=function(M,P){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(M,P)})},x.prototype.outputImg=function(M){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(M){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+M+'" is not supported.'}})},x.prototype.save=function(M){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(M?{filename:M}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},x.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},x.prototype.set=function(M){if("object"!==b(M))return this;var P=Object.keys(M||{}).map(function(O){if(O in x.template.prop)return function(){this.prop[O]=M[O]};switch(O){case"margin":return this.setMargin.bind(this,M.margin);case"jsPDF":return function(){return this.opt.jsPDF=M.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,M.pageSize);default:return function(){this.opt[O]=M[O]}}},this);return this.then(function(){return this.thenList(P)})},x.prototype.get=function(M,P){return this.then(function(){var O=M in x.template.prop?this.prop[M]:this.opt[M];return P?P(O):O})},x.prototype.setMargin=function(M){return this.then(function(){switch(b(M)){case"number":M=[M,M,M,M];case"array":if(2===M.length&&(M=[M[0],M[1],M[0],M[1]]),4===M.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=M}).then(this.setPageSize)},x.prototype.setPageSize=function(M){function P(O,H){return Math.floor(O*H/72*96)}return this.then(function(){(M=M||Pr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(M.inner={width:M.width-this.opt.margin[1]-this.opt.margin[3],height:M.height-this.opt.margin[0]-this.opt.margin[2]},M.inner.px={width:P(M.inner.width,M.k),height:P(M.inner.height,M.k)},M.inner.ratio=M.inner.height/M.inner.width),this.prop.pageSize=M})},x.prototype.setProgress=function(M,P,O,H){return null!=M&&(this.progress.val=M),null!=P&&(this.progress.state=P),null!=O&&(this.progress.n=O),null!=H&&(this.progress.stack=H),this.progress.ratio=this.progress.val/this.progress.state,this},x.prototype.updateProgress=function(M,P,O,H){return this.setProgress(M?this.progress.val+M:null,P||null,O?this.progress.n+O:null,H?this.progress.stack.concat(H):null)},x.prototype.then=function(M,P){var O=this;return this.thenCore(M,P,function(H,Y){return O.updateProgress(null,null,1,[H]),Promise.prototype.then.call(this,function(Q){return O.updateProgress(null,H),Q}).then(H,Y).then(function(Q){return O.updateProgress(1),Q})})},x.prototype.thenCore=function(M,P,O){O=O||Promise.prototype.then,M&&(M=M.bind(this)),P&&(P=P.bind(this));var H=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:x.convert(Object.assign({},this),Promise.prototype),Y=O.call(H,M,P);return x.convert(Y,this.__proto__)},x.prototype.thenExternal=function(M,P){return Promise.prototype.then.call(this,M,P)},x.prototype.thenList=function(M){var P=this;return M.forEach(function(O){P=P.thenCore(O)}),P},x.prototype.catch=function(M){M&&(M=M.bind(this));var P=Promise.prototype.catch.call(this,M);return x.convert(P,this)},x.prototype.catchExternal=function(M){return Promise.prototype.catch.call(this,M)},x.prototype.error=function(M){return this.then(function(){throw new Error(M)})},x.prototype.using=x.prototype.set,x.prototype.saveAs=x.prototype.save,x.prototype.export=x.prototype.output,x.prototype.run=x.prototype.then,Pr.getPageSize=function(M,P,O){if("object"===(0,zn.Z)(M)){var H=M;M=H.orientation,P=H.unit||P,O=H.format||O}P=P||"mm",O=O||"a4",M=(""+(M||"P")).toLowerCase();var Y,Q=(""+O).toLowerCase(),re={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(P){case"pt":Y=1;break;case"mm":Y=72/25.4;break;case"cm":Y=72/2.54;break;case"in":Y=72;break;case"px":Y=.75;break;case"pc":case"em":Y=12;break;case"ex":Y=6;break;default:throw"Invalid unit: "+P}var V,ve=0,ce=0;if(re.hasOwnProperty(Q))ve=re[Q][1]/Y,ce=re[Q][0]/Y;else try{ve=O[1],ce=O[0]}catch{throw new Error("Invalid format: "+O)}if("p"===M||"portrait"===M)M="p",ce>ve&&(V=ce,ce=ve,ve=V);else{if("l"!==M&&"landscape"!==M)throw"Invalid orientation: "+M;M="l",ve>ce&&(V=ce,ce=ve,ve=V)}return{width:ce,height:ve,unit:P,k:Y,orientation:M}},_.html=function(M,P){(P=P||{}).callback=P.callback||function(){},P.html2canvas=P.html2canvas||{},P.html2canvas.canvas=P.html2canvas.canvas||this.canvas,P.jsPDF=P.jsPDF||this,P.fontFaces=P.fontFaces?P.fontFaces.map(rd):null;var O=new x(P);return P.worker?O:O.from(M).doCallback()}}(Pr.API),Pr.API.addJS=function(_){return Xf=_,this.internal.events.subscribe("postPutResources",function(){id=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(id+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),zd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Xf+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==id&&void 0!==zd&&this.internal.out("/Names <</JavaScript "+id+" 0 R>>")}),this},
/**
         * @license
         * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){var p;_.events.push(["postPutResources",function(){var g=this,b=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var S=g.outline.render().split(/\r\n/),x=0;x<S.length;x++){var M=S[x],P=b.exec(M);null!=P&&g.internal.newObjectDeferredBegin(P[1],!1),g.internal.write(M)}if(this.outline.createNamedDestinations){var H=this.internal.pages.length,Y=[];for(x=0;x<H;x++){var Q=g.internal.newObject();Y.push(Q);var re=g.internal.getPageInfo(x+1);g.internal.write("<< /D["+re.objId+" 0 R /XYZ null null null]>> endobj")}var V=g.internal.newObject();for(g.internal.write("<< /Names [ "),x=0;x<Y.length;x++)g.internal.write("(page_"+(x+1)+")"+Y[x]+" 0 R");g.internal.write(" ] >>","endobj"),p=g.internal.newObject(),g.internal.write("<< /Dests "+V+" 0 R"),g.internal.write(">>","endobj")}}]),_.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+p+" 0 R"))}]),_.events.push(["initialized",function(){var g=this;g.outline={createNamedDestinations:!1,root:{children:[]}},g.outline.add=function(b,S,x){var M={title:S,options:x,children:[]};return null==b&&(b=this.root),b.children.push(M),M},g.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=g,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},g.outline.genIds_r=function(b){b.id=g.internal.newObjectDeferred();for(var S=0;S<b.children.length;S++)this.genIds_r(b.children[S])},g.outline.renderRoot=function(b){this.objStart(b),this.line("/Type /Outlines"),b.children.length>0&&(this.line("/First "+this.makeRef(b.children[0])),this.line("/Last "+this.makeRef(b.children[b.children.length-1]))),this.line("/Count "+this.count_r({count:0},b)),this.objEnd()},g.outline.renderItems=function(b){for(var S=this.ctx.pdf.internal.getVerticalCoordinateString,x=0;x<b.children.length;x++){var M=b.children[x];this.objStart(M),this.line("/Title "+this.makeString(M.title)),this.line("/Parent "+this.makeRef(b)),x>0&&this.line("/Prev "+this.makeRef(b.children[x-1])),x<b.children.length-1&&this.line("/Next "+this.makeRef(b.children[x+1])),M.children.length>0&&(this.line("/First "+this.makeRef(M.children[0])),this.line("/Last "+this.makeRef(M.children[M.children.length-1])));var P=this.count=this.count_r({count:0},M);if(P>0&&this.line("/Count "+P),M.options&&M.options.pageNumber){var O=g.internal.getPageInfo(M.options.pageNumber);this.line("/Dest ["+O.objId+" 0 R /XYZ 0 "+S(0)+" 0]")}this.objEnd()}for(var H=0;H<b.children.length;H++)this.renderItems(b.children[H])},g.outline.line=function(b){this.ctx.val+=b+"\r\n"},g.outline.makeRef=function(b){return b.id+" 0 R"},g.outline.makeString=function(b){return"("+g.internal.pdfEscape(b)+")"},g.outline.objStart=function(b){this.ctx.val+="\r\n"+b.id+" 0 obj\r\n<<\r\n"},g.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},g.outline.count_r=function(b,S){for(var x=0;x<S.children.length;x++)b.count++,this.count_r(b,S.children[x]);return b.count}}])}(Pr.API),
/**
         * @license
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){var p=[192,193,194,195,196,197,198,199];_.processJPEG=function(g,b,S,x,M,P){var O,H=this.decode.DCT_DECODE,Y=null;if("string"==typeof g||this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g)){switch(g=this.__addimage__.isArrayBuffer(g=M||g)?new Uint8Array(g):g,(O=function(Q){for(var re,V=256*Q.charCodeAt(4)+Q.charCodeAt(5),ve=Q.length,ce={width:0,height:0,numcomponents:1},be=4;be<ve;be+=2){if(-1!==p.indexOf(Q.charCodeAt((be+=V)+1))){re=256*Q.charCodeAt(be+5)+Q.charCodeAt(be+6),ce={width:256*Q.charCodeAt(be+7)+Q.charCodeAt(be+8),height:re,numcomponents:Q.charCodeAt(be+9)};break}V=256*Q.charCodeAt(be+2)+Q.charCodeAt(be+3)}return ce}(g=this.__addimage__.isArrayBufferView(g)?this.__addimage__.arrayBufferToBinaryString(g):g)).numcomponents){case 1:P=this.color_spaces.DEVICE_GRAY;break;case 4:P=this.color_spaces.DEVICE_CMYK;break;case 3:P=this.color_spaces.DEVICE_RGB}Y={data:g,width:O.width,height:O.height,colorSpace:P,bitsPerComponent:8,filter:H,index:b,alias:S}}return Y}}(Pr.API);var ts,Wl,k0,pr,Rm,F0=function(){var _,p,g;function b(x){var M,O,H,Y,Q,re,V,ve,ce,be,se,me,Be;for(this.data=x,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},Q=null;;){switch(M=this.readUInt32(),ve=function(){var st,At;for(At=[],st=0;st<4;++st)At.push(String.fromCharCode(this.data[this.pos++]));return At}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(M);break;case"fcTL":Q&&this.animation.frames.push(Q),this.pos+=4,Q={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},Y=this.readUInt16(),H=this.readUInt16()||100,Q.delay=1e3*Y/H,Q.disposeOp=this.data[this.pos++],Q.blendOp=this.data[this.pos++],Q.data=[];break;case"IDAT":case"fdAT":for("fdAT"===ve&&(this.pos+=4,M-=4),x=Q?.data||this.imgData,se=0;0<=M?se<M:se>M;0<=M?++se:--se)x.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(O=this.palette.length/3,this.transparency.indexed=this.read(M),this.transparency.indexed.length>O)throw new Error("More transparent colors than palette size");if((ce=O-this.transparency.indexed.length)>0)for(me=0;0<=ce?me<ce:me>ce;0<=ce?++me:--me)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(M)[0];break;case 2:this.transparency.rgb=this.read(M)}break;case"tEXt":re=(be=this.read(M)).indexOf(0),V=String.fromCharCode.apply(String,be.slice(0,re)),this.text[V]=String.fromCharCode.apply(String,be.slice(re+1));break;case"IEND":return Q&&this.animation.frames.push(Q),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(Be=this.colorType)||6===Be,this.pixelBitlength=this.bits*(this.colors+(this.hasAlphaChannel?1:0)),this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=M}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}b.prototype.read=function(x){var M,P;for(P=[],M=0;0<=x?M<x:M>x;0<=x?++M:--M)P.push(this.data[this.pos++]);return P},b.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},b.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},b.prototype.decodePixels=function(x){var M=this.pixelBitlength/8,P=new Uint8Array(this.width*this.height*M),O=0,H=this;if(null==x&&(x=this.imgData),0===x.length)return new Uint8Array(0);function Y(Q,re,V,ve){var ce,be,se,me,Be,st,At,ln,Oe,Kt,Yt,fe,de,He,Ne,Tt,St,zt,gt,Zt,Wt=Math.ceil((H.width-Q)/V),Yn=Math.ceil((H.height-re)/ve),J=H.width==Wt&&H.height==Yn;for(de=M*Wt,Yt=J?P:new Uint8Array(de*Yn),st=x.length,fe=0,be=0;fe<Yn&&O<st;){switch(x[O++]){case 0:for(me=Tt=0;Tt<de;me=Tt+=1)Yt[be++]=x[O++];break;case 1:for(me=St=0;St<de;me=St+=1)ce=x[O++],Be=me<M?0:Yt[be-M],Yt[be++]=(ce+Be)%256;break;case 2:for(me=zt=0;zt<de;me=zt+=1)ce=x[O++],se=(me-me%M)/M,Yt[be++]=((He=fe&&Yt[(fe-1)*de+se*M+me%M])+ce)%256;break;case 3:for(me=gt=0;gt<de;me=gt+=1)ce=x[O++],se=(me-me%M)/M,Be=me<M?0:Yt[be-M],He=fe&&Yt[(fe-1)*de+se*M+me%M],Yt[be++]=(ce+Math.floor((Be+He)/2))%256;break;case 4:for(me=Zt=0;Zt<de;me=Zt+=1)ce=x[O++],se=(me-me%M)/M,0===fe?He=Ne=0:(He=Yt[(fe-1)*de+se*M+me%M],Ne=se&&Yt[(fe-1)*de+(se-1)*M+me%M]),At=(Be=me<M?0:Yt[be-M])+He-Ne,ln=Math.abs(At-Be),Oe=Math.abs(At-He),Kt=Math.abs(At-Ne),Yt[be++]=(ce+(ln<=Oe&&ln<=Kt?Be:Oe<=Kt?He:Ne))%256;break;default:throw new Error("Invalid filter algorithm: "+x[O-1])}if(!J){var we=((re+fe*ve)*H.width+Q)*M,Te=fe*de;for(me=0;me<Wt;me+=1){for(var $e=0;$e<M;$e+=1)P[we++]=Yt[Te++];we+=(V-1)*M}}fe++}}return x=function Hf(_,p){return mt((Wh(_),_.subarray(2,-4)),p)}(x),1==H.interlaceMethod?(Y(0,0,8,8),Y(4,0,8,8),Y(0,4,4,8),Y(2,0,4,4),Y(0,2,2,4),Y(1,0,2,2),Y(0,1,1,2)):Y(0,0,1,1),P},b.prototype.decodePalette=function(){var x,M,P,O,H,Y,Q,re,V;for(P=this.palette,Y=this.transparency.indexed||[],H=new Uint8Array((Y.length||0)+P.length),O=0,x=0,M=Q=0,re=P.length;Q<re;M=Q+=3)H[O++]=P[M],H[O++]=P[M+1],H[O++]=P[M+2],H[O++]=null!=(V=Y[x++])?V:255;return H},b.prototype.copyToImageData=function(x,M){var P,O,H,Y,Q,re,V,ve,ce,be,se;if(O=this.colors,ce=null,P=this.hasAlphaChannel,this.palette.length&&(ce=null!=(se=this._decodedPalette)?se:this._decodedPalette=this.decodePalette(),O=4,P=!0),ve=(H=x.data||x).length,Q=ce||M,Y=re=0,1===O)for(;Y<ve;)V=ce?4*M[Y/4]:re,be=Q[V++],H[Y++]=be,H[Y++]=be,H[Y++]=be,H[Y++]=P?Q[V++]:255,re=V;else for(;Y<ve;)V=ce?4*M[Y/4]:re,H[Y++]=Q[V++],H[Y++]=Q[V++],H[Y++]=Q[V++],H[Y++]=P?Q[V++]:255,re=V},b.prototype.decode=function(){var x;return x=new Uint8Array(this.width*this.height*4),this.copyToImageData(x,this.decodePixels()),x};var S=function(){if("[object Window]"===Object.prototype.toString.call(Lr)){try{p=Lr.document.createElement("canvas"),g=p.getContext("2d")}catch{return!1}return!0}return!1};return S(),_=function(x){var M;if(!0===S())return g.width=x.width,g.height=x.height,g.clearRect(0,0,x.width,x.height),g.putImageData(x,0,0),(M=new Image).src=p.toDataURL(),M;throw new Error("This method requires a Browser with Canvas-capability.")},b.prototype.decodeFrames=function(x){var M,P,O,H,Y,Q,re,V;if(this.animation){for(V=[],P=Y=0,Q=(re=this.animation.frames).length;Y<Q;P=++Y)O=x.createImageData((M=re[P]).width,M.height),H=this.decodePixels(new Uint8Array(M.data)),this.copyToImageData(O,H),M.imageData=O,V.push(M.image=_(O));return V}},b.prototype.renderFrame=function(x,M){var P,O,H;return P=(O=this.animation.frames)[M],H=O[M-1],0===M&&x.clearRect(0,0,this.width,this.height),1===H?.disposeOp?x.clearRect(H.xOffset,H.yOffset,H.width,H.height):2===H?.disposeOp&&x.putImageData(H.imageData,H.xOffset,H.yOffset),0===P.blendOp&&x.clearRect(P.xOffset,P.yOffset,P.width,P.height),x.drawImage(P.image,P.xOffset,P.yOffset)},b.prototype.animate=function(x){var M,P,O,H,Y,Q,re=this;return P=0,H=(Q=this.animation).numFrames,O=Q.frames,Y=Q.numPlays,(M=function(){var V,ve;if(V=P++%H,ve=O[V],re.renderFrame(x,V),H>1&&P/H<Y)return re.animation._timeout=setTimeout(M,ve.delay)})()},b.prototype.stopAnimation=function(){var x;return clearTimeout(null!=(x=this.animation)?x._timeout:void 0)},b.prototype.render=function(x){var M,P;return x._png&&x._png.stopAnimation(),x._png=this,x.width=this.width,x.height=this.height,M=x.getContext("2d"),this.animation?(this.decodeFrames(M),this.animate(M)):(P=M.createImageData(this.width,this.height),this.copyToImageData(P,this.decodePixels()),M.putImageData(P,0,0))},b}();function I0(_){var p=0;if(71!==_[p++]||73!==_[p++]||70!==_[p++]||56!==_[p++]||56!=(_[p++]+1&253)||97!==_[p++])throw new Error("Invalid GIF 87a/89a header.");var g=_[p++]|_[p++]<<8,b=_[p++]|_[p++]<<8,S=_[p++],M=1<<1+(7&S);p++,p++;var P=null,O=null;S>>7&&(P=p,O=M,p+=3*M);var H=!0,Y=[],Q=0,re=null,V=0,ve=null;for(this.width=g,this.height=b;H&&p<_.length;)switch(_[p++]){case 33:switch(_[p++]){case 255:if(11!==_[p]||78==_[p+1]&&69==_[p+2]&&84==_[p+3]&&83==_[p+4]&&67==_[p+5]&&65==_[p+6]&&80==_[p+7]&&69==_[p+8]&&50==_[p+9]&&46==_[p+10]&&48==_[p+11]&&3==_[p+12]&&1==_[p+13]&&0==_[p+16])p+=14,ve=_[p++]|_[p++]<<8,p++;else for(p+=12;;){if(!((fe=_[p++])>=0))throw Error("Invalid block size");if(0===fe)break;p+=fe}break;case 249:if(4!==_[p++]||0!==_[p+4])throw new Error("Invalid graphics extension block.");var ce=_[p++];Q=_[p++]|_[p++]<<8,re=_[p++],!(1&ce)&&(re=null),V=ce>>2&7,p++;break;case 254:for(;;){if(!((fe=_[p++])>=0))throw Error("Invalid block size");if(0===fe)break;p+=fe}break;default:throw new Error("Unknown graphic control label: 0x"+_[p-1].toString(16))}break;case 44:var be=_[p++]|_[p++]<<8,se=_[p++]|_[p++]<<8,me=_[p++]|_[p++]<<8,Be=_[p++]|_[p++]<<8,st=_[p++],At=st>>6&1,ln=1<<1+(7&st),nt=P,Oe=O,Kt=!1;st>>7&&(Kt=!0,nt=p,Oe=ln,p+=3*ln);var Yt=p;for(p++;;){var fe;if(!((fe=_[p++])>=0))throw Error("Invalid block size");if(0===fe)break;p+=fe}Y.push({x:be,y:se,width:me,height:Be,has_local_palette:Kt,palette_offset:nt,palette_size:Oe,data_offset:Yt,data_length:p-Yt,transparent_index:re,interlaced:!!At,delay:Q,disposal:V});break;case 59:H=!1;break;default:throw new Error("Unknown gif block: 0x"+_[p-1].toString(16))}this.numFrames=function(){return Y.length},this.loopCount=function(){return ve},this.frameInfo=function(de){if(de<0||de>=Y.length)throw new Error("Frame index out of range.");return Y[de]},this.decodeAndBlitFrameBGRA=function(de,He){var Ne=this.frameInfo(de),Tt=Ne.width*Ne.height,St=new Uint8Array(Tt);Kr(_,Ne.data_offset,St,Tt);var zt=Ne.palette_offset,gt=Ne.transparent_index;null===gt&&(gt=256);var Zt=Ne.width,Wt=g-Zt,Yn=Zt,J=4*(Ne.y*g+Ne.x),we=4*((Ne.y+Ne.height)*g+Ne.x),Te=J,$e=4*Wt;!0===Ne.interlaced&&($e+=4*g*7);for(var Xe=8,ft=0,ot=St.length;ft<ot;++ft){var bt=St[ft];if(0===Yn&&(Yn=Zt,(Te+=$e)>=we&&($e=4*Wt+4*g*(Xe-1),Te=J+(Zt+Wt)*(Xe<<1),Xe>>=1)),bt===gt)Te+=4;else{var Rn=_[zt+3*bt],gn=_[zt+3*bt+1];He[Te++]=_[zt+3*bt+2],He[Te++]=gn,He[Te++]=Rn,He[Te++]=255}--Yn}},this.decodeAndBlitFrameRGBA=function(de,He){var Ne=this.frameInfo(de),Tt=Ne.width*Ne.height,St=new Uint8Array(Tt);Kr(_,Ne.data_offset,St,Tt);var zt=Ne.palette_offset,gt=Ne.transparent_index;null===gt&&(gt=256);var Zt=Ne.width,Wt=g-Zt,Yn=Zt,J=4*(Ne.y*g+Ne.x),we=4*((Ne.y+Ne.height)*g+Ne.x),Te=J,$e=4*Wt;!0===Ne.interlaced&&($e+=4*g*7);for(var Xe=8,ft=0,ot=St.length;ft<ot;++ft){var bt=St[ft];if(0===Yn&&(Yn=Zt,(Te+=$e)>=we&&($e=4*Wt+4*g*(Xe-1),Te=J+(Zt+Wt)*(Xe<<1),Xe>>=1)),bt===gt)Te+=4;else{var gn=_[zt+3*bt+1],Xn=_[zt+3*bt+2];He[Te++]=_[zt+3*bt],He[Te++]=gn,He[Te++]=Xn,He[Te++]=255}--Yn}}}function Kr(_,p,g,b){for(var S=_[p++],x=1<<S,M=x+1,P=M+1,O=S+1,H=(1<<O)-1,Y=0,Q=0,re=0,V=_[p++],ve=new Int32Array(4096),ce=null;;){for(;Y<16&&0!==V;)Q|=_[p++]<<Y,Y+=8,1===V?V=_[p++]:--V;if(Y<O)break;var be=Q&H;if(Q>>=O,Y-=O,be!==x){if(be===M)break;for(var se=be<P?be:ce,me=0,Be=se;Be>x;)Be=ve[Be]>>8,++me;var st=Be;if(re+me+(se!==be?1:0)>b)return void io.log("Warning, gif stream longer than expected.");g[re++]=st;var At=re+=me;for(se!==be&&(g[re++]=st),Be=se;me--;)g[--At]=255&(Be=ve[Be]),Be>>=8;null!==ce&&P<4096&&(ve[P++]=ce<<8|st,P>=H+1&&O<12&&(++O,H=H<<1|1)),ce=be}else P=M+1,H=(1<<(O=S+1))-1,ce=null}return re!==b&&io.log("Warning, gif stream shorter than expected."),g}function tp(_){var p,g,b,S,x,M=Math.floor,P=new Array(64),O=new Array(64),H=new Array(64),Y=new Array(64),Q=new Array(65535),re=new Array(65535),V=new Array(64),ve=new Array(64),ce=[],be=0,se=7,me=new Array(64),Be=new Array(64),st=new Array(64),At=new Array(256),ln=new Array(2048),nt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Oe=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Kt=[0,1,2,3,4,5,6,7,8,9,10,11],Yt=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],fe=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],de=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],He=[0,1,2,3,4,5,6,7,8,9,10,11],Ne=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Tt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function St(J,we){for(var Te=0,$e=0,Xe=new Array,ft=1;ft<=16;ft++){for(var ot=1;ot<=J[ft];ot++)Xe[we[$e]]=[],Xe[we[$e]][0]=Te,Xe[we[$e]][1]=ft,$e++,Te++;Te*=2}return Xe}function zt(J){for(var we=J[0],Te=J[1]-1;Te>=0;)we&1<<Te&&(be|=1<<se),Te--,--se<0&&(255==be?(gt(255),gt(0)):gt(be),se=7,be=0)}function gt(J){ce.push(J)}function Zt(J){gt(J>>8&255),gt(255&J)}function Wt(J,we,Te,$e,Xe){for(var ft,ot=Xe[0],bt=Xe[240],Rn=function(B,C){var F,j,le,et,cn,In,nr,Or,wr,Hr,Jn=0;for(wr=0;wr<8;++wr){var Ua=(F=B[Jn])+(Or=B[Jn+7]),Xi=F-Or,rs=(j=B[Jn+1])+(nr=B[Jn+6]),po=j-nr,Io=(le=B[Jn+2])+(In=B[Jn+5]),Tr=le-In,no=(et=B[Jn+3])+(cn=B[Jn+4]),sp=et-cn,fa=Ua+no,Nc=Ua-no,ad=rs+Io,ta=rs-Io;B[Jn]=fa+ad,B[Jn+4]=fa-ad;var ai=.707106781*(ta+Nc);B[Jn+2]=Nc+ai,B[Jn+6]=Nc-ai;var ao=.382683433*((fa=sp+Tr)-(ta=po+Xi)),fn=.5411961*fa+ao,zr=1.306562965*ta+ao,ht=.707106781*(ad=Tr+po),pt=Xi+ht,mr=Xi-ht;B[Jn+5]=mr+fn,B[Jn+3]=mr-fn,B[Jn+1]=pt+zr,B[Jn+7]=pt-zr,Jn+=8}for(Jn=0,wr=0;wr<8;++wr){var uc=(F=B[Jn])+(Or=B[Jn+56]),yl=F-Or,na=(j=B[Jn+8])+(nr=B[Jn+48]),_a=j-nr,ha=(le=B[Jn+16])+(In=B[Jn+40]),Gl=le-In,Bm=(et=B[Jn+24])+(cn=B[Jn+32]),wu=et-cn,Ho=uc+Bm,Ha=uc-Bm,dc=na+ha,rl=na-ha;B[Jn]=Ho+dc,B[Jn+32]=Ho-dc;var Aa=.707106781*(rl+Ha);B[Jn+16]=Ha+Aa,B[Jn+48]=Ha-Aa;var xu=.382683433*((Ho=wu+Gl)-(rl=_a+yl)),$d=.5411961*Ho+xu,lp=1.306562965*rl+xu,cp=.707106781*(dc=Gl+_a),Wd=yl+cp,qd=yl-cp;B[Jn+40]=qd+$d,B[Jn+24]=qd-$d,B[Jn+8]=Wd+lp,B[Jn+56]=Wd-lp,Jn++}for(wr=0;wr<64;++wr)V[wr]=(Hr=B[wr]*C[wr])>0?Hr+.5|0:Hr-.5|0;return V}(J,we),gn=0;gn<64;++gn)ve[nt[gn]]=Rn[gn];var Xn=ve[0]-Te;Te=ve[0],0==Xn?zt($e[0]):(zt($e[re[ft=32767+Xn]]),zt(Q[ft]));for(var tr=63;tr>0&&0==ve[tr];)tr--;if(0==tr)return zt(ot),Te;for(var jr,Lt=1;Lt<=tr;){for(var Me=Lt;0==ve[Lt]&&Lt<=tr;)++Lt;var ti=Lt-Me;if(ti>=16){jr=ti>>4;for(var fr=1;fr<=jr;++fr)zt(bt);ti&=15}zt(Xe[(ti<<4)+re[ft=32767+ve[Lt]]]),zt(Q[ft]),Lt++}return 63!=tr&&zt(ot),Te}function Yn(J){J=Math.min(Math.max(J,1),100),x!=J&&(function(we){for(var Te=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],$e=0;$e<64;$e++){var Xe=M((Te[$e]*we+50)/100);Xe=Math.min(Math.max(Xe,1),255),P[nt[$e]]=Xe}for(var ft=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ot=0;ot<64;ot++){var bt=M((ft[ot]*we+50)/100);bt=Math.min(Math.max(bt,1),255),O[nt[ot]]=bt}for(var Rn=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],gn=0,Xn=0;Xn<8;Xn++)for(var tr=0;tr<8;tr++)H[gn]=1/(P[nt[gn]]*Rn[Xn]*Rn[tr]*8),Y[gn]=1/(O[nt[gn]]*Rn[Xn]*Rn[tr]*8),gn++}(J<50?Math.floor(5e3/J):Math.floor(200-2*J)),x=J)}this.encode=function(J,we){var j,le;we&&Yn(we),ce=new Array,be=0,se=7,Zt(65496),Zt(65504),Zt(16),gt(74),gt(70),gt(73),gt(70),gt(0),gt(1),gt(1),gt(0),Zt(1),Zt(1),gt(0),gt(0),function(){Zt(65499),Zt(132),gt(0);for(var j=0;j<64;j++)gt(P[j]);gt(1);for(var le=0;le<64;le++)gt(O[le])}(),j=J.width,le=J.height,Zt(65472),Zt(17),gt(8),Zt(le),Zt(j),gt(3),gt(1),gt(17),gt(0),gt(2),gt(17),gt(1),gt(3),gt(17),gt(1),function(){Zt(65476),Zt(418),gt(0);for(var j=0;j<16;j++)gt(Oe[j+1]);for(var le=0;le<=11;le++)gt(Kt[le]);gt(16);for(var et=0;et<16;et++)gt(Yt[et+1]);for(var cn=0;cn<=161;cn++)gt(fe[cn]);gt(1);for(var In=0;In<16;In++)gt(de[In+1]);for(var nr=0;nr<=11;nr++)gt(He[nr]);gt(17);for(var Or=0;Or<16;Or++)gt(Ne[Or+1]);for(var wr=0;wr<=161;wr++)gt(Tt[wr])}(),Zt(65498),Zt(12),gt(3),gt(1),gt(0),gt(2),gt(17),gt(3),gt(17),gt(0),gt(63),gt(0);var Te=0,$e=0,Xe=0;be=0,se=7,this.encode.displayName="_encode_";for(var ft,ot,bt,Rn,gn,Xn,tr,jr,Lt,Me=J.data,fr=J.height,B=4*J.width,C=0;C<fr;){for(ft=0;ft<B;){for(gn=B*C+ft,tr=-1,jr=0,Lt=0;Lt<64;Lt++)Xn=gn+(jr=Lt>>3)*B+(tr=4*(7&Lt)),C+jr>=fr&&(Xn-=B*(C+1+jr-fr)),ft+tr>=B&&(Xn-=ft+tr-B+4),ot=Me[Xn++],bt=Me[Xn++],Rn=Me[Xn++],me[Lt]=(ln[ot]+ln[bt+256>>0]+ln[Rn+512>>0]>>16)-128,Be[Lt]=(ln[ot+768>>0]+ln[bt+1024>>0]+ln[Rn+1280>>0]>>16)-128,st[Lt]=(ln[ot+1280>>0]+ln[bt+1536>>0]+ln[Rn+1792>>0]>>16)-128;Te=Wt(me,H,Te,p,b),$e=Wt(Be,Y,$e,g,S),Xe=Wt(st,Y,Xe,g,S),ft+=32}C+=8}if(se>=0){var F=[];F[1]=se+1,F[0]=(1<<se+1)-1,zt(F)}return Zt(65497),new Uint8Array(ce)},_=_||50,function(){for(var J=String.fromCharCode,we=0;we<256;we++)At[we]=J(we)}(),p=St(Oe,Kt),g=St(de,He),b=St(Yt,fe),S=St(Ne,Tt),function(){for(var J=1,we=2,Te=1;Te<=15;Te++){for(var $e=J;$e<we;$e++)re[32767+$e]=Te,Q[32767+$e]=[],Q[32767+$e][1]=Te,Q[32767+$e][0]=$e;for(var Xe=-(we-1);Xe<=-J;Xe++)re[32767+Xe]=Te,Q[32767+Xe]=[],Q[32767+Xe][1]=Te,Q[32767+Xe][0]=we-1+Xe;J<<=1,we<<=1}}(),function(){for(var J=0;J<256;J++)ln[J]=19595*J,ln[J+256>>0]=38470*J,ln[J+512>>0]=7471*J+32768,ln[J+768>>0]=-11059*J,ln[J+1024>>0]=-21709*J,ln[J+1280>>0]=32768*J+8421375,ln[J+1536>>0]=-27439*J,ln[J+1792>>0]=-5329*J}(),Yn(_)}function nl(_,p){if(this.pos=0,this.buffer=_,this.datav=new DataView(_.buffer),this.is_with_alpha=!!p,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function jn(_){function p(Oe){if(!Oe)throw Error("assert :P")}function g(Oe,Kt,Yt){for(var fe=0;4>fe;fe++)if(Oe[Kt+fe]!=Yt.charCodeAt(fe))return!0;return!1}function b(Oe,Kt,Yt,fe,de){for(var He=0;He<de;He++)Oe[Kt+He]=Yt[fe+He]}function S(Oe,Kt,Yt,fe){for(var de=0;de<fe;de++)Oe[Kt+de]=Yt}function x(Oe){return new Int32Array(Oe)}function M(Oe,Kt){for(var Yt=[],fe=0;fe<Oe;fe++)Yt.push(new Kt);return Yt}function P(Oe,Kt){var Yt=[];return function fe(de,He,Ne){for(var Tt=Ne[He],St=0;St<Tt&&(de.push(Ne.length>He+1?[]:new Kt),!(Ne.length<He+1));St++)fe(de[St],He+1,Ne)}(Yt,0,Oe),Yt}var O=function(){var Oe=this;function Kt(m,y){for(var I=1<<y-1>>>0;m&I;)I>>>=1;return I?(m&I-1)+I:m}function Yt(m,y,I,L,G){p(!(L%I));do{m[y+(L-=I)]=G}while(0<L)}function fe(m,y,I,L,G){if(p(2328>=G),512>=G)var K=x(512);else if(null==(K=x(G)))return 0;return function(ee,ne,ie,he,Ue,ct){var at,Ke,un=ne,kt=1<<ie,ze=x(16),We=x(16);for(p(0!=Ue),p(null!=he),p(null!=ee),p(0<ie),Ke=0;Ke<Ue;++Ke){if(15<he[Ke])return 0;++ze[he[Ke]]}if(ze[0]==Ue)return 0;for(We[1]=0,at=1;15>at;++at){if(ze[at]>1<<at)return 0;We[at+1]=We[at]+ze[at]}for(Ke=0;Ke<Ue;++Ke)at=he[Ke],0<he[Ke]&&(ct[We[at]++]=Ke);if(1==We[15])return(he=new de).g=0,he.value=ct[0],Yt(ee,un,1,kt,he),kt;var en,vn=-1,sn=kt-1,lr=0,$n=1,Nr=1,qn=1<<ie;for(Ke=0,at=1,Ue=2;at<=ie;++at,Ue<<=1){if($n+=Nr<<=1,0>(Nr-=ze[at]))return 0;for(;0<ze[at];--ze[at])(he=new de).g=at,he.value=ct[Ke++],Yt(ee,un+lr,Ue,qn,he),lr=Kt(lr,at)}for(at=ie+1,Ue=2;15>=at;++at,Ue<<=1){if($n+=Nr<<=1,0>(Nr-=ze[at]))return 0;for(;0<ze[at];--ze[at]){if(he=new de,(lr&sn)!=vn){for(un+=qn,en=1<<(vn=at)-ie;15>vn&&!(0>=(en-=ze[vn]));)++vn,en<<=1;kt+=qn=1<<(en=vn-ie),ee[ne+(vn=lr&sn)].g=en+ie,ee[ne+vn].value=un-ne-vn}he.g=at-ie,he.value=ct[Ke++],Yt(ee,un+(lr>>ie),Ue,qn,he),lr=Kt(lr,at)}}return $n!=2*We[15]-1?0:kt}(m,y,I,L,G,K)}function de(){this.value=this.g=0}function He(){this.value=this.g=0}function Ne(){this.G=M(5,de),this.H=x(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=M(za,He)}function Tt(m,y,I,L){p(null!=m),p(null!=y),p(2147483648>L),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=y,m.pa=I,m.Jd=y,m.Yc=I+L,m.Zc=4<=L?I+L-4+1:I,ft(m)}function St(m,y){for(var I=0;0<y--;)I|=bt(m,128)<<y;return I}function zt(m,y){var I=St(m,y);return ot(m)?-I:I}function gt(m,y,I,L){var G,K=0;for(p(null!=m),p(null!=y),p(4294967288>L),m.Sb=L,m.Ra=0,m.u=0,m.h=0,4<L&&(L=4),G=0;G<L;++G)K+=y[I+G]<<8*G;m.Ra=K,m.bb=L,m.oa=y,m.pa=I}function Zt(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<Dp-8>>>0,++m.bb,m.u-=8;Te(m)&&(m.h=1,m.u=0)}function Wt(m,y){if(p(0<=y),!m.h&&y<=lh){var I=we(m)&Km[y];return m.u+=y,Zt(m),I}return m.h=1,m.u=0}function Yn(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function J(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function we(m){return m.Ra>>>(m.u&Dp-1)>>>0}function Te(m){return p(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>Dp}function $e(m,y){m.u=y,m.h=Te(m)}function Xe(m){m.u>=Zm&&(p(m.u>=Zm),Zt(m))}function ft(m){p(null!=m&&null!=m.oa),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(p(null!=m&&null!=m.oa),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function ot(m){return St(m,1)}function bt(m,y){var I=m.Ca;0>m.b&&ft(m);var L=m.b,G=I*y>>>8,K=(m.I>>>L>G)+0;for(K?(I-=G,m.I-=G+1<<L>>>0):I=G+1,L=I,G=0;256<=L;)G+=8,L>>=8;return m.b-=L=7^G+El[L],m.Ca=(I<<L)-1,K}function Rn(m,y,I){m[y+0]=I>>24&255,m[y+1]=I>>16&255,m[y+2]=I>>8&255,m[y+3]=I>>0&255}function gn(m,y){return m[y+0]<<0|m[y+1]<<8}function Xn(m,y){return gn(m,y)|m[y+2]<<16}function tr(m,y){return gn(m,y)|gn(m,y+2)<<16}function jr(m,y){var I=1<<y;return p(null!=m),p(0<y),m.X=x(I),null==m.X?0:(m.Mb=32-y,m.Xa=y,1)}function Lt(m,y){p(null!=m),p(null!=y),p(m.Xa==y.Xa),b(y.X,0,m.X,0,1<<y.Xa)}function Me(){this.X=[],this.Xa=this.Mb=0}function ti(m,y,I,L){p(null!=I),p(null!=L);var G=I[0],K=L[0];return 0==G&&(G=(m*K+y/2)/y),0==K&&(K=(y*G+m/2)/m),0>=G||0>=K?0:(I[0]=G,L[0]=K,1)}function fr(m,y){return m+(1<<y)-1>>>y}function B(m,y){return((4278255360&m)+(4278255360&y)>>>0&4278255360)+((16711935&m)+(16711935&y)>>>0&16711935)>>>0}function C(m,y){Oe[y]=function(I,L,G,K,ee,ne,ie){var he;for(he=0;he<ee;++he){var Ue=Oe[m](ne[ie+he-1],G,K+he);ne[ie+he]=B(I[L+he],Ue)}}}function F(){this.ud=this.hd=this.jd=0}function j(m,y){return((4278124286&(m^y))>>>1)+(m&y)>>>0}function le(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function et(m,y){return le(m+(m-y+.5>>1))}function cn(m,y,I){return Math.abs(y-I)-Math.abs(m-I)}function In(m,y,I,L,G,K,ee){for(L=K[ee-1],I=0;I<G;++I)K[ee+I]=L=B(m[y+I],L)}function nr(m,y,I,L,G){var K;for(K=0;K<I;++K){var ee=m[y+K],ne=ee>>8&255,ie=16711935&(ie=(ie=16711935&ee)+((ne<<16)+ne));L[G+K]=(4278255360&ee)+ie>>>0}}function Or(m,y){y.jd=m>>0&255,y.hd=m>>8&255,y.ud=m>>16&255}function wr(m,y,I,L,G,K){var ee;for(ee=0;ee<L;++ee){var ne=y[I+ee],ie=ne>>>8,he=ne,Ue=255&(Ue=(Ue=ne>>>16)+((m.jd<<24>>24)*(ie<<24>>24)>>>5));he=255&(he=(he+=(m.hd<<24>>24)*(ie<<24>>24)>>>5)+((m.ud<<24>>24)*(Ue<<24>>24)>>>5)),G[K+ee]=(4278255360&ne)+(Ue<<16)+he}}function Hr(m,y,I,L,G){Oe[y]=function(K,ee,ne,ie,he,Ue,ct,at,Ke){for(ie=ct;ie<at;++ie)for(ct=0;ct<Ke;++ct)he[Ue++]=G(ne[L(K[ee++])])},Oe[m]=function(K,ee,ne,ie,he,Ue,ct){var at=8>>K.b,Ke=K.Ea,un=K.K[0],kt=K.w;if(8>at)for(K=(1<<K.b)-1,kt=(1<<at)-1;ee<ne;++ee){var ze,We=0;for(ze=0;ze<Ke;++ze)ze&K||(We=L(ie[he++])),Ue[ct++]=G(un[We&kt]),We>>=at}else Oe["VP8LMapColor"+I](ie,he,un,kt,Ue,ct,ee,ne,Ke)}}function Jn(m,y,I,L,G){for(I=y+I;y<I;){var K=m[y++];L[G++]=K>>16&255,L[G++]=K>>8&255,L[G++]=K>>0&255}}function Ua(m,y,I,L,G){for(I=y+I;y<I;){var K=m[y++];L[G++]=K>>16&255,L[G++]=K>>8&255,L[G++]=K>>0&255,L[G++]=K>>24&255}}function Xi(m,y,I,L,G){for(I=y+I;y<I;){var K=(ee=m[y++])>>16&240|ee>>12&15,ee=ee>>0&240|ee>>28&15;L[G++]=K,L[G++]=ee}}function rs(m,y,I,L,G){for(I=y+I;y<I;){var K=(ee=m[y++])>>16&248|ee>>13&7,ee=ee>>5&224|ee>>3&31;L[G++]=K,L[G++]=ee}}function po(m,y,I,L,G){for(I=y+I;y<I;){var K=m[y++];L[G++]=K>>0&255,L[G++]=K>>8&255,L[G++]=K>>16&255}}function Io(m,y,I,L,G,K){if(0==K)for(I=y+I;y<I;)Rn(L,((K=m[y++])[0]>>24|K[1]>>8&65280|K[2]<<8&16711680|K[3]<<24)>>>0),G+=32;else b(L,G,m,y,I)}function Tr(m,y){Oe[y][0]=Oe[m+"0"],Oe[y][1]=Oe[m+"1"],Oe[y][2]=Oe[m+"2"],Oe[y][3]=Oe[m+"3"],Oe[y][4]=Oe[m+"4"],Oe[y][5]=Oe[m+"5"],Oe[y][6]=Oe[m+"6"],Oe[y][7]=Oe[m+"7"],Oe[y][8]=Oe[m+"8"],Oe[y][9]=Oe[m+"9"],Oe[y][10]=Oe[m+"10"],Oe[y][11]=Oe[m+"11"],Oe[y][12]=Oe[m+"12"],Oe[y][13]=Oe[m+"13"],Oe[y][14]=Oe[m+"0"],Oe[y][15]=Oe[m+"0"]}function no(m){return m==j_||m==V_||m==ig||m==og}function sp(){this.eb=[],this.size=this.A=this.fb=0}function fa(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Nc(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new sp,this.f.kb=new fa,this.sd=null}function ad(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ta(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ai(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function ao(m,y){var I=m.T,L=y.ba.f.RGBA,G=L.eb,K=L.fb+m.ka*L.A,ee=yc[y.ba.S],ne=m.y,ie=m.O,he=m.f,Ue=m.N,ct=m.ea,at=m.W,Ke=y.cc,un=y.dc,kt=y.Mc,ze=y.Nc,We=m.ka,en=m.ka+m.T,vn=m.U,sn=vn+1>>1;for(0==We?ee(ne,ie,null,null,he,Ue,ct,at,he,Ue,ct,at,G,K,null,null,vn):(ee(y.ec,y.fc,ne,ie,Ke,un,kt,ze,he,Ue,ct,at,G,K-L.A,G,K,vn),++I);We+2<en;We+=2)ee(ne,(ie+=2*m.fa)-m.fa,ne,ie,Ke=he,un=Ue,kt=ct,ze=at,he,Ue+=m.Rc,ct,at+=m.Rc,G,(K+=2*L.A)-L.A,G,K,vn);return ie+=m.fa,m.j+en<m.o?(b(y.ec,y.fc,ne,ie,vn),b(y.cc,y.dc,he,Ue,sn),b(y.Mc,y.Nc,ct,at,sn),I--):1&en||ee(ne,ie,null,null,he,Ue,ct,at,he,Ue,ct,at,G,K+L.A,null,null,vn),I}function fn(m,y,I){var L=m.F,G=[m.J];if(null!=L){var K=m.U,ee=y.ba.S,ne=ee==rg||ee==ig;y=y.ba.f.RGBA;var ie=[0],he=m.ka;ie[0]=m.T,m.Kb&&(0==he?--ie[0]:(--he,G[0]-=m.width),m.j+m.ka+m.T==m.o&&(ie[0]=m.o-m.j-he));var Ue=y.eb;m=G0(L,G[0],m.width,K,ie,Ue,(he=y.fb+he*y.A)+(ne?0:3),y.A),p(I==ie),m&&no(ee)&&uh(Ue,he,ne,K,ie,y.A)}return 0}function zr(m){var y=m.ma,I=y.ba.S,L=11>I,G=I==Fp||I==ng||I==rg||I==Ls||12==I||no(I);if(y.memory=null,y.Ib=null,y.Jb=null,y.Nd=null,!W0(y.Oa,m,G?11:12))return 0;if(G&&no(I)&&xn(),m.da)alert("todo:use_scaling");else{if(L){if(y.Ib=ai,m.Kb){if(y.memory=x(m.U+2*(I=m.U+1>>1)),null==y.memory)return 0;y.ec=y.memory,y.fc=0,y.cc=y.ec,y.dc=y.fc+m.U,y.Mc=y.cc,y.Nc=y.dc+I,y.Ib=ao,xn()}}else alert("todo:EmitYUV");G&&(y.Jb=fn,L&&rt())}if(L&&!A2){for(m=0;256>m;++m)rC[m]=89858*(m-128)+cg>>Pp,T2[m]=-22014*(m-128)+cg,oC[m]=-45773*(m-128),iC[m]=113618*(m-128)+cg>>Pp;for(m=ug;m<dg;++m)$_[m-ug]=Cl(y=76283*(m-16)+cg>>Pp,255),M2[m-ug]=Cl(y+8>>4,15);A2=1}return 1}function ht(m){var y=m.ma,I=m.U,L=m.T;return p(!(1&m.ka)),0>=I||0>=L?0:(I=y.Ib(m,y),null!=y.Jb&&y.Jb(m,y,I),y.Dc+=I,1)}function pt(m){m.ma.memory=null}function mr(m,y,I,L){return 47!=Wt(m,8)?0:(y[0]=Wt(m,14)+1,I[0]=Wt(m,14)+1,L[0]=Wt(m,1),0!=Wt(m,3)?0:!m.h)}function uc(m,y){if(4>m)return m+1;var I=m-2>>1;return(2+(1&m)<<I)+Wt(y,I)+1}function yl(m,y){return 120<y?y-120:1<=(I=((I=Zx[y-1])>>4)*m+(8-(15&I)))?I:1;var I}function na(m,y,I){var L=we(I),G=m[y+=255&L].g-8;return 0<G&&($e(I,I.u+8),L=we(I),y+=m[y].value,y+=L&(1<<G)-1),$e(I,I.u+m[y].g),m[y].value}function _a(m,y,I){return I.g+=m.g,I.value+=m.value<<y>>>0,p(8>=I.g),m.g}function ha(m,y,I){var L=m.xc;return p((y=0==L?0:m.vc[m.md*(I>>L)+(y>>L)])<m.Wb),m.Ya[y]}function Gl(m,y,I,L){var G=m.ab,K=m.c*y,ee=m.C;y=ee+y;var ne=I,ie=L;for(L=m.Ta,I=m.Ua;0<G--;){var he=m.gc[G],Ue=ee,ct=y,at=ne,Ke=ie,un=(ie=L,ne=I,he.Ea);switch(p(Ue<ct),p(ct<=he.nc),he.hc){case 2:q0(at,Ke,(ct-Ue)*un,ie,ne);break;case 0:var kt=Ue,ze=ct,We=ie,en=ne,vn=(qn=he).Ea;0==kt&&(R_(at,Ke,null,null,1,We,en),In(at,Ke+1,0,0,vn-1,We,en+1),Ke+=vn,en+=vn,++kt);for(var sn=1<<qn.b,lr=sn-1,$n=fr(vn,qn.b),Nr=qn.K,qn=qn.w+(kt>>qn.b)*$n;kt<ze;){var Ki=Nr,Zi=qn,Ni=1;for(Qm(at,Ke,We,en-vn,1,We,en);Ni<vn;){var gi=(Ni&~lr)+sn;gi>vn&&(gi=vn),(0,dd[Ki[Zi++]>>8&15])(at,Ke+ +Ni,We,en+Ni-vn,gi-Ni,We,en+Ni),Ni=gi}Ke+=vn,en+=vn,++kt&lr||(qn+=$n)}ct!=he.nc&&b(ie,ne-un,ie,ne+(ct-Ue-1)*un,un);break;case 1:for(un=at,ze=Ke,vn=(at=he.Ea)-(en=at&~(We=(Ke=1<<he.b)-1)),kt=fr(at,he.b),sn=he.K,he=he.w+(Ue>>he.b)*kt;Ue<ct;){for(lr=sn,$n=he,Nr=new F,qn=ze+en,Ki=ze+at;ze<qn;)Or(lr[$n++],Nr),ws(Nr,un,ze,Ke,ie,ne),ze+=Ke,ne+=Ke;ze<Ki&&(Or(lr[$n++],Nr),ws(Nr,un,ze,vn,ie,ne),ze+=vn,ne+=vn),++Ue&We||(he+=kt)}break;case 3:if(at==ie&&Ke==ne&&0<he.b){for(ze=ie,at=un=ne+(ct-Ue)*un-(en=(ct-Ue)*fr(he.Ea,he.b)),Ke=ie,We=ne,kt=[],en=(vn=en)-1;0<=en;--en)kt[en]=Ke[We+en];for(en=vn-1;0<=en;--en)ze[at+en]=kt[en];Xl(he,Ue,ct,ie,un,ie,ne)}else Xl(he,Ue,ct,at,Ke,ie,ne)}ne=L,ie=I}ie!=I&&b(L,I,ne,ie,K)}function Bm(m,y){var I=m.V,L=m.Ba+m.c*m.C,G=y-m.C;if(p(y<=m.l.o),p(16>=G),0<G){var K=m.l,ee=m.Ta,ne=m.Ua,ie=K.width;if(Gl(m,G,I,L),G=ne=[ne],p((I=m.C)<(L=y)),p(K.v<K.va),L>K.o&&(L=K.o),I<K.j){var he=K.j-I;I=K.j,G[0]+=he*ie}if(I>=L?I=0:(G[0]+=4*K.v,K.ka=I-K.j,K.U=K.va-K.v,K.T=L-I,I=1),I){if(ne=ne[0],11>(I=m.ca).S){var Ue=I.f.RGBA,ct=(L=I.S,G=K.U,K=K.T,he=Ue.eb,Ue.A),at=K;for(Ue=Ue.fb+m.Ma*Ue.A;0<at--;){var Ke=ee,un=ne,kt=G,ze=he,We=Ue;switch(L){case tg:Hc(Ke,un,kt,ze,We);break;case Fp:fd(Ke,un,kt,ze,We);break;case j_:fd(Ke,un,kt,ze,We),uh(ze,We,0,kt,1,0);break;case B_:ch(Ke,un,kt,ze,We);break;case ng:Io(Ke,un,kt,ze,We,1);break;case V_:Io(Ke,un,kt,ze,We,1),uh(ze,We,0,kt,1,0);break;case rg:Io(Ke,un,kt,ze,We,0);break;case ig:Io(Ke,un,kt,ze,We,0),uh(ze,We,1,kt,1,0);break;case Ls:Sl(Ke,un,kt,ze,We);break;case og:Sl(Ke,un,kt,ze,We),kp(ze,We,kt,1,0);break;case b2:hc(Ke,un,kt,ze,We);break;default:p(0)}ne+=ie,Ue+=ct}m.Ma+=K}else alert("todo:EmitRescaledRowsYUVA");p(m.Ma<=I.height)}}m.C=y,p(m.C<=m.i)}function wu(m){var y;if(0<m.ua)return 0;for(y=0;y<m.Wb;++y){var I=m.Ya[y].G,L=m.Ya[y].H;if(0<I[1][L[1]+0].g||0<I[2][L[2]+0].g||0<I[3][L[3]+0].g)return 0}return 1}function Ho(m,y,I,L,G,K){if(0!=m.Z){var ee=m.qd,ne=m.rd;for(p(null!=Mu[m.Z]);y<I;++y)Mu[m.Z](ee,ne,L,G,L,G,K),ee=L,ne=G,G+=K;m.qd=ee,m.rd=ne}}function Ha(m,y){var I=m.l.ma,L=0==I.Z||1==I.Z?m.l.j:m.C;if(L=m.C<L?L:m.C,p(y<=m.l.o),y>L){var G=m.l.width,K=I.ca,ee=I.tb+G*L,ne=m.V,ie=m.Ba+m.c*L,he=m.gc;p(1==m.ab),p(3==he[0].hc),Jm(he[0],L,y,ne,ie,K,ee),Ho(I,L,y,K,ee,G)}m.C=m.Ma=y}function dc(m,y,I,L,G,K,ee){var ne=m.$/L,ie=m.$%L,he=m.m,Ue=m.s,ct=I+m.$,at=ct;G=I+L*G;var Ke=I+L*K,un=280+Ue.ua,kt=m.Pb?ne:16777216,ze=0<Ue.ua?Ue.Wa:null,We=Ue.wc,en=ct<Ke?ha(Ue,ie,ne):null;p(m.C<K),p(Ke<=G);var vn=!1;e:for(;;){for(;vn||ct<Ke;){var sn=0;if(ne>=kt){var lr=ct-I;p((kt=m).Pb),kt.wd=kt.m,kt.xd=lr,0<kt.s.ua&&Lt(kt.s.Wa,kt.s.vb),kt=ne+U_}if(ie&We||(en=ha(Ue,ie,ne)),p(null!=en),en.Qb&&(y[ct]=en.qb,vn=!0),!vn)if(Xe(he),en.jc){lr=y;var $n=ct,Nr=en.pd[we(sn=he)&za-1];p(en.jc),256>Nr.g?($e(sn,sn.u+Nr.g),lr[$n]=Nr.value,sn=0):($e(sn,sn.u+Nr.g-256),p(256<=Nr.value),sn=Nr.value),0==sn&&(vn=!0)}else sn=na(en.G[0],en.H[0],he);if(he.h)break;if(vn||256>sn){if(!vn)if(en.nd)y[ct]=(en.qb|sn<<8)>>>0;else{if(Xe(he),vn=na(en.G[1],en.H[1],he),Xe(he),lr=na(en.G[2],en.H[2],he),$n=na(en.G[3],en.H[3],he),he.h)break;y[ct]=($n<<24|vn<<16|sn<<8|lr)>>>0}if(vn=!1,++ct,++ie>=L&&(ie=0,++ne,null!=ee&&ne<=K&&!(ne%16)&&ee(m,ne),null!=ze))for(;at<ct;)sn=y[at++],ze.X[(506832829*sn&4294967295)>>>ze.Mb]=sn}else if(280>sn){if(sn=uc(sn-256,he),lr=na(en.G[4],en.H[4],he),Xe(he),lr=yl(L,lr=uc(lr,he)),he.h)break;if(ct-I<lr||G-ct<sn)break e;for($n=0;$n<sn;++$n)y[ct+$n]=y[ct+$n-lr];for(ct+=sn,ie+=sn;ie>=L;)ie-=L,++ne,null!=ee&&ne<=K&&!(ne%16)&&ee(m,ne);if(p(ct<=G),ie&We&&(en=ha(Ue,ie,ne)),null!=ze)for(;at<ct;)sn=y[at++],ze.X[(506832829*sn&4294967295)>>>ze.Mb]=sn}else{if(!(sn<un))break e;for(vn=sn-280,p(null!=ze);at<ct;)sn=y[at++],ze.X[(506832829*sn&4294967295)>>>ze.Mb]=sn;sn=ct,p(!(vn>>>(lr=ze).Xa)),y[sn]=lr.X[vn],vn=!0}vn||p(he.h==Te(he))}if(m.Pb&&he.h&&ct<G)p(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&Lt(m.s.vb,m.s.Wa);else{if(he.h)break e;ee?.(m,ne>K?K:ne),m.a=0,m.$=ct-I}return 1}return m.a=3,0}function rl(m){p(null!=m),m.vc=null,m.yc=null,m.Ya=null;var y=m.Wa;null!=y&&(y.X=null),m.vb=null,p(null!=m)}function Aa(){var m=new Qd;return null==m?null:(m.a=0,m.xb=Z0,Tr("Predictor","VP8LPredictors"),Tr("Predictor","VP8LPredictors_C"),Tr("PredictorAdd","VP8LPredictorsAdd"),Tr("PredictorAdd","VP8LPredictorsAdd_C"),q0=nr,ws=wr,Hc=Jn,fd=Ua,Sl=Xi,hc=rs,ch=po,Oe.VP8LMapColor32b=nf,Oe.VP8LMapColor8b=Uc,m)}function xu(m,y,I,L,G){var K=1,ee=[m],ne=[y],ie=L.m,he=L.s,Ue=null,ct=0;e:for(;;){if(I)for(;K&&Wt(ie,1);){var at=ee,Ke=ne,un=L,kt=1,ze=un.m,We=un.gc[un.ab],en=Wt(ze,2);if(un.Oc&1<<en)K=0;else{switch(un.Oc|=1<<en,We.hc=en,We.Ea=at[0],We.nc=Ke[0],We.K=[null],++un.ab,p(4>=un.ab),en){case 0:case 1:We.b=Wt(ze,3)+2,kt=xu(fr(We.Ea,We.b),fr(We.nc,We.b),0,un,We.K),We.K=We.K[0];break;case 3:var vn,sn=Wt(ze,8)+1,lr=16<sn?0:4<sn?1:2<sn?2:3;if(at[0]=fr(We.Ea,lr),We.b=lr,vn=kt=xu(sn,1,0,un,We.K)){var $n,Nr=sn,qn=We,Ki=1<<(8>>qn.b),Zi=x(Ki);if(null==Zi)vn=0;else{var Ni=qn.K[0],gi=qn.w;for(Zi[0]=qn.K[0][0],$n=1;$n<1*Nr;++$n)Zi[$n]=B(Ni[gi+$n],Zi[$n-1]);for(;$n<4*Ki;++$n)Zi[$n]=0;qn.K[0]=null,qn.K[0]=Zi,vn=1}}kt=vn;break;case 2:break;default:p(0)}K=kt}}if(ee=ee[0],ne=ne[0],K&&Wt(ie,1)&&!(K=1<=(ct=Wt(ie,4))&&11>=ct)){L.a=3;break e}var Do;if(Do=K)t:{var mo,_i,Ma,Bs=L,ka=ee,ol=ne,Qi=ct,al=I,Al=Bs.m,$a=Bs.s,os=[null],va=1,wc=0,ku=Dl[Qi];n:for(;;){if(al&&Wt(Al,1)){var as=Wt(Al,3)+2,pd=fr(ka,as),dh=fr(ol,as),ss=pd*dh;if(!xu(pd,dh,0,Bs,os))break n;for(os=os[0],$a.xc=as,mo=0;mo<ss;++mo){var xs=os[mo]>>8&65535;os[mo]=xs,xs>=va&&(va=xs+1)}}if(Al.h)break n;for(_i=0;5>_i;++_i){var ma=y2[_i];!_i&&0<Qi&&(ma+=1<<Qi),wc<ma&&(wc=ma)}var q_=M(va*ku,de),F2=va,I2=M(F2,Ne);if(null==I2)var n1=null;else p(65536>=F2),n1=I2;var fg=x(wc);if(null==n1||null==fg||null==q_){Bs.a=1;break n}var hg=q_;for(mo=Ma=0;mo<va;++mo){var Wc=n1[mo],Op=Wc.G,Np=Wc.H,P2=0,fh=1,Fu=0;for(_i=0;5>_i;++_i){ma=y2[_i],Op[_i]=hg,Np[_i]=Ma,!_i&&0<Qi&&(ma+=1<<Qi);i:{var cf,r1=ma,pg=Bs,Rp=fg,jA=hg,VA=Ma,O2=0,Iu=pg.m,G_=Wt(Iu,1);if(S(Rp,0,0,r1),G_){var UA=Wt(Iu,1)+1,HA=Wt(Iu,1),Y_=Wt(Iu,0==HA?1:8);Rp[Y_]=1,2==UA&&(Rp[Y_=Wt(Iu,8)]=1);var o1=1}else{var N2=x(19),R2=Wt(Iu,4)+4;if(19<R2){pg.a=3;var a1=0;break i}for(cf=0;cf<R2;++cf)N2[Kx[cf]]=Wt(Iu,3);var s1=void 0,uf=void 0,X_=pg,K_=N2,l1=r1,Ji=Rp,Z_=0,df=X_.m,Q_=8,J_=M(128,de);r:for(;fe(J_,0,7,K_,19);){if(Wt(df,1)){var sC=2+2*Wt(df,3);if((s1=2+Wt(df,sC))>l1)break r}else s1=l1;for(uf=0;uf<l1&&s1--;){Xe(df);var L2=J_[0+(127&we(df))];$e(df,df.u+L2.g);var Lp=L2.value;if(16>Lp)Ji[uf++]=Lp,0!=Lp&&(Q_=Lp);else{var lC=16==Lp,ev=Lp-16,zA=Xx[ev],cC=Wt(df,Yx[ev])+zA;if(uf+cC>l1)break r;for(var mg=lC?Q_:0;0<cC--;)Ji[uf++]=mg}}Z_=1;break r}Z_||(X_.a=3),o1=Z_}(o1=o1&&!Iu.h)&&(O2=fe(jA,VA,8,Rp,r1)),o1&&0!=O2?a1=O2:(pg.a=3,a1=0)}if(0==a1)break n;if(fh&&1==w2[_i]&&(fh=0==hg[Ma].g),P2+=hg[Ma].g,Ma+=a1,3>=_i){var ff,c1=fg[0];for(ff=1;ff<ma;++ff)fg[ff]>c1&&(c1=fg[ff]);Fu+=c1}}if(Wc.nd=fh,Wc.Qb=0,fh&&(Wc.qb=(Op[3][Np[3]+0].value<<24|Op[1][Np[1]+0].value<<16|Op[2][Np[2]+0].value)>>>0,0==P2&&256>Op[0][Np[0]+0].value&&(Wc.Qb=1,Wc.qb+=Op[0][Np[0]+0].value<<8)),Wc.jc=!Wc.Qb&&6>Fu,Wc.jc){var gg,Pu=Wc;for(gg=0;gg<za;++gg){var hf=gg,pf=Pu.pd[hf],_g=Pu.G[0][Pu.H[0]+hf];256<=_g.value?(pf.g=_g.g+256,pf.value=_g.value):(pf.g=0,pf.value=0,hf>>=_a(_g,8,pf),hf>>=_a(Pu.G[1][Pu.H[1]+hf],16,pf),hf>>=_a(Pu.G[2][Pu.H[2]+hf],0,pf),_a(Pu.G[3][Pu.H[3]+hf],24,pf))}}}$a.vc=os,$a.Wb=va,$a.Ya=n1,$a.yc=q_,Do=1;break t}Do=0}if(!(K=Do)){L.a=3;break e}if(0<ct){if(he.ua=1<<ct,!jr(he.Wa,ct)){L.a=1,K=0;break e}}else he.ua=0;var u1=L,d1=ee,$A=ne,vg=u1.s,tv=vg.xc;if(u1.c=d1,u1.i=$A,vg.md=fr(d1,tv),vg.wc=0==tv?-1:(1<<tv)-1,I){L.xb=eC;break e}if(null==(Ue=x(ee*ne))){L.a=1,K=0;break e}K=(K=dc(L,Ue,0,ee,ne,ne,null))&&!ie.h;break e}return K?(null!=G?G[0]=Ue:(p(null==Ue),p(I)),L.$=0,I||rl(he)):rl(he),K}function $d(m,y){var I=m.c*m.i,L=I+y+16*y;return p(m.c<=y),m.V=x(L),null==m.V?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+I+y,1)}function lp(m,y){var I=m.C,L=y-I,G=m.V,K=m.Ba+m.c*I;for(p(y<=m.l.o);0<L;){var ee=16<L?16:L,ne=m.l.ma,ie=m.l.width,he=ie*ee,Ue=ne.ca,ct=ne.tb+ie*I,at=m.Ta,Ke=m.Ua;Gl(m,ee,G,K),Y0(at,Ke,Ue,ct,he),Ho(ne,I,I+ee,Ue,ct,ie),L-=ee,G+=ee*m.c,I+=ee}p(I==y),m.C=m.Ma=y}function cp(){this.ub=this.yd=this.td=this.Rb=0}function Wd(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function qd(){this.Fb=this.Bb=this.Cb=0,this.Zb=x(4),this.Lb=x(4)}function jm(){var m;this.Yb=(function y(I,L,G){for(var K=G[L],ee=0;ee<K&&(I.push(G.length>L+1?[]:0),!(G.length<L+1));ee++)y(I[ee],L+1,G)}(m=[],0,[3,11]),m)}function Vm(){this.jb=x(3),this.Wc=P([4,8],jm),this.Xc=P([4,17],jm)}function F_(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new x(4),this.od=new x(4)}function Zf(){this.ld=this.La=this.dd=this.tc=0}function up(){this.Na=this.la=0}function P0(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function dp(){this.ad=x(384),this.Za=0,this.Ob=x(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function O0(){this.uc=this.M=this.Nb=0,this.wa=Array(new Zf),this.Y=0,this.ya=Array(new dp),this.aa=0,this.l=new fp}function Um(){this.y=x(16),this.f=x(8),this.ea=x(8)}function Hm(){this.cb=this.a=0,this.sc="",this.m=new Yn,this.Od=new cp,this.Kc=new Wd,this.ed=new F_,this.Qa=new qd,this.Ic=this.$c=this.Aa=0,this.D=new O0,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=M(8,Yn),this.ia=0,this.pb=M(4,P0),this.Pa=new Vm,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Um),this.Hd=0,this.rb=Array(new up),this.sb=0,this.wa=Array(new Zf),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new dp),this.L=this.aa=0,this.gd=P([4,2],Zf),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function fp(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function I_(){var m=new Hm;return null!=m&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,Ta||(Ta=Ns)),m}function Oi(m,y,I){return 0==m.a&&(m.a=y,m.sc=I,m.cb=0),0}function Cu(m,y,I){return 3<=I&&157==m[y+0]&&1==m[y+1]&&42==m[y+2]}function Po(m,y){if(null==m)return 0;if(m.a=0,m.sc="OK",null==y)return Oi(m,2,"null VP8Io passed to VP8GetHeaders()");var I=y.data,L=y.w,G=y.ha;if(4>G)return Oi(m,7,"Truncated header.");var K=I[L+0]|I[L+1]<<8|I[L+2]<<16,ee=m.Od;if(ee.Rb=!(1&K),ee.td=K>>1&7,ee.yd=K>>4&1,ee.ub=K>>5,3<ee.td)return Oi(m,3,"Incorrect keyframe parameters.");if(!ee.yd)return Oi(m,4,"Frame not displayable.");L+=3,G-=3;var ne=m.Kc;if(ee.Rb){if(7>G)return Oi(m,7,"cannot parse picture header");if(!Cu(I,L,G))return Oi(m,3,"Bad code word");ne.c=16383&(I[L+4]<<8|I[L+3]),ne.Td=I[L+4]>>6,ne.i=16383&(I[L+6]<<8|I[L+5]),ne.Ud=I[L+6]>>6,L+=7,G-=7,m.za=ne.c+15>>4,m.Ub=ne.i+15>>4,y.width=ne.c,y.height=ne.i,y.Da=0,y.j=0,y.v=0,y.va=y.width,y.o=y.height,y.da=0,y.ib=y.width,y.hb=y.height,y.U=y.width,y.T=y.height,S((K=m.Pa).jb,0,255,K.jb.length),p(null!=(K=m.Qa)),K.Cb=0,K.Bb=0,K.Fb=1,S(K.Zb,0,0,K.Zb.length),S(K.Lb,0,0,K.Lb)}if(ee.ub>G)return Oi(m,7,"bad partition length");Tt(K=m.m,I,L,ee.ub),L+=ee.ub,G-=ee.ub,ee.Rb&&(ne.Ld=ot(K),ne.Kd=ot(K)),ne=m.Qa;var ie,he=m.Pa;if(p(null!=K),p(null!=ne),ne.Cb=ot(K),ne.Cb){if(ne.Bb=ot(K),ot(K)){for(ne.Fb=ot(K),ie=0;4>ie;++ie)ne.Zb[ie]=ot(K)?zt(K,7):0;for(ie=0;4>ie;++ie)ne.Lb[ie]=ot(K)?zt(K,6):0}if(ne.Bb)for(ie=0;3>ie;++ie)he.jb[ie]=ot(K)?St(K,8):255}else ne.Bb=0;if(K.Ka)return Oi(m,3,"cannot parse segment header");if((ne=m.ed).zd=ot(K),ne.Tb=St(K,6),ne.wb=St(K,3),ne.Pc=ot(K),ne.Pc&&ot(K)){for(he=0;4>he;++he)ot(K)&&(ne.vd[he]=zt(K,6));for(he=0;4>he;++he)ot(K)&&(ne.od[he]=zt(K,6))}if(m.L=0==ne.Tb?0:ne.zd?1:2,K.Ka)return Oi(m,3,"cannot parse filter header");var Ue=G;if(G=ie=L,L=ie+Ue,ne=Ue,m.Xb=(1<<St(m.m,2))-1,Ue<3*(he=m.Xb))I=7;else{for(ie+=3*he,ne-=3*he,Ue=0;Ue<he;++Ue){var ct=I[G+0]|I[G+1]<<8|I[G+2]<<16;ct>ne&&(ct=ne),Tt(m.Jc[+Ue],I,ie,ct),ie+=ct,ne-=ct,G+=3}Tt(m.Jc[+he],I,ie,ne),I=ie<L?0:5}if(0!=I)return Oi(m,I,"cannot parse partitions");for(I=St(ie=m.m,7),G=ot(ie)?zt(ie,4):0,L=ot(ie)?zt(ie,4):0,ne=ot(ie)?zt(ie,4):0,he=ot(ie)?zt(ie,4):0,ie=ot(ie)?zt(ie,4):0,Ue=m.Qa,ct=0;4>ct;++ct){if(Ue.Cb){var at=Ue.Zb[ct];Ue.Fb||(at+=I)}else{if(0<ct){m.pb[ct]=m.pb[0];continue}at=I}var Ke=m.pb[ct];Ke.Sc[0]=K0[Cl(at+G,127)],Ke.Sc[1]=ag[Cl(at+0,127)],Ke.Eb[0]=2*K0[Cl(at+L,127)],Ke.Eb[1]=101581*ag[Cl(at+ne,127)]>>16,8>Ke.Eb[1]&&(Ke.Eb[1]=8),Ke.Qc[0]=K0[Cl(at+he,117)],Ke.Qc[1]=ag[Cl(at+ie,127)],Ke.lc=at+ie}if(!ee.Rb)return Oi(m,4,"Not a key frame.");for(ot(K),ee=m.Pa,I=0;4>I;++I){for(G=0;8>G;++G)for(L=0;3>L;++L)for(ne=0;11>ne;++ne)he=bt(K,Jx[I][G][L][ne])?St(K,8):Qx[I][G][L][ne],ee.Wc[I][G].Yb[L][ne]=he;for(G=0;17>G;++G)ee.Xc[I][G]=ee.Wc[I][E2[G]]}return m.kc=ot(K),m.kc&&(m.Bd=St(K,8)),m.cb=1}function Ns(m,y,I,L,G,K,ee){var ne=y[G].Yb[I];for(I=0;16>G;++G){if(!bt(m,ne[I+0]))return G;for(;!bt(m,ne[I+1]);)if(ne=y[++G].Yb[0],I=0,16==G)return 16;var ie=y[G+1].Yb;if(bt(m,ne[I+2])){var he=m,Ue=0;if(bt(he,(at=ne)[(ct=I)+3]))if(bt(he,at[ct+6])){for(ne=0,ct=2*(Ue=bt(he,at[ct+8]))+(at=bt(he,at[ct+9+Ue])),Ue=0,at=sg[ct];at[ne];++ne)Ue+=Ue+bt(he,at[ne]);Ue+=3+(8<<ct)}else bt(he,at[ct+7])?(Ue=7+2*bt(he,165),Ue+=bt(he,145)):Ue=5+bt(he,159);else Ue=bt(he,at[ct+4])?3+bt(he,at[ct+5]):2;ne=ie[2]}else Ue=1,ne=ie[1];ie=ee+x2[G],0>(he=m).b&&ft(he);var ct,at=he.b,Ke=(ct=he.Ca>>1)-(he.I>>at)>>31;--he.b,he.Ca+=Ke,he.Ca|=1,he.I-=(ct+1&Ke)<<at,K[ie]=((Ue^Ke)-Ke)*L[(0<G)+0]}return 16}function zm(m){var y=m.rb[m.sb-1];y.la=0,y.Na=0,S(m.zc,0,0,m.zc.length),m.ja=0}function Rc(m,y,I,L,G){m[y+I+32*L]=-256&(G=m[y+I+32*L]+(G>>3))?0>G?0:255:G}function hp(m,y,I,L,G,K){Rc(m,y,0,I,L+G),Rc(m,y,1,I,L+K),Rc(m,y,2,I,L-K),Rc(m,y,3,I,L-G)}function wl(m){return(20091*m>>16)+m}function Gd(m,y,I,L){var G,K=0,ee=x(16);for(G=0;4>G;++G){var ne=m[y+0]+m[y+8],ie=m[y+0]-m[y+8],he=(35468*m[y+4]>>16)-wl(m[y+12]),Ue=wl(m[y+4])+(35468*m[y+12]>>16);ee[K+0]=ne+Ue,ee[K+1]=ie+he,ee[K+2]=ie-he,ee[K+3]=ne-Ue,K+=4,y++}for(G=K=0;4>G;++G)ne=(m=ee[K+0]+4)+ee[K+8],ie=m-ee[K+8],he=(35468*ee[K+4]>>16)-wl(ee[K+12]),Rc(I,L,0,0,ne+(Ue=wl(ee[K+4])+(35468*ee[K+12]>>16))),Rc(I,L,1,0,ie+he),Rc(I,L,2,0,ie-he),Rc(I,L,3,0,ne-Ue),K++,L+=32}function Qf(m,y,I,L){var G=m[y+0]+4,K=35468*m[y+4]>>16,ee=wl(m[y+4]),ne=35468*m[y+1]>>16;hp(I,L,0,G+ee,m=wl(m[y+1]),ne),hp(I,L,1,G+K,m,ne),hp(I,L,2,G-K,m,ne),hp(I,L,3,G-ee,m,ne)}function pp(m,y,I,L,G){Gd(m,y,I,L),G&&Gd(m,y+16,I,L+4)}function mp(m,y,I,L){Ap(m,y+0,I,L,1),Ap(m,y+32,I,L+128,1)}function N0(m,y,I,L){var G;for(m=m[y+0]+4,G=0;4>G;++G)for(y=0;4>y;++y)Rc(I,L,y,G,m)}function R0(m,y,I,L){m[y+0]&&$c(m,y+0,I,L),m[y+16]&&$c(m,y+16,I,L+4),m[y+32]&&$c(m,y+32,I,L+128),m[y+48]&&$c(m,y+48,I,L+128+4)}function Yd(m,y,I,L){var G,K=x(16);for(G=0;4>G;++G){var ee=m[y+0+G]+m[y+12+G],ne=m[y+4+G]+m[y+8+G],ie=m[y+4+G]-m[y+8+G],he=m[y+0+G]-m[y+12+G];K[0+G]=ee+ne,K[8+G]=ee-ne,K[4+G]=he+ie,K[12+G]=he-ie}for(G=0;4>G;++G)ee=(m=K[0+4*G]+3)+K[3+4*G],ie=K[1+4*G]-K[2+4*G],he=m-K[3+4*G],I[L+0]=ee+(ne=K[1+4*G]+K[2+4*G])>>3,I[L+16]=he+ie>>3,I[L+32]=ee-ne>>3,I[L+48]=he-ie>>3,L+=64}function sd(m,y,I){var L,G=y-32,K=_c,ee=255-m[G-1];for(L=0;L<I;++L){var ne,ie=K,he=ee+m[y-1];for(ne=0;ne<I;++ne)m[y+ne]=ie[he+m[G+ne]];y+=32}}function P_(m,y){sd(m,y,4)}function g2(m,y){sd(m,y,8)}function $m(m,y){sd(m,y,16)}function Xd(m,y){var I;for(I=0;16>I;++I)b(m,y+32*I,m,y-32,16)}function gp(m,y){var I;for(I=16;0<I;--I)S(m,y,m[y-1],16),y+=32}function _p(m,y,I){var L;for(L=0;16>L;++L)S(y,I+32*L,m,16)}function O_(m,y){var I,L=16;for(I=0;16>I;++I)L+=m[y-1+32*I]+m[y+I-32];_p(L>>5,m,y)}function il(m,y){var I,L=8;for(I=0;16>I;++I)L+=m[y-1+32*I];_p(L>>4,m,y)}function Wm(m,y){var I,L=8;for(I=0;16>I;++I)L+=m[y+I-32];_p(L>>4,m,y)}function qm(m,y){_p(128,m,y)}function ni(m,y,I){return m+2*y+I+2>>2}function Jf(m,y){var I,L=y-32;for(L=new Uint8Array([ni(m[L-1],m[L+0],m[L+1]),ni(m[L+0],m[L+1],m[L+2]),ni(m[L+1],m[L+2],m[L+3]),ni(m[L+2],m[L+3],m[L+4])]),I=0;4>I;++I)b(m,y+32*I,L,0,L.length)}function L0(m,y){var I=m[y-1],L=m[y-1+32],G=m[y-1+64],K=m[y-1+96];Rn(m,y+0,16843009*ni(m[y-1-32],I,L)),Rn(m,y+32,16843009*ni(I,L,G)),Rn(m,y+64,16843009*ni(L,G,K)),Rn(m,y+96,16843009*ni(G,K,K))}function Lc(m,y){var I,L=4;for(I=0;4>I;++I)L+=m[y+I-32]+m[y-1+32*I];for(L>>=3,I=0;4>I;++I)S(m,y+32*I,L,4)}function eh(m,y){var I=m[y-1+0],L=m[y-1+32],G=m[y-1+64],K=m[y-1-32],ee=m[y+0-32],ne=m[y+1-32],ie=m[y+2-32],he=m[y+3-32];m[y+0+96]=ni(L,G,m[y-1+96]),m[y+1+96]=m[y+0+64]=ni(I,L,G),m[y+2+96]=m[y+1+64]=m[y+0+32]=ni(K,I,L),m[y+3+96]=m[y+2+64]=m[y+1+32]=m[y+0+0]=ni(ee,K,I),m[y+3+64]=m[y+2+32]=m[y+1+0]=ni(ne,ee,K),m[y+3+32]=m[y+2+0]=ni(ie,ne,ee),m[y+3+0]=ni(he,ie,ne)}function B0(m,y){var I=m[y+1-32],L=m[y+2-32],G=m[y+3-32],K=m[y+4-32],ee=m[y+5-32],ne=m[y+6-32],ie=m[y+7-32];m[y+0+0]=ni(m[y+0-32],I,L),m[y+1+0]=m[y+0+32]=ni(I,L,G),m[y+2+0]=m[y+1+32]=m[y+0+64]=ni(L,G,K),m[y+3+0]=m[y+2+32]=m[y+1+64]=m[y+0+96]=ni(G,K,ee),m[y+3+32]=m[y+2+64]=m[y+1+96]=ni(K,ee,ne),m[y+3+64]=m[y+2+96]=ni(ee,ne,ie),m[y+3+96]=ni(ne,ie,ie)}function ld(m,y){var I=m[y-1+0],L=m[y-1+32],G=m[y-1+64],K=m[y-1-32],ee=m[y+0-32],ne=m[y+1-32],ie=m[y+2-32],he=m[y+3-32];m[y+0+0]=m[y+1+64]=K+ee+1>>1,m[y+1+0]=m[y+2+64]=ee+ne+1>>1,m[y+2+0]=m[y+3+64]=ne+ie+1>>1,m[y+3+0]=ie+he+1>>1,m[y+0+96]=ni(G,L,I),m[y+0+64]=ni(L,I,K),m[y+0+32]=m[y+1+96]=ni(I,K,ee),m[y+1+32]=m[y+2+96]=ni(K,ee,ne),m[y+2+32]=m[y+3+96]=ni(ee,ne,ie),m[y+3+32]=ni(ne,ie,he)}function th(m,y){var I=m[y+0-32],L=m[y+1-32],G=m[y+2-32],K=m[y+3-32],ee=m[y+4-32],ne=m[y+5-32],ie=m[y+6-32],he=m[y+7-32];m[y+0+0]=I+L+1>>1,m[y+1+0]=m[y+0+64]=L+G+1>>1,m[y+2+0]=m[y+1+64]=G+K+1>>1,m[y+3+0]=m[y+2+64]=K+ee+1>>1,m[y+0+32]=ni(I,L,G),m[y+1+32]=m[y+0+96]=ni(L,G,K),m[y+2+32]=m[y+1+96]=ni(G,K,ee),m[y+3+32]=m[y+2+96]=ni(K,ee,ne),m[y+3+64]=ni(ee,ne,ie),m[y+3+96]=ni(ne,ie,he)}function vp(m,y){var I=m[y-1+0],L=m[y-1+32],G=m[y-1+64],K=m[y-1+96];m[y+0+0]=I+L+1>>1,m[y+2+0]=m[y+0+32]=L+G+1>>1,m[y+2+32]=m[y+0+64]=G+K+1>>1,m[y+1+0]=ni(I,L,G),m[y+3+0]=m[y+1+32]=ni(L,G,K),m[y+3+32]=m[y+1+64]=ni(G,K,K),m[y+3+64]=m[y+2+64]=m[y+0+96]=m[y+1+96]=m[y+2+96]=m[y+3+96]=K}function _2(m,y){var I=m[y-1+0],L=m[y-1+32],G=m[y-1+64],K=m[y-1+96],ee=m[y-1-32],ne=m[y+0-32],ie=m[y+1-32],he=m[y+2-32];m[y+0+0]=m[y+2+32]=I+ee+1>>1,m[y+0+32]=m[y+2+64]=L+I+1>>1,m[y+0+64]=m[y+2+96]=G+L+1>>1,m[y+0+96]=K+G+1>>1,m[y+3+0]=ni(ne,ie,he),m[y+2+0]=ni(ee,ne,ie),m[y+1+0]=m[y+3+32]=ni(I,ee,ne),m[y+1+32]=m[y+3+64]=ni(L,I,ee),m[y+1+64]=m[y+3+96]=ni(G,L,I),m[y+1+96]=ni(K,G,L)}function j0(m,y){var I;for(I=0;8>I;++I)b(m,y+32*I,m,y-32,8)}function bp(m,y){var I;for(I=0;8>I;++I)S(m,y,m[y-1],8),y+=32}function nh(m,y,I){var L;for(L=0;8>L;++L)S(y,I+32*L,m,8)}function vs(m,y){var I,L=8;for(I=0;8>I;++I)L+=m[y+I-32]+m[y-1+32*I];nh(L>>4,m,y)}function N_(m,y){var I,L=4;for(I=0;8>I;++I)L+=m[y+I-32];nh(L>>3,m,y)}function Su(m,y){var I,L=4;for(I=0;8>I;++I)L+=m[y-1+32*I];nh(L>>3,m,y)}function rh(m,y){nh(128,m,y)}function ih(m,y,I){var L=m[y-I],G=m[y+0],K=3*(G-L)+v2[1020+m[y-2*I]-m[y+I]],ee=L_[112+(K+4>>3)];m[y-I]=_c[255+L+L_[112+(K+3>>3)]],m[y+0]=_c[255+G-ee]}function yp(m,y,I,L){return vc[255+m[y-2*I]-m[y-I]]>L||vc[255+m[y+I]-m[y+0]]>L}function wp(m,y,I,L){return 4*vc[255+m[y-I]-m[y+0]]+vc[255+m[y-2*I]-m[y+I]]<=L}function V0(m,y,I,L,G){var K=m[y-3*I],ee=m[y-2*I],ne=m[y-I],ie=m[y+0],he=m[y+I],Ue=m[y+2*I];return 4*vc[255+ne-ie]+vc[255+ee-he]>L?0:vc[255+m[y-4*I]-K]<=G&&vc[255+K-ee]<=G&&vc[255+ee-ne]<=G&&vc[255+m[y+3*I]-Ue]<=G&&vc[255+Ue-he]<=G&&vc[255+he-ie]<=G}function Gm(m,y,I,L){var G=2*L+1;for(L=0;16>L;++L)wp(m,y+L,I,G)&&ih(m,y+L,I)}function Du(m,y,I,L){var G=2*L+1;for(L=0;16>L;++L)wp(m,y+L*I,1,G)&&ih(m,y+L*I,1)}function cd(m,y,I,L){var G;for(G=3;0<G;--G)Gm(m,y+=4*I,I,L)}function U0(m,y,I,L){var G;for(G=3;0<G;--G)Du(m,y+=4,I,L)}function Kd(m,y,I,L,G,K,ee,ne){for(K=2*K+1;0<G--;){if(V0(m,y,I,K,ee))if(yp(m,y,I,ne))ih(m,y,I);else{var ie=m,he=y,Ue=I,ct=ie[he-2*Ue],at=ie[he-Ue],Ke=ie[he+0],un=ie[he+Ue],kt=ie[he+2*Ue],ze=27*(en=v2[1020+3*(Ke-at)+v2[1020+ct-un]])+63>>7,We=18*en+63>>7,en=9*en+63>>7;ie[he-3*Ue]=_c[255+ie[he-3*Ue]+en],ie[he-2*Ue]=_c[255+ct+We],ie[he-Ue]=_c[255+at+ze],ie[he+0]=_c[255+Ke-ze],ie[he+Ue]=_c[255+un-We],ie[he+2*Ue]=_c[255+kt-en]}y+=L}}function xl(m,y,I,L,G,K,ee,ne){for(K=2*K+1;0<G--;){if(V0(m,y,I,K,ee))if(yp(m,y,I,ne))ih(m,y,I);else{var ie=m,he=y,Ue=I,ct=ie[he-Ue],at=ie[he+0],Ke=ie[he+Ue],un=L_[112+(4+(kt=3*(at-ct))>>3)],kt=L_[112+(kt+3>>3)],ze=un+1>>1;ie[he-2*Ue]=_c[255+ie[he-2*Ue]+ze],ie[he-Ue]=_c[255+ct+kt],ie[he+0]=_c[255+at-un],ie[he+Ue]=_c[255+Ke-ze]}y+=L}}function Bc(m,y,I,L,G,K){Kd(m,y,I,1,16,L,G,K)}function oh(m,y,I,L,G,K){Kd(m,y,1,I,16,L,G,K)}function H0(m,y,I,L,G,K){var ee;for(ee=3;0<ee;--ee)xl(m,y+=4*I,I,1,16,L,G,K)}function ah(m,y,I,L,G,K){var ee;for(ee=3;0<ee;--ee)xl(m,y+=4,1,I,16,L,G,K)}function Zd(m,y,I,L,G,K,ee,ne){Kd(m,y,G,1,8,K,ee,ne),Kd(I,L,G,1,8,K,ee,ne)}function Ym(m,y,I,L,G,K,ee,ne){Kd(m,y,1,G,8,K,ee,ne),Kd(I,L,1,G,8,K,ee,ne)}function co(m,y,I,L,G,K,ee,ne){xl(m,y+4*G,G,1,8,K,ee,ne),xl(I,L+4*G,G,1,8,K,ee,ne)}function xp(m,y,I,L,G,K,ee,ne){xl(m,y+4,1,G,8,K,ee,ne),xl(I,L+4,1,G,8,K,ee,ne)}function Cp(){this.ba=new Nc,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ta,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ep(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function jc(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ud(){this.ua=0,this.Wa=new Me,this.vb=new Me,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Ne,this.yc=new de}function Qd(){this.xb=this.a=0,this.l=new fp,this.ca=new Nc,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new J,this.Pb=0,this.wd=new J,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ud,this.ab=0,this.gc=M(4,jc),this.Oc=0}function Vc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new fp,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Jd(m,y,I,L,G,K,ee){for(m=null==m?0:m[y+0],y=0;y<ee;++y)G[K+y]=m+I[L+y]&255,m=G[K+y]}function sh(m,y,I,L,G,K,ee){var ne;if(null==m)Jd(null,null,I,L,G,K,ee);else for(ne=0;ne<ee;++ne)G[K+ne]=m[y+ne]+I[L+ne]&255}function Yl(m,y,I,L,G,K,ee){if(null==m)Jd(null,null,I,L,G,K,ee);else{var ne,ie=m[y+0],he=ie,Ue=ie;for(ne=0;ne<ee;++ne)he=Ue+(ie=m[y+ne])-he,Ue=I[L+ne]+(-256&he?0>he?0:255:he)&255,he=ie,G[K+ne]=Ue}}function z0(m,y,I,L){var G=y.width,K=y.o;if(p(null!=m&&null!=y),0>I||0>=L||I+L>K)return null;if(!m.Cc){if(null==m.ga){var ee;if(m.ga=new Vc,(ee=null==m.ga)||(ee=y.width*y.o,p(0==m.Gb.length),m.Gb=x(ee),m.Uc=0,null==m.Gb?ee=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,ee=1),ee=!ee),!ee){var ne=m.Fa,ie=m.P,he=m.qc,Ue=m.mb,ct=m.nb,at=ie+1,Ke=he-1,un=(ee=m.ga).l;if(p(null!=ne&&null!=Ue&&null!=y),Mu[0]=null,Mu[1]=Jd,Mu[2]=sh,Mu[3]=Yl,ee.ca=Ue,ee.tb=ct,ee.c=y.width,ee.i=y.height,p(0<ee.c&&0<ee.i),1>=he)y=0;else if(ee.$a=ne[ie+0]>>0&3,ee.Z=ne[ie+0]>>2&3,ee.Lc=ne[ie+0]>>4&3,ie=ne[ie+0]>>6&3,0>ee.$a||1<ee.$a||4<=ee.Z||1<ee.Lc||ie)y=0;else if(un.put=ht,un.ac=zr,un.bc=pt,un.ma=ee,un.width=y.width,un.height=y.height,un.Da=y.Da,un.v=y.v,un.va=y.va,un.j=y.j,un.o=y.o,ee.$a)e:{p(1==ee.$a),y=Aa();t:for(;;){if(null==y){y=0;break e}if(p(null!=ee),ee.mc=y,y.c=ee.c,y.i=ee.i,y.l=ee.l,y.l.ma=ee,y.l.width=ee.c,y.l.height=ee.i,y.a=0,gt(y.m,ne,at,Ke),!xu(ee.c,ee.i,1,y,null)||(1==y.ab&&3==y.gc[0].hc&&wu(y.s)?(ee.ic=1,ne=y.c*y.i,y.Ta=null,y.Ua=0,y.V=x(ne),y.Ba=0,null==y.V?(y.a=1,y=0):y=1):(ee.ic=0,y=$d(y,ee.c)),!y))break t;y=1;break e}ee.mc=null,y=0}else y=Ke>=ee.c*ee.i;ee=!y}if(ee)return null;1!=m.ga.Lc?m.Ga=0:L=K-I}p(null!=m.ga),p(I+L<=K);e:{if(y=(ne=m.ga).c,K=ne.l.o,0==ne.$a){if(at=m.rc,Ke=m.Vc,un=m.Fa,he=m.mb,Ue=m.nb+I*y,p((ie=m.P+1+I*y)<=m.P+m.qc),0!=ne.Z)for(p(null!=Mu[ne.Z]),ee=0;ee<L;++ee)Mu[ne.Z](at,Ke,un,ie,he,Ue,y),at=he,Ke=Ue,Ue+=y,ie+=y;else for(ee=0;ee<L;++ee)b(he,Ue,un,ie,y),at=he,Ke=Ue,Ue+=y,ie+=y;m.rc=at,m.Vc=Ke}else{if(p(null!=ne.mc),y=I+L,p(null!=(ee=ne.mc)),p(y<=ee.i),ee.C>=y)y=1;else if(ne.ic||rt(),ne.ic){ne=ee.V,at=ee.Ba;var kt=ee.i,ze=(un=1,ie=ee.$/(Ke=ee.c),he=ee.$%Ke,Ue=ee.m,ct=ee.s,ee.$),We=Ke*kt,en=Ke*y,vn=ct.wc,sn=ze<en?ha(ct,he,ie):null;p(ze<=We),p(y<=kt),p(wu(ct));t:for(;;){for(;!Ue.h&&ze<en;){if(he&vn||(sn=ha(ct,he,ie)),p(null!=sn),Xe(Ue),256>(kt=na(sn.G[0],sn.H[0],Ue)))ne[at+ze]=kt,++ze,++he>=Ke&&(he=0,++ie<=y&&!(ie%16)&&Ha(ee,ie));else{if(!(280>kt)){un=0;break t}kt=uc(kt-256,Ue);var lr,$n=na(sn.G[4],sn.H[4],Ue);if(Xe(Ue),!(ze>=($n=yl(Ke,$n=uc($n,Ue)))&&We-ze>=kt)){un=0;break t}for(lr=0;lr<kt;++lr)ne[at+ze+lr]=ne[at+ze+lr-$n];for(ze+=kt,he+=kt;he>=Ke;)he-=Ke,++ie<=y&&!(ie%16)&&Ha(ee,ie);ze<en&&he&vn&&(sn=ha(ct,he,ie))}p(Ue.h==Te(Ue))}Ha(ee,ie>y?y:ie);break t}!un||Ue.h&&ze<We?(un=0,ee.a=Ue.h?5:3):ee.$=ze,y=un}else y=dc(ee,ee.V,ee.Ba,ee.c,ee.i,y,lp);if(!y){L=0;break e}}I+L>=K&&(m.Cc=1),L=1}if(!L)return null;if(m.Cc&&(null!=(L=m.ga)&&(L.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+I*G}function A(m,y,I,L,G,K){for(;0<G--;){var ee,ne=m,ie=y+(I?1:0),he=m,Ue=y+(I?0:3);for(ee=0;ee<L;++ee){var ct=he[Ue+4*ee];255!=ct&&(ne[ie+4*ee+0]=ne[ie+4*ee+0]*(ct*=32897)>>23,ne[ie+4*ee+1]=ne[ie+4*ee+1]*ct>>23,ne[ie+4*ee+2]=ne[ie+4*ee+2]*ct>>23)}y+=K}}function U(m,y,I,L,G){for(;0<L--;){var K;for(K=0;K<I;++K){var ee=m[y+2*K+0],ne=15&(he=m[y+2*K+1]),ie=4369*ne,he=(240&he|he>>4)*ie>>16;m[y+2*K+0]=(240&ee|ee>>4)*ie>>16&240|(15&ee|ee<<4)*ie>>16>>4&15,m[y+2*K+1]=240&he|ne}y+=G}}function xe(m,y,I,L,G,K,ee,ne){var ie,he,Ue=255;for(he=0;he<G;++he){for(ie=0;ie<L;++ie){var ct=m[y+ie];K[ee+4*ie]=ct,Ue&=ct}y+=I,ee+=ne}return 255!=Ue}function je(m,y,I,L,G){var K;for(K=0;K<G;++K)I[L+K]=m[y+K]>>8}function rt(){uh=A,kp=U,G0=xe,Y0=je}function jt(m,y,I){Oe[m]=function(L,G,K,ee,ne,ie,he,Ue,ct,at,Ke,un,kt,ze,We,en,vn){var sn,lr=vn-1>>1,$n=ne[ie+0]|he[Ue+0]<<16,Nr=ct[at+0]|Ke[un+0]<<16;p(null!=L);var qn=3*$n+Nr+131074>>2;for(y(L[G+0],255&qn,qn>>16,kt,ze),null!=K&&y(K[ee+0],255&(qn=3*Nr+$n+131074>>2),qn>>16,We,en),sn=1;sn<=lr;++sn){var Ki=ne[ie+sn]|he[Ue+sn]<<16,Zi=ct[at+sn]|Ke[un+sn]<<16,Ni=$n+Ki+Nr+Zi+524296,gi=Ni+2*(Ki+Nr)>>3;qn=gi+$n>>1,$n=(Ni=Ni+2*($n+Zi)>>3)+Ki>>1,y(L[G+2*sn-1],255&qn,qn>>16,kt,ze+(2*sn-1)*I),y(L[G+2*sn-0],255&$n,$n>>16,kt,ze+(2*sn-0)*I),null!=K&&($n=gi+Zi>>1,y(K[ee+2*sn-1],255&(qn=Ni+Nr>>1),qn>>16,We,en+(2*sn-1)*I),y(K[ee+2*sn+0],255&$n,$n>>16,We,en+(2*sn+0)*I)),$n=Ki,Nr=Zi}1&vn||(y(L[G+vn-1],255&(qn=3*$n+Nr+131074>>2),qn>>16,kt,ze+(vn-1)*I),null!=K&&y(K[ee+vn-1],255&(qn=3*Nr+$n+131074>>2),qn>>16,We,en+(vn-1)*I))}}function xn(){yc[tg]=lg,yc[Fp]=S2,yc[B_]=tC,yc[ng]=Q0,yc[rg]=J0,yc[Ls]=z_,yc[b2]=Ip,yc[j_]=S2,yc[V_]=Q0,yc[ig]=J0,yc[og]=z_}function sr(m){return m&~nC?0>m?0:255:m>>D2}function Mr(m,y){return sr((19077*m>>8)+(26149*y>>8)-14234)}function Zr(m,y,I){return sr((19077*m>>8)-(6419*y>>8)-(13320*I>>8)+8708)}function xi(m,y){return sr((19077*m>>8)+(33050*y>>8)-17685)}function $i(m,y,I,L,G){L[G+0]=Mr(m,I),L[G+1]=Zr(m,y,I),L[G+2]=xi(m,y)}function mi(m,y,I,L,G){L[G+0]=xi(m,y),L[G+1]=Zr(m,y,I),L[G+2]=Mr(m,I)}function Go(m,y,I,L,G){var K=Zr(m,y,I);y=K<<3&224|xi(m,y)>>3,L[G+0]=248&Mr(m,I)|K>>5,L[G+1]=y}function Yo(m,y,I,L,G){var K=240&xi(m,y)|15;L[G+0]=240&Mr(m,I)|Zr(m,y,I)>>4,L[G+1]=K}function Rs(m,y,I,L,G){L[G+0]=255,$i(m,y,I,L,G+1)}function uo(m,y,I,L,G){mi(m,y,I,L,G),L[G+3]=255}function bs(m,y,I,L,G){$i(m,y,I,L,G),L[G+3]=255}function Cl(m,y){return 0>m?0:m>y?y:m}function fc(m,y,I){Oe[m]=function(L,G,K,ee,ne,ie,he,Ue,ct){for(var at=Ue+(-2&ct)*I;Ue!=at;)y(L[G+0],K[ee+0],ne[ie+0],he,Ue),y(L[G+1],K[ee+0],ne[ie+0],he,Ue+I),G+=2,++ee,++ie,Ue+=2*I;1&ct&&y(L[G+0],K[ee+0],ne[ie+0],he,Ue)}}function ef(m,y,I){return 0==I?0==m?0==y?6:5:0==y?4:0:I}function Xm(m,y,I,L,G){switch(m>>>30){case 3:Ap(y,I,L,G,0);break;case 2:Au(y,I,L,G);break;case 1:$c(y,I,L,G)}}function $0(m,y){var I,L,G=y.M,K=y.Nb,ee=m.oc,ne=m.pc+40,ie=m.oc,he=m.pc+584,Ue=m.oc,ct=m.pc+600;for(I=0;16>I;++I)ee[ne+32*I-1]=129;for(I=0;8>I;++I)ie[he+32*I-1]=129,Ue[ct+32*I-1]=129;for(0<G?ee[ne-1-32]=ie[he-1-32]=Ue[ct-1-32]=129:(S(ee,ne-32-1,127,21),S(ie,he-32-1,127,9),S(Ue,ct-32-1,127,9)),L=0;L<m.za;++L){var at=y.ya[y.aa+L];if(0<L){for(I=-1;16>I;++I)b(ee,ne+32*I-4,ee,ne+32*I+12,4);for(I=-1;8>I;++I)b(ie,he+32*I-4,ie,he+32*I+4,4),b(Ue,ct+32*I-4,Ue,ct+32*I+4,4)}var Ke=m.Gd,un=m.Hd+L,kt=at.ad,ze=at.Hc;if(0<G&&(b(ee,ne-32,Ke[un].y,0,16),b(ie,he-32,Ke[un].f,0,8),b(Ue,ct-32,Ke[un].ea,0,8)),at.Za){var We=ee,en=ne-32+16;for(0<G&&(L>=m.za-1?S(We,en,Ke[un].y[15],4):b(We,en,Ke[un+1].y,0,4)),I=0;4>I;I++)We[en+128+I]=We[en+256+I]=We[en+384+I]=We[en+0+I];for(I=0;16>I;++I,ze<<=2)bc[at.Ob[I]](We=ee,en=ne+e1[I]),Xm(ze,kt,16*+I,We,en)}else if(We=ef(L,G,at.Ob[0]),lf[We](ee,ne),0!=ze)for(I=0;16>I;++I,ze<<=2)Xm(ze,kt,16*+I,ee,ne+e1[I]);for(I=at.Gc,We=ef(L,G,at.Dd),hd[We](ie,he),hd[We](Ue,ct),ze=kt,We=ie,en=he,255&(at=I>>0)&&(170&at?pc(ze,256,We,en):rf(ze,256,We,en)),at=Ue,ze=ct,255&(I>>=8)&&(170&I?pc(kt,320,at,ze):rf(kt,320,at,ze)),G<m.Ub-1&&(b(Ke[un].y,0,ee,ne+480,16),b(Ke[un].f,0,ie,he+224,8),b(Ke[un].ea,0,Ue,ct+224,8)),Ke=m.sa,un=m.ta+16*L+16*K*m.R,kt=m.qa,at=m.ra+8*L+(I=8*K*m.B),ze=m.Ha,We=m.Ia+8*L+I,I=0;16>I;++I)b(Ke,un+I*m.R,ee,ne+32*I,16);for(I=0;8>I;++I)b(kt,at+I*m.B,ie,he+32*I,8),b(ze,We+I*m.B,Ue,ct+32*I,8)}}function Sp(m,y,I,L,G,K,ee,ne,ie){var he=[0],Ue=[0],ct=0,at=null!=ie?ie.kd:0,Ke=ie??new Ep;if(null==m||12>I)return 7;Ke.data=m,Ke.w=y,Ke.ha=I,y=[y],I=[I],Ke.gb=[Ke.gb];e:{var un=y,kt=I,ze=Ke.gb;if(p(null!=m),p(null!=kt),p(null!=ze),ze[0]=0,12<=kt[0]&&!g(m,un[0],"RIFF")){if(g(m,un[0]+8,"WEBP")){ze=3;break e}var We=tr(m,un[0]+4);if(12>We||4294967286<We){ze=3;break e}if(at&&We>kt[0]-8){ze=7;break e}ze[0]=We,un[0]+=12,kt[0]-=12}ze=0}if(0!=ze)return ze;for(We=0<Ke.gb[0],I=I[0];;){e:{var en=m;kt=y,ze=I;var vn=he,sn=Ue,lr=un=[0];if((qn=ct=[ct])[0]=0,8>ze[0])ze=7;else{if(!g(en,kt[0],"VP8X")){if(10!=tr(en,kt[0]+4)){ze=3;break e}if(18>ze[0]){ze=7;break e}var $n=tr(en,kt[0]+8),Nr=1+Xn(en,kt[0]+12);if(2147483648<=Nr*(en=1+Xn(en,kt[0]+15))){ze=3;break e}null!=lr&&(lr[0]=$n),null!=vn&&(vn[0]=Nr),null!=sn&&(sn[0]=en),kt[0]+=18,ze[0]-=18,qn[0]=1}ze=0}}if(ct=ct[0],0!=ze)return ze;if(kt=!!(2&(un=un[0])),!We&&ct)return 3;if(null!=K&&(K[0]=!!(16&un)),null!=ee&&(ee[0]=kt),null!=ne&&(ne[0]=0),ee=he[0],un=Ue[0],ct&&kt&&null==ie){ze=0;break}if(4>I){ze=7;break}if(We&&ct||!We&&!ct&&!g(m,y[0],"ALPH")){I=[I],Ke.na=[Ke.na],Ke.P=[Ke.P],Ke.Sa=[Ke.Sa];e:{ze=y,We=I;var qn=Ke.gb;vn=Ke.na,sn=Ke.P,lr=Ke.Sa,Nr=22,p(null!=($n=m)),p(null!=We),en=ze[0];var Ki=We[0];for(p(null!=vn),p(null!=lr),vn[0]=null,sn[0]=null,lr[0]=0;;){if(ze[0]=en,We[0]=Ki,8>Ki){ze=7;break e}var Zi=tr($n,en+4);if(4294967286<Zi){ze=3;break e}var Ni=8+Zi+1&-2;if(Nr+=Ni,0<qn&&Nr>qn){ze=3;break e}if(!g($n,en,"VP8 ")||!g($n,en,"VP8L")){ze=0;break e}if(Ki[0]<Ni){ze=7;break e}g($n,en,"ALPH")||(vn[0]=$n,sn[0]=en+8,lr[0]=Zi),en+=Ni,Ki-=Ni}}if(I=I[0],Ke.na=Ke.na[0],Ke.P=Ke.P[0],Ke.Sa=Ke.Sa[0],0!=ze)break}I=[I],Ke.Ja=[Ke.Ja],Ke.xa=[Ke.xa];e:if(qn=m,ze=y,We=I,vn=Ke.gb[0],sn=Ke.Ja,lr=Ke.xa,$n=ze[0],en=!g(qn,$n,"VP8 "),Nr=!g(qn,$n,"VP8L"),p(null!=qn),p(null!=We),p(null!=sn),p(null!=lr),8>We[0])ze=7;else{if(en||Nr){if(qn=tr(qn,$n+4),12<=vn&&qn>vn-12){ze=3;break e}if(at&&qn>We[0]-8){ze=7;break e}sn[0]=qn,ze[0]+=8,We[0]-=8,lr[0]=Nr}else lr[0]=5<=We[0]&&47==qn[$n+0]&&!(qn[$n+4]>>5),sn[0]=We[0];ze=0}if(I=I[0],Ke.Ja=Ke.Ja[0],Ke.xa=Ke.xa[0],y=y[0],0!=ze)break;if(4294967286<Ke.Ja)return 3;if(null==ne||kt||(ne[0]=Ke.xa?2:1),ee=[ee],un=[un],Ke.xa){if(5>I){ze=7;break}ne=ee,at=un,kt=K,null==m||5>I?m=0:5<=I&&47==m[y+0]&&!(m[y+4]>>5)?(We=[0],qn=[0],vn=[0],gt(sn=new J,m,y,I),mr(sn,We,qn,vn)?(null!=ne&&(ne[0]=We[0]),null!=at&&(at[0]=qn[0]),null!=kt&&(kt[0]=vn[0]),m=1):m=0):m=0}else{if(10>I){ze=7;break}ne=un,null==m||10>I||!Cu(m,y+3,I-3)?m=0:(at=m[y+0]|m[y+1]<<8|m[y+2]<<16,kt=16383&(m[y+7]<<8|m[y+6]),m=16383&(m[y+9]<<8|m[y+8]),1&at||3<(at>>1&7)||!(at>>4&1)||at>>5>=Ke.Ja||!kt||!m?m=0:(ee&&(ee[0]=kt),ne&&(ne[0]=m),m=1))}if(!m||(ee=ee[0],un=un[0],ct&&(he[0]!=ee||Ue[0]!=un)))return 3;null!=ie&&(ie[0]=Ke,ie.offset=y-ie.w,p(4294967286>y-ie.w),p(ie.offset==ie.ha-I));break}return 0==ze||7==ze&&ct&&null==ie?(null!=K&&(K[0]|=null!=Ke.na&&0<Ke.na.length),null!=L&&(L[0]=ee),null!=G&&(G[0]=un),0):ze}function W0(m,y,I){var L=y.width,G=y.height,K=0,ee=0,ne=L,ie=G;if(y.Da=null!=m&&0<m.Da,y.Da&&(ne=m.cd,ie=m.bd,K=m.v,ee=m.j,11>I||(K&=-2,ee&=-2),0>K||0>ee||0>=ne||0>=ie||K+ne>L||ee+ie>G))return 0;if(y.v=K,y.j=ee,y.va=K+ne,y.o=ee+ie,y.U=ne,y.T=ie,y.da=null!=m&&0<m.da,y.da){if(!ti(ne,ie,I=[m.ib],K=[m.hb]))return 0;y.ib=I[0],y.hb=K[0]}return y.ob=null!=m&&m.ob,y.Kb=null==m||!m.Sd,y.da&&(y.ob=y.ib<3*L/4&&y.hb<3*G/4,y.Kb=0),1}function ys(m){if(null==m)return 2;if(11>m.S){var y=m.f.RGBA;y.fb+=(m.height-1)*y.A,y.A=-y.A}else(y=m.f.kb).O+=((m=m.height)-1)*y.fa,y.fa=-y.fa,y.N+=(m-1>>1)*y.Ab,y.Ab=-y.Ab,y.W+=(m-1>>1)*y.Db,y.Db=-y.Db,null!=y.F&&(y.J+=(m-1)*y.lb,y.lb=-y.lb);return 0}function tf(m,y,I,L){if(null==L||0>=m||0>=y)return 2;if(null!=I){if(I.Da){var G=I.cd,K=I.bd,ee=-2&I.v,ne=-2&I.j;if(0>ee||0>ne||0>=G||0>=K||ee+G>m||ne+K>y)return 2;m=G,y=K}if(I.da){if(!ti(m,y,G=[I.ib],K=[I.hb]))return 2;m=G[0],y=K[0]}}L.width=m,L.height=y;e:{var ie=L.width,he=L.height;if(m=L.S,0>=ie||0>=he||!(m>=tg&&13>m))m=2;else{if(0>=L.Rd&&null==L.sd){ee=K=G=y=0;var Ue=(ne=ie*W_[m])*he;if(11>m||(K=(he+1)/2*(y=(ie+1)/2),12==m&&(ee=(G=ie)*he)),null==(he=x(Ue+2*K+ee))){m=1;break e}L.sd=he,11>m?((ie=L.f.RGBA).eb=he,ie.fb=0,ie.A=ne,ie.size=Ue):((ie=L.f.kb).y=he,ie.O=0,ie.fa=ne,ie.Fd=Ue,ie.f=he,ie.N=0+Ue,ie.Ab=y,ie.Cd=K,ie.ea=he,ie.W=0+Ue+K,ie.Db=y,ie.Ed=K,12==m&&(ie.F=he,ie.J=0+Ue+2*K),ie.Tc=ee,ie.lb=G)}if(y=1,K=L.width,ee=L.height,(G=L.S)>=tg&&13>G)if(11>G)m=L.f.RGBA,y&=(ne=Math.abs(m.A))*(ee-1)+K<=m.size,y&=ne>=K*W_[G],y&=null!=m.eb;else{m=L.f.kb,ne=(K+1)/2,Ue=(ee+1)/2,ie=Math.abs(m.fa),he=Math.abs(m.Ab);var ct=Math.abs(m.Db),at=Math.abs(m.lb);y&=ie*(ee-1)+K<=m.Fd,y&=he*(Ue-1)+ne<=m.Cd,y=(y&=ct*(Ue-1)+ne<=m.Ed)&ie>=K&he>=ne&ct>=ne,y&=null!=m.y,y&=null!=m.f,y&=null!=m.ea,12==G&&(y&=at>=K,y&=at*(ee-1)+K<=m.Tc,y&=null!=m.F)}else y=0;m=y?0:2}}return 0!=m||null!=I&&I.fd&&(m=ys(L)),m}var za=64,Km=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],lh=24,Dp=32,Zm=8,El=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];C("Predictor0","PredictorAdd0"),Oe.Predictor0=function(){return 4278190080},Oe.Predictor1=function(m){return m},Oe.Predictor2=function(m,y,I){return y[I+0]},Oe.Predictor3=function(m,y,I){return y[I+1]},Oe.Predictor4=function(m,y,I){return y[I-1]},Oe.Predictor5=function(m,y,I){return j(j(m,y[I+1]),y[I+0])},Oe.Predictor6=function(m,y,I){return j(m,y[I-1])},Oe.Predictor7=function(m,y,I){return j(m,y[I+0])},Oe.Predictor8=function(m,y,I){return j(y[I-1],y[I+0])},Oe.Predictor9=function(m,y,I){return j(y[I+0],y[I+1])},Oe.Predictor10=function(m,y,I){return j(j(m,y[I-1]),j(y[I+0],y[I+1]))},Oe.Predictor11=function(m,y,I){var L=y[I+0];return 0>=cn(L>>24&255,m>>24&255,(y=y[I-1])>>24&255)+cn(L>>16&255,m>>16&255,y>>16&255)+cn(L>>8&255,m>>8&255,y>>8&255)+cn(255&L,255&m,255&y)?L:m},Oe.Predictor12=function(m,y,I){var L=y[I+0];return(le((m>>24&255)+(L>>24&255)-((y=y[I-1])>>24&255))<<24|le((m>>16&255)+(L>>16&255)-(y>>16&255))<<16|le((m>>8&255)+(L>>8&255)-(y>>8&255))<<8|le((255&m)+(255&L)-(255&y)))>>>0},Oe.Predictor13=function(m,y,I){var L=y[I-1];return(et((m=j(m,y[I+0]))>>24&255,L>>24&255)<<24|et(m>>16&255,L>>16&255)<<16|et(m>>8&255,L>>8&255)<<8|et(m>>0&255,L>>0&255))>>>0};var R_=Oe.PredictorAdd0;Oe.PredictorAdd1=In,C("Predictor2","PredictorAdd2"),C("Predictor3","PredictorAdd3"),C("Predictor4","PredictorAdd4"),C("Predictor5","PredictorAdd5"),C("Predictor6","PredictorAdd6"),C("Predictor7","PredictorAdd7"),C("Predictor8","PredictorAdd8"),C("Predictor9","PredictorAdd9"),C("Predictor10","PredictorAdd10"),C("Predictor11","PredictorAdd11"),C("Predictor12","PredictorAdd12"),C("Predictor13","PredictorAdd13");var Qm=Oe.PredictorAdd2;Hr("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),Hr("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var q0,Xl=Oe.ColorIndexInverseTransform,nf=Oe.MapARGB,Jm=Oe.VP8LColorIndexInverseTransformAlpha,Uc=Oe.MapAlpha,dd=Oe.VP8LPredictorsAdd=[];dd.length=16,(Oe.VP8LPredictors=[]).length=16,(Oe.VP8LPredictorsAdd_C=[]).length=16,(Oe.VP8LPredictors_C=[]).length=16;var ws,Hc,fd,Sl,hc,ch,zc,Ap,Au,pc,$c,rf,af,Tp,Mp,sf,eg,mc,gc,So,Oo,pa,is,Tu,uh,kp,G0,Y0,$x=x(511),Wx=x(2041),X0=x(225),qx=x(767),Gx=0,v2=Wx,L_=X0,_c=qx,vc=$x,tg=0,Fp=1,B_=2,ng=3,rg=4,Ls=5,b2=6,j_=7,V_=8,ig=9,og=10,Yx=[2,3,7],Xx=[3,3,11],y2=[280,256,256,256,40],w2=[0,1,1,1,0],Kx=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Zx=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Dl=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],U_=8,K0=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ag=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ta=null,sg=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],x2=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],H_=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Qx=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],C2=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Jx=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],E2=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],lf=[],bc=[],hd=[],eC=1,Z0=2,Mu=[],yc=[];jt("UpsampleRgbLinePair",$i,3),jt("UpsampleBgrLinePair",mi,3),jt("UpsampleRgbaLinePair",bs,4),jt("UpsampleBgraLinePair",uo,4),jt("UpsampleArgbLinePair",Rs,4),jt("UpsampleRgba4444LinePair",Yo,2),jt("UpsampleRgb565LinePair",Go,2);var lg=Oe.UpsampleRgbLinePair,tC=Oe.UpsampleBgrLinePair,S2=Oe.UpsampleRgbaLinePair,Q0=Oe.UpsampleBgraLinePair,J0=Oe.UpsampleArgbLinePair,z_=Oe.UpsampleRgba4444LinePair,Ip=Oe.UpsampleRgb565LinePair,Pp=16,cg=1<<Pp-1,ug=-227,dg=482,D2=6,nC=(256<<D2)-1,A2=0,rC=x(256),iC=x(256),oC=x(256),T2=x(256),$_=x(dg-ug),M2=x(dg-ug);fc("YuvToRgbRow",$i,3),fc("YuvToBgrRow",mi,3),fc("YuvToRgbaRow",bs,4),fc("YuvToBgraRow",uo,4),fc("YuvToArgbRow",Rs,4),fc("YuvToRgba4444Row",Yo,2),fc("YuvToRgb565Row",Go,2);var e1=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],t1=[0,2,8],aC=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(m,y,I,L,G){var K=Fp,ee=new Cp,ne=new Nc;ee.ba=ne,ne.S=K,ne.width=[ne.width],ne.height=[ne.height];var ie=ne.width,he=ne.height,Ue=new ad;if(null==Ue||null==m)var ct=2;else p(null!=Ue),ct=Sp(m,y,I,Ue.width,Ue.height,Ue.Pd,Ue.Qd,Ue.format,null);if(0!=ct?ie=0:(null!=ie&&(ie[0]=Ue.width[0]),null!=he&&(he[0]=Ue.height[0]),ie=1),ie){ne.width=ne.width[0],ne.height=ne.height[0],null!=L&&(L[0]=ne.width),null!=G&&(G[0]=ne.height);e:{if(L=new fp,(G=new Ep).data=m,G.w=y,G.ha=I,G.kd=1,y=[0],p(null!=G),(0==(m=Sp(G.data,G.w,G.ha,null,null,null,y,null,G))||7==m)&&y[0]&&(m=4),0==(y=m)){if(p(null!=ee),L.data=G.data,L.w=G.w+G.offset,L.ha=G.ha-G.offset,L.put=ht,L.ac=zr,L.bc=pt,L.ma=ee,G.xa){if(null==(m=Aa())){ee=1;break e}if(function(at,Ke){var un=[0],kt=[0],ze=[0];t:for(;;){if(null==at)return 0;if(null==Ke)return at.a=2,0;if(at.l=Ke,at.a=0,gt(at.m,Ke.data,Ke.w,Ke.ha),!mr(at.m,un,kt,ze)){at.a=3;break t}if(at.xb=Z0,Ke.width=un[0],Ke.height=kt[0],!xu(un[0],kt[0],1,at,null))break t;return 1}return p(0!=at.a),0}(m,L)){if(L=0==(y=tf(L.width,L.height,ee.Oa,ee.ba))){t:{L=m;n:for(;;){if(null==L){L=0;break t}if(p(null!=L.s.yc),p(null!=L.s.Ya),p(0<L.s.Wb),p(null!=(I=L.l)),p(null!=(G=I.ma)),0!=L.xb){if(L.ca=G.ba,L.tb=G.tb,p(null!=L.ca),!W0(G.Oa,I,ng)){L.a=2;break n}if(!$d(L,I.width)||I.da)break n;if((I.da||no(L.ca.S))&&rt(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=L.ca.f.kb.F&&rt()),L.Pb&&0<L.s.ua&&null==L.s.vb.X&&!jr(L.s.vb,L.s.Wa.Xa)){L.a=1;break n}L.xb=0}if(!dc(L,L.V,L.Ba,L.c,L.i,I.o,Bm))break n;G.Dc=L.Ma,L=1;break t}p(0!=L.a),L=0}L=!L}L&&(y=m.a)}else y=m.a}else{if(null==(m=new I_)){ee=1;break e}if(m.Fa=G.na,m.P=G.P,m.qc=G.Sa,Po(m,L)){if(0==(y=tf(L.width,L.height,ee.Oa,ee.ba))){if(m.Aa=0,I=ee.Oa,p(null!=(G=m)),null!=I){if(0<(ie=0>(ie=I.Md)?0:100<ie?255:255*ie/100)){for(he=Ue=0;4>he;++he)12>(ct=G.pb[he]).lc&&(ct.ia=ie*aC[0>ct.lc?0:ct.lc]>>3),Ue|=ct.ia;Ue&&(alert("todo:VP8InitRandom"),G.ia=1)}G.Ga=I.Id,100<G.Ga?G.Ga=100:0>G.Ga&&(G.Ga=0)}(function Eu(m,y){if(null==m)return 0;if(null==y)return Oi(m,2,"NULL VP8Io parameter in VP8Decode().");if(!m.cb&&!Po(m,y))return 0;if(p(m.cb),null==y.ac||y.ac(y)){y.ob&&(m.L=0);var I=t1[m.L];if(2==m.L?(m.yb=0,m.zb=0):(m.yb=y.v-I>>4,m.zb=y.j-I>>4,0>m.yb&&(m.yb=0),0>m.zb&&(m.zb=0)),m.Va=y.o+15+I>>4,m.Hb=y.va+15+I>>4,m.Hb>m.za&&(m.Hb=m.za),m.Va>m.Ub&&(m.Va=m.Ub),0<m.L){var L=m.ed;for(I=0;4>I;++I){var G;if(m.Qa.Cb){var K=m.Qa.Lb[I];m.Qa.Fb||(K+=L.Tb)}else K=L.Tb;for(G=0;1>=G;++G){var ee=m.gd[I][G],ne=K;if(L.Pc&&(ne+=L.vd[0],G&&(ne+=L.od[0])),0<(ne=0>ne?0:63<ne?63:ne)){var ie=ne;0<L.wb&&(ie=4<L.wb?ie>>2:ie>>1)>9-L.wb&&(ie=9-L.wb),1>ie&&(ie=1),ee.dd=ie,ee.tc=2*ne+ie,ee.ld=40<=ne?2:15<=ne?1:0}else ee.tc=0;ee.La=G}}}I=0}else Oi(m,6,"Frame setup failed"),I=m.a;if(I=0==I){if(I){m.$c=0,0<m.Aa||(m.Ic=1);e:{L=4*(ie=m.za);var he=32*ie,Ue=ie+1,ct=0<m.L?ie*(0<m.Aa?2:1):0,at=(2==m.Aa?2:1)*ie;if((ee=L+832+(G=3*(16*(I=m.Ic)+t1[m.L])/2*he)+(K=null!=m.Fa&&0<m.Fa.length?m.Kc.c*m.Kc.i:0))!=ee)I=0;else{if(ee>m.Vb){if(m.Vb=0,m.Ec=x(ee),m.Fc=0,null==m.Ec){I=Oi(m,1,"no memory during frame initialization.");break e}m.Vb=ee}ne=m.Fc,m.Ac=ee=m.Ec,m.Bc=ne,ne+=L,m.Gd=M(he,Um),m.Hd=0,m.rb=M(Ue+1,up),m.sb=1,m.wa=ct?M(ct,Zf):null,m.Y=0,m.D.Nb=0,m.D.wa=m.wa,m.D.Y=m.Y,0<m.Aa&&(m.D.Y+=ie),p(!0),m.oc=ee,m.pc=ne,ne+=832,m.ya=M(at,dp),m.aa=0,m.D.ya=m.ya,m.D.aa=m.aa,2==m.Aa&&(m.D.aa+=ie),m.R=16*ie,m.B=8*ie,ie=(he=t1[m.L])*m.R,he=he/2*m.B,m.sa=ee,m.ta=ne+ie,m.qa=m.sa,m.ra=m.ta+16*I*m.R+he,m.Ha=m.qa,m.Ia=m.ra+8*I*m.B+he,m.$c=0,ne+=G,m.mb=K?ee:null,m.nb=K?ne:null,p(ne+K<=m.Fc+m.Vb),zm(m),S(m.Ac,m.Bc,0,L),I=1}}if(I){if(y.ka=0,y.y=m.sa,y.O=m.ta,y.f=m.qa,y.N=m.ra,y.ea=m.Ha,y.Vd=m.Ia,y.fa=m.R,y.Rc=m.B,y.F=null,y.J=0,!Gx){for(I=-255;255>=I;++I)$x[255+I]=0>I?-I:I;for(I=-1020;1020>=I;++I)Wx[1020+I]=-128>I?-128:127<I?127:I;for(I=-112;112>=I;++I)X0[112+I]=-16>I?-16:15<I?15:I;for(I=-255;510>=I;++I)qx[255+I]=0>I?0:255<I?255:I;Gx=1}zc=Yd,Ap=pp,pc=mp,$c=N0,rf=R0,Au=Qf,af=Bc,Tp=oh,Mp=Zd,sf=Ym,eg=H0,mc=ah,gc=co,So=xp,Oo=Gm,pa=Du,is=cd,Tu=U0,bc[0]=Lc,bc[1]=P_,bc[2]=Jf,bc[3]=L0,bc[4]=eh,bc[5]=ld,bc[6]=B0,bc[7]=th,bc[8]=_2,bc[9]=vp,lf[0]=O_,lf[1]=$m,lf[2]=Xd,lf[3]=gp,lf[4]=il,lf[5]=Wm,lf[6]=qm,hd[0]=vs,hd[1]=g2,hd[2]=j0,hd[3]=bp,hd[4]=Su,hd[5]=N_,hd[6]=rh,I=1}else I=0}I&&(I=function(Ke,un){for(Ke.M=0;Ke.M<Ke.Va;++Ke.M){var kt,ze=Ke.Jc[Ke.M&Ke.Xb],We=Ke.m,en=Ke;for(kt=0;kt<en.za;++kt){var vn=We,sn=en,lr=sn.Ac,$n=sn.Bc+4*kt,Nr=sn.zc,qn=sn.ya[sn.aa+kt];if(qn.$b=sn.Qa.Bb?bt(vn,sn.Pa.jb[0])?2+bt(vn,sn.Pa.jb[2]):bt(vn,sn.Pa.jb[1]):0,sn.kc&&(qn.Ad=bt(vn,sn.Bd)),qn.Za=!bt(vn,145)+0,qn.Za){var Ki=qn.Ob,Zi=0;for(sn=0;4>sn;++sn){var Ni,gi=Nr[0+sn];for(Ni=0;4>Ni;++Ni){for(var Do=H_[bt(vn,(gi=C2[lr[$n+Ni]][gi])[0])];0<Do;)Do=H_[2*Do+bt(vn,gi[Do])];lr[$n+Ni]=gi=-Do}b(Ki,Zi,lr,$n,4),Zi+=4,Nr[0+sn]=gi}}else gi=bt(vn,156)?bt(vn,128)?1:3:bt(vn,163)?2:0,qn.Ob[0]=gi,S(lr,$n,gi,4),S(Nr,0,gi,4);qn.Dd=bt(vn,142)?bt(vn,114)?bt(vn,183)?1:3:2:0}if(en.m.Ka)return Oi(Ke,7,"Premature end-of-partition0 encountered.");for(;Ke.ja<Ke.za;++Ke.ja){if(en=ze,vn=(We=Ke).rb[We.sb-1],lr=We.rb[We.sb+We.ja],kt=We.ya[We.aa+We.ja],$n=We.kc?kt.Ad:0)vn.la=lr.la=0,kt.Za||(vn.Na=lr.Na=0),kt.Hc=0,kt.Gc=0,kt.ia=0;else{var mo,_i;if(vn=lr,lr=en,$n=We.Pa.Xc,qn=We.pb[(Nr=We.ya[We.aa+We.ja]).$b],Zi=We.rb[We.sb-1],gi=Ni=0,S(sn=Nr.ad,Ki=0,0,384),Nr.Za)var Ma=0,Bs=$n[3];else{Do=x(16);var ka=vn.Na+Zi.Na;if(ka=Ta(lr,$n[1],ka,qn.Eb,0,Do,0),vn.Na=Zi.Na=(0<ka)+0,1<ka)zc(Do,0,sn,Ki);else{var ol=Do[0]+3>>3;for(Do=0;256>Do;Do+=16)sn[Ki+Do]=ol}Ma=1,Bs=$n[0]}var Qi=15&vn.la,al=15&Zi.la;for(Do=0;4>Do;++Do){var Al=1&al;for(ol=_i=0;4>ol;++ol)Qi=Qi>>1|(Al=(ka=Ta(lr,Bs,ka=Al+(1&Qi),qn.Sc,Ma,sn,Ki))>Ma)<<7,_i=_i<<2|(3<ka?3:1<ka?2:0!=sn[Ki+0]),Ki+=16;Qi>>=4,al=al>>1|Al<<7,Ni=(Ni<<8|_i)>>>0}for(Bs=Qi,Ma=al>>4,mo=0;4>mo;mo+=2){for(_i=0,Qi=vn.la>>4+mo,al=Zi.la>>4+mo,Do=0;2>Do;++Do){for(Al=1&al,ol=0;2>ol;++ol)Qi=Qi>>1|(Al=0<(ka=Ta(lr,$n[2],ka=Al+(1&Qi),qn.Qc,0,sn,Ki)))<<3,_i=_i<<2|(3<ka?3:1<ka?2:0!=sn[Ki+0]),Ki+=16;Qi>>=2,al=al>>1|Al<<5}gi|=_i<<4*mo,Bs|=Qi<<4<<mo,Ma|=(240&al)<<mo}vn.la=Bs,Zi.la=Ma,Nr.Hc=Ni,Nr.Gc=gi,Nr.ia=43690&gi?0:qn.ia,$n=!(Ni|gi)}if(0<We.L&&(We.wa[We.Y+We.ja]=We.gd[kt.$b][kt.Za],We.wa[We.Y+We.ja].La|=!$n),en.Ka)return Oi(Ke,7,"Premature end-of-file encountered.")}if(zm(Ke),We=un,en=1,kt=(ze=Ke).D,vn=0<ze.L&&ze.M>=ze.zb&&ze.M<=ze.Va,0==ze.Aa)e:{if(kt.M=ze.M,kt.uc=vn,$0(ze,kt),en=1,kt=(_i=ze.D).Nb,vn=(gi=t1[ze.L])*ze.R,$n=ze.sa,Nr=ze.ta-vn+(Do=16*kt*ze.R),qn=ze.qa,sn=ze.ra-(lr=gi/2*ze.B)+(ol=8*kt*ze.B),Ki=ze.Ha,Zi=ze.Ia-lr+ol,al=0==(Qi=_i.M),Ni=Qi>=ze.Va-1,2==ze.Aa&&$0(ze,_i),_i.uc)for(Al=(ka=ze).D.M,p(ka.D.uc),_i=ka.yb;_i<ka.Hb;++_i){Bs=Al;var $a=(os=(ma=ka).D).Nb,os=os.wa[os.Y+(Ma=_i)],va=ma.sa,wc=ma.ta+16*$a*(mo=ma.R)+16*Ma,ku=os.dd,as=os.tc;if(0!=as)if(p(3<=as),1==ma.L)0<Ma&&pa(va,wc,mo,as+4),os.La&&Tu(va,wc,mo,as),0<Bs&&Oo(va,wc,mo,as+4),os.La&&is(va,wc,mo,as);else{var pd=ma.B,dh=ma.qa,ss=ma.ra+8*$a*pd+8*Ma,xs=ma.Ha,ma=ma.Ia+8*$a*pd+8*Ma;$a=os.ld,0<Ma&&(Tp(va,wc,mo,as+4,ku,$a),sf(dh,ss,xs,ma,pd,as+4,ku,$a)),os.La&&(mc(va,wc,mo,as,ku,$a),So(dh,ss,xs,ma,pd,as,ku,$a)),0<Bs&&(af(va,wc,mo,as+4,ku,$a),Mp(dh,ss,xs,ma,pd,as+4,ku,$a)),os.La&&(eg(va,wc,mo,as,ku,$a),gc(dh,ss,xs,ma,pd,as,ku,$a))}}if(ze.ia&&alert("todo:DitherRow"),null!=We.put){if(_i=16*Qi,Qi=16*(Qi+1),al?(We.y=ze.sa,We.O=ze.ta+Do,We.f=ze.qa,We.N=ze.ra+ol,We.ea=ze.Ha,We.W=ze.Ia+ol):(_i-=gi,We.y=$n,We.O=Nr,We.f=qn,We.N=sn,We.ea=Ki,We.W=Zi),Ni||(Qi-=gi),Qi>We.o&&(Qi=We.o),We.F=null,We.J=null,null!=ze.Fa&&0<ze.Fa.length&&_i<Qi&&(We.J=z0(ze,We,_i,Qi-_i),We.F=ze.mb,null==We.F&&0==We.F.length)){en=Oi(ze,3,"Could not decode alpha data.");break e}_i<We.j&&(gi=We.j-_i,_i=We.j,p(!(1&gi)),We.O+=ze.R*gi,We.N+=ze.B*(gi>>1),We.W+=ze.B*(gi>>1),null!=We.F&&(We.J+=We.width*gi)),_i<Qi&&(We.O+=We.v,We.N+=We.v>>1,We.W+=We.v>>1,null!=We.F&&(We.J+=We.v),We.ka=_i-We.j,We.U=We.va-We.v,We.T=Qi-_i,en=We.put(We))}kt+1!=ze.Ic||Ni||(b(ze.sa,ze.ta-vn,$n,Nr+16*ze.R,vn),b(ze.qa,ze.ra-lr,qn,sn+8*ze.B,lr),b(ze.Ha,ze.Ia-lr,Ki,Zi+8*ze.B,lr))}if(!en)return Oi(Ke,6,"Output aborted.")}return 1}(m,y)),null!=y.bc&&y.bc(y),I&=1}return I?(m.cb=0,I):0})(m,L)||(y=m.a)}}else y=m.a}0==y&&null!=ee.Oa&&ee.Oa.fd&&(y=ys(ee.ba))}ee=y}K=0!=ee?null:11>K?ne.f.RGBA.eb:ne.f.kb.y}else K=null;return K};var W_=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function H(Oe,Kt){for(var Yt="",fe=0;fe<4;fe++)Yt+=String.fromCharCode(Oe[Kt++]);return Yt}function Y(Oe,Kt){return(Oe[Kt+0]<<0|Oe[Kt+1]<<8|Oe[Kt+2]<<16)>>>0}function Q(Oe,Kt){return(Oe[Kt+0]<<0|Oe[Kt+1]<<8|Oe[Kt+2]<<16|Oe[Kt+3]<<24)>>>0}new O;var re=[0],V=[0],ve=[],ce=new O,be=_,se=function(Oe,Kt){var Yt={},fe=0,de=!1,He=0,Ne=0;if(Yt.frames=[],!
/** @license
               * Copyright (c) 2017 Dominik Homberger
              Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
              The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
              THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
              https://webpjs.appspot.com
              WebPRiffParser dominikhlbg@gmail.com
              */
function(we,Te,$e,Xe){for(var ft=0;ft<4;ft++)if(we[Te+ft]!="RIFF".charCodeAt(ft))return!0;return!1}(Oe,Kt)){var Tt,St;for(Q(Oe,Kt+=4),Kt+=8;Kt<Oe.length;){var zt=H(Oe,Kt),gt=Q(Oe,Kt+=4);Kt+=4;var Zt=gt+(1&gt);switch(zt){case"VP8 ":case"VP8L":void 0===Yt.frames[fe]&&(Yt.frames[fe]={}),(J=Yt.frames[fe]).src_off=de?Ne:Kt-8,J.src_size=He+gt+8,fe++,de&&(de=!1,He=0,Ne=0);break;case"VP8X":(J=Yt.header={}).feature_flags=Oe[Kt];var Wt=Kt+4;J.canvas_width=1+Y(Oe,Wt),J.canvas_height=1+Y(Oe,Wt+=3),Wt+=3;break;case"ALPH":de=!0,He=Zt+8,Ne=Kt-8;break;case"ANIM":(J=Yt.header).bgcolor=Q(Oe,Kt),J.loop_count=(Tt=Oe)[(St=Wt=Kt+4)+0]<<0|Tt[St+1]<<8,Wt+=2;break;case"ANMF":var Yn,J;(J=Yt.frames[fe]={}).offset_x=2*Y(Oe,Kt),J.offset_y=2*Y(Oe,Kt+=3),J.width=1+Y(Oe,Kt+=3),J.height=1+Y(Oe,Kt+=3),J.duration=Y(Oe,Kt+=3),Kt+=3,Yn=Oe[Kt++],J.dispose=1&Yn,J.blend=Yn>>1&1}"ANMF"!=zt&&(Kt+=Zt)}return Yt}}(be,0);se.response=be,se.rgbaoutput=!0,se.dataurl=!1;var me=se.header?se.header:null,Be=se.frames?se.frames:null;if(me){me.loop_counter=me.loop_count,re=[me.canvas_height],V=[me.canvas_width];for(var st=0;st<Be.length&&0!=Be[st].blend;st++);}var At=Be[0],ln=ce.WebPDecodeRGBA(be,At.src_off,At.src_size,V,re);At.rgba=ln,At.imgwidth=V[0],At.imgheight=re[0];for(var nt=0;nt<V[0]*re[0]*4;nt++)ve[nt]=ln[nt];return this.width=V,this.height=re,this.data=ve,this}(function(_){var g=function(re,V,ve,ce){var be=4,se=M;switch(ce){case _.image_compression.FAST:be=1,se=x;break;case _.image_compression.MEDIUM:be=6,se=P;break;case _.image_compression.SLOW:be=9,se=O}var me=Od(re=b(re,V,ve,se),{level:be});return _.__addimage__.arrayBufferToBinaryString(me)},b=function(re,V,ve,ce){for(var be,se,me,Be=re.length/V,st=new Uint8Array(re.length+Be),At=Y(),ln=0;ln<Be;ln+=1){if(be=re.subarray(me=ln*V,me+V),ce)st.set(ce(be,ve,se),me+ln);else{for(var nt,Oe=At.length,Kt=[];nt<Oe;nt+=1)Kt[nt]=At[nt](be,ve,se);var Yt=Q(Kt.concat());st.set(Kt[Yt],me+ln)}se=be}return st},S=function(re){var V=Array.apply([],re);return V.unshift(0),V},x=function(re,V){var ce=[],be=re.length;ce[0]=1;for(var se=0;se<be;se+=1)ce[se+1]=re[se]-(re[se-V]||0)+256&255;return ce},M=function(re,V,ve){var be=[],se=re.length;be[0]=2;for(var me=0;me<se;me+=1)be[me+1]=re[me]-(ve&&ve[me]||0)+256&255;return be},P=function(re,V,ve){var se=[],me=re.length;se[0]=3;for(var Be=0;Be<me;Be+=1)se[Be+1]=re[Be]+256-((re[Be-V]||0)+(ve&&ve[Be]||0)>>>1)&255;return se},O=function(re,V,ve){var me,Be=[],st=re.length;Be[0]=4;for(var At=0;At<st;At+=1)me=H(re[At-V]||0,ve&&ve[At]||0,ve&&ve[At-V]||0),Be[At+1]=re[At]-me+256&255;return Be},H=function(re,V,ve){if(re===V&&V===ve)return re;var ce=Math.abs(V-ve),be=Math.abs(re-ve),se=Math.abs(re+V-ve-ve);return ce<=be&&ce<=se?re:be<=se?V:ve},Y=function(){return[S,x,M,P,O]},Q=function(re){var V=re.map(function(ve){return ve.reduce(function(ce,be){return ce+Math.abs(be)},0)});return V.indexOf(Math.min.apply(null,V))};_.processPNG=function(re,V,ve,ce){var be,se,me,Be,st,At,ln,nt,Oe,Kt,Yt,fe,de,He,Ne,Tt=this.decode.FLATE_DECODE,St="";if(this.__addimage__.isArrayBuffer(re)&&(re=new Uint8Array(re)),this.__addimage__.isArrayBufferView(re)){if(re=(me=new F0(re)).imgData,se=me.bits,be=me.colorSpace,st=me.colors,-1!==[4,6].indexOf(me.colorType)){if(8===me.bits){Oe=(nt=32==me.pixelBitlength?new Uint32Array(me.decodePixels().buffer):16==me.pixelBitlength?new Uint16Array(me.decodePixels().buffer):new Uint8Array(me.decodePixels().buffer)).length,Yt=new Uint8Array(Oe*me.colors),Kt=new Uint8Array(Oe);var zt,gt=me.pixelBitlength-me.bits;for(He=0,Ne=0;He<Oe;He++){for(de=nt[He],zt=0;zt<gt;)Yt[Ne++]=de>>>zt&255,zt+=me.bits;Kt[He]=de>>>zt&255}}if(16===me.bits){Oe=(nt=new Uint32Array(me.decodePixels().buffer)).length,Yt=new Uint8Array(Oe*(32/me.pixelBitlength)*me.colors),Kt=new Uint8Array(Oe*(32/me.pixelBitlength)),fe=me.colors>1,He=0,Ne=0;for(var Zt=0;He<Oe;)de=nt[He++],Yt[Ne++]=de>>>0&255,fe&&(Yt[Ne++]=de>>>16&255,de=nt[He++],Yt[Ne++]=de>>>0&255),Kt[Zt++]=de>>>16&255;se=8}ce!==_.image_compression.NONE?(re=g(Yt,me.width*me.colors,me.colors,ce),ln=g(Kt,me.width,1,ce)):(re=Yt,ln=Kt,Tt=void 0)}if(3===me.colorType&&(be=this.color_spaces.INDEXED,At=me.palette,me.transparency.indexed)){var Wt=me.transparency.indexed,Yn=0;for(He=0,Oe=Wt.length;He<Oe;++He)Yn+=Wt[He];if((Yn/=255)==Oe-1&&-1!==Wt.indexOf(0))Be=[Wt.indexOf(0)];else if(Yn!==Oe){for(nt=me.decodePixels(),Kt=new Uint8Array(nt.length),He=0,Oe=nt.length;He<Oe;He++)Kt[He]=Wt[nt[He]];ln=g(Kt,me.width,1)}}var J=function(we){var Te;switch(we){case _.image_compression.FAST:Te=11;break;case _.image_compression.MEDIUM:Te=13;break;case _.image_compression.SLOW:Te=14;break;default:Te=12}return Te}(ce);return Tt===this.decode.FLATE_DECODE&&(St="/Predictor "+J+" "),St+="/Colors "+st+" /BitsPerComponent "+se+" /Columns "+me.width,(this.__addimage__.isArrayBuffer(re)||this.__addimage__.isArrayBufferView(re))&&(re=this.__addimage__.arrayBufferToBinaryString(re)),(ln&&this.__addimage__.isArrayBuffer(ln)||this.__addimage__.isArrayBufferView(ln))&&(ln=this.__addimage__.arrayBufferToBinaryString(ln)),{alias:ve,data:re,index:V,filter:Tt,decodeParameters:St,transparency:Be,palette:At,sMask:ln,predictor:J,width:me.width,height:me.height,bitsPerComponent:se,colorSpace:be}}}})(Pr.API),function(_){_.processGIF89A=function(p,g,b,S){var x=new I0(p),M=x.width,P=x.height,O=[];x.decodeAndBlitFrameRGBA(0,O);var H={data:O,width:M,height:P},Y=new tp(100).encode(H,100);return _.processJPEG.call(this,Y,g,b,S)},_.processGIF87A=_.processGIF89A}(Pr.API),nl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var _=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(_);for(var p=0;p<_;p++){var g=this.datav.getUint8(this.pos++,!0),b=this.datav.getUint8(this.pos++,!0),S=this.datav.getUint8(this.pos++,!0),x=this.datav.getUint8(this.pos++,!0);this.palette[p]={red:S,green:b,blue:g,quad:x}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},nl.prototype.parseBGR=function(){this.pos=this.offset;try{var _="bit"+this.bitPP;this.data=new Uint8Array(this.width*this.height*4),this[_]()}catch(g){io.log("bit decode error:"+g)}},nl.prototype.bit1=function(){var _,p=Math.ceil(this.width/8),g=p%4;for(_=this.height-1;_>=0;_--){for(var b=this.bottom_up?_:this.height-1-_,S=0;S<p;S++)for(var x=this.datav.getUint8(this.pos++,!0),M=b*this.width*4+8*S*4,P=0;P<8&&8*S+P<this.width;P++){var O=this.palette[x>>7-P&1];this.data[M+4*P]=O.blue,this.data[M+4*P+1]=O.green,this.data[M+4*P+2]=O.red,this.data[M+4*P+3]=255}0!==g&&(this.pos+=4-g)}},nl.prototype.bit4=function(){for(var _=Math.ceil(this.width/2),p=_%4,g=this.height-1;g>=0;g--){for(var b=this.bottom_up?g:this.height-1-g,S=0;S<_;S++){var x=this.datav.getUint8(this.pos++,!0),M=b*this.width*4+2*S*4,O=15&x,H=this.palette[x>>4];if(this.data[M]=H.blue,this.data[M+1]=H.green,this.data[M+2]=H.red,this.data[M+3]=255,2*S+1>=this.width)break;this.data[M+4]=(H=this.palette[O]).blue,this.data[M+4+1]=H.green,this.data[M+4+2]=H.red,this.data[M+4+3]=255}0!==p&&(this.pos+=4-p)}},nl.prototype.bit8=function(){for(var _=this.width%4,p=this.height-1;p>=0;p--){for(var g=this.bottom_up?p:this.height-1-p,b=0;b<this.width;b++){var S=this.datav.getUint8(this.pos++,!0),x=g*this.width*4+4*b;if(S<this.palette.length){var M=this.palette[S];this.data[x]=M.red,this.data[x+1]=M.green,this.data[x+2]=M.blue,this.data[x+3]=255}else this.data[x]=255,this.data[x+1]=255,this.data[x+2]=255,this.data[x+3]=255}0!==_&&(this.pos+=4-_)}},nl.prototype.bit15=function(){for(var _=this.width%3,p=parseInt("11111",2),g=this.height-1;g>=0;g--){for(var b=this.bottom_up?g:this.height-1-g,S=0;S<this.width;S++){var x=this.datav.getUint16(this.pos,!0);this.pos+=2;var M=(x&p)/p*255|0,P=(x>>5&p)/p*255|0,H=x>>15?255:0,Y=b*this.width*4+4*S;this.data[Y]=(x>>10&p)/p*255|0,this.data[Y+1]=P,this.data[Y+2]=M,this.data[Y+3]=H}this.pos+=_}},nl.prototype.bit16=function(){for(var _=this.width%3,p=parseInt("11111",2),g=parseInt("111111",2),b=this.height-1;b>=0;b--){for(var S=this.bottom_up?b:this.height-1-b,x=0;x<this.width;x++){var M=this.datav.getUint16(this.pos,!0);this.pos+=2;var P=(M&p)/p*255|0,O=(M>>5&g)/g*255|0,Y=S*this.width*4+4*x;this.data[Y]=(M>>11)/p*255|0,this.data[Y+1]=O,this.data[Y+2]=P,this.data[Y+3]=255}this.pos+=_}},nl.prototype.bit24=function(){for(var _=this.height-1;_>=0;_--){for(var p=this.bottom_up?_:this.height-1-_,g=0;g<this.width;g++){var b=this.datav.getUint8(this.pos++,!0),S=this.datav.getUint8(this.pos++,!0),x=this.datav.getUint8(this.pos++,!0),M=p*this.width*4+4*g;this.data[M]=x,this.data[M+1]=S,this.data[M+2]=b,this.data[M+3]=255}this.pos+=this.width%4}},nl.prototype.bit32=function(){for(var _=this.height-1;_>=0;_--)for(var p=this.bottom_up?_:this.height-1-_,g=0;g<this.width;g++){var b=this.datav.getUint8(this.pos++,!0),S=this.datav.getUint8(this.pos++,!0),x=this.datav.getUint8(this.pos++,!0),M=this.datav.getUint8(this.pos++,!0),P=p*this.width*4+4*g;this.data[P]=x,this.data[P+1]=S,this.data[P+2]=b,this.data[P+3]=M}},nl.prototype.getData=function(){return this.data},
/**
         * @license
         * Copyright (c) 2018 Aras Abbasi
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){_.processBMP=function(p,g,b,S){var x=new nl(p,!1),M=x.width,P=x.height,O={data:x.getData(),width:M,height:P},H=new tp(100).encode(O,100);return _.processJPEG.call(this,H,g,b,S)}}(Pr.API),jn.prototype.getData=function(){return this.data},
/**
         * @license
         * Copyright (c) 2019 Aras Abbasi
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){_.processWEBP=function(p,g,b,S){var x=new jn(p,!1),M=x.width,P=x.height,O={data:x.getData(),width:M,height:P},H=new tp(100).encode(O,100);return _.processJPEG.call(this,H,g,b,S)}}(Pr.API),Pr.API.processRGBA=function(_,p,g){for(var b=_.data,S=b.length,x=new Uint8Array(S/4*3),M=new Uint8Array(S/4),P=0,O=0,H=0;H<S;H+=4){var Q=b[H+1],re=b[H+2],V=b[H+3];x[P++]=b[H],x[P++]=Q,x[P++]=re,M[O++]=V}var ve=this.__addimage__.arrayBufferToBinaryString(x);return{alpha:this.__addimage__.arrayBufferToBinaryString(M),data:ve,index:p,alias:g,colorSpace:"DeviceRGB",bitsPerComponent:8,width:_.width,height:_.height}},Pr.API.setLanguage=function(_){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[_]&&(this.internal.languageSettings.languageCode=_,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Wl=(ts=Pr.API).getCharWidthsArray=function(_,p){var g,b,S=(p=p||{}).font||this.internal.getFont(),x=p.fontSize||this.internal.getFontSize(),M=p.charSpace||this.internal.getCharSpace(),P=p.widths?p.widths:S.metadata.Unicode.widths,O=P.fof?P.fof:1,H=p.kerning?p.kerning:S.metadata.Unicode.kerning,Y=H.fof?H.fof:1,Q=!1!==p.doKerning,re=0,V=_.length,ve=0,ce=P[0]||O,be=[];for(g=0;g<V;g++)b=_.charCodeAt(g),"function"==typeof S.metadata.widthOfString?be.push((S.metadata.widthOfGlyph(S.metadata.characterToGlyph(b))+M*(1e3/x)||0)/1e3):(re=Q&&"object"===(0,zn.Z)(H[b])&&!isNaN(parseInt(H[b][ve],10))?H[b][ve]/Y:0,be.push((P[b]||ce)/O+re)),ve=b;return be},k0=ts.getStringUnitWidth=function(_,p){var g=(p=p||{}).fontSize||this.internal.getFontSize(),b=p.font||this.internal.getFont(),S=p.charSpace||this.internal.getCharSpace();return ts.processArabic&&(_=ts.processArabic(_)),"function"==typeof b.metadata.widthOfString?b.metadata.widthOfString(_,g,S)/g:Wl.apply(this,arguments).reduce(function(x,M){return x+M},0)},pr=function(_,p,g,b){for(var S=[],x=0,M=_.length,P=0;x!==M&&P+p[x]<g;)P+=p[x],x++;S.push(_.slice(0,x));var O=x;for(P=0;x!==M;)P+p[x]>b&&(S.push(_.slice(O,x)),P=0,O=x),P+=p[x],x++;return O!==x&&S.push(_.slice(O,x)),S},Rm=function(_,p,g){g||(g={});var b,S,x,M,P,O,Y=[],Q=[Y],re=g.textIndent||0,V=0,ve=0,ce=_.split(" "),be=Wl.apply(this,[" ",g])[0];if(O=-1===g.lineIndent?ce[0].length+2:g.lineIndent||0){var se=Array(O).join(" "),me=[];ce.map(function(st){(st=st.split(/\s*\n/)).length>1?me=me.concat(st.map(function(At,ln){return(ln&&At.length?"\n":"")+At})):me.push(st[0])}),ce=me,O=k0.apply(this,[se,g])}for(x=0,M=ce.length;x<M;x++){var Be=0;if(b=ce[x],O&&"\n"==b[0]&&(b=b.substr(1),Be=1),re+V+(ve=(S=Wl.apply(this,[b,g])).reduce(function(st,At){return st+At},0))>p||Be){if(ve>p){for(P=pr.apply(this,[b,S,p-(re+V),p]),Y.push(P.shift()),Y=[P.pop()];P.length;)Q.push([P.shift()]);ve=S.slice(b.length-(Y[0]?Y[0].length:0)).reduce(function(st,At){return st+At},0)}else Y=[b];Q.push(Y),re=ve+O,V=be}else Y.push(b),re+=V+ve,V=be}return Q.map(O?function(st,At){return(At?se:"")+st.join(" ")}:function(st){return st.join(" ")})},ts.splitTextToSize=function(_,p,g){var b,S=(g=g||{}).fontSize||this.internal.getFontSize(),x=function(Y){if(Y.widths&&Y.kerning)return{widths:Y.widths,kerning:Y.kerning};var Q=this.internal.getFont(Y.fontName,Y.fontStyle);return Q.metadata.Unicode?{widths:Q.metadata.Unicode.widths||{0:1},kerning:Q.metadata.Unicode.kerning||{}}:{font:Q.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,g);b=Array.isArray(_)?_:String(_).split(/\r?\n/);var M=1*this.internal.scaleFactor*p/S;x.textIndent=g.textIndent?1*g.textIndent*this.internal.scaleFactor/S:0,x.lineIndent=g.lineIndent;var P,O,H=[];for(P=0,O=b.length;P<O;P++)H=H.concat(Rm.apply(this,[b[P],M,x]));return H},function(_){_.__fontmetrics__=_.__fontmetrics__||{};for(var p="klmnopqrstuvwxyz",g={},b={},S=0;S<p.length;S++)g[p[S]]="0123456789abcdef"[S],b["0123456789abcdef"[S]]=p[S];var x=function(Q){return"0x"+parseInt(Q,10).toString(16)},M=_.__fontmetrics__.compress=function(Q){var re,V,ve,ce,be=["{"];for(var se in Q){if(re=Q[se],isNaN(parseInt(se,10))?V="'"+se+"'":(se=parseInt(se,10),V=(V=x(se).slice(2)).slice(0,-1)+b[V.slice(-1)]),"number"==typeof re)re<0?(ve=x(re).slice(3),ce="-"):(ve=x(re).slice(2),ce=""),ve=ce+ve.slice(0,-1)+b[ve.slice(-1)];else{if("object"!==(0,zn.Z)(re))throw new Error("Don't know what to do with value type "+(0,zn.Z)(re)+".");ve=M(re)}be.push(V+ve)}return be.push("}"),be.join("")},P=_.__fontmetrics__.uncompress=function(Q){if("string"!=typeof Q)throw new Error("Invalid argument passed to uncompress.");for(var re,V,ve,ce,be={},se=1,me=be,Be=[],st="",At="",ln=Q.length-1,nt=1;nt<ln;nt+=1)"'"==(ce=Q[nt])?re?(ve=re.join(""),re=void 0):re=[]:re?re.push(ce):"{"==ce?(Be.push([me,ve]),me={},ve=void 0):"}"==ce?((V=Be.pop())[0][V[1]]=me,ve=void 0,me=V[0]):"-"==ce?se=-1:void 0===ve?g.hasOwnProperty(ce)?(st+=g[ce],ve=parseInt(st,16)*se,se=1,st=""):st+=ce:g.hasOwnProperty(ce)?(At+=g[ce],me[ve]=parseInt(At,16)*se,se=1,ve=void 0,At=""):At+=ce;return be},O={codePages:["WinAnsiEncoding"],WinAnsiEncoding:P("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},H={Unicode:{Courier:O,"Courier-Bold":O,"Courier-BoldOblique":O,"Courier-Oblique":O,Helvetica:O,"Helvetica-Bold":O,"Helvetica-BoldOblique":O,"Helvetica-Oblique":O,"Times-Roman":O,"Times-Bold":O,"Times-BoldItalic":O,"Times-Italic":O}},Y={Unicode:{"Courier-Oblique":P("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":P("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":P("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:P("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":P("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":P("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:P("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:P("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":P("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:P("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":P("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":P("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":P("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":P("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};_.events.push(["addFont",function(Q){var re=Q.font,V=Y.Unicode[re.postScriptName];V&&(re.metadata.Unicode={},re.metadata.Unicode.widths=V.widths,re.metadata.Unicode.kerning=V.kerning);var ve=H.Unicode[re.postScriptName];ve&&(re.metadata.Unicode.encoding=ve,re.encoding=ve.codePages[0])}])}(Pr.API),
/**
         * @license
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){var p=function(g){for(var b=g.length,S=new Uint8Array(b),x=0;x<b;x++)S[x]=g.charCodeAt(x);return S};_.API.events.push(["addFont",function(g){var M,P,b=void 0,S=g.font,x=g.instance;if(!S.isStandardFont){if(void 0===x)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+S.postScriptName+"').");if("string"!=typeof(b=!1===x.existsFileInVFS(S.postScriptName)?x.loadFile(S.postScriptName):x.getFileFromVFS(S.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+S.postScriptName+"').");M=S,P=/^\x00\x01\x00\x00/.test(P=b)?p(P):p(Ea(P)),M.metadata=_.API.TTFFont.open(P),M.metadata.Unicode=M.metadata.Unicode||{encoding:{},kerning:{},widths:[]},M.metadata.glyIdsUsed=[0]}}])}(Pr),Pr.API.addSvgAsImage=function(g,b,S,x,M,P,O,H){if(isNaN(b)||isNaN(S))throw io.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(x)||isNaN(M))throw io.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var Y=document.createElement("canvas");Y.width=x,Y.height=M;var Q=Y.getContext("2d");Q.fillStyle="#fff",Q.fillRect(0,0,Y.width,Y.height);var re={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},V=this;return function p(){return(Lr.canvg?Promise.resolve(Lr.canvg):qi.e(130).then(qi.bind(qi,7130))).catch(function(g){return Promise.reject(new Error("Could not load canvg: "+g))}).then(function(g){return g.default?g.default:g})}().then(function(ve){return ve.fromString(Q,g,re)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(ve){return ve.render(re)}).then(function(){V.addImage(Y.toDataURL("image/jpeg",1),b,S,x,M,O,H)})},Pr.API.putTotalPages=function(_){var p,g=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(p=new RegExp(_,"g"),g=this.internal.getNumberOfPages()):(p=new RegExp(this.pdfEscape16(_,this.internal.getFont()),"g"),g=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var b=1;b<=this.internal.getNumberOfPages();b++)for(var S=0;S<this.internal.pages[b].length;S++)this.internal.pages[b][S]=this.internal.pages[b][S].replace(p,g);return this},Pr.API.viewerPreferences=function(_,p){var g;_=_||{},p=p||!1;var b,S,x,M={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},P=Object.keys(M),O=[],H=0,Y=0,Q=0;function re(ve,ce){var be,se=!1;for(be=0;be<ve.length;be+=1)ve[be]===ce&&(se=!0);return se}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(M)),this.internal.viewerpreferences.isSubscribed=!1),g=this.internal.viewerpreferences.configuration,"reset"===_||!0===p){var V=P.length;for(Q=0;Q<V;Q+=1)g[P[Q]].value=g[P[Q]].defaultValue,g[P[Q]].explicitSet=!1}if("object"===(0,zn.Z)(_))for(S in _)if(x=_[S],re(P,S)&&void 0!==x){if("boolean"===g[S].type&&"boolean"==typeof x)g[S].value=x;else if("name"===g[S].type&&re(g[S].valueSet,x))g[S].value=x;else if("integer"===g[S].type&&Number.isInteger(x))g[S].value=x;else if("array"===g[S].type){for(H=0;H<x.length;H+=1)if(b=!0,1===x[H].length&&"number"==typeof x[H][0])O.push(String(x[H]-1));else if(x[H].length>1){for(Y=0;Y<x[H].length;Y+=1)"number"!=typeof x[H][Y]&&(b=!1);!0===b&&O.push([x[H][0]-1,x[H][1]-1].join(" "))}g[S].value="["+O.join(" ")+"]"}else g[S].value=g[S].defaultValue;g[S].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var ve,ce=[];for(ve in g)!0===g[ve].explicitSet&&ce.push("name"===g[ve].type?"/"+ve+" /"+g[ve].value:"/"+ve+" "+g[ve].value);0!==ce.length&&this.internal.write("/ViewerPreferences\n<<\n"+ce.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=g,this},
/** ====================================================================
         * @license
         * jsPDF XMP metadata plugin
         * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
         *
         * Permission is hereby granted, free of charge, to any person obtaining
         * a copy of this software and associated documentation files (the
         * "Software"), to deal in the Software without restriction, including
         * without limitation the rights to use, copy, modify, merge, publish,
         * distribute, sublicense, and/or sell copies of the Software, and to
         * permit persons to whom the Software is furnished to do so, subject to
         * the following conditions:
         *
         * The above copyright notice and this permission notice shall be
         * included in all copies or substantial portions of the Software.
         *
         * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
         * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
         * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
         * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
         * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
         * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
         * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
         * ====================================================================
         */
function(_){var p=function(){var b='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',S=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),x=unescape(encodeURIComponent(b)),M=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),P=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),O=unescape(encodeURIComponent("</x:xmpmeta>")),H=x.length+M.length+P.length+S.length+O.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+H+" >>"),this.internal.write("stream"),this.internal.write(S+x+M+P+O),this.internal.write("endstream"),this.internal.write("endobj")},g=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};_.addMetadata=function(b,S){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:b,namespaceuri:S||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",g),this.internal.events.subscribe("postPutResources",p)),this}}(Pr.API),function(_){var p=_.API,g=p.pdfEscape16=function(x,M){for(var P,O=M.metadata.Unicode.widths,H=["","0","00","000","0000"],Y=[""],Q=0,re=x.length;Q<re;++Q){if(P=M.metadata.characterToGlyph(x.charCodeAt(Q)),M.metadata.glyIdsUsed.push(P),M.metadata.toUnicode[P]=x.charCodeAt(Q),-1==O.indexOf(P)&&(O.push(P),O.push([parseInt(M.metadata.widthOfGlyph(P),10)])),"0"==P)return Y.join("");P=P.toString(16),Y.push(H[4-P.length],P)}return Y.join("")},b=function(x){var M,P,O,H,Y,Q,re;for(Y="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",O=[],Q=0,re=(P=Object.keys(x).sort(function(V,ve){return V-ve})).length;Q<re;Q++)M=P[Q],O.length>=100&&(Y+="\n"+O.length+" beginbfchar\n"+O.join("\n")+"\nendbfchar",O=[]),null!=x[M]&&"function"==typeof x[M].toString&&(H=("0000"+x[M].toString(16)).slice(-4),M=("0000"+(+M).toString(16)).slice(-4),O.push("<"+M+"><"+H+">"));return O.length&&(Y+="\n"+O.length+" beginbfchar\n"+O.join("\n")+"\nendbfchar\n"),Y+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};p.events.push(["putFont",function(x){!function(M){var P=M.font,O=M.out,H=M.newObject,Y=M.putStream;if(P.metadata instanceof _.API.TTFFont&&"Identity-H"===P.encoding){for(var Q=P.metadata.Unicode.widths,re=P.metadata.subset.encode(P.metadata.glyIdsUsed,1),V="",ve=0;ve<re.length;ve++)V+=String.fromCharCode(re[ve]);var ce=H();Y({data:V,addLength1:!0,objectId:ce}),O("endobj");var be=H();Y({data:b(P.metadata.toUnicode),addLength1:!0,objectId:be}),O("endobj");var se=H();O("<<"),O("/Type /FontDescriptor"),O("/FontName /"+Ic(P.fontName)),O("/FontFile2 "+ce+" 0 R"),O("/FontBBox "+_.API.PDFObject.convert(P.metadata.bbox)),O("/Flags "+P.metadata.flags),O("/StemV "+P.metadata.stemV),O("/ItalicAngle "+P.metadata.italicAngle),O("/Ascent "+P.metadata.ascender),O("/Descent "+P.metadata.decender),O("/CapHeight "+P.metadata.capHeight),O(">>"),O("endobj");var me=H();O("<<"),O("/Type /Font"),O("/BaseFont /"+Ic(P.fontName)),O("/FontDescriptor "+se+" 0 R"),O("/W "+_.API.PDFObject.convert(Q)),O("/CIDToGIDMap /Identity"),O("/DW 1000"),O("/Subtype /CIDFontType2"),O("/CIDSystemInfo"),O("<<"),O("/Supplement 0"),O("/Registry (Adobe)"),O("/Ordering ("+P.encoding+")"),O(">>"),O(">>"),O("endobj"),P.objectNumber=H(),O("<<"),O("/Type /Font"),O("/Subtype /Type0"),O("/ToUnicode "+be+" 0 R"),O("/BaseFont /"+Ic(P.fontName)),O("/Encoding /"+P.encoding),O("/DescendantFonts ["+me+" 0 R]"),O(">>"),O("endobj"),P.isAlreadyPutted=!0}}(x)}]),p.events.push(["putFont",function(x){!function(M){var P=M.font,O=M.out,H=M.newObject,Y=M.putStream;if(P.metadata instanceof _.API.TTFFont&&"WinAnsiEncoding"===P.encoding){for(var Q=P.metadata.rawData,re="",V=0;V<Q.length;V++)re+=String.fromCharCode(Q[V]);var ve=H();Y({data:re,addLength1:!0,objectId:ve}),O("endobj");var ce=H();Y({data:b(P.metadata.toUnicode),addLength1:!0,objectId:ce}),O("endobj");var be=H();O("<<"),O("/Descent "+P.metadata.decender),O("/CapHeight "+P.metadata.capHeight),O("/StemV "+P.metadata.stemV),O("/Type /FontDescriptor"),O("/FontFile2 "+ve+" 0 R"),O("/Flags 96"),O("/FontBBox "+_.API.PDFObject.convert(P.metadata.bbox)),O("/FontName /"+Ic(P.fontName)),O("/ItalicAngle "+P.metadata.italicAngle),O("/Ascent "+P.metadata.ascender),O(">>"),O("endobj"),P.objectNumber=H();for(var se=0;se<P.metadata.hmtx.widths.length;se++)P.metadata.hmtx.widths[se]=parseInt(P.metadata.hmtx.widths[se]*(1e3/P.metadata.head.unitsPerEm));O("<</Subtype/TrueType/Type/Font/ToUnicode "+ce+" 0 R/BaseFont/"+Ic(P.fontName)+"/FontDescriptor "+be+" 0 R/Encoding/"+P.encoding+" /FirstChar 29 /LastChar 255 /Widths "+_.API.PDFObject.convert(P.metadata.hmtx.widths)+">>"),O("endobj"),P.isAlreadyPutted=!0}}(x)}]);var S=function(x){var M,P=x.text||"",O=x.x,H=x.y,Y=x.options||{},Q=x.mutex||{},re=Q.pdfEscape,V=Q.activeFontKey,ve=Q.fonts,ce=V,be="",se=0,me="",Be=ve[ce].encoding;if("Identity-H"!==ve[ce].encoding)return{text:P,x:O,y:H,options:Y,mutex:Q};for(me=P,ce=V,Array.isArray(P)&&(me=P[0]),se=0;se<me.length;se+=1)ve[ce].metadata.hasOwnProperty("cmap")&&(M=ve[ce].metadata.cmap.unicode.codeMap[me[se].charCodeAt(0)]),M||me[se].charCodeAt(0)<256&&ve[ce].metadata.hasOwnProperty("Unicode")?be+=me[se]:be+="";var st="";return parseInt(ce.slice(1))<14||"WinAnsiEncoding"===Be?st=re(be,ce).split("").map(function(At){return At.charCodeAt(0).toString(16)}).join(""):"Identity-H"===Be&&(st=g(be,ve[ce])),Q.isHex=!0,{text:st,x:O,y:H,options:Y,mutex:Q}};p.events.push(["postProcessText",function(x){var M=x.text||"",P=[],O={text:M,x:x.x,y:x.y,options:x.options,mutex:x.mutex};if(Array.isArray(M)){var H=0;for(H=0;H<M.length;H+=1)Array.isArray(M[H])&&3===M[H].length?P.push([S(Object.assign({},O,{text:M[H][0]})).text,M[H][1],M[H][2]]):P.push(S(Object.assign({},O,{text:M[H]})).text);x.text=P}else x.text=S(Object.assign({},O,{text:M})).text}])}(Pr),
/**
         * @license
         * jsPDF virtual FileSystem functionality
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(_){var p=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};_.existsFileInVFS=function(g){return p.call(this),void 0!==this.internal.vFS[g]},_.addFileToVFS=function(g,b){return p.call(this),this.internal.vFS[g]=b,this},_.getFileFromVFS=function(g){return p.call(this),void 0!==this.internal.vFS[g]?this.internal.vFS[g]:null}}(Pr.API),
/**
         * @license
         * Unicode Bidi Engine based on the work of Alex Shensis (@asthensis)
         * MIT License
         */
function(_){_.__bidiEngine__=_.prototype.__bidiEngine__=function(b){var S,x,M,P,O,H,Y,Q=p,re=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],V=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],ve={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},ce={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},be=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],se=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),me=!1,Be=0;this.__bidiEngine__={};var st=function(fe){var de=fe.charCodeAt(),He=de>>8,Ne=ce[He];return void 0!==Ne?Q[256*Ne+(255&de)]:252===He||253===He?"AL":se.test(He)?"L":8===He?"R":"N"},At=function(fe){for(var de,He=0;He<fe.length;He++){if("L"===(de=st(fe.charAt(He))))return!1;if("R"===de)return!0}return!1},ln=function(fe,de,He,Ne){var Tt,St,zt,gt,Zt=de[Ne];switch(Zt){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":me=!1;break;case"N":case"AN":break;case"EN":me&&(Zt="AN");break;case"AL":me=!0,Zt="R";break;case"WS":case"BN":Zt="N";break;case"CS":Ne<1||Ne+1>=de.length||"EN"!==(Tt=He[Ne-1])&&"AN"!==Tt||"EN"!==(St=de[Ne+1])&&"AN"!==St?Zt="N":me&&(St="AN"),Zt=St===Tt?St:"N";break;case"ES":Zt="EN"===(Tt=Ne>0?He[Ne-1]:"B")&&Ne+1<de.length&&"EN"===de[Ne+1]?"EN":"N";break;case"ET":if(Ne>0&&"EN"===He[Ne-1]){Zt="EN";break}if(me){Zt="N";break}for(zt=Ne+1,gt=de.length;zt<gt&&"ET"===de[zt];)zt++;Zt=zt<gt&&"EN"===de[zt]?"EN":"N";break;case"NSM":if(M&&!P){for(gt=de.length,zt=Ne+1;zt<gt&&"NSM"===de[zt];)zt++;if(zt<gt){var Wt=fe[Ne];if(Tt=de[zt],(Wt>=1425&&Wt<=2303||64286===Wt)&&("R"===Tt||"AL"===Tt)){Zt="R";break}}}Zt=Ne<1||"B"===(Tt=de[Ne-1])?"N":He[Ne-1];break;case"B":me=!1,S=!0,Zt=Be;break;case"S":x=!0,Zt="N"}return Zt},nt=function(fe,de,He){var Ne=fe.split("");return He&&Oe(Ne,He,{hiLevel:Be}),Ne.reverse(),de&&de.reverse(),Ne.join("")},Oe=function(fe,de,He){var Ne,Tt,St,zt,gt,Zt=-1,Wt=fe.length,Yn=0,J=[],we=Be?V:re,Te=[];for(me=!1,S=!1,x=!1,Tt=0;Tt<Wt;Tt++)Te[Tt]=st(fe[Tt]);for(St=0;St<Wt;St++){if(gt=Yn,J[St]=ln(fe,Te,J,St),Ne=240&(Yn=we[gt][ve[J[St]]]),de[St]=zt=we[Yn&=15][5],Ne>0)if(16===Ne){for(Tt=Zt;Tt<St;Tt++)de[Tt]=1;Zt=-1}else Zt=-1;if(we[Yn][6])-1===Zt&&(Zt=St);else if(Zt>-1){for(Tt=Zt;Tt<St;Tt++)de[Tt]=zt;Zt=-1}"B"===Te[St]&&(de[St]=0),He.hiLevel|=zt}x&&function($e,Xe,ft){for(var ot=0;ot<ft;ot++)if("S"===$e[ot]){Xe[ot]=Be;for(var bt=ot-1;bt>=0&&"WS"===$e[bt];bt--)Xe[bt]=Be}}(Te,de,Wt)},Kt=function(fe,de,He,Ne,Tt){if(!(Tt.hiLevel<fe)){if(1===fe&&1===Be&&!S)return de.reverse(),void(He&&He.reverse());for(var St,zt,gt,Zt,Wt=de.length,Yn=0;Yn<Wt;){if(Ne[Yn]>=fe){for(gt=Yn+1;gt<Wt&&Ne[gt]>=fe;)gt++;for(Zt=Yn,zt=gt-1;Zt<zt;Zt++,zt--)St=de[Zt],de[Zt]=de[zt],de[zt]=St,He&&(St=He[Zt],He[Zt]=He[zt],He[zt]=St);Yn=gt}Yn++}}},Yt=function(fe,de,He){var Ne=fe.split(""),Tt={hiLevel:Be};return He||(He=[]),Oe(Ne,He,Tt),function(St,zt,gt){if(0!==gt.hiLevel&&Y)for(var Zt,Wt=0;Wt<St.length;Wt++)1===zt[Wt]&&(Zt=be.indexOf(St[Wt]))>=0&&(St[Wt]=be[Zt+1])}(Ne,He,Tt),Kt(2,Ne,de,He,Tt),Kt(1,Ne,de,He,Tt),Ne.join("")};return this.__bidiEngine__.doBidiReorder=function(fe,de,He){if(function(Tt,St){if(St)for(var zt=0;zt<Tt.length;zt++)St[zt]=zt;void 0===P&&(P=At(Tt)),void 0===H&&(H=At(Tt))}(fe,de),M||!O||H)if(M&&O&&P^H)Be=P?1:0,fe=nt(fe,de,He);else if(!M&&O&&H)Be=P?1:0,fe=Yt(fe,de,He),fe=nt(fe,de);else if(!M||P||O||H){if(M&&!O&&P^H)fe=nt(fe,de),P?(Be=0,fe=Yt(fe,de,He)):(Be=1,fe=Yt(fe,de,He),fe=nt(fe,de));else if(M&&P&&!O&&H)Be=1,fe=Yt(fe,de,He),fe=nt(fe,de);else if(!M&&!O&&P^H){var Ne=Y;P?(Be=1,fe=Yt(fe,de,He),Be=0,Y=!1,fe=Yt(fe,de,He),Y=Ne):(Be=0,fe=Yt(fe,de,He),fe=nt(fe,de),Be=1,Y=!1,fe=Yt(fe,de,He),Y=Ne,fe=nt(fe,de))}}else Be=0,fe=Yt(fe,de,He);else Be=P?1:0,fe=Yt(fe,de,He);return fe},this.__bidiEngine__.setOptions=function(fe){fe&&(M=fe.isInputVisual,O=fe.isOutputVisual,P=fe.isInputRtl,H=fe.isOutputRtl,Y=fe.isSymmetricSwapping)},this.__bidiEngine__.setOptions(b),this.__bidiEngine__};var p=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],g=new _.__bidiEngine__({isInputVisual:!0});_.API.events.push(["postProcessText",function(b){var S=b.text,x=b.options||{},M=[];if(x.isInputVisual="boolean"!=typeof x.isInputVisual||x.isInputVisual,g.setOptions(x),"[object Array]"===Object.prototype.toString.call(S)){var P=0;for(M=[],P=0;P<S.length;P+=1)"[object Array]"===Object.prototype.toString.call(S[P])?M.push([g.doBidiReorder(S[P][0]),S[P][1],S[P][2]]):M.push([g.doBidiReorder(S[P])]);b.text=M}else b.text=g.doBidiReorder(S);g.setOptions({isInputVisual:!0})}])}(Pr),Pr.API.TTFFont=function(){function _(p){var g;if(this.rawData=p,g=this.contents=new oi(p),this.contents.pos=4,"ttcf"===g.readString(4))throw new Error("TTCF not supported.");g.pos=0,this.parse(),this.subset=new di(this),this.registerTTF()}return _.open=function(p){return new _(p)},_.prototype.parse=function(){return this.directory=new ns(this.contents),this.head=new Os(this),this.name=new Vo(this),this.cmap=new rp(this),this.toUnicode={},this.hhea=new ip(this),this.maxp=new ql(this),this.hmtx=new yu(this),this.post=new ar(this),this.os2=new Oc(this),this.loca=new ap(this),this.glyf=new od(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},_.prototype.registerTTF=function(){var g,b,S,x;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var M,P,O,H;for(H=[],M=0,P=(O=this.bbox).length;M<P;M++)H.push(Math.round(O[M]*this.scaleFactor));return H}.call(this),this.stemV=0,this.post.exists?(b=255&(S=this.post.italic_angle),32768&(g=S>>16)&&(g=-(1+(65535^g))),this.italicAngle=+(g+"."+b)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(x=this.familyClass)||2===x||3===x||4===x||5===x||7===x,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},_.prototype.characterToGlyph=function(p){var g;return(null!=(g=this.cmap.unicode)?g.codeMap[p]:void 0)||0},_.prototype.widthOfGlyph=function(p){var g;return g=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(p).advance*g},_.prototype.widthOfString=function(p,g,b){var S,x,M,P;for(M=0,x=0,P=(p=""+p).length;0<=P?x<P:x>P;x=0<=P?++x:--x)S=p.charCodeAt(x),M+=this.widthOfGlyph(this.characterToGlyph(S))+b*(1e3/g)||0;return M*(g/1e3)},_.prototype.lineHeight=function(p,g){return null==g&&(g=!1),(this.ascender+(g?this.lineGap:0)-this.decender)/1e3*p},_}();var Eo,oi=function(){function _(p){this.data=p??[],this.pos=0,this.length=this.data.length}return _.prototype.readByte=function(){return this.data[this.pos++]},_.prototype.writeByte=function(p){return this.data[this.pos++]=p},_.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},_.prototype.writeUInt32=function(p){return this.writeByte(p>>>24&255),this.writeByte(p>>16&255),this.writeByte(p>>8&255),this.writeByte(255&p)},_.prototype.readInt32=function(){var p;return(p=this.readUInt32())>=2147483648?p-4294967296:p},_.prototype.writeInt32=function(p){return p<0&&(p+=4294967296),this.writeUInt32(p)},_.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},_.prototype.writeUInt16=function(p){return this.writeByte(p>>8&255),this.writeByte(255&p)},_.prototype.readInt16=function(){var p;return(p=this.readUInt16())>=32768?p-65536:p},_.prototype.writeInt16=function(p){return p<0&&(p+=65536),this.writeUInt16(p)},_.prototype.readString=function(p){var g,b;for(b=[],g=0;0<=p?g<p:g>p;g=0<=p?++g:--g)b[g]=String.fromCharCode(this.readByte());return b.join("")},_.prototype.writeString=function(p){var g,b,S;for(S=[],g=0,b=p.length;0<=b?g<b:g>b;g=0<=b?++g:--g)S.push(this.writeByte(p.charCodeAt(g)));return S},_.prototype.readShort=function(){return this.readInt16()},_.prototype.writeShort=function(p){return this.writeInt16(p)},_.prototype.readLongLong=function(){var p,g,b,S,x,M,P,O;return p=this.readByte(),g=this.readByte(),b=this.readByte(),S=this.readByte(),x=this.readByte(),M=this.readByte(),P=this.readByte(),O=this.readByte(),128&p?-1*(72057594037927940*(255^p)+281474976710656*(255^g)+1099511627776*(255^b)+4294967296*(255^S)+16777216*(255^x)+65536*(255^M)+256*(255^P)+(255^O)+1):72057594037927940*p+281474976710656*g+1099511627776*b+4294967296*S+16777216*x+65536*M+256*P+O},_.prototype.writeLongLong=function(p){var g,b;return g=Math.floor(p/4294967296),b=4294967295&p,this.writeByte(g>>24&255),this.writeByte(g>>16&255),this.writeByte(g>>8&255),this.writeByte(255&g),this.writeByte(b>>24&255),this.writeByte(b>>16&255),this.writeByte(b>>8&255),this.writeByte(255&b)},_.prototype.readInt=function(){return this.readInt32()},_.prototype.writeInt=function(p){return this.writeInt32(p)},_.prototype.read=function(p){var g,b;for(g=[],b=0;0<=p?b<p:b>p;b=0<=p?++b:--b)g.push(this.readByte());return g},_.prototype.write=function(p){var b,S,x;for(x=[],b=0,S=p.length;b<S;b++)x.push(this.writeByte(p[b]));return x},_}(),ns=function(){var _;function p(g){var b,S,x;for(this.scalarType=g.readInt(),this.tableCount=g.readShort(),this.searchRange=g.readShort(),this.entrySelector=g.readShort(),this.rangeShift=g.readShort(),this.tables={},S=0,x=this.tableCount;0<=x?S<x:S>x;S=0<=x?++S:--S)b={tag:g.readString(4),checksum:g.readInt(),offset:g.readInt(),length:g.readInt()},this.tables[b.tag]=b}return p.prototype.encode=function(g){var b,S,M,P,O,H,Y,Q,re,V,ve,ce;for(ce in V=Object.keys(g).length,O=Math.log(2),Q=16*Math.floor(Math.log(V)/O),M=Math.floor(Q/O),Y=16*V-Q,(S=new oi).writeInt(this.scalarType),S.writeShort(V),S.writeShort(Q),S.writeShort(M),S.writeShort(Y),H=S.pos+16*V,P=null,ve=[],g)for(re=g[ce],S.writeString(ce),S.writeInt(_(re)),S.writeInt(H),S.writeInt(re.length),ve=ve.concat(re),"head"===ce&&(P=H),H+=re.length;H%4;)ve.push(0),H++;return S.write(ve),b=2981146554-_(S.data),S.pos=P+8,S.writeUInt32(b),S.data},_=function(g){var b,S,x,M;for(g=Va.call(g);g.length%4;)g.push(0);for(x=new oi(g),S=0,b=0,M=g.length;b<M;b=b+=4)S+=x.readUInt32();return 4294967295&S},p}(),Ps={}.hasOwnProperty,_s=function(_,p){for(var g in p)Ps.call(p,g)&&(_[g]=p[g]);function b(){this.constructor=_}return b.prototype=p.prototype,_.prototype=new b,_.__super__=p.prototype,_};Eo=function(){function _(p){var g;this.file=p,this.exists=!!(g=this.file.directory.tables[this.tag]),g&&(this.offset=g.offset,this.length=g.length,this.parse(this.file.contents))}return _.prototype.parse=function(){},_.prototype.encode=function(){},_.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},_}();var Os=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="head",p.prototype.parse=function(g){return g.pos=this.offset,this.version=g.readInt(),this.revision=g.readInt(),this.checkSumAdjustment=g.readInt(),this.magicNumber=g.readInt(),this.flags=g.readShort(),this.unitsPerEm=g.readShort(),this.created=g.readLongLong(),this.modified=g.readLongLong(),this.xMin=g.readShort(),this.yMin=g.readShort(),this.xMax=g.readShort(),this.yMax=g.readShort(),this.macStyle=g.readShort(),this.lowestRecPPEM=g.readShort(),this.fontDirectionHint=g.readShort(),this.indexToLocFormat=g.readShort(),this.glyphDataFormat=g.readShort()},p.prototype.encode=function(g){var b;return(b=new oi).writeInt(this.version),b.writeInt(this.revision),b.writeInt(this.checkSumAdjustment),b.writeInt(this.magicNumber),b.writeShort(this.flags),b.writeShort(this.unitsPerEm),b.writeLongLong(this.created),b.writeLongLong(this.modified),b.writeShort(this.xMin),b.writeShort(this.yMin),b.writeShort(this.xMax),b.writeShort(this.yMax),b.writeShort(this.macStyle),b.writeShort(this.lowestRecPPEM),b.writeShort(this.fontDirectionHint),b.writeShort(g),b.writeShort(this.glyphDataFormat),b.data},p}(),np=function(){function _(p,g){var b,S,x,M,P,O,H,Y,Q,re,V,ve,ce,be,se,me,Be;switch(this.platformID=p.readUInt16(),this.encodingID=p.readShort(),this.offset=g+p.readInt(),Q=p.pos,p.pos=this.offset,this.format=p.readUInt16(),this.length=p.readUInt16(),this.language=p.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(O=0;O<256;++O)this.codeMap[O]=p.readByte();break;case 4:for(V=p.readUInt16(),re=V/2,p.pos+=6,x=function(){var st,At;for(At=[],O=st=0;0<=re?st<re:st>re;O=0<=re?++st:--st)At.push(p.readUInt16());return At}(),p.pos+=2,ce=function(){var st,At;for(At=[],O=st=0;0<=re?st<re:st>re;O=0<=re?++st:--st)At.push(p.readUInt16());return At}(),H=function(){var st,At;for(At=[],O=st=0;0<=re?st<re:st>re;O=0<=re?++st:--st)At.push(p.readUInt16());return At}(),Y=function(){var st,At;for(At=[],O=st=0;0<=re?st<re:st>re;O=0<=re?++st:--st)At.push(p.readUInt16());return At}(),S=(this.length-p.pos+this.offset)/2,P=function(){var st,At;for(At=[],O=st=0;0<=S?st<S:st>S;O=0<=S?++st:--st)At.push(p.readUInt16());return At}(),O=se=0,Be=x.length;se<Be;O=++se)for(be=x[O],b=me=ve=ce[O];ve<=be?me<=be:me>=be;b=ve<=be?++me:--me)0===Y[O]?M=b+H[O]:0!==(M=P[Y[O]/2+(b-ve)-(re-O)]||0)&&(M+=H[O]),this.codeMap[b]=65535&M}p.pos=Q}return _.encode=function(p,g){var b,S,x,M,P,O,H,Y,Q,re,V,ve,ce,be,se,me,Be,At,ln,nt,Oe,Kt,Yt,fe,de,He,Ne,Tt,St,zt,gt,Zt,Wt,Yn,J,we,Te,$e,Xe,ft,ot,bt,Rn,gn,Xn;switch(Ne=new oi,M=Object.keys(p).sort(function(tr,jr){return tr-jr}),g){case"macroman":for(ce=0,be=function(){var tr=[];for(ve=0;ve<256;++ve)tr.push(0);return tr}(),me={0:0},x={},Tt=0,Zt=M.length;Tt<Zt;Tt++)null==me[bt=p[S=M[Tt]]]&&(me[bt]=++ce),x[S]={old:p[S],new:me[p[S]]},be[S]=me[p[S]];return Ne.writeUInt16(1),Ne.writeUInt16(0),Ne.writeUInt32(12),Ne.writeUInt16(0),Ne.writeUInt16(262),Ne.writeUInt16(0),Ne.write(be),{charMap:x,subtable:Ne.data,maxGlyphID:ce+1};case"unicode":for(de=[],Q=[],Be=0,me={},b={},se=H=null,St=0,Wt=M.length;St<Wt;St++)null==me[At=p[S=M[St]]]&&(me[At]=++Be),b[S]={old:At,new:me[At]},P=me[At]-S,null!=se&&P===H||(se&&Q.push(se),de.push(S),H=P),se=S;for(se&&Q.push(se),Q.push(65535),de.push(65535),Yt=2*(Kt=de.length),Oe=2*Math.pow(Math.log(Kt)/Math.LN2,2),re=Math.log(Oe/2)/Math.LN2,nt=2*Kt-Oe,O=[],ln=[],V=[],ve=zt=0,Yn=de.length;zt<Yn;ve=++zt){if(Y=Q[ve],65535===(fe=de[ve])){O.push(0),ln.push(0);break}if(fe-(He=b[fe].new)>=32768)for(O.push(0),ln.push(2*(V.length+Kt-ve)),S=gt=fe;fe<=Y?gt<=Y:gt>=Y;S=fe<=Y?++gt:--gt)V.push(b[S].new);else O.push(He-fe),ln.push(0)}for(Ne.writeUInt16(3),Ne.writeUInt16(1),Ne.writeUInt32(12),Ne.writeUInt16(4),Ne.writeUInt16(16+8*Kt+2*V.length),Ne.writeUInt16(0),Ne.writeUInt16(Yt),Ne.writeUInt16(Oe),Ne.writeUInt16(re),Ne.writeUInt16(nt),ft=0,J=Q.length;ft<J;ft++)Ne.writeUInt16(S=Q[ft]);for(Ne.writeUInt16(0),ot=0,we=de.length;ot<we;ot++)Ne.writeUInt16(S=de[ot]);for(Rn=0,Te=O.length;Rn<Te;Rn++)Ne.writeUInt16(P=O[Rn]);for(gn=0,$e=ln.length;gn<$e;gn++)Ne.writeUInt16(ln[gn]);for(Xn=0,Xe=V.length;Xn<Xe;Xn++)Ne.writeUInt16(ce=V[Xn]);return{charMap:b,subtable:Ne.data,maxGlyphID:Be+1}}},_}(),rp=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="cmap",p.prototype.parse=function(g){var b,S,x;for(g.pos=this.offset,this.version=g.readUInt16(),x=g.readUInt16(),this.tables=[],this.unicode=null,S=0;0<=x?S<x:S>x;S=0<=x?++S:--S)b=new np(g,this.offset),this.tables.push(b),b.isUnicode&&null==this.unicode&&(this.unicode=b);return!0},p.encode=function(g,b){var S,x;return null==b&&(b="macroman"),S=np.encode(g,b),(x=new oi).writeUInt16(0),x.writeUInt16(1),S.table=x.data.concat(S.subtable),S},p}(),ip=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="hhea",p.prototype.parse=function(g){return g.pos=this.offset,this.version=g.readInt(),this.ascender=g.readShort(),this.decender=g.readShort(),this.lineGap=g.readShort(),this.advanceWidthMax=g.readShort(),this.minLeftSideBearing=g.readShort(),this.minRightSideBearing=g.readShort(),this.xMaxExtent=g.readShort(),this.caretSlopeRise=g.readShort(),this.caretSlopeRun=g.readShort(),this.caretOffset=g.readShort(),g.pos+=8,this.metricDataFormat=g.readShort(),this.numberOfMetrics=g.readUInt16()},p}(),Oc=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="OS/2",p.prototype.parse=function(g){if(g.pos=this.offset,this.version=g.readUInt16(),this.averageCharWidth=g.readShort(),this.weightClass=g.readUInt16(),this.widthClass=g.readUInt16(),this.type=g.readShort(),this.ySubscriptXSize=g.readShort(),this.ySubscriptYSize=g.readShort(),this.ySubscriptXOffset=g.readShort(),this.ySubscriptYOffset=g.readShort(),this.ySuperscriptXSize=g.readShort(),this.ySuperscriptYSize=g.readShort(),this.ySuperscriptXOffset=g.readShort(),this.ySuperscriptYOffset=g.readShort(),this.yStrikeoutSize=g.readShort(),this.yStrikeoutPosition=g.readShort(),this.familyClass=g.readShort(),this.panose=function(){var b,S;for(S=[],b=0;b<10;++b)S.push(g.readByte());return S}(),this.charRange=function(){var b,S;for(S=[],b=0;b<4;++b)S.push(g.readInt());return S}(),this.vendorID=g.readString(4),this.selection=g.readShort(),this.firstCharIndex=g.readShort(),this.lastCharIndex=g.readShort(),this.version>0&&(this.ascent=g.readShort(),this.descent=g.readShort(),this.lineGap=g.readShort(),this.winAscent=g.readShort(),this.winDescent=g.readShort(),this.codePageRange=function(){var b,S;for(S=[],b=0;b<2;b=++b)S.push(g.readInt());return S}(),this.version>1))return this.xHeight=g.readShort(),this.capHeight=g.readShort(),this.defaultChar=g.readShort(),this.breakChar=g.readShort(),this.maxContext=g.readShort()},p}(),ar=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="post",p.prototype.parse=function(g){var b,S,x;switch(g.pos=this.offset,this.format=g.readInt(),this.italicAngle=g.readInt(),this.underlinePosition=g.readShort(),this.underlineThickness=g.readShort(),this.isFixedPitch=g.readInt(),this.minMemType42=g.readInt(),this.maxMemType42=g.readInt(),this.minMemType1=g.readInt(),this.maxMemType1=g.readInt(),this.format){case 65536:case 196608:break;case 131072:var M;for(S=g.readUInt16(),this.glyphNameIndex=[],M=0;0<=S?M<S:M>S;M=0<=S?++M:--M)this.glyphNameIndex.push(g.readUInt16());for(this.names=[],x=[];g.pos<this.offset+this.length;)b=g.readByte(),x.push(this.names.push(g.readString(b)));return x;case 151552:return S=g.readUInt16(),this.offsets=g.read(S);case 262144:return this.map=function(){var P,O,H;for(H=[],M=P=0,O=this.file.maxp.numGlyphs;0<=O?P<O:P>O;M=0<=O?++P:--P)H.push(g.readUInt32());return H}.call(this)}},p}(),ui=function(_,p){this.raw=_,this.length=_.length,this.platformID=p.platformID,this.encodingID=p.encodingID,this.languageID=p.languageID},Vo=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="name",p.prototype.parse=function(g){var b,S,x,M,P,O,H,Y,Q,re,V;for(g.pos=this.offset,g.readShort(),b=g.readShort(),O=g.readShort(),S=[],M=0;0<=b?M<b:M>b;M=0<=b?++M:--M)S.push({platformID:g.readShort(),encodingID:g.readShort(),languageID:g.readShort(),nameID:g.readShort(),length:g.readShort(),offset:this.offset+O+g.readShort()});for(H={},M=Q=0,re=S.length;Q<re;M=++Q)g.pos=(x=S[M]).offset,Y=g.readString(x.length),P=new ui(Y,x),null==H[V=x.nameID]&&(H[V]=[]),H[x.nameID].push(P);this.strings=H,this.copyright=H[0],this.fontFamily=H[1],this.fontSubfamily=H[2],this.uniqueSubfamily=H[3],this.fontName=H[4],this.version=H[5];try{this.postscriptName=H[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=H[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=H[7],this.manufacturer=H[8],this.designer=H[9],this.description=H[10],this.vendorUrl=H[11],this.designerUrl=H[12],this.license=H[13],this.licenseUrl=H[14],this.preferredFamily=H[15],this.preferredSubfamily=H[17],this.compatibleFull=H[18],this.sampleText=H[19]},p}(),ql=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="maxp",p.prototype.parse=function(g){return g.pos=this.offset,this.version=g.readInt(),this.numGlyphs=g.readUInt16(),this.maxPoints=g.readUInt16(),this.maxContours=g.readUInt16(),this.maxCompositePoints=g.readUInt16(),this.maxComponentContours=g.readUInt16(),this.maxZones=g.readUInt16(),this.maxTwilightPoints=g.readUInt16(),this.maxStorage=g.readUInt16(),this.maxFunctionDefs=g.readUInt16(),this.maxInstructionDefs=g.readUInt16(),this.maxStackElements=g.readUInt16(),this.maxSizeOfInstructions=g.readUInt16(),this.maxComponentElements=g.readUInt16(),this.maxComponentDepth=g.readUInt16()},p}(),yu=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="hmtx",p.prototype.parse=function(g){var b,S,x,P,O,H;for(g.pos=this.offset,this.metrics=[],b=0,O=this.file.hhea.numberOfMetrics;0<=O?b<O:b>O;b=0<=O?++b:--b)this.metrics.push({advance:g.readUInt16(),lsb:g.readInt16()});for(x=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var Y,Q;for(Q=[],b=Y=0;0<=x?Y<x:Y>x;b=0<=x?++Y:--Y)Q.push(g.readInt16());return Q}(),this.widths=function(){var Y,Q,re,V;for(V=[],Y=0,Q=(re=this.metrics).length;Y<Q;Y++)V.push(re[Y].advance);return V}.call(this),S=this.widths[this.widths.length-1],H=[],b=P=0;0<=x?P<x:P>x;b=0<=x?++P:--P)H.push(this.widths.push(S));return H},p.prototype.forGlyph=function(g){return g in this.metrics?this.metrics[g]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[g-this.metrics.length]}},p}(),Va=[].slice,od=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="glyf",p.prototype.parse=function(){return this.cache={}},p.prototype.glyphFor=function(g){var b,S,x,M,P,O,H,Y,Q,re;return g in this.cache?this.cache[g]:(b=this.file.contents,S=(M=this.file.loca).indexOf(g),0===(x=M.lengthOf(g))?this.cache[g]=null:(b.pos=this.offset+S,P=(O=new oi(b.read(x))).readShort(),Y=O.readShort(),re=O.readShort(),H=O.readShort(),Q=O.readShort(),this.cache[g]=-1===P?new op(O,Y,re,H,Q):new Uo(O,P,Y,re,H,Q),this.cache[g]))},p.prototype.encode=function(g,b,S){var x,M,P,O,H;for(P=[],M=[],O=0,H=b.length;O<H;O++)x=g[b[O]],M.push(P.length),x&&(P=P.concat(x.encode(S)));return M.push(P.length),{table:P,offsets:M}},p}(),Uo=function(){function _(p,g,b,S,x,M){this.raw=p,this.numberOfContours=g,this.xMin=b,this.yMin=S,this.xMax=x,this.yMax=M,this.compound=!1}return _.prototype.encode=function(){return this.raw.data},_}(),op=function(){function _(p,g,b,S,x){var M,P;for(this.raw=p,this.xMin=g,this.yMin=b,this.xMax=S,this.yMax=x,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],M=this.raw;P=M.readShort(),this.glyphOffsets.push(M.pos),this.glyphIDs.push(M.readUInt16()),32&P;)M.pos+=1&P?4:2,128&P?M.pos+=8:64&P?M.pos+=4:8&P&&(M.pos+=2)}return _.prototype.encode=function(){var p,g,b;for(g=new oi(Va.call(this.raw.data)),p=0,b=this.glyphIDs.length;p<b;++p)g.pos=this.glyphOffsets[p];return g.data},_}(),ap=function(_){function p(){return p.__super__.constructor.apply(this,arguments)}return _s(p,Eo),p.prototype.tag="loca",p.prototype.parse=function(g){var S;return g.pos=this.offset,this.offsets=0===this.file.head.indexToLocFormat?function(){var x,M;for(M=[],S=0,x=this.length;S<x;S+=2)M.push(2*g.readUInt16());return M}.call(this):function(){var x,M;for(M=[],S=0,x=this.length;S<x;S+=4)M.push(g.readUInt32());return M}.call(this)},p.prototype.indexOf=function(g){return this.offsets[g]},p.prototype.lengthOf=function(g){return this.offsets[g+1]-this.offsets[g]},p.prototype.encode=function(g,b){for(var S=new Uint32Array(this.offsets.length),x=0,M=0,P=0;P<S.length;++P)if(S[P]=x,M<b.length&&b[M]==P){++M,S[P]=x;var H=this.offsets[P+1]-this.offsets[P];H>0&&(x+=H)}for(var Y=new Array(4*S.length),Q=0;Q<S.length;++Q)Y[4*Q+3]=255&S[Q],Y[4*Q+2]=(65280&S[Q])>>8,Y[4*Q+1]=(16711680&S[Q])>>16,Y[4*Q]=(4278190080&S[Q])>>24;return Y},p}(),di=function(){function _(p){this.font=p,this.subset={},this.unicodes={},this.next=33}return _.prototype.generateCmap=function(){var p,g,S,x;for(g in S=this.font.cmap.tables[0].codeMap,p={},x=this.subset)p[g]=S[x[g]];return p},_.prototype.glyphsFor=function(p){var g,b,S,x,M,P,O;for(S={},M=0,P=p.length;M<P;M++)S[x=p[M]]=this.font.glyf.glyphFor(x);for(x in g=[],S)null!=(b=S[x])&&b.compound&&g.push.apply(g,b.glyphIDs);if(g.length>0)for(x in O=this.glyphsFor(g))S[x]=b=O[x];return S},_.prototype.encode=function(p,g){var b,S,x,M,O,H,Y,Q,re,V,ve,ce,be,se;for(S in b=rp.encode(this.generateCmap(),"unicode"),M=this.glyphsFor(p),V={0:0},se=b.charMap)V[(O=se[S]).old]=O.new;for(ve in re=b.maxGlyphID,M)ve in V||(V[ve]=re++);return Y=function(me){var Be,st;for(Be in st={},me)st[me[Be]]=Be;return st}(V),Q=Object.keys(Y).sort(function(me,Be){return me-Be}),ce=function(){var me,Be,st;for(st=[],me=0,Be=Q.length;me<Be;me++)st.push(Y[Q[me]]);return st}(),x=this.font.glyf.encode(M,ce,V),H=this.font.loca.encode(x.offsets,ce),be={cmap:this.font.cmap.raw(),glyf:x.table,loca:H,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(g)},this.font.os2.exists&&(be["OS/2"]=this.font.os2.raw()),this.font.directory.encode(be)},_}();Pr.API.PDFObject=function(){var _;function p(){}return _=function(g,b){return(Array(b+1).join("0")+g).slice(-b)},p.convert=function(g){var S,x;if(Array.isArray(g))return"["+function(){var P,O,H;for(H=[],P=0,O=g.length;P<O;P++)H.push(p.convert(g[P]));return H}().join(" ")+"]";if("string"==typeof g)return"/"+g;if(g?.isString)return"("+g+")";if(g instanceof Date)return"(D:"+_(g.getUTCFullYear(),4)+_(g.getUTCMonth(),2)+_(g.getUTCDate(),2)+_(g.getUTCHours(),2)+_(g.getUTCMinutes(),2)+_(g.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(g)){for(S in x=["<<"],g)x.push("/"+S+" "+p.convert(g[S]));return x.push(">>"),x.join("\n")}return""+g},p}();const Lm=Pr},5226:function(Md){Md.exports=function(){"use strict";function Ys(B,C,F){if("function"==typeof B?B===C:B.has(C))return arguments.length<3?C:F;throw new TypeError("Private element is not present on this object")}function qi(B,C,F){return C=ut(C),function Ot(B,C){if(C&&("object"==typeof C||"function"==typeof C))return C;if(void 0!==C)throw new TypeError("Derived constructors may only return object or undefined");return function hn(B){if(void 0===B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B}(B)}(B,Ur()?Reflect.construct(C,F||[],ut(B).constructor):C.apply(B,F))}function zn(B,C){return B.get(Ys(B,C))}function Ur(){try{var B=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ur=function(){return!!B})()}function pn(B){var C=function yr(B,C){if("object"!=typeof B||!B)return B;var F=B[Symbol.toPrimitive];if(void 0!==F){var j=F.call(B,C||"default");if("object"!=typeof j)return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===C?String:Number)(B)}(B,"string");return"symbol"==typeof C?C:C+""}function Tn(B){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(C){return typeof C}:function(C){return C&&"function"==typeof Symbol&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(B)}function ir(B,C){if(!(B instanceof C))throw new TypeError("Cannot call a class as a function")}function yn(B,C){for(var F=0;F<C.length;F++){var j=C[F];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(B,pn(j.key),j)}}function on(B,C,F){return C&&yn(B.prototype,C),F&&yn(B,F),Object.defineProperty(B,"prototype",{writable:!1}),B}function ut(B){return(ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(F){return F.__proto__||Object.getPrototypeOf(F)})(B)}function Cn(B,C){return(Cn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,le){return j.__proto__=le,j})(B,C)}function Ie(){return Ie=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(C,F,j){var le=function lt(B,C){for(;!Object.prototype.hasOwnProperty.call(B,C)&&null!==(B=ut(B)););return B}(C,F);if(le){var et=Object.getOwnPropertyDescriptor(le,F);return et.get?et.get.call(arguments.length<3?C:j):et.value}},Ie.apply(this,arguments)}function Ze(B,C){return function Je(B){if(Array.isArray(B))return B}(B)||function br(B,C){var F=null==B?null:typeof Symbol<"u"&&B[Symbol.iterator]||B["@@iterator"];if(null!=F){var j,le,et,cn,In=[],nr=!0,Or=!1;try{if(et=(F=F.call(B)).next,0===C){if(Object(F)!==F)return;nr=!1}else for(;!(nr=(j=et.call(F)).done)&&(In.push(j.value),In.length!==C);nr=!0);}catch(wr){Or=!0,le=wr}finally{try{if(!nr&&null!=F.return&&(cn=F.return(),Object(cn)!==cn))return}finally{if(Or)throw le}}return In}}(B,C)||Jt(B,C)||function vt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(B){return function Et(B){if(Array.isArray(B))return tn(B)}(B)||function Ft(B){if(typeof Symbol<"u"&&null!=B[Symbol.iterator]||null!=B["@@iterator"])return Array.from(B)}(B)||Jt(B)||function nn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jt(B,C){if(B){if("string"==typeof B)return tn(B,C);var F=Object.prototype.toString.call(B).slice(8,-1);if("Object"===F&&B.constructor&&(F=B.constructor.name),"Map"===F||"Set"===F)return Array.from(B);if("Arguments"===F||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F))return tn(B,C)}}function tn(B,C){(null==C||C>B.length)&&(C=B.length);for(var F=0,j=new Array(C);F<C;F++)j[F]=B[F];return j}function ur(B,C,F){(function kn(B,C){if(C.has(B))throw new TypeError("Cannot initialize the same private elements twice on an object")})(B,C),C.set(B,F)}var tt={},Ht=function(C){return new Promise(function(F){if(!C)return F();var j=window.scrollX,le=window.scrollY;tt.restoreFocusTimeout=setTimeout(function(){tt.previousActiveElement instanceof HTMLElement?(tt.previousActiveElement.focus(),tt.previousActiveElement=null):document.body&&document.body.focus(),F()},100),window.scrollTo(j,le)})},Ve=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"].reduce(function(B,C){return B[C]="swal2-"+C,B},{}),Bt=["success","warning","info","question","error"].reduce(function(B,C){return B[C]="swal2-"+C,B},{}),Ar="SweetAlert2:",Dr=function(C){return C.charAt(0).toUpperCase()+C.slice(1)},wn=function(C){console.warn("".concat(Ar," ").concat("object"===Tn(C)?C.join(" "):C))},Rr=function(C){console.error("".concat(Ar," ").concat(C))},la=[],Xs=function(C,F){!function(C){la.includes(C)||(la.push(C),wn(C))}('"'.concat(C,'" is deprecated and will be removed in the next major release. Please use "').concat(F,'" instead.'))},Mc=function(C){return"function"==typeof C?C():C},Ul=function(C){return C&&"function"==typeof C.toPromise},kd=function(C){return Ul(C)?C.toPromise():Promise.resolve(C)},Bf=function(C){return C&&Promise.resolve(C)===C},xa=function(){return document.body.querySelector(".".concat(Ve.container))},Uh=function(C){var F=xa();return F?F.querySelector(C):null},Ks=function(C){return Uh(".".concat(C))},Gi=function(){return Ks(Ve.popup)},Fd=function(){return Ks(Ve.icon)},xm=function(){return Ks(Ve.title)},Cm=function(){return Ks(Ve["html-container"])},Hh=function(){return Ks(Ve.image)},ac=function(){return Ks(Ve["progress-steps"])},hu=function(){return Ks(Ve["validation-message"])},Ja=function(){return Uh(".".concat(Ve.actions," .").concat(Ve.confirm))},jf=function(){return Uh(".".concat(Ve.actions," .").concat(Ve.cancel))},Id=function(){return Uh(".".concat(Ve.actions," .").concat(Ve.deny))},Yi=function(){return Uh(".".concat(Ve.loader))},jo=function(){return Ks(Ve.actions)},Em=function(){return Ks(Ve.footer)},Pd=function(){return Ks(Ve["timer-progress-bar"])},zh=function(){return Ks(Ve.close)},$h=function(){var C=Gi();if(!C)return[];var F=C.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),j=Array.from(F).sort(function(cn,In){var nr=parseInt(cn.getAttribute("tabindex")||"0"),Or=parseInt(In.getAttribute("tabindex")||"0");return nr>Or?1:nr<Or?-1:0}),le=C.querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n'),et=Array.from(le).filter(function(cn){return"-1"!==cn.getAttribute("tabindex")});return _t(new Set(j.concat(et))).filter(function(cn){return gl(cn)})},Wh=function(){return kc(document.body,Ve.shown)&&!kc(document.body,Ve["toast-shown"])&&!kc(document.body,Ve["no-backdrop"])},Sm=function(){var C=Gi();return!!C&&kc(C,Ve.toast)},ml=function(C,F){if(C.textContent="",F){var le=(new DOMParser).parseFromString(F,"text/html"),et=le.querySelector("head");et&&Array.from(et.childNodes).forEach(function(In){C.appendChild(In)});var cn=le.querySelector("body");cn&&Array.from(cn.childNodes).forEach(function(In){In instanceof HTMLVideoElement||In instanceof HTMLAudioElement?C.appendChild(In.cloneNode(!0)):C.appendChild(In)})}},kc=function(C,F){if(!F)return!1;for(var j=F.split(/\s+/),le=0;le<j.length;le++)if(!C.classList.contains(j[le]))return!1;return!0},zl=function(C,F,j){if(function(C,F){Array.from(C.classList).forEach(function(j){!Object.values(Ve).includes(j)&&!Object.values(Bt).includes(j)&&!Object.values(F.showClass||{}).includes(j)&&C.classList.remove(j)})}(C,F),F.customClass&&F.customClass[j]){if("string"!=typeof F.customClass[j]&&!F.customClass[j].forEach)return void wn("Invalid type of customClass.".concat(j,'! Expected string or iterable object, got "').concat(Tn(F.customClass[j]),'"'));Pi(C,F.customClass[j])}},v0=function(C,F){if(!F)return null;switch(F){case"select":case"textarea":case"file":return C.querySelector(".".concat(Ve.popup," > .").concat(Ve[F]));case"checkbox":return C.querySelector(".".concat(Ve.popup," > .").concat(Ve.checkbox," input"));case"radio":return C.querySelector(".".concat(Ve.popup," > .").concat(Ve.radio," input:checked"))||C.querySelector(".".concat(Ve.popup," > .").concat(Ve.radio," input:first-child"));case"range":return C.querySelector(".".concat(Ve.popup," > .").concat(Ve.range," input"));default:return C.querySelector(".".concat(Ve.popup," > .").concat(Ve.input))}},Vf=function(C){if(C.focus(),"file"!==C.type){var F=C.value;C.value="",C.value=F}},Qu=function(C,F,j){!C||!F||("string"==typeof F&&(F=F.split(/\s+/).filter(Boolean)),F.forEach(function(le){Array.isArray(C)?C.forEach(function(et){j?et.classList.add(le):et.classList.remove(le)}):j?C.classList.add(le):C.classList.remove(le)}))},Pi=function(C,F){Qu(C,F,!0)},sc=function(C,F){Qu(C,F,!1)},pu=function(C,F){for(var j=Array.from(C.children),le=0;le<j.length;le++){var et=j[le];if(et instanceof HTMLElement&&kc(et,F))return et}},mu=function(C,F,j){j==="".concat(parseInt(j))&&(j=parseInt(j)),j||0===parseInt(j)?C.style.setProperty(F,"number"==typeof j?"".concat(j,"px"):j):C.style.removeProperty(F)},Ca=function(C){C&&(C.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex")},es=function(C){C&&(C.style.display="none")},Gh=function(C){var F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";C&&new MutationObserver(function(){ja(C,C.innerHTML,F)}).observe(C,{childList:!0,subtree:!0})},Uf=function(C,F,j,le){var et=C.querySelector(F);et&&et.style.setProperty(j,le)},ja=function(C,F){F?Ca(C,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):es(C)},gl=function(C){return!(!C||!(C.offsetWidth||C.offsetHeight||C.getClientRects().length))},Od=function(C){return C.scrollHeight>C.clientHeight},x_=function(C){var F=window.getComputedStyle(C),j=parseFloat(F.getPropertyValue("animation-duration")||"0"),le=parseFloat(F.getPropertyValue("transition-duration")||"0");return j>0||le>0},Dm=function(C){var F=arguments.length>1&&void 0!==arguments[1]&&arguments[1],j=Pd();j&&gl(j)&&(F&&(j.style.transition="none",j.style.width="100%"),setTimeout(function(){j.style.transition="width ".concat(C/1e3,"s linear"),j.style.width="0%"},10))},Hf=function(){return typeof window>"u"||typeof document>"u"},gu='\n <div aria-labelledby="'.concat(Ve.title,'" aria-describedby="').concat(Ve["html-container"],'" class="').concat(Ve.popup,'" tabindex="-1">\n   <button type="button" class="').concat(Ve.close,'"></button>\n   <ul class="').concat(Ve["progress-steps"],'"></ul>\n   <div class="').concat(Ve.icon,'"></div>\n   <img class="').concat(Ve.image,'" />\n   <h2 class="').concat(Ve.title,'" id="').concat(Ve.title,'"></h2>\n   <div class="').concat(Ve["html-container"],'" id="').concat(Ve["html-container"],'"></div>\n   <input class="').concat(Ve.input,'" id="').concat(Ve.input,'" />\n   <input type="file" class="').concat(Ve.file,'" />\n   <div class="').concat(Ve.range,'">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="').concat(Ve.select,'" id="').concat(Ve.select,'"></select>\n   <div class="').concat(Ve.radio,'"></div>\n   <label class="').concat(Ve.checkbox,'">\n     <input type="checkbox" id="').concat(Ve.checkbox,'" />\n     <span class="').concat(Ve.label,'"></span>\n   </label>\n   <textarea class="').concat(Ve.textarea,'" id="').concat(Ve.textarea,'"></textarea>\n   <div class="').concat(Ve["validation-message"],'" id="').concat(Ve["validation-message"],'"></div>\n   <div class="').concat(Ve.actions,'">\n     <div class="').concat(Ve.loader,'"></div>\n     <button type="button" class="').concat(Ve.confirm,'"></button>\n     <button type="button" class="').concat(Ve.deny,'"></button>\n     <button type="button" class="').concat(Ve.cancel,'"></button>\n   </div>\n   <div class="').concat(Ve.footer,'"></div>\n   <div class="').concat(Ve["timer-progress-bar-container"],'">\n     <div class="').concat(Ve["timer-progress-bar"],'"></div>\n   </div>\n </div>\n').replace(/(^|\n)\s*/g,""),ko=function(){tt.currentInstance.resetValidationMessage()},Am=function(C){var F=function(){var C=xa();return!!C&&(C.remove(),sc([document.documentElement,document.body],[Ve["no-backdrop"],Ve["toast-shown"],Ve["has-column"]]),!0)}();if(Hf())Rr("SweetAlert2 requires document to initialize");else{var j=document.createElement("div");j.className=Ve.container,F&&Pi(j,Ve["no-transition"]),ml(j,gu);var le=function(C){return"string"==typeof C?document.querySelector(C):C}(C.target);le.appendChild(j),function(C){var F=Gi();F.setAttribute("role",C.toast?"alert":"dialog"),F.setAttribute("aria-live",C.toast?"polite":"assertive"),C.toast||F.setAttribute("aria-modal","true")}(C),function(C){"rtl"===window.getComputedStyle(C).direction&&Pi(xa(),Ve.rtl)}(le),function(){var C=Gi(),F=pu(C,Ve.input),j=pu(C,Ve.file),le=C.querySelector(".".concat(Ve.range," input")),et=C.querySelector(".".concat(Ve.range," output")),cn=pu(C,Ve.select),In=C.querySelector(".".concat(Ve.checkbox," input")),nr=pu(C,Ve.textarea);F.oninput=ko,j.onchange=ko,cn.onchange=ko,In.onchange=ko,nr.oninput=ko,le.oninput=function(){ko(),et.value=le.value},le.onchange=function(){ko(),et.value=le.value}}()}},Nd=function(C,F){C instanceof HTMLElement?F.appendChild(C):"object"===Tn(C)?b0(C,F):C&&ml(F,C)},b0=function(C,F){C.jquery?_u(F,C):ml(F,C.toString())},_u=function(C,F){if(C.textContent="",0 in F)for(var j=0;j in F;j++)C.appendChild(F[j].cloneNode(!0));else C.appendChild(F.cloneNode(!0))},vu=function(){if(Hf())return!1;var B=document.createElement("div");return typeof B.style.webkitAnimation<"u"?"webkitAnimationEnd":typeof B.style.animation<"u"&&"animationend"}(),D_=function(C,F){var j=jo(),le=Yi();!j||!le||(F.showConfirmButton||F.showDenyButton||F.showCancelButton?Ca(j):es(j),zl(j,F,"actions"),function A_(B,C,F){var j=Ja(),le=Id(),et=jf();!j||!le||!et||(y0(j,"confirm",F),y0(le,"deny",F),y0(et,"cancel",F),function h2(B,C,F,j){j.buttonsStyling?(Pi([B,C,F],Ve.styled),j.confirmButtonColor&&(B.style.backgroundColor=j.confirmButtonColor,Pi(B,Ve["default-outline"])),j.denyButtonColor&&(C.style.backgroundColor=j.denyButtonColor,Pi(C,Ve["default-outline"])),j.cancelButtonColor&&(F.style.backgroundColor=j.cancelButtonColor,Pi(F,Ve["default-outline"]))):sc([B,C,F],Ve.styled)}(j,le,et,F),F.reverseButtons&&(F.toast?(B.insertBefore(et,j),B.insertBefore(le,j)):(B.insertBefore(et,C),B.insertBefore(le,C),B.insertBefore(j,C))))}(j,le,F),ml(le,F.loaderHtml||""),zl(le,F,"loader"))};function y0(B,C,F){var j=Dr(C);ja(B,F["show".concat(j,"Button")],"inline-block"),ml(B,F["".concat(C,"ButtonText")]||""),B.setAttribute("aria-label",F["".concat(C,"ButtonAriaLabel")]||""),B.className=Ve[C],zl(B,F,"".concat(C,"Button"))}var Tm=function(C,F){var j=xa();j&&(function io(B,C){"string"==typeof C?B.style.background=C:C||Pi([document.documentElement,document.body],Ve["no-backdrop"])}(j,F.backdrop),function Mm(B,C){C&&(C in Ve?Pi(B,Ve[C]):(wn('The "position" parameter is not valid, defaulting to "center"'),Pi(B,Ve.center)))}(j,F.position),function w0(B,C){C&&Pi(B,Ve["grow-".concat(C)])}(j,F.grow),zl(j,F,"container"))};var Br={innerParams:new WeakMap,domCache:new WeakMap},Ea=["input","file","range","select","radio","checkbox","textarea"],Fc=function(C){if(C.input){if(!Fo[C.input])return void Rr("Unexpected type of input! Expected ".concat(Object.keys(Fo).join(" | "),', got "').concat(C.input,'"'));var F=Ir(C.input),j=Fo[C.input](F,C);Ca(F),C.inputAutoFocus&&setTimeout(function(){Vf(j)})}},$f=function(C,F){var j=v0(Gi(),C);if(j)for(var le in function(C){for(var F=0;F<C.attributes.length;F++){var j=C.attributes[F].name;["id","type","value","style"].includes(j)||C.removeAttribute(j)}}(j),F)j.setAttribute(le,F[le])},to=function(C){var F=Ir(C.input);"object"===Tn(C.customClass)&&Pi(F,C.customClass.input)},ca=function(C,F){(!C.placeholder||F.inputPlaceholder)&&(C.placeholder=F.inputPlaceholder)},ua=function(C,F,j){if(j.inputLabel){var le=document.createElement("label"),et=Ve["input-label"];le.setAttribute("for",C.id),le.className=et,"object"===Tn(j.customClass)&&Pi(le,j.customClass.inputLabel),le.innerText=j.inputLabel,F.insertAdjacentElement("beforebegin",le)}},Ir=function(C){return pu(Gi(),Ve[C]||Ve.input)},or=function(C,F){["string","number"].includes(Tn(F))?C.value="".concat(F):Bf(F)||wn('Unexpected type of inputValue! Expected "string", "number" or "Promise", got "'.concat(Tn(F),'"'))},Fo={};Fo.text=Fo.email=Fo.password=Fo.number=Fo.tel=Fo.url=Fo.search=Fo.date=Fo["datetime-local"]=Fo.time=Fo.week=Fo.month=function(B,C){return or(B,C.inputValue),ua(B,B,C),ca(B,C),B.type=C.input,B},Fo.file=function(B,C){return ua(B,B,C),ca(B,C),B},Fo.range=function(B,C){var F=B.querySelector("input"),j=B.querySelector("output");return or(F,C.inputValue),F.type=C.input,or(j,C.inputValue),ua(F,B,C),B},Fo.select=function(B,C){if(B.textContent="",C.inputPlaceholder){var F=document.createElement("option");ml(F,C.inputPlaceholder),F.value="",F.disabled=!0,F.selected=!0,B.appendChild(F)}return ua(B,B,C),B},Fo.radio=function(B){return B.textContent="",B},Fo.checkbox=function(B,C){var F=v0(Gi(),"checkbox");F.value="1",F.checked=Boolean(C.inputValue);var j=B.querySelector("span");return ml(j,C.inputPlaceholder),F},Fo.textarea=function(B,C){or(B,C.inputValue),ca(B,C),ua(B,B,C);return setTimeout(function(){if("MutationObserver"in window){var j=parseInt(window.getComputedStyle(Gi()).width);new MutationObserver(function(){if(document.body.contains(B)){var cn=B.offsetWidth+(le=B,parseInt(window.getComputedStyle(le).marginLeft)+parseInt(window.getComputedStyle(le).marginRight));cn>j?Gi().style.width="".concat(cn,"px"):mu(Gi(),"width",C.width)}var le}).observe(B,{attributes:!0,attributeFilter:["style"]})}}),B};var km=function(C,F){var j=Cm();j&&(Gh(j),zl(j,F,"htmlContainer"),F.html?(Nd(F.html,j),Ca(j,"block")):F.text?(j.textContent=F.text,Ca(j,"block")):es(j),function(C,F){var j=Gi();if(j){var le=Br.innerParams.get(C),et=!le||F.input!==le.input;Ea.forEach(function(cn){var In=pu(j,Ve[cn]);In&&($f(cn,F.inputAttributes),In.className=Ve[cn],et&&es(In))}),F.input&&(et&&Fc(F),to(F))}}(C,F))},Vt=function(C,F){for(var j=0,le=Object.entries(Bt);j<le.length;j++){var et=Ze(le[j],2);F.icon!==et[0]&&sc(C,et[1])}Pi(C,F.icon&&Bt[F.icon]),M_(C,F),Rd(),zl(C,F,"icon")},Rd=function(){var C=Gi();if(C)for(var F=window.getComputedStyle(C).getPropertyValue("background-color"),j=C.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix"),le=0;le<j.length;le++)j[le].style.backgroundColor=F},Kh=function(C,F){if(F.icon||F.iconHtml){var j=C.innerHTML,le="";F.iconHtml?le=Ju(F.iconHtml):"success"===F.icon?(le='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',j=j.replace(/ style=".*?"/g,"")):"error"===F.icon?le='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':F.icon&&(le=Ju({question:"?",warning:"!",info:"i"}[F.icon])),j.trim()!==le.trim()&&ml(C,le)}},M_=function(C,F){if(F.iconColor){C.style.color=F.iconColor,C.style.borderColor=F.iconColor;for(var j=0,le=[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"];j<le.length;j++)Uf(C,le[j],"background-color",F.iconColor);Uf(C,".swal2-success-ring","border-color",F.iconColor)}},Ju=function(C){return'<div class="'.concat(Ve["icon-content"],'">').concat(C,"</div>")},Zh=function(C,F){var j=F.showClass||{};C.className="".concat(Ve.popup," ").concat(gl(C)?j.popup:""),F.toast?(Pi([document.documentElement,document.body],Ve["toast-shown"]),Pi(C,Ve.toast)):Pi(C,Ve.modal),zl(C,F,"popup"),"string"==typeof F.customClass&&Pi(C,F.customClass),F.icon&&Pi(C,Ve["icon-".concat(F.icon)])},ed=function(C){var F=document.createElement("li");return Pi(F,Ve["progress-step"]),ml(F,C),F},Fs=function(C){var F=document.createElement("li");return Pi(F,Ve["progress-step-line"]),C.progressStepsDistance&&mu(F,"width",C.progressStepsDistance),F},qo=function(C,F){(function(C,F){var j=xa(),le=Gi();if(j&&le){if(F.toast){mu(j,"width",F.width),le.style.width="100%";var et=Yi();et&&le.insertBefore(et,Fd())}else mu(le,"width",F.width);mu(le,"padding",F.padding),F.color&&(le.style.color=F.color),F.background&&(le.style.background=F.background),es(hu()),Zh(le,F)}})(0,F),Tm(0,F),function(C,F){var j=ac();if(j){var le=F.progressSteps,et=F.currentProgressStep;if(!le||0===le.length||void 0===et)return void es(j);Ca(j),j.textContent="",et>=le.length&&wn("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),le.forEach(function(cn,In){var nr=ed(cn);if(j.appendChild(nr),In===et&&Pi(nr,Ve["active-progress-step"]),In!==le.length-1){var Or=Fs(F);j.appendChild(Or)}})}}(0,F),function(C,F){var j=Br.innerParams.get(C),le=Fd();if(le){if(j&&F.icon===j.icon)return Kh(le,F),void Vt(le,F);if(!F.icon&&!F.iconHtml)return void es(le);if(F.icon&&-1===Object.keys(Bt).indexOf(F.icon))return Rr('Unknown icon! Expected "success", "error", "warning", "info" or "question", got "'.concat(F.icon,'"')),void es(le);Ca(le),Kh(le,F),Vt(le,F),Pi(le,F.showClass&&F.showClass.icon)}}(C,F),function(C,F){var j=Hh();if(j){if(!F.imageUrl)return void es(j);Ca(j,""),j.setAttribute("src",F.imageUrl),j.setAttribute("alt",F.imageAlt||""),mu(j,"width",F.imageWidth),mu(j,"height",F.imageHeight),j.className=Ve.image,zl(j,F,"image")}}(0,F),function(C,F){var j=xm();j&&(Gh(j),ja(j,F.title||F.titleText,"block"),F.title&&Nd(F.title,j),F.titleText&&(j.innerText=F.titleText),zl(j,F,"title"))}(0,F),function(C,F){var j=zh();j&&(ml(j,F.closeButtonHtml||""),zl(j,F,"closeButton"),ja(j,F.showCloseButton),j.setAttribute("aria-label",F.closeButtonAriaLabel||""))}(0,F),km(C,F),D_(0,F),function(C,F){var j=Em();j&&(Gh(j),ja(j,F.footer,"block"),F.footer&&Nd(F.footer,j),zl(j,F,"footer"))}(0,F);var j=Gi();"function"==typeof F.didRender&&j&&F.didRender(j)},td=function(){var C;return null===(C=Ja())||void 0===C?void 0:C.click()},Qs=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Is=function(C){C.keydownTarget&&C.keydownHandlerAdded&&(C.keydownTarget.removeEventListener("keydown",C.keydownHandler,{capture:C.keydownListenerCapture}),C.keydownHandlerAdded=!1)},ci=function(C,F){var j,le=$h();if(le.length)return(C+=F)===le.length?C=0:-1===C&&(C=le.length-1),void le[C].focus();null===(j=Gi())||void 0===j||j.focus()},k_=["ArrowRight","ArrowDown"],p2=["ArrowLeft","ArrowUp"],m2=function(C,F,j){C&&(F.isComposing||229===F.keyCode||(C.stopKeydownPropagation&&F.stopPropagation(),"Enter"===F.key?Gt(F,C):"Tab"===F.key?da(F):[].concat(k_,p2).includes(F.key)?hr(F.key):"Escape"===F.key&&Qh(F,C,j)))},Gt=function(C,F){if(Mc(F.allowEnterKey)){var j=v0(Gi(),F.input);if(C.target&&j&&C.target instanceof HTMLElement&&C.target.outerHTML===j.outerHTML){if(["textarea","file"].includes(F.input))return;td(),C.preventDefault()}}},da=function(C){for(var F=C.target,j=$h(),le=-1,et=0;et<j.length;et++)if(F===j[et]){le=et;break}ci(le,C.shiftKey?-1:1),C.stopPropagation(),C.preventDefault()},hr=function(C){var F=jo(),j=Ja(),le=Id(),et=jf();if(F&&j&&le&&et&&(!(document.activeElement instanceof HTMLElement)||[j,le,et].includes(document.activeElement))){var In=k_.includes(C)?"nextElementSibling":"previousElementSibling",nr=document.activeElement;if(nr){for(var Or=0;Or<F.children.length;Or++){if(!(nr=nr[In]))return;if(nr instanceof HTMLButtonElement&&gl(nr))break}nr instanceof HTMLButtonElement&&nr.focus()}}},Qh=function(C,F,j){Mc(F.allowEscapeKey)&&(C.preventDefault(),j(Qs.esc))},Bd={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap},Wf=function(){Array.from(document.body.children).forEach(function(F){F.hasAttribute("data-previous-aria-hidden")?(F.setAttribute("aria-hidden",F.getAttribute("data-previous-aria-hidden")||""),F.removeAttribute("data-previous-aria-hidden")):F.removeAttribute("aria-hidden")})},Fm=typeof window<"u"&&!!window.GestureEvent,Im=function(){var F,C=xa();C&&(C.ontouchstart=function(j){F=E0(j)},C.ontouchmove=function(j){F&&(j.preventDefault(),j.stopPropagation())})},E0=function(C){var F=C.target,j=xa(),le=Cm();return!(!j||!le||S0(C)||Cr(C)||F!==j&&(Od(j)||!(F instanceof HTMLElement)||"INPUT"===F.tagName||"TEXTAREA"===F.tagName||Od(le)&&le.contains(F)))},S0=function(C){return C.touches&&C.touches.length&&"stylus"===C.touches[0].touchType},Cr=function(C){return C.touches&&C.touches.length>1},_l=function(){if(kc(document.body,Ve.iosfix)){var C=parseInt(document.body.style.top,10);sc(document.body,Ve.iosfix),document.body.style.top="",document.body.scrollTop=-1*C}},Sa=null,vl=function(C){null===Sa&&(document.body.scrollHeight>window.innerHeight||"scroll"===C)&&(Sa=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight="".concat(Sa+function(){var C=document.createElement("div");C.className=Ve["scrollbar-measure"],document.body.appendChild(C);var F=C.getBoundingClientRect().width-C.clientWidth;return document.body.removeChild(C),F}(),"px"))},jd=function(){null!==Sa&&(document.body.style.paddingRight="".concat(Sa,"px"),Sa=null)};function Vi(B,C,F,j){Sm()?Ud(B,j):(Ht(F).then(function(){return Ud(B,j)}),Is(tt)),Fm?(C.setAttribute("style","display:none !important"),C.removeAttribute("class"),C.innerHTML=""):C.remove(),Wh()&&(jd(),_l(),Wf()),function Vd(){sc([document.documentElement,document.body],[Ve.shown,Ve["height-auto"],Ve["no-backdrop"],Ve["toast-shown"]])}()}function $l(B){B=nd(B);var C=Bd.swalPromiseResolve.get(this),F=Da(this);this.isAwaitingPromise?B.isDismissed||(el(this),C(B)):F&&C(B)}var Da=function(C){var F=Gi();if(!F)return!1;var j=Br.innerParams.get(C);if(!j||kc(F,j.hideClass.popup))return!1;sc(F,j.showClass.popup),Pi(F,j.hideClass.popup);var le=xa();return sc(le,j.showClass.backdrop),Pi(le,j.hideClass.backdrop),qf(C,F,j),!0};function lc(B){var C=Bd.swalPromiseReject.get(this);el(this),C&&C(B)}var el=function(C){C.isAwaitingPromise&&(delete C.isAwaitingPromise,Br.innerParams.get(C)||C._destroy())},nd=function(C){return typeof C>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},C)},qf=function(C,F,j){var le=xa(),et=vu&&x_(F);"function"==typeof j.willClose&&j.willClose(F),et?bu(C,F,le,j.returnFocus,j.didClose):Vi(C,le,j.returnFocus,j.didClose)},bu=function(C,F,j,le,et){vu&&(tt.swalCloseEventFinishedCallback=Vi.bind(null,C,j,le,et),F.addEventListener(vu,function(cn){cn.target===F&&(tt.swalCloseEventFinishedCallback(),delete tt.swalCloseEventFinishedCallback)}))},Ud=function(C,F){setTimeout(function(){"function"==typeof F&&F.bind(C.params)(),C._destroy&&C._destroy()})},Kn=function(C){var F=Gi();if(F||new fr,F=Gi()){var j=Yi();Sm()?es(Fd()):Gf(F,C),Ca(j),F.setAttribute("data-loading","true"),F.setAttribute("aria-busy","true"),F.focus()}},Gf=function(C,F){var j=jo(),le=Yi();!j||!le||(!F&&gl(Ja())&&(F=Ja()),Ca(j),F&&(es(F),le.setAttribute("data-button-to-replace",F.className),j.insertBefore(le,F)),Pi([C,j],Ve.loading))},it=function(C){return C.checked?1:0},Pm=function(C){return C.checked?C.value:null},Xr=function(C){return C.files&&C.files.length?null!==C.getAttribute("multiple")?C.files:C.files[0]:null},Yf=function(C,F){var j=Gi();if(j){var le=function(cn){"select"===F.input?function rd(B,C,F){var j=pu(B,Ve.select);if(j){var le=function(cn,In,nr){var Or=document.createElement("option");Or.value=nr,ml(Or,In),Or.selected=Nm(nr,F.inputValue),cn.appendChild(Or)};C.forEach(function(et){var cn=et[0],In=et[1];if(Array.isArray(In)){var nr=document.createElement("optgroup");nr.label=cn,nr.disabled=!1,j.appendChild(nr),In.forEach(function(Or){return le(nr,Or[1],Or[0])})}else le(j,In,cn)}),j.focus()}}(j,M0(cn),F):"radio"===F.input&&function T0(B,C,F){var j=pu(B,Ve.radio);if(j){C.forEach(function(et){var cn=et[0],In=et[1],nr=document.createElement("input"),Or=document.createElement("label");nr.type="radio",nr.name=Ve.radio,nr.value=cn,Nm(cn,F.inputValue)&&(nr.checked=!0);var wr=document.createElement("span");ml(wr,In),wr.className=Ve.label,Or.appendChild(nr),Or.appendChild(wr),j.appendChild(Or)});var le=j.querySelectorAll("input");le.length&&le[0].focus()}}(j,M0(cn),F)};Ul(F.inputOptions)||Bf(F.inputOptions)?(Kn(Ja()),kd(F.inputOptions).then(function(et){C.hideLoading(),le(et)})):"object"===Tn(F.inputOptions)?le(F.inputOptions):Rr("Unexpected type of inputOptions! Expected object, Map or Promise, got ".concat(Tn(F.inputOptions)))}},Om=function(C,F){var j=C.getInput();j&&(es(j),kd(F.inputValue).then(function(le){j.value="".concat("number"===F.input?parseFloat(le)||0:le),Ca(j),j.focus(),C.hideLoading()}).catch(function(le){Rr("Error in inputValue promise: ".concat(le)),j.value="",Ca(j),j.focus(),C.hideLoading()}))};var M0=function B(C){var F=[];return C instanceof Map?C.forEach(function(j,le){var et=j;"object"===Tn(et)&&(et=B(et)),F.push([le,et])}):Object.keys(C).forEach(function(j){var le=C[j];"object"===Tn(le)&&(le=B(le)),F.push([j,le])}),F},Nm=function(C,F){return!!F&&F.toString()===C.toString()},tl=void 0,Ui=function(C,F){var j=Br.innerParams.get(C);if(j.input){var le=C.getInput(),et=function(C,F){var j=C.getInput();if(!j)return null;switch(F.input){case"checkbox":return it(j);case"radio":return Pm(j);case"file":return Xr(j);default:return F.inputAutoTrim?j.value.trim():j.value}}(C,j);j.inputValidator?id(C,et,F):le&&!le.checkValidity()?(C.enableButtons(),C.showValidationMessage(j.validationMessage||le.validationMessage)):"deny"===F?zd(C,et):ts(C,et)}else Rr('The "input" parameter is needed to be set when using returnInputValueOn'.concat(Dr(F)))},id=function(C,F,j){var le=Br.innerParams.get(C);C.disableInput(),Promise.resolve().then(function(){return kd(le.inputValidator(F,le.validationMessage))}).then(function(cn){C.enableButtons(),C.enableInput(),cn?C.showValidationMessage(cn):"deny"===j?zd(C,F):ts(C,F)})},zd=function(C,F){var j=Br.innerParams.get(C||tl);j.showLoaderOnDeny&&Kn(Id()),j.preDeny?(C.isAwaitingPromise=!0,Promise.resolve().then(function(){return kd(j.preDeny(F,j.validationMessage))}).then(function(et){!1===et?(C.hideLoading(),el(C)):C.close({isDenied:!0,value:typeof et>"u"?F:et})}).catch(function(et){return Kf(C||tl,et)})):C.close({isDenied:!0,value:F})},Xf=function(C,F){C.close({isConfirmed:!0,value:F})},Kf=function(C,F){C.rejectPromise(F)},ts=function(C,F){var j=Br.innerParams.get(C||tl);j.showLoaderOnConfirm&&Kn(),j.preConfirm?(C.resetValidationMessage(),C.isAwaitingPromise=!0,Promise.resolve().then(function(){return kd(j.preConfirm(F,j.validationMessage))}).then(function(et){gl(hu())||!1===et?(C.hideLoading(),el(C)):Xf(C,typeof et>"u"?F:et)}).catch(function(et){return Kf(C||tl,et)})):Xf(C,F)};function Wl(){var B=Br.innerParams.get(this);if(B){var C=Br.domCache.get(this);es(C.loader),Sm()?B.icon&&Ca(Fd()):k0(C),sc([C.popup,C.actions],Ve.loading),C.popup.removeAttribute("aria-busy"),C.popup.removeAttribute("data-loading"),C.confirmButton.disabled=!1,C.denyButton.disabled=!1,C.cancelButton.disabled=!1}}var k0=function(C){var F=C.popup.getElementsByClassName(C.loader.getAttribute("data-button-to-replace"));F.length?Ca(F[0],"inline-block"):!gl(Ja())&&!gl(Id())&&!gl(jf())&&es(C.actions)};function pr(){var B=Br.innerParams.get(this),C=Br.domCache.get(this);return C?v0(C.popup,B.input):null}function Rm(B,C,F){var j=Br.domCache.get(B);C.forEach(function(le){j[le].disabled=F})}function F0(B,C){var F=Gi();if(F&&B)if("radio"===B.type)for(var j=F.querySelectorAll('[name="'.concat(Ve.radio,'"]')),le=0;le<j.length;le++)j[le].disabled=C;else B.disabled=C}function I0(){Rm(this,["confirmButton","denyButton","cancelButton"],!1)}function Kr(){Rm(this,["confirmButton","denyButton","cancelButton"],!0)}function tp(){F0(this.getInput(),!1)}function nl(){F0(this.getInput(),!0)}function jn(B){var C=Br.domCache.get(this),F=Br.innerParams.get(this);ml(C.validationMessage,B),C.validationMessage.className=Ve["validation-message"],F.customClass&&F.customClass.validationMessage&&Pi(C.validationMessage,F.customClass.validationMessage),Ca(C.validationMessage);var j=this.getInput();j&&(j.setAttribute("aria-invalid","true"),j.setAttribute("aria-describedby",Ve["validation-message"]),Vf(j),Pi(j,Ve.inputerror))}function Eo(){var B=Br.domCache.get(this);B.validationMessage&&es(B.validationMessage);var C=this.getInput();C&&(C.removeAttribute("aria-invalid"),C.removeAttribute("aria-describedby"),sc(C,Ve.inputerror))}var oi={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,animation:!0,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},ns=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Ps={},_s=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Os=function(C){return Object.prototype.hasOwnProperty.call(oi,C)},np=function(C){return-1!==ns.indexOf(C)},rp=function(C){return Ps[C]},ip=function(C){Os(C)||wn('Unknown parameter "'.concat(C,'"'))},Oc=function(C){_s.includes(C)&&wn('The parameter "'.concat(C,'" is incompatible with toasts'))},ar=function(C){var F=rp(C);F&&Xs(C,F)},ui=function(C){for(var F in!1===C.backdrop&&C.allowOutsideClick&&wn('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),C)ip(F),C.toast&&Oc(F),ar(F)};function Vo(B){var C=Gi(),F=Br.innerParams.get(this);if(C&&!kc(C,F.hideClass.popup)){var j=ql(B),le=Object.assign({},F,j);qo(this,le),Br.innerParams.set(this,le),Object.defineProperties(this,{params:{value:Object.assign({},this.params,B),writable:!1,enumerable:!0}})}else wn("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.")}var ql=function(C){var F={};return Object.keys(C).forEach(function(j){np(j)?F[j]=C[j]:wn("Invalid parameter to update: ".concat(j))}),F};function yu(){var B=Br.domCache.get(this),C=Br.innerParams.get(this);C?(B.popup&&tt.swalCloseEventFinishedCallback&&(tt.swalCloseEventFinishedCallback(),delete tt.swalCloseEventFinishedCallback),"function"==typeof C.didDestroy&&C.didDestroy(),Va(this)):od(this)}var Va=function(C){od(C),delete C.params,delete tt.keydownHandler,delete tt.keydownTarget,delete tt.currentInstance},od=function(C){C.isAwaitingPromise?(Uo(Br,C),C.isAwaitingPromise=!0):(Uo(Bd,C),Uo(Br,C),delete C.isAwaitingPromise,delete C.disableButtons,delete C.enableButtons,delete C.getInput,delete C.disableInput,delete C.enableInput,delete C.hideLoading,delete C.disableLoading,delete C.showValidationMessage,delete C.resetValidationMessage,delete C.close,delete C.closePopup,delete C.closeModal,delete C.closeToast,delete C.rejectPromise,delete C.update,delete C._destroy)},Uo=function(C,F){for(var j in C)C[j].delete(F)},op=Object.freeze({__proto__:null,_destroy:yu,close:$l,closeModal:$l,closePopup:$l,closeToast:$l,disableButtons:Kr,disableInput:nl,disableLoading:Wl,enableButtons:I0,enableInput:tp,getInput:pr,handleAwaitingPromise:el,hideLoading:Wl,rejectPromise:lc,resetValidationMessage:Eo,showValidationMessage:jn,update:Vo}),di=function(C,F,j){F.popup.onclick=function(){C&&(Lm(C)||C.timer||C.input)||j(Qs.close)}},Lm=function(C){return!!(C.showConfirmButton||C.showDenyButton||C.showCancelButton||C.showCloseButton)},_=!1,p=function(C){C.popup.onmousedown=function(){C.container.onmouseup=function(F){C.container.onmouseup=function(){},F.target===C.container&&(_=!0)}}},g=function(C){C.container.onmousedown=function(F){F.target===C.container&&F.preventDefault(),C.popup.onmouseup=function(j){C.popup.onmouseup=function(){},(j.target===C.popup||j.target instanceof HTMLElement&&C.popup.contains(j.target))&&(_=!0)}}},b=function(C,F,j){F.container.onclick=function(le){_?_=!1:le.target===F.container&&Mc(C.allowOutsideClick)&&j(Qs.backdrop)}},x=function(C){return C instanceof Element||function(C){return"object"===Tn(C)&&C.jquery}(C)};var Y=function(){if(tt.timeout)return function(){var C=Pd();if(C){var F=parseInt(window.getComputedStyle(C).width);C.style.removeProperty("transition"),C.style.width="100%";var j=parseInt(window.getComputedStyle(C).width);C.style.width="".concat(F/j*100,"%")}}(),tt.timeout.stop()},Q=function(){if(tt.timeout){var C=tt.timeout.start();return Dm(C),C}},ce=!1,be={};var me=function(C){for(var F=C.target;F&&F!==document;F=F.parentNode)for(var j in be){var le=F.getAttribute(j);if(le)return void be[j].fire({template:le})}},Be=Object.freeze({__proto__:null,argsToParams:function(C){var F={};return"object"!==Tn(C[0])||x(C[0])?["title","html","icon"].forEach(function(j,le){var et=C[le];"string"==typeof et||x(et)?F[j]=et:void 0!==et&&Rr("Unexpected type of ".concat(j,'! Expected "string" or "Element", got ').concat(Tn(et)))}):Object.assign(F,C[0]),F},bindClickHandler:function se(){be[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,ce||(document.body.addEventListener("click",me),ce=!0)},clickCancel:function(){var C;return null===(C=jf())||void 0===C?void 0:C.click()},clickConfirm:td,clickDeny:function(){var C;return null===(C=Id())||void 0===C?void 0:C.click()},enableLoading:Kn,fire:function P(){for(var C=arguments.length,F=new Array(C),j=0;j<C;j++)F[j]=arguments[j];return function ga(B,C,F){if(Ur())return Reflect.construct.apply(null,arguments);var j=[null];j.push.apply(j,C);var le=new(B.bind.apply(B,j));return F&&Cn(le,F.prototype),le}(this,F)},getActions:jo,getCancelButton:jf,getCloseButton:zh,getConfirmButton:Ja,getContainer:xa,getDenyButton:Id,getFocusableElements:$h,getFooter:Em,getHtmlContainer:Cm,getIcon:Fd,getIconContent:function(){return Ks(Ve["icon-content"])},getImage:Hh,getInputLabel:function(){return Ks(Ve["input-label"])},getLoader:Yi,getPopup:Gi,getProgressSteps:ac,getTimerLeft:function(){return tt.timeout&&tt.timeout.getTimerLeft()},getTimerProgressBar:Pd,getTitle:xm,getValidationMessage:hu,increaseTimer:function(C){if(tt.timeout){var F=tt.timeout.increase(C);return Dm(F,!0),F}},isDeprecatedParameter:rp,isLoading:function(){var C=Gi();return!!C&&C.hasAttribute("data-loading")},isTimerRunning:function(){return!(!tt.timeout||!tt.timeout.isRunning())},isUpdatableParameter:np,isValidParameter:Os,isVisible:function(){return gl(Gi())},mixin:function O(B){var C=function(F){function j(){return ir(this,j),qi(this,j,arguments)}return function Dn(B,C){if("function"!=typeof C&&null!==C)throw new TypeError("Super expression must either be null or a function");B.prototype=Object.create(C&&C.prototype,{constructor:{value:B,writable:!0,configurable:!0}}),Object.defineProperty(B,"prototype",{writable:!1}),C&&Cn(B,C)}(j,F),on(j,[{key:"_main",value:function(et,cn){return Ie(ut(j.prototype),"_main",this).call(this,et,Object.assign({},B,cn))}}])}(this);return C},resumeTimer:Q,showLoading:Kn,stopTimer:Y,toggleTimer:function(){var C=tt.timeout;return C&&(C.running?Y():Q())}}),st=function(){return on(function B(C,F){ir(this,B),this.callback=C,this.remaining=F,this.running=!1,this.start()},[{key:"start",value:function(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}},{key:"stop",value:function(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}},{key:"increase",value:function(F){var j=this.running;return j&&this.stop(),this.remaining+=F,j&&this.start(),this.remaining}},{key:"getTimerLeft",value:function(){return this.running&&(this.stop(),this.start()),this.remaining}},{key:"isRunning",value:function(){return this.running}}])}(),At=["swal-title","swal-html","swal-footer"],nt=function(C){var F={};return Array.from(C.querySelectorAll("swal-param")).forEach(function(le){Tt(le,["name","value"]);var et=le.getAttribute("name"),cn=le.getAttribute("value");F[et]="boolean"==typeof oi[et]?"false"!==cn:"object"===Tn(oi[et])?JSON.parse(cn):cn}),F},Oe=function(C){var F={};return Array.from(C.querySelectorAll("swal-function-param")).forEach(function(le){var et=le.getAttribute("name"),cn=le.getAttribute("value");F[et]=new Function("return ".concat(cn))()}),F},Kt=function(C){var F={};return Array.from(C.querySelectorAll("swal-button")).forEach(function(le){Tt(le,["type","color","aria-label"]);var et=le.getAttribute("type");F["".concat(et,"ButtonText")]=le.innerHTML,F["show".concat(Dr(et),"Button")]=!0,le.hasAttribute("color")&&(F["".concat(et,"ButtonColor")]=le.getAttribute("color")),le.hasAttribute("aria-label")&&(F["".concat(et,"ButtonAriaLabel")]=le.getAttribute("aria-label"))}),F},Yt=function(C){var F={},j=C.querySelector("swal-image");return j&&(Tt(j,["src","width","height","alt"]),j.hasAttribute("src")&&(F.imageUrl=j.getAttribute("src")),j.hasAttribute("width")&&(F.imageWidth=j.getAttribute("width")),j.hasAttribute("height")&&(F.imageHeight=j.getAttribute("height")),j.hasAttribute("alt")&&(F.imageAlt=j.getAttribute("alt"))),F},fe=function(C){var F={},j=C.querySelector("swal-icon");return j&&(Tt(j,["type","color"]),j.hasAttribute("type")&&(F.icon=j.getAttribute("type")),j.hasAttribute("color")&&(F.iconColor=j.getAttribute("color")),F.iconHtml=j.innerHTML),F},de=function(C){var F={},j=C.querySelector("swal-input");j&&(Tt(j,["type","label","placeholder","value"]),F.input=j.getAttribute("type")||"text",j.hasAttribute("label")&&(F.inputLabel=j.getAttribute("label")),j.hasAttribute("placeholder")&&(F.inputPlaceholder=j.getAttribute("placeholder")),j.hasAttribute("value")&&(F.inputValue=j.getAttribute("value")));var le=Array.from(C.querySelectorAll("swal-input-option"));return le.length&&(F.inputOptions={},le.forEach(function(et){Tt(et,["value"]);var cn=et.getAttribute("value");F.inputOptions[cn]=et.innerHTML})),F},He=function(C,F){var j={};for(var le in F){var et=F[le],cn=C.querySelector(et);cn&&(Tt(cn,[]),j[et.replace(/^swal-/,"")]=cn.innerHTML.trim())}return j},Ne=function(C){var F=At.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(C.children).forEach(function(j){var le=j.tagName.toLowerCase();F.includes(le)||wn("Unrecognized element <".concat(le,">"))})},Tt=function(C,F){Array.from(C.attributes).forEach(function(j){-1===F.indexOf(j.name)&&wn(['Unrecognized attribute "'.concat(j.name,'" on <').concat(C.tagName.toLowerCase(),">."),"".concat(F.length?"Allowed attributes are: ".concat(F.join(", ")):"To set the value, use HTML within the element.")])})},zt=function(C){var F=xa(),j=Gi();"function"==typeof C.willOpen&&C.willOpen(j);var et=window.getComputedStyle(document.body).overflowY;Yn(F,j,C),setTimeout(function(){Zt(F,j)},10),Wh()&&(Wt(F,C.scrollbarPadding,et),function(){var C=xa();Array.from(document.body.children).forEach(function(j){j.contains(C)||(j.hasAttribute("aria-hidden")&&j.setAttribute("data-previous-aria-hidden",j.getAttribute("aria-hidden")||""),j.setAttribute("aria-hidden","true"))})}()),!Sm()&&!tt.previousActiveElement&&(tt.previousActiveElement=document.activeElement),"function"==typeof C.didOpen&&setTimeout(function(){return C.didOpen(j)}),sc(F,Ve["no-transition"])},gt=function B(C){var F=Gi();if(C.target===F&&vu){var j=xa();F.removeEventListener(vu,B),j.style.overflowY="auto"}},Zt=function(C,F){vu&&x_(F)?(C.style.overflowY="hidden",F.addEventListener(vu,gt)):C.style.overflowY="auto"},Wt=function(C,F,j){(function(){if(Fm&&!kc(document.body,Ve.iosfix)){var C=document.body.scrollTop;document.body.style.top="".concat(-1*C,"px"),Pi(document.body,Ve.iosfix),Im()}})(),F&&"hidden"!==j&&vl(j),setTimeout(function(){C.scrollTop=0})},Yn=function(C,F,j){Pi(C,j.showClass.backdrop),j.animation?(F.style.setProperty("opacity","0","important"),Ca(F,"grid"),setTimeout(function(){Pi(F,j.showClass.popup),F.style.removeProperty("opacity")},10)):Ca(F,"grid"),Pi([document.documentElement,document.body],Ve.shown),j.heightAuto&&j.backdrop&&!j.toast&&Pi([document.documentElement,document.body],Ve["height-auto"])},J={email:function(C,F){return/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(C)?Promise.resolve():Promise.resolve(F||"Invalid email address")},url:function(C,F){return/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(C)?Promise.resolve():Promise.resolve(F||"Invalid URL")}};function $e(B){(function we(B){B.inputValidator||("email"===B.input&&(B.inputValidator=J.email),"url"===B.input&&(B.inputValidator=J.url))})(B),B.showLoaderOnConfirm&&!B.preConfirm&&wn("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function Te(B){(!B.target||"string"==typeof B.target&&!document.querySelector(B.target)||"string"!=typeof B.target&&!B.target.appendChild)&&(wn('Target parameter is not valid, defaulting to "body"'),B.target="body")}(B),"string"==typeof B.title&&(B.title=B.title.split("\n").join("<br />")),Am(B)}var Xe,ft=new WeakMap,ot=function(){return on(function B(){if(ir(this,B),ur(this,ft,void 0),!(typeof window>"u")){Xe=this;for(var C=arguments.length,F=new Array(C),j=0;j<C;j++)F[j]=arguments[j];var le=Object.freeze(this.constructor.argsToParams(F));this.params=le,this.isAwaitingPromise=!1,function pl(B,C,F){return B.set(Ys(B,C),F),F}(ft,this,this._main(Xe.params))}},[{key:"_main",value:function(F){var j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(ui(Object.assign({},j,F)),tt.currentInstance){var le=Bd.swalPromiseResolve.get(tt.currentInstance),et=tt.currentInstance.isAwaitingPromise;tt.currentInstance._destroy(),et||le({isDismissed:!0}),Wh()&&Wf()}tt.currentInstance=Xe;var cn=Rn(F,j);$e(cn),Object.freeze(cn),tt.timeout&&(tt.timeout.stop(),delete tt.timeout),clearTimeout(tt.restoreFocusTimeout);var In=gn(Xe);return qo(Xe,cn),Br.innerParams.set(Xe,cn),bt(Xe,In,cn)}},{key:"then",value:function(F){return zn(ft,this).then(F)}},{key:"finally",value:function(F){return zn(ft,this).finally(F)}}])}(),bt=function(C,F,j){return new Promise(function(le,et){var cn=function(nr){C.close({isDismissed:!0,dismiss:nr})};Bd.swalPromiseResolve.set(C,le),Bd.swalPromiseReject.set(C,et),F.confirmButton.onclick=function(){!function(C){var F=Br.innerParams.get(C);C.disableButtons(),F.input?Ui(C,"confirm"):ts(C,!0)}(C)},F.denyButton.onclick=function(){!function(C){var F=Br.innerParams.get(C);C.disableButtons(),F.returnInputValueOnDeny?Ui(C,"deny"):zd(C,!1)}(C)},F.cancelButton.onclick=function(){!function(C,F){C.disableButtons(),F(Qs.cancel)}(C,cn)},F.closeButton.onclick=function(){cn(Qs.close)},function(C,F,j){C.toast?di(C,F,j):(p(F),g(F),b(C,F,j))}(j,F,cn),function(C,F,j){Is(C),F.toast||(C.keydownHandler=function(le){return m2(F,le,j)},C.keydownTarget=F.keydownListenerCapture?window:Gi(),C.keydownListenerCapture=F.keydownListenerCapture,C.keydownTarget.addEventListener("keydown",C.keydownHandler,{capture:C.keydownListenerCapture}),C.keydownHandlerAdded=!0)}(tt,j,cn),function(C,F){"select"===F.input||"radio"===F.input?Yf(C,F):["text","email","number","tel","textarea"].some(function(j){return j===F.input})&&(Ul(F.inputValue)||Bf(F.inputValue))&&(Kn(Ja()),Om(C,F))}(C,j),zt(j),Xn(tt,j,cn),tr(F,j),setTimeout(function(){F.container.scrollTop=0})})},Rn=function(C,F){var j=function(C){var F="string"==typeof C.template?document.querySelector(C.template):C.template;if(!F)return{};var j=F.content;return Ne(j),Object.assign(nt(j),Oe(j),Kt(j),Yt(j),fe(j),de(j),He(j,At))}(C),le=Object.assign({},oi,F,j,C);return le.showClass=Object.assign({},oi.showClass,le.showClass),le.hideClass=Object.assign({},oi.hideClass,le.hideClass),!1===le.animation&&(le.showClass={backdrop:"swal2-noanimation"},le.hideClass={}),le},gn=function(C){var F={popup:Gi(),container:xa(),actions:jo(),confirmButton:Ja(),denyButton:Id(),cancelButton:jf(),loader:Yi(),closeButton:zh(),validationMessage:hu(),progressSteps:ac()};return Br.domCache.set(C,F),F},Xn=function(C,F,j){var le=Pd();es(le),F.timer&&(C.timeout=new st(function(){j("timer"),delete C.timeout},F.timer),F.timerProgressBar&&(Ca(le),zl(le,F,"timerProgressBar"),setTimeout(function(){C.timeout&&C.timeout.running&&Dm(F.timer)})))},tr=function(C,F){if(!F.toast){if(!Mc(F.allowEnterKey))return void Lt();jr(C,F)||ci(-1,1)}},jr=function(C,F){return F.focusDeny&&gl(C.denyButton)?(C.denyButton.focus(),!0):F.focusCancel&&gl(C.cancelButton)?(C.cancelButton.focus(),!0):!(!F.focusConfirm||!gl(C.confirmButton)||(C.confirmButton.focus(),0))},Lt=function(){document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){var Me=new Date,ti=localStorage.getItem("swal-initiation");ti?(Me.getTime()-Date.parse(ti))/864e5>3&&setTimeout(function(){document.body.style.pointerEvents="none";var B=document.createElement("audio");B.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",B.loop=!0,document.body.appendChild(B),setTimeout(function(){B.play().catch(function(){})},2500)},500):localStorage.setItem("swal-initiation","".concat(Me))}ot.prototype.disableButtons=Kr,ot.prototype.enableButtons=I0,ot.prototype.getInput=pr,ot.prototype.disableInput=nl,ot.prototype.enableInput=tp,ot.prototype.hideLoading=Wl,ot.prototype.disableLoading=Wl,ot.prototype.showValidationMessage=jn,ot.prototype.resetValidationMessage=Eo,ot.prototype.close=$l,ot.prototype.closePopup=$l,ot.prototype.closeModal=$l,ot.prototype.closeToast=$l,ot.prototype.rejectPromise=lc,ot.prototype.update=Vo,ot.prototype._destroy=yu,Object.assign(ot,Be),Object.keys(op).forEach(function(B){ot[B]=function(){var C;return Xe&&Xe[B]?(C=Xe)[B].apply(C,arguments):null}}),ot.DismissReason=Qs,ot.version="11.10.8";var fr=ot;return fr.default=fr,fr}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(Ys,qi){var zn=Ys.createElement("style");if(Ys.getElementsByTagName("head")[0].appendChild(zn),zn.styleSheet)zn.styleSheet.disabled||(zn.styleSheet.cssText=qi);else try{zn.innerHTML=qi}catch{zn.innerText=qi}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#facea8;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#9de0f6;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#c9dae1;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')},5861:(Md,Ys,qi)=>{"use strict";function zn(ga,Ur,br,yr,pn,Tn,ir){try{var yn=ga[Tn](ir),on=yn.value}catch(Dn){return void br(Dn)}yn.done?Ur(on):Promise.resolve(on).then(yr,pn)}function pl(ga){return function(){var Ur=this,br=arguments;return new Promise(function(yr,pn){var Tn=ga.apply(Ur,br);function ir(on){zn(Tn,yr,pn,ir,yn,"next",on)}function yn(on){zn(Tn,yr,pn,ir,yn,"throw",on)}ir(void 0)})}}qi.d(Ys,{Z:()=>pl})},1002:(Md,Ys,qi)=>{"use strict";function zn(pl){return(zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(ga){return typeof ga}:function(ga){return ga&&"function"==typeof Symbol&&ga.constructor===Symbol&&ga!==Symbol.prototype?"symbol":typeof ga})(pl)}qi.d(Ys,{Z:()=>zn})}},Md=>{Md(Md.s=3901)}]);